<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="string operations">
    
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>M_matrix.f90 &ndash; M_strings</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">M_strings </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>M_matrix.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="84.3% of total for source files.">5617 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/M_matrix.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">M_matrix.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_matrix.html">M_matrix</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_matrix.f90.html#src">M_matrix.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
      
      

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_matrix.html">M_matrix</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_matrix.f90.html#src">M_matrix.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt;</span>
<a name="ln-2"></a><span class="c">!!##NAME</span>
<a name="ln-3"></a><span class="c">!!    M_matrix(3f) - [M_matrix] The Los Alamos-inspired Linear Algebra Fortran Facility (LALA)</span>
<a name="ln-4"></a><span class="c">!!    LICENSE(MIT)</span>
<a name="ln-5"></a><span class="c">!!</span>
<a name="ln-6"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7"></a><span class="c">!! The M_matrix module contains the Linear Algebra Fortran Facility (LALA)</span>
<a name="ln-8"></a><span class="c">!! which allows for interacting with a Fortran program using Matlab</span>
<a name="ln-9"></a><span class="c">!! or Octave-like commands.  LALA is also usable as a simple one-line</span>
<a name="ln-10"></a><span class="c">!! language. It is a WIP (Work In Progress) but is already useful.</span>
<a name="ln-11"></a><span class="c">!!</span>
<a name="ln-12"></a><span class="c">!!   * You can pass intrinsic-type data easily between your Fortran</span>
<a name="ln-13"></a><span class="c">!!     program and the LALA utility.</span>
<a name="ln-14"></a><span class="c">!!   * blocks of LALA commands may be passed to lala(3f) as well.</span>
<a name="ln-15"></a><span class="c">!!   * external files containing lala(3f) commands may be read to create</span>
<a name="ln-16"></a><span class="c">!!     data or as configuration files.</span>
<a name="ln-17"></a><span class="c">!!   * LALA commands may be recorded and played back.</span>
<a name="ln-18"></a><span class="c">!!   * a command-line based command history allowed for recalling and editing</span>
<a name="ln-19"></a><span class="c">!!     input.</span>
<a name="ln-20"></a><span class="c">!!   * a stand-alone program lets you create and test LALA files. It is</span>
<a name="ln-21"></a><span class="c">!!     a flexible calculator utility all by itself.</span>
<a name="ln-22"></a><span class="c">!!   * a built-in help command describes the many functions and commands</span>
<a name="ln-23"></a><span class="c">!!   * a user-added Fortran routine may be called via the USER() function.</span>
<a name="ln-24"></a><span class="c">!!</span>
<a name="ln-25"></a><span class="c">!! All together, this allows lala(3f) to be used for self-describing</span>
<a name="ln-26"></a><span class="c">!! configuration and data files, inspecting data in existing programs,</span>
<a name="ln-27"></a><span class="c">!! transferring small amounts of data between programs or assisting in</span>
<a name="ln-28"></a><span class="c">!! debugging and development, unit testing and macro-level timing.</span>
<a name="ln-29"></a><span class="c">!!</span>
<a name="ln-30"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-31"></a><span class="c">!!</span>
<a name="ln-32"></a><span class="c">!!   Sample program:</span>
<a name="ln-33"></a><span class="c">!!</span>
<a name="ln-34"></a><span class="c">!!     program demo_M_matrix</span>
<a name="ln-35"></a><span class="c">!!     use M_matrix, only : lala, put_into_lala, get_from_lala, ifin_lala</span>
<a name="ln-36"></a><span class="c">!!     !real,allocatable             :: r</span>
<a name="ln-37"></a><span class="c">!!     !complex,allocatable          :: cvec(:)</span>
<a name="ln-38"></a><span class="c">!!     integer,allocatable          :: iarr(:,:)</span>
<a name="ln-39"></a><span class="c">!!     character(len=:),allocatable :: t(:)</span>
<a name="ln-40"></a><span class="c">!!     integer                      :: ierr</span>
<a name="ln-41"></a><span class="c">!!</span>
<a name="ln-42"></a><span class="c">!!     ! store some data into lala(3)</span>
<a name="ln-43"></a><span class="c">!!     call put_into_lala(&#39;A&#39;,[1,2,3,4,5]*10.5,ierr)</span>
<a name="ln-44"></a><span class="c">!!     write(*,*)&#39;is A defined in LALA?&#39;,ifin_lala(&#39;A&#39;)</span>
<a name="ln-45"></a><span class="c">!!     call lala(&#39;A/2.0&#39;)</span>
<a name="ln-46"></a><span class="c">!!</span>
<a name="ln-47"></a><span class="c">!!     ! pass some commands to lala(3f)</span>
<a name="ln-48"></a><span class="c">!!     call lala([character(len=80) :: &amp;</span>
<a name="ln-49"></a><span class="c">!!     &amp;&#39;PI=atan(1)*4               &#39;, &amp;</span>
<a name="ln-50"></a><span class="c">!!     &amp;&quot;mytitle=&#39;this is my title&#39;;&quot;, &amp;</span>
<a name="ln-51"></a><span class="c">!!     &amp;&#39;littlearray=&lt;              &#39;, &amp;</span>
<a name="ln-52"></a><span class="c">!!     &amp;&#39;   1 2 3;                  &#39;, &amp;</span>
<a name="ln-53"></a><span class="c">!!     &amp;&#39;   4 5 6;                  &#39;, &amp;</span>
<a name="ln-54"></a><span class="c">!!     &amp;&#39;   7 8 9;                  &#39;, &amp;</span>
<a name="ln-55"></a><span class="c">!!     &amp;&#39;&gt;                          &#39;, &amp;</span>
<a name="ln-56"></a><span class="c">!!     &amp;&#39;S=sum(A)                   &#39;, &amp;</span>
<a name="ln-57"></a><span class="c">!!     &amp;&#39;I=inv(littlearray);        &#39;, &amp;</span>
<a name="ln-58"></a><span class="c">!!     &amp;&#39;B=littlearray*sin(PI/3)    &#39;, &amp;</span>
<a name="ln-59"></a><span class="c">!!     &amp;&quot;save(&#39;keepB&#39;,B)            &quot;, &amp;</span>
<a name="ln-60"></a><span class="c">!!     &amp;&#39;&#39;])</span>
<a name="ln-61"></a><span class="c">!!</span>
<a name="ln-62"></a><span class="c">!!     ! read a file containing lala(3f) commands</span>
<a name="ln-63"></a><span class="c">!!     call lala(&quot;exec(&#39;mycommands&#39;);&quot;)</span>
<a name="ln-64"></a><span class="c">!!</span>
<a name="ln-65"></a><span class="c">!!     ! interactively interact with lala(3f) interpreter</span>
<a name="ln-66"></a><span class="c">!!     call lala()</span>
<a name="ln-67"></a><span class="c">!!</span>
<a name="ln-68"></a><span class="c">!!     ! get some data from LALA into the calling program</span>
<a name="ln-69"></a><span class="c">!!     call get_from_lala(&#39;littlearray&#39;,iarr,ierr)</span>
<a name="ln-70"></a><span class="c">!!     write(*,&#39;(a)&#39;)&#39;IN CALLING PROGRAM IARR=&#39;</span>
<a name="ln-71"></a><span class="c">!!     write(*,&#39;(1x,*(g0,1x))&#39;)(IARR(i,:),new_line(&#39;A&#39;),i=1,size(iarr,dim=1))</span>
<a name="ln-72"></a><span class="c">!!</span>
<a name="ln-73"></a><span class="c">!!     call get_from_lala(&#39;mytitle&#39;,t,ierr)</span>
<a name="ln-74"></a><span class="c">!!     write(*,*)&#39;IN CALLING PROGRAM T=&#39;,t</span>
<a name="ln-75"></a><span class="c">!!</span>
<a name="ln-76"></a><span class="c">!!     end program demo_M_matrix</span>
<a name="ln-77"></a><span class="k">module </span><span class="n">M_matrix</span>
<a name="ln-78"></a>
<a name="ln-79"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">stderr</span><span class="o">=&gt;</span><span class="n">ERROR_UNIT</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=&gt;</span><span class="n">INPUT_UNIT</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=&gt;</span><span class="n">OUTPUT_UNIT</span>
<a name="ln-80"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">int8</span><span class="p">,</span> <span class="n">int16</span><span class="p">,</span> <span class="n">int32</span><span class="p">,</span> <span class="n">int64</span><span class="p">,</span> <span class="n">real32</span><span class="p">,</span> <span class="n">real64</span><span class="p">,</span> <span class="n">real128</span>
<a name="ln-81"></a>
<a name="ln-82"></a><span class="k">use </span><span class="n">M_strings</span><span class="p">,</span> <span class="k">only</span>     <span class="p">:</span> <span class="n">value_to_string</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">v2s</span><span class="p">,</span> <span class="n">s2v</span>
<a name="ln-83"></a><span class="k">use </span><span class="n">M_journal</span><span class="p">,</span> <span class="k">only</span>     <span class="p">:</span> <span class="n">journal</span>
<a name="ln-84"></a><span class="k">use </span><span class="n">M_help</span><span class="p">,</span> <span class="k">only</span>        <span class="p">:</span> <span class="n">help_command</span>
<a name="ln-85"></a><span class="k">use </span><span class="n">M_history</span><span class="p">,</span> <span class="k">only</span>     <span class="p">:</span> <span class="n">redo</span>
<a name="ln-86"></a><span class="k">use </span><span class="n">M_list</span><span class="p">,</span> <span class="k">only</span>        <span class="p">:</span> <span class="n">insert</span><span class="p">,</span> <span class="n">locate</span><span class="p">,</span> <span class="n">replace</span><span class="p">,</span> <span class="n">remove</span>
<a name="ln-87"></a><span class="k">use </span><span class="n">M_io</span><span class="p">,</span> <span class="k">only</span>          <span class="p">:</span> <span class="n">lookfor</span>
<a name="ln-88"></a><span class="k">use </span><span class="n">M_intrinsics</span><span class="p">,</span> <span class="k">only</span>  <span class="p">:</span> <span class="n">help_intrinsics</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="k">use </span><span class="n">M_LA</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">mat_flop</span><span class="p">,</span>   <span class="n">mat_inverse_hilbert</span><span class="p">,</span>  <span class="n">mat_iwamax</span><span class="p">,</span>  <span class="n">mat_magic</span><span class="p">,</span>   <span class="n">mat_pythag</span><span class="p">,</span>  <span class="n">mat_rat</span><span class="p">,</span>    <span class="n">mat_round</span><span class="p">,</span>  <span class="n">mat_rref</span>
<a name="ln-91"></a><span class="k">use </span><span class="n">M_LA</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">mat_rrot</span><span class="p">,</span>   <span class="n">mat_rrotg</span><span class="p">,</span>            <span class="n">mat_rset</span><span class="p">,</span>    <span class="n">mat_rswap</span><span class="p">,</span>   <span class="n">mat_urand</span><span class="p">,</span>   <span class="n">mat_wasum</span><span class="p">,</span>  <span class="n">mat_wcopy</span>
<a name="ln-92"></a><span class="k">use </span><span class="n">M_LA</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">mat_wdotci</span><span class="p">,</span>           <span class="n">mat_wdotcr</span><span class="p">,</span>  <span class="n">mat_wdotui</span><span class="p">,</span>  <span class="n">mat_wdotur</span><span class="p">,</span> <span class="n">mat_wmul</span><span class="p">,</span>   <span class="n">mat_wnrm2</span>
<a name="ln-93"></a><span class="k">use </span><span class="n">M_LA</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">mat_wpofa</span><span class="p">,</span>  <span class="n">mat_wrscal</span><span class="p">,</span>           <span class="n">mat_wscal</span><span class="p">,</span>   <span class="n">mat_wset</span><span class="p">,</span>    <span class="n">mat_wsign</span><span class="p">,</span>   <span class="n">mat_wsqrt</span><span class="p">,</span>  <span class="n">mat_wswap</span>
<a name="ln-94"></a>
<a name="ln-95"></a><span class="c">!use M_LA, only : mat_wdiv,   mat_wlog, mat_watan</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="c">!matx_waxpy,ml_comqr3,ml_corth,ml_htribk,ml_htridi,ml_imtql2,ml_wgeco,ml_wgedi,ml_wgefa,ml_wgesl,ml_wqrdc,ml_wqrsl,ml_wsvdc_</span>
<a name="ln-98"></a><span class="c">!&gt;</span>
<a name="ln-99"></a><span class="c">!!##SYNTAX DIAGRAMS (9)</span>
<a name="ln-100"></a><span class="c">!!</span>
<a name="ln-101"></a><span class="c">!!    A formal description of the language acceptable to LALA, as well as</span>
<a name="ln-102"></a><span class="c">!!    a flow chart of the lala program, is provided by the syntax diagrams</span>
<a name="ln-103"></a><span class="c">!!    or syntax graphs of wirth [6]. There are eleven non-terminal symbols</span>
<a name="ln-104"></a><span class="c">!!    in the language:</span>
<a name="ln-105"></a><span class="c">!!</span>
<a name="ln-106"></a><span class="c">!!       LINE, STATEMENT, CLAUSE, EXPRESSION, TERM,</span>
<a name="ln-107"></a><span class="c">!!       FACTOR, NUMBER, INTEGER, NAME, COMMAND, TEXT .</span>
<a name="ln-108"></a><span class="c">!!</span>
<a name="ln-109"></a><span class="c">!!    The diagrams define each of the non-terminal symbols using the others</span>
<a name="ln-110"></a><span class="c">!!    and the terminal symbols:</span>
<a name="ln-111"></a><span class="c">!!</span>
<a name="ln-112"></a><span class="c">!!       LETTER -- A THROUGH Z,</span>
<a name="ln-113"></a><span class="c">!!       DIGIT  -- 0 THROUGH 9,</span>
<a name="ln-114"></a><span class="c">!!       CHAR   -- ( ) ; : + - * / \ = . , &lt; &gt;</span>
<a name="ln-115"></a><span class="c">!!       QUOTE  -- &#39;</span>
<a name="ln-116"></a><span class="c">!!</span>
<a name="ln-117"></a><span class="c">!!    LINE</span>
<a name="ln-118"></a><span class="c">!!</span>
<a name="ln-119"></a><span class="c">!!           |-----&gt; STATEMENT &gt;----|</span>
<a name="ln-120"></a><span class="c">!!           |                      |</span>
<a name="ln-121"></a><span class="c">!!           |-----&gt; CLAUSE &gt;-------|</span>
<a name="ln-122"></a><span class="c">!!           |                      |</span>
<a name="ln-123"></a><span class="c">!!    -------|-----&gt; EXPR &gt;---------|------&gt;</span>
<a name="ln-124"></a><span class="c">!!         | |                      | |</span>
<a name="ln-125"></a><span class="c">!!         | |-----&gt; COMMAND &gt;------| |</span>
<a name="ln-126"></a><span class="c">!!         | |                      | |</span>
<a name="ln-127"></a><span class="c">!!         | |-&gt; &gt; &gt;-&gt; EXPR &gt;-&gt; &lt; &gt;-| |</span>
<a name="ln-128"></a><span class="c">!!         | |                      | |</span>
<a name="ln-129"></a><span class="c">!!         | |----------------------| |</span>
<a name="ln-130"></a><span class="c">!!         |                          |</span>
<a name="ln-131"></a><span class="c">!!         |        |-&lt; ; &lt;-|         |</span>
<a name="ln-132"></a><span class="c">!!         |--------|       |---------|</span>
<a name="ln-133"></a><span class="c">!!                  |-&lt; , &lt;-|</span>
<a name="ln-134"></a><span class="c">!!</span>
<a name="ln-135"></a><span class="c">!!    STATEMENT</span>
<a name="ln-136"></a><span class="c">!!</span>
<a name="ln-137"></a><span class="c">!!         |-&gt; NAME &gt;--------------------------------|</span>
<a name="ln-138"></a><span class="c">!!         |          |                              |</span>
<a name="ln-139"></a><span class="c">!!         |          |         |--&gt; : &gt;---|         |</span>
<a name="ln-140"></a><span class="c">!!         |          |         |          |         |</span>
<a name="ln-141"></a><span class="c">!!         |          |-&gt; ( &gt;---|-&gt; EXPR &gt;-|---&gt; ) &gt;-|</span>
<a name="ln-142"></a><span class="c">!!         |                  |              |       |</span>
<a name="ln-143"></a><span class="c">!!    -----|                  |-----&lt; , &lt;----|       |--&gt; = &gt;--&gt; EXPR &gt;---&gt;</span>
<a name="ln-144"></a><span class="c">!!         |                                         |</span>
<a name="ln-145"></a><span class="c">!!         |       |--&lt; , &lt;---|                      |</span>
<a name="ln-146"></a><span class="c">!!         |       |          |                      |</span>
<a name="ln-147"></a><span class="c">!!         |-&gt; &lt; &gt;---&gt; NAME &gt;---&gt; &gt; &gt;----------------|</span>
<a name="ln-148"></a><span class="c">!!</span>
<a name="ln-149"></a><span class="c">!!    CLAUSE</span>
<a name="ln-150"></a><span class="c">!!</span>
<a name="ln-151"></a><span class="c">!!         |---&gt; FOR   &gt;---&gt; NAME &gt;---&gt; = &gt;---&gt; EXPR &gt;--------------|</span>
<a name="ln-152"></a><span class="c">!!         |                                                        |</span>
<a name="ln-153"></a><span class="c">!!         | |-&gt; WHILE &gt;-|                                          |</span>
<a name="ln-154"></a><span class="c">!!         |-|           |-&gt; EXPR &gt;----------------------           |</span>
<a name="ln-155"></a><span class="c">!!         | |-&gt; IF    &gt;-|          |   |   |   |   |   |           |</span>
<a name="ln-156"></a><span class="c">!!    -----|                        &lt;   &lt;=  =   &lt;&gt;  &gt;=  &gt;           |----&gt;</span>
<a name="ln-157"></a><span class="c">!!         |                        |   |   |   |   |   |           |</span>
<a name="ln-158"></a><span class="c">!!         |                        ----------------------&gt; EXPR &gt;--|</span>
<a name="ln-159"></a><span class="c">!!         |                                                        |</span>
<a name="ln-160"></a><span class="c">!!         |---&gt; ELSE  &gt;--------------------------------------------|</span>
<a name="ln-161"></a><span class="c">!!         |                                                        |</span>
<a name="ln-162"></a><span class="c">!!         |---&gt; END   &gt;--------------------------------------------|</span>
<a name="ln-163"></a><span class="c">!!</span>
<a name="ln-164"></a><span class="c">!!    EXPR</span>
<a name="ln-165"></a><span class="c">!!</span>
<a name="ln-166"></a><span class="c">!!           |-&gt; + &gt;-|</span>
<a name="ln-167"></a><span class="c">!!           |       |</span>
<a name="ln-168"></a><span class="c">!!    -------|-------|-------&gt; TERM &gt;----------&gt;</span>
<a name="ln-169"></a><span class="c">!!           |       |    |             |</span>
<a name="ln-170"></a><span class="c">!!           |-&gt; - &gt;-|    |  |-&lt; + &lt;-|  |</span>
<a name="ln-171"></a><span class="c">!!                        |  |       |  |</span>
<a name="ln-172"></a><span class="c">!!                        |--|-&lt; - &lt;-|--|</span>
<a name="ln-173"></a><span class="c">!!                           |       |</span>
<a name="ln-174"></a><span class="c">!!                           |-&lt; : &lt;-|</span>
<a name="ln-175"></a><span class="c">!!</span>
<a name="ln-176"></a><span class="c">!!    TERM</span>
<a name="ln-177"></a><span class="c">!!</span>
<a name="ln-178"></a><span class="c">!!    ---------------------&gt; FACTOR &gt;----------------------&gt;</span>
<a name="ln-179"></a><span class="c">!!            |                                   |</span>
<a name="ln-180"></a><span class="c">!!            |             |-&lt; * &lt;-|             |</span>
<a name="ln-181"></a><span class="c">!!            |  |-------|  |       |  |-------|  |</span>
<a name="ln-182"></a><span class="c">!!            |--|       |--|-&lt; / &lt;-|--|       |--|</span>
<a name="ln-183"></a><span class="c">!!               |-&lt; . &lt;-|  |       |  |-&lt; . &lt;-|</span>
<a name="ln-184"></a><span class="c">!!                          |-&lt; \ &lt;-|</span>
<a name="ln-185"></a><span class="c">!!</span>
<a name="ln-186"></a><span class="c">!!    FACTOR</span>
<a name="ln-187"></a><span class="c">!!</span>
<a name="ln-188"></a><span class="c">!!         |----------------&gt; NUMBER &gt;---------------|</span>
<a name="ln-189"></a><span class="c">!!         |                                         |</span>
<a name="ln-190"></a><span class="c">!!         |-&gt; NAME &gt;--------------------------------|</span>
<a name="ln-191"></a><span class="c">!!         |          |                              |</span>
<a name="ln-192"></a><span class="c">!!         |          |         |--&gt; : &gt;---|         |</span>
<a name="ln-193"></a><span class="c">!!         |          |         |          |         |</span>
<a name="ln-194"></a><span class="c">!!         |          |-&gt; ( &gt;---|-&gt; EXPR &gt;-|---&gt; ) &gt;-|</span>
<a name="ln-195"></a><span class="c">!!         |                  |              |       |</span>
<a name="ln-196"></a><span class="c">!!         |                  |-----&lt; , &lt;----|       |</span>
<a name="ln-197"></a><span class="c">!!         |                                         |</span>
<a name="ln-198"></a><span class="c">!!    -----|------------&gt; ( &gt;-----&gt; EXPR &gt;-----&gt; ) &gt;-|-|-------|-----&gt;</span>
<a name="ln-199"></a><span class="c">!!         |                                         | |       | |</span>
<a name="ln-200"></a><span class="c">!!         |                  |--------------|       | |-&gt; &#39; &gt;-| |</span>
<a name="ln-201"></a><span class="c">!!         |                  |              |       |           |</span>
<a name="ln-202"></a><span class="c">!!         |------------&gt; &lt; &gt;-|---&gt; EXPR &gt;---|-&gt; &gt; &gt;-|           |</span>
<a name="ln-203"></a><span class="c">!!         |                    |          |         |           |</span>
<a name="ln-204"></a><span class="c">!!         |                    |--&lt;   &lt;---|         |           |</span>
<a name="ln-205"></a><span class="c">!!         |                    |          |         |           |</span>
<a name="ln-206"></a><span class="c">!!         |                    |--&lt; ; &lt;---|         |           |</span>
<a name="ln-207"></a><span class="c">!!         |                    |          |         |           |</span>
<a name="ln-208"></a><span class="c">!!         |                    |--&lt; , &lt;---|         |           |</span>
<a name="ln-209"></a><span class="c">!!         |                                         |           |</span>
<a name="ln-210"></a><span class="c">!!         |------------&gt; &gt; &gt;-----&gt; EXPR &gt;-----&gt; &lt; &gt;-|           |</span>
<a name="ln-211"></a><span class="c">!!         |                                         |           |</span>
<a name="ln-212"></a><span class="c">!!         |-----&gt; FACTOR &gt;---&gt; ** &gt;---&gt; FACTOR &gt;----|           |</span>
<a name="ln-213"></a><span class="c">!!         |                                                     |</span>
<a name="ln-214"></a><span class="c">!!         |------------&gt; &#39; &gt;-----&gt; TEXT &gt;-----&gt; &#39; &gt;-------------|</span>
<a name="ln-215"></a><span class="c">!!</span>
<a name="ln-216"></a><span class="c">!!    NUMBER</span>
<a name="ln-217"></a><span class="c">!!</span>
<a name="ln-218"></a><span class="c">!!        |----------|                          |-&gt; + &gt;-|</span>
<a name="ln-219"></a><span class="c">!!        |          |                          |       |</span>
<a name="ln-220"></a><span class="c">!!    -----&gt; INT &gt;-----&gt; . &gt;---&gt; INT &gt;-----&gt; E &gt;---------&gt; INT &gt;----&gt;</span>
<a name="ln-221"></a><span class="c">!!                 |                   | |      |       |        |</span>
<a name="ln-222"></a><span class="c">!!                 |                   | |      |-&gt; - &gt;-|        |</span>
<a name="ln-223"></a><span class="c">!!                 |                   | |                       |</span>
<a name="ln-224"></a><span class="c">!!                 |---------------------------------------------|</span>
<a name="ln-225"></a><span class="c">!!</span>
<a name="ln-226"></a><span class="c">!!    INT</span>
<a name="ln-227"></a><span class="c">!!</span>
<a name="ln-228"></a><span class="c">!!    ------------&gt; DIGIT &gt;-----------&gt;</span>
<a name="ln-229"></a><span class="c">!!              |           |</span>
<a name="ln-230"></a><span class="c">!!              |-----------|</span>
<a name="ln-231"></a><span class="c">!!</span>
<a name="ln-232"></a><span class="c">!!    NAME</span>
<a name="ln-233"></a><span class="c">!!</span>
<a name="ln-234"></a><span class="c">!!                      |--&lt; LETTER &lt;--|</span>
<a name="ln-235"></a><span class="c">!!                      |              |</span>
<a name="ln-236"></a><span class="c">!!    ------&gt; LETTER &gt;--|--------------|-----&gt;</span>
<a name="ln-237"></a><span class="c">!!                      |              |</span>
<a name="ln-238"></a><span class="c">!!                      |--&lt; DIGIT  &lt;--|</span>
<a name="ln-239"></a><span class="c">!!</span>
<a name="ln-240"></a><span class="c">!!    COMMAND</span>
<a name="ln-241"></a><span class="c">!!</span>
<a name="ln-242"></a><span class="c">!!                            |--&gt; NAME &gt;--|</span>
<a name="ln-243"></a><span class="c">!!                            |            |</span>
<a name="ln-244"></a><span class="c">!!    --------&gt; NAME &gt;--------|------------|----&gt;</span>
<a name="ln-245"></a><span class="c">!!                            |            |</span>
<a name="ln-246"></a><span class="c">!!                            |--&gt; CHAR &gt;--|</span>
<a name="ln-247"></a><span class="c">!!                            |            |</span>
<a name="ln-248"></a><span class="c">!!                            |---&gt; &#39; &gt;----|</span>
<a name="ln-249"></a><span class="c">!!</span>
<a name="ln-250"></a><span class="c">!!    TEXT</span>
<a name="ln-251"></a><span class="c">!!</span>
<a name="ln-252"></a><span class="c">!!                    |-&gt; LETTER &gt;--|</span>
<a name="ln-253"></a><span class="c">!!                    |             |</span>
<a name="ln-254"></a><span class="c">!!                    |-&gt; DIGIT &gt;---|</span>
<a name="ln-255"></a><span class="c">!!    ----------------|             |--------------&gt;</span>
<a name="ln-256"></a><span class="c">!!                |   |-&gt; CHAR &gt;----|   |</span>
<a name="ln-257"></a><span class="c">!!                |   |             |   |</span>
<a name="ln-258"></a><span class="c">!!                |   |-&gt; &#39; &gt;-&gt; &#39; &gt;-|   |</span>
<a name="ln-259"></a><span class="c">!!                |                     |</span>
<a name="ln-260"></a><span class="c">!!                |---------------------|</span>
<a name="ln-261"></a><span class="c">!&gt;</span>
<a name="ln-262"></a><span class="c">!! Originally based on a routine called MATLAB, although heavily modified</span>
<a name="ln-263"></a><span class="c">!! since. The original stated ...</span>
<a name="ln-264"></a><span class="c">!!</span>
<a name="ln-265"></a><span class="c">!!    MATLAB stands for MATrix LABoratory. It is a FORTRAN package</span>
<a name="ln-266"></a><span class="c">!!    developed by Argonne National Laboratories for in-house use. It</span>
<a name="ln-267"></a><span class="c">!!    provides comprehensive vector and tensor operations in a package</span>
<a name="ln-268"></a><span class="c">!!    which may be programmed, either through a macro language or through</span>
<a name="ln-269"></a><span class="c">!!    execution of script files.</span>
<a name="ln-270"></a><span class="c">!!</span>
<a name="ln-271"></a><span class="c">!!    Matlab is reentrant and recursive. Functions supported include (but</span>
<a name="ln-272"></a><span class="c">!!    are not by any means limited to) sin, cos, tan, arc functions, upper</span>
<a name="ln-273"></a><span class="c">!!    triangular, lower triangular, determinants, matrix multiplication,</span>
<a name="ln-274"></a><span class="c">!!    identity, Hilbert matrices, eigenvalues and eigenvectors, matrix</span>
<a name="ln-275"></a><span class="c">!!    roots and products, inversion and so on and so forth.</span>
<a name="ln-276"></a><span class="c">!!</span>
<a name="ln-277"></a><span class="c">!!    The file available on the bulletin board as Matlab.arc contains an</span>
<a name="ln-278"></a><span class="c">!!    Amiga-ized executable copy of MATLAB and the online help file, as</span>
<a name="ln-279"></a><span class="c">!!    well as this intro.</span>
<a name="ln-280"></a><span class="c">!!</span>
<a name="ln-281"></a><span class="c">!!    If you want the source code (over 300K) and a manual, or if your</span>
<a name="ln-282"></a><span class="c">!!    bulletin board only has this message and not the package, send $5.00</span>
<a name="ln-283"></a><span class="c">!!    and a 3.5&quot; disk to:</span>
<a name="ln-284"></a><span class="c">!!</span>
<a name="ln-285"></a><span class="c">!!                               Jim Locker</span>
<a name="ln-286"></a><span class="c">!!                               4443 N. Hyland Ave.</span>
<a name="ln-287"></a><span class="c">!!                               Dayton, OH 45424</span>
<a name="ln-288"></a><span class="c">!!</span>
<a name="ln-289"></a><span class="c">!!    The package is public domain, but of course postage and reproduction</span>
<a name="ln-290"></a><span class="c">!!    cost money. Believe me, this package is a bargain at the price.</span>
<a name="ln-291"></a><span class="c">!!    Please feel free to distribute the package.</span>
<a name="ln-292"></a><span class="c">!!</span>
<a name="ln-293"></a><span class="c">!!    The source was taken off a VAX 11/780. It ran without modification</span>
<a name="ln-294"></a><span class="c">!!    (except the file handler and some minor error handling) on an Amiga</span>
<a name="ln-295"></a><span class="c">!!    1000 using ABSoft Fortran v2.2.  It will run in 512K environment.</span>
<a name="ln-296"></a><span class="c">!!    I have seen it on IBM mainframes and IBM PCs.</span>
<a name="ln-297"></a><span class="c">!!</span>
<a name="ln-298"></a><span class="c">!!    Subsequent changes per John S. Urban: see change log and git(1) history</span>
<a name="ln-299"></a><span class="k">implicit none</span>
<a name="ln-300"></a><span class="c">!private</span>
<a name="ln-301"></a>
<a name="ln-302"></a><span class="k">public </span><span class="n">lala</span>
<a name="ln-303"></a><span class="k">public </span><span class="n">get_from_lala</span>  <span class="c">! get_a_lala   ! ??? maybe a function too with a second parameter and returned value is of same type(?)</span>
<a name="ln-304"></a><span class="k">public </span><span class="n">put_into_lala</span>  <span class="c">! give_a_lala</span>
<a name="ln-305"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">ifin_lala</span>   <span class="c">! lalain</span>
<a name="ln-306"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">printit</span>
<a name="ln-307"></a><span class="c">!!public :: size_lala</span>
<a name="ln-308"></a>
<a name="ln-309"></a><span class="c">! for other routines</span>
<a name="ln-310"></a><span class="k">public </span><span class="n">mat_flop</span>
<a name="ln-311"></a><span class="k">public </span><span class="n">mat_wasum</span>
<a name="ln-312"></a><span class="k">public </span><span class="n">mat_wdotcr</span>
<a name="ln-313"></a><span class="k">public </span><span class="n">mat_wdotci</span>
<a name="ln-314"></a><span class="c">! till get rid of type mismatches, the following are public</span>
<a name="ln-315"></a>
<a name="ln-316"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="p">,</span><span class="k">private</span><span class="kd">::</span> <span class="n">sp</span><span class="o">=</span><span class="nb">kind</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span><span class="n">dp</span><span class="o">=</span><span class="nb">kind</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-317"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">gen0</span><span class="o">=</span><span class="s1">&#39;(*(g0))&#39;</span>
<a name="ln-318"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">gen1</span><span class="o">=</span><span class="s1">&#39;(*(g0,1x))&#39;</span>
<a name="ln-319"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-320"></a><span class="c">! program limits</span>
<a name="ln-321"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">GG_LINELEN</span><span class="o">=</span><span class="mi">1024</span>
<a name="ln-322"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">=</span><span class="mi">480</span>
<a name="ln-323"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">GG_MAX_NAME_LENGTH</span><span class="o">=</span><span class="mi">63</span>
<a name="ln-324"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">GG_EOL</span><span class="o">=</span><span class="mi">99999</span>           <span class="c">! make &gt; 2256</span>
<a name="ln-325"></a>
<a name="ln-326"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-327"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">save</span> <span class="kd">::</span> <span class="n">G_PSEUDO_FILE</span><span class="p">(:)</span> <span class="c">! allow for input to be passed from program instead of from file</span>
<a name="ln-328"></a><span class="kt">logical</span>                  <span class="kd">::</span> <span class="n">G_PROMPT</span>              <span class="c">! companion for G_PSEUDO_FILE</span>
<a name="ln-329"></a><span class="kt">logical</span><span class="p">,</span><span class="k">save</span>             <span class="kd">::</span> <span class="n">G_ECHO</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>        <span class="c">! echo input lines</span>
<a name="ln-330"></a>
<a name="ln-331"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">GG_LINELEN</span><span class="p">)</span>
<a name="ln-332"></a>
<a name="ln-333"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_LHS</span> <span class="c">! number of arguments on LHS</span>
<a name="ln-334"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_RHS</span> <span class="c">! number of arguments on RHS</span>
<a name="ln-335"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_FIN</span>
<a name="ln-336"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_FUN</span>
<a name="ln-337"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_FMT</span>
<a name="ln-338"></a>
<a name="ln-339"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_RIO</span>
<a name="ln-340"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_INPUT_LUN</span>
<a name="ln-341"></a>
<a name="ln-342"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_PTZ</span>
<a name="ln-343"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_SYM</span>
<a name="ln-344"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_SYN</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-345"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-346"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_CURRENT_RANDOM_SEED</span>
<a name="ln-347"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_CURRENT_RANDOM_TYPE</span>     <span class="c">! [0] uniform distribution</span>
<a name="ln-348"></a>                                                      <span class="c">! [*] normal distribution</span>
<a name="ln-349"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_FLOP_COUNTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-350"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_DEBUG_LEVEL</span>             <span class="c">! select which debug messages to display. zero (0) is off</span>
<a name="ln-351"></a><span class="kt">logical</span>                  <span class="kd">::</span> <span class="n">G_FILE_OPEN_ERROR</span>         <span class="c">! flag whether file open error occurred or not</span>
<a name="ln-352"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_ERR</span>
<a name="ln-353"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>            <span class="c">! [1] lines displayed since count started</span>
<a name="ln-354"></a>                                                      <span class="c">! [2] line limit before warning (ie. page length+1)</span>
<a name="ln-355"></a>                                                      <span class="c">! [3] 0 or 1 for &quot;semi&quot; mode to be on or off</span>
<a name="ln-356"></a>                                                      <span class="c">! [4] flag from &quot;exec&quot; command, and ...</span>
<a name="ln-357"></a>
<a name="ln-358"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_BUF</span><span class="p">(</span><span class="n">GG_LINELEN</span><span class="p">)</span>
<a name="ln-359"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-360"></a><span class="c">! PARSING</span>
<a name="ln-361"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">G_PSIZE</span><span class="o">=</span><span class="mi">32</span>                        <span class="c">! stack size for pseudo-recursion</span>
<a name="ln-362"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_IDS</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">,</span><span class="n">G_PSIZE</span><span class="p">)</span>
<a name="ln-363"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PSIZE</span><span class="p">)</span>
<a name="ln-364"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PSIZE</span><span class="p">)</span>
<a name="ln-365"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_PT</span>
<a name="ln-366"></a>
<a name="ln-367"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_CHRA</span> <span class="c">! current character in line</span>
<a name="ln-368"></a><span class="kt">integer</span>                  <span class="kd">::</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="c">! [1] first character to process in current line</span>
<a name="ln-369"></a>                                              <span class="c">! [2] last character to process in current line</span>
<a name="ln-370"></a>                                              <span class="c">! [3]</span>
<a name="ln-371"></a>                                              <span class="c">! [4] pointer into current character in current line being processed</span>
<a name="ln-372"></a>                                              <span class="c">! [5]</span>
<a name="ln-373"></a>                                              <span class="c">! [6]</span>
<a name="ln-374"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-375"></a><span class="kt">integer</span><span class="p">,</span><span class="k">save</span>                   <span class="kd">::</span> <span class="n">GM_BIGMEM</span><span class="o">=-</span><span class="mi">1</span>                           <span class="c">! allocated size of data storage</span>
<a name="ln-376"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">GM_REALS</span><span class="p">(:),</span> <span class="n">GM_IMAGS</span><span class="p">(:)</span>               <span class="c">! set to size of GM_BIGMEM</span>
<a name="ln-377"></a>
<a name="ln-378"></a><span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">G_VAR_IDS</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">,</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span>
<a name="ln-379"></a><span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span>
<a name="ln-380"></a><span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span>
<a name="ln-381"></a><span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span>
<a name="ln-382"></a>
<a name="ln-383"></a><span class="k">type </span><span class="n">vctr</span>
<a name="ln-384"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">rows</span>
<a name="ln-385"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">cols</span>
<a name="ln-386"></a>   <span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">re</span><span class="p">(:)</span>
<a name="ln-387"></a>   <span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">im</span><span class="p">(:)</span>
<a name="ln-388"></a><span class="k">endtype </span><span class="n">vctr</span>
<a name="ln-389"></a>
<a name="ln-390"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">keywords</span><span class="p">(:)</span>
<a name="ln-391"></a><span class="kt">integer</span><span class="p">,</span><span class="k">allocatable</span>            <span class="kd">::</span> <span class="n">locs</span><span class="p">(:)</span>
<a name="ln-392"></a><span class="kt">integer</span><span class="p">,</span><span class="k">allocatable</span>            <span class="kd">::</span> <span class="n">rows</span><span class="p">(:)</span>
<a name="ln-393"></a><span class="kt">integer</span><span class="p">,</span><span class="k">allocatable</span>            <span class="kd">::</span> <span class="n">cols</span><span class="p">(:)</span>
<a name="ln-394"></a><span class="k">type</span><span class="p">(</span><span class="n">vctr</span><span class="p">),</span><span class="k">allocatable</span>         <span class="kd">::</span> <span class="n">vals</span><span class="p">(:)</span>
<a name="ln-395"></a>
<a name="ln-396"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">scr_keywords</span><span class="p">(:)</span>
<a name="ln-397"></a><span class="kt">integer</span><span class="p">,</span><span class="k">allocatable</span>            <span class="kd">::</span> <span class="n">scr_locs</span><span class="p">(:)</span>
<a name="ln-398"></a><span class="kt">integer</span><span class="p">,</span><span class="k">allocatable</span>            <span class="kd">::</span> <span class="n">scr_rows</span><span class="p">(:)</span>
<a name="ln-399"></a><span class="kt">integer</span><span class="p">,</span><span class="k">allocatable</span>            <span class="kd">::</span> <span class="n">scr_cols</span><span class="p">(:)</span>
<a name="ln-400"></a>
<a name="ln-401"></a><span class="kt">integer</span>                     <span class="kd">::</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">,</span> <span class="n">G_ARGUMENT_POINTER</span>
<a name="ln-402"></a>
<a name="ln-403"></a><span class="c">!   Two large real arrays, GM_REALS and GM_IMAGS (for real and imaginary parts), are used to store all</span>
<a name="ln-404"></a><span class="c">!   the matrices. Four integer arrays (G_VAR_IDS, G_VAR_ROWS, G_VAR_COLS, G_VAR_DATALOC) are used to store the names,</span>
<a name="ln-405"></a><span class="c">!   the row and column dimensions, and the pointers into the real stacks. The following diagram illustrates this storage scheme.</span>
<a name="ln-406"></a><span class="c">!</span>
<a name="ln-407"></a><span class="c">!                    TOP        IDS       ROWS COLS LOCS              GM_REALS    GM_IMAGS</span>
<a name="ln-408"></a><span class="c">!                     --      -- -- -- --   --   --   --              --------   --------    &lt;&lt;== G_ARGUMENT_POINTER</span>
<a name="ln-409"></a><span class="c">!                    |  |---&gt;|  |  |  |  | |  | |  | |  |-----------&gt;|        | |        |</span>
<a name="ln-410"></a><span class="c">!                     --      -- -- -- --   --   --   --              --------   --------</span>
<a name="ln-411"></a><span class="c">!                            |  |  |  |  | |  | |  | |  |            |        | |        |</span>
<a name="ln-412"></a><span class="c">!                             -- -- -- --   --   --   --              --------   --------</span>
<a name="ln-413"></a><span class="c">!                                  .         .    .    .                  .          .</span>
<a name="ln-414"></a><span class="c">!                                  .         .    .    .                  .          .</span>
<a name="ln-415"></a><span class="c">!                                  .         .    .    .                  .          .</span>
<a name="ln-416"></a><span class="c">!                             -- -- -- --   --   --   --              --------   --------</span>
<a name="ln-417"></a><span class="c">!                    BOT     |  |  |  |  | |  | |  | |  |            |        | |        |</span>
<a name="ln-418"></a><span class="c">!                     --      -- -- -- --   --   --   --              --------   --------</span>
<a name="ln-419"></a><span class="c">!                    |  |---&gt;| X|  |  |  | | 2| | 1| |  |-----------&gt;|  3.14  | |  0.00  |  &lt;&lt;== G_TOP_OF_SAVED</span>
<a name="ln-420"></a><span class="c">!                     --      -- -- -- --   --   --   --              --------   --------</span>
<a name="ln-421"></a><span class="c">!                            | A|  |  |  | | 2| | 2| |  |---------   |  0.00  | |  1.00  |</span>
<a name="ln-422"></a><span class="c">!                             -- -- -- --   --   --   --          \   --------   --------</span>
<a name="ln-423"></a><span class="c">!                            | E| P| S|  | | 1| | 1| |  |-------   -&gt;| 11.00  | |  0.00  |</span>
<a name="ln-424"></a><span class="c">!                             -- -- -- --   --   --   --        \     --------   --------</span>
<a name="ln-425"></a><span class="c">!                            | F| L| O| P| | 1| | 2| |  |------  \   | 21.00  | |  0.00  |</span>
<a name="ln-426"></a><span class="c">!                             -- -- -- --   --   --   --       \  \   --------   --------</span>
<a name="ln-427"></a><span class="c">!                            | E| Y| E|  | |-1| |-1| |  |---    \ |  | 12.00  | |  0.00  |</span>
<a name="ln-428"></a><span class="c">!                             -- -- -- --   --   --   --    \   | |   --------   --------</span>
<a name="ln-429"></a><span class="c">!   GG_MAX_NUMBER_OF_NAMES-&gt; | R| A| N| D| | 1| | 1| |  |-   \  | |  | 22.00  | |  0.00  |</span>
<a name="ln-430"></a><span class="c">!                             -- -- -- --   --   --   --  \  |  \ \   --------   --------</span>
<a name="ln-431"></a><span class="c">!                                                         |  \   \ -&gt;| 1.E-15 | |  0.00  |</span>
<a name="ln-432"></a><span class="c">!                                                         \   \   \   --------   --------</span>
<a name="ln-433"></a><span class="c">!                                                          \   \   -&gt;|  0.00  | |  0.00  |</span>
<a name="ln-434"></a><span class="c">!                                                           \   \     --------   --------</span>
<a name="ln-435"></a><span class="c">!                                                            \   \   |  0.00  | |  0.00  |</span>
<a name="ln-436"></a><span class="c">!                                                             \   \   --------   --------</span>
<a name="ln-437"></a><span class="c">!                                                              \   -&gt;|  1.00  | |  0.00  |</span>
<a name="ln-438"></a><span class="c">!                                                               \     --------   --------</span>
<a name="ln-439"></a><span class="c">!                                                                ---&gt;| URAND  | |  0.00  |  GM_BIGMEM</span>
<a name="ln-440"></a><span class="c">!                                                                     --------   --------</span>
<a name="ln-441"></a><span class="c">!</span>
<a name="ln-442"></a><span class="c">!   The top portion of the stack is used for temporary variables and the</span>
<a name="ln-443"></a><span class="c">!   bottom portion for saved variables. The figure shows the situation</span>
<a name="ln-444"></a><span class="c">!   after the line</span>
<a name="ln-445"></a><span class="c">!</span>
<a name="ln-446"></a><span class="c">!      A = [11,12; 21,22],  x = [3.14, sqrt(-1)]&#39;</span>
<a name="ln-447"></a><span class="c">!</span>
<a name="ln-448"></a><span class="c">!   has been processed. The four permanent names, &quot;eps&quot;, &quot;flop&quot;, &quot;rand&quot;</span>
<a name="ln-449"></a><span class="c">!   and &quot;eye&quot;, occupy the last four positions of the variable stacks.</span>
<a name="ln-450"></a><span class="c">!   RAND has dimensions 1 by 1, but whenever its value is requested,</span>
<a name="ln-451"></a><span class="c">!   a random number generator is used instead. &quot;eye&quot; has dimensions -1</span>
<a name="ln-452"></a><span class="c">!   by -1 to indicate that the actual dimensions must be determined</span>
<a name="ln-453"></a><span class="c">!   later by context. The two saved variables have dimensions 2 by 2</span>
<a name="ln-454"></a><span class="c">!   and 2 by 1 and so take up a total of 6 locations.</span>
<a name="ln-455"></a><span class="c">!</span>
<a name="ln-456"></a><span class="c">!   Subsequent statements involving A and x will result in</span>
<a name="ln-457"></a><span class="c">!   temporary copies being made in the top of the stack for use in</span>
<a name="ln-458"></a><span class="c">!   the actual calculations. Whenever the top of the stack reaches</span>
<a name="ln-459"></a><span class="c">!   the bottom, a message indicating memory has been exceeded is</span>
<a name="ln-460"></a><span class="c">!   printed, but the current variables are not affected.</span>
<a name="ln-461"></a><span class="c">!</span>
<a name="ln-462"></a><span class="c">!   This modular structure makes it possible to implement LALA</span>
<a name="ln-463"></a><span class="c">!   on a system with a limited amount of memory, as this can easily be</span>
<a name="ln-464"></a><span class="c">!   implemented with a direct-access file as well.</span>
<a name="ln-465"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-466"></a><span class="k">interface </span><span class="n">put_into_lala</span>
<a name="ln-467"></a>   <span class="k">module procedure </span><span class="n">store_array_into_lala</span>
<a name="ln-468"></a>   <span class="k">module procedure </span><span class="n">store_vector_into_lala</span>
<a name="ln-469"></a>   <span class="k">module procedure </span><span class="n">store_scalar_into_lala</span>
<a name="ln-470"></a><span class="k">end interface </span><span class="n">put_into_lala</span>
<a name="ln-471"></a>
<a name="ln-472"></a><span class="k">interface </span><span class="n">get_from_lala</span>
<a name="ln-473"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_dpcmplx</span>
<a name="ln-474"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_cmplx</span>
<a name="ln-475"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_real32</span>
<a name="ln-476"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_real64</span>
<a name="ln-477"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_real128</span>
<a name="ln-478"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_int8</span>
<a name="ln-479"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_int16</span>
<a name="ln-480"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_int32</span>
<a name="ln-481"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_int64</span>
<a name="ln-482"></a>   <span class="k">module procedure </span><span class="n">get_fixed_array_from_lala_logical</span>
<a name="ln-483"></a>   <span class="c">!module procedure get_fixed_array_from_lala_character !???? hmmm, does not meet current lala model</span>
<a name="ln-484"></a>
<a name="ln-485"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_dpcmplx</span>
<a name="ln-486"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_cmplx</span>
<a name="ln-487"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_real32</span>
<a name="ln-488"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_real64</span>
<a name="ln-489"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_real128</span>
<a name="ln-490"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_int8</span>
<a name="ln-491"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_int16</span>
<a name="ln-492"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_int32</span>
<a name="ln-493"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_int64</span>
<a name="ln-494"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_logical</span>
<a name="ln-495"></a>   <span class="k">module procedure </span><span class="n">get_fixed_vector_from_lala_character</span>
<a name="ln-496"></a>
<a name="ln-497"></a>   <span class="k">module procedure </span><span class="n">get_fixed_scalar_from_lala_character</span>
<a name="ln-498"></a>
<a name="ln-499"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_dpcmplx</span>
<a name="ln-500"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_cmplx</span>
<a name="ln-501"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_real32</span>
<a name="ln-502"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_real64</span>
<a name="ln-503"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_real128</span>
<a name="ln-504"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_int8</span>
<a name="ln-505"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_int16</span>
<a name="ln-506"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_int32</span>
<a name="ln-507"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_int64</span>
<a name="ln-508"></a>   <span class="k">module procedure </span><span class="n">get_array_from_lala_logical</span>
<a name="ln-509"></a>   <span class="c">!module procedure get_array_from_lala_character !???? hmmm, does not meet current lala model</span>
<a name="ln-510"></a>
<a name="ln-511"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_dpcmplx</span>
<a name="ln-512"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_cmplx</span>
<a name="ln-513"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_real32</span>
<a name="ln-514"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_real64</span>
<a name="ln-515"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_real128</span>
<a name="ln-516"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_int8</span>
<a name="ln-517"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_int16</span>
<a name="ln-518"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_int32</span>
<a name="ln-519"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_int64</span>
<a name="ln-520"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_logical</span>
<a name="ln-521"></a>   <span class="k">module procedure </span><span class="n">get_vector_from_lala_character</span>
<a name="ln-522"></a>
<a name="ln-523"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_dpcmplx</span>
<a name="ln-524"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_cmplx</span>
<a name="ln-525"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_real32</span>
<a name="ln-526"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_real64</span>
<a name="ln-527"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_real128</span>
<a name="ln-528"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_int8</span>
<a name="ln-529"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_int16</span>
<a name="ln-530"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_int32</span>
<a name="ln-531"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_int64</span>
<a name="ln-532"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_logical</span>
<a name="ln-533"></a>   <span class="k">module procedure </span><span class="n">get_scalar_from_lala_character</span>
<a name="ln-534"></a>
<a name="ln-535"></a><span class="k">end interface </span><span class="n">get_from_lala</span>
<a name="ln-536"></a>
<a name="ln-537"></a><span class="k">interface </span><span class="n">lala</span>
<a name="ln-538"></a>   <span class="k">module procedure </span><span class="n">lala_init</span>
<a name="ln-539"></a>   <span class="k">module procedure </span><span class="n">lala_cmd</span>
<a name="ln-540"></a>   <span class="k">module procedure </span><span class="n">lala_cmds</span>
<a name="ln-541"></a><span class="k">end interface </span><span class="n">lala</span>
<a name="ln-542"></a>
<a name="ln-543"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">G_HELP_TEXT</span><span class="p">(:)</span>
<a name="ln-544"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">G_FORTRAN_TEXT</span><span class="p">(:)</span>
<a name="ln-545"></a>
<a name="ln-546"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-547"></a><span class="c">! CHARACTER SET</span>
<a name="ln-548"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">G_CHARSET_SIZE</span><span class="o">=</span><span class="mi">256</span>      <span class="c">! number of characters in character set</span>
<a name="ln-549"></a>
<a name="ln-550"></a><span class="c">! unused: `~!#%^&amp;_?</span>
<a name="ln-551"></a><span class="c">! now allow all characters, using !#</span>
<a name="ln-552"></a><span class="c">! thinking ! for comments, &amp; for continue like Fortran</span>
<a name="ln-553"></a><span class="c">! use % for shell commands?</span>
<a name="ln-554"></a>
<a name="ln-555"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">digit</span><span class="o">=</span><span class="s1">&#39;0123456789&#39;</span>
<a name="ln-556"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">little</span><span class="o">=</span><span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span>
<a name="ln-557"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">big</span><span class="o">=</span><span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
<a name="ln-558"></a>
<a name="ln-559"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">dstar</span><span class="o">=</span><span class="mi">3042</span>
<a name="ln-560"></a>
<a name="ln-561"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">isname</span><span class="o">=</span><span class="mi">0</span> <span class="c">! -1000</span>
<a name="ln-562"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">isnum</span><span class="o">=</span><span class="mi">1</span>  <span class="c">! -1001</span>
<a name="ln-563"></a>
<a name="ln-564"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">blank</span><span class="o">=</span><span class="mi">32</span> <span class="c">! blank</span>
<a name="ln-565"></a><span class="c">!integer,parameter ::  =33 !  !</span>
<a name="ln-566"></a><span class="c">!integer,parameter :: doublequote=34 ! &quot;</span>
<a name="ln-567"></a><span class="c">!integer,parameter ::  =35 ! #</span>
<a name="ln-568"></a><span class="c">!integer,parameter ::  =36 ! $</span>
<a name="ln-569"></a><span class="c">!integer,parameter ::  =37 ! %</span>
<a name="ln-570"></a><span class="c">!integer,parameter ::  =38 ! &amp;</span>
<a name="ln-571"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">quote</span><span class="o">=</span><span class="mi">39</span>  <span class="c">! &#39;</span>
<a name="ln-572"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">lparen</span><span class="o">=</span><span class="mi">40</span> <span class="c">! (</span>
<a name="ln-573"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">rparen</span><span class="o">=</span><span class="mi">41</span> <span class="c">! )</span>
<a name="ln-574"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">star</span><span class="o">=</span><span class="mi">42</span>   <span class="c">! *</span>
<a name="ln-575"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">plus</span><span class="o">=</span><span class="mi">43</span>   <span class="c">! +</span>
<a name="ln-576"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">comma</span><span class="o">=</span><span class="mi">44</span>  <span class="c">! ,</span>
<a name="ln-577"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">minus</span><span class="o">=</span><span class="mi">45</span>  <span class="c">! -</span>
<a name="ln-578"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">dot</span><span class="o">=</span><span class="mi">46</span>    <span class="c">! .</span>
<a name="ln-579"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">slash</span><span class="o">=</span><span class="mi">47</span>  <span class="c">! /</span>
<a name="ln-580"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">zero</span><span class="o">=</span><span class="mi">48</span>   <span class="c">! 0</span>
<a name="ln-581"></a><span class="c">!integer,parameter ::  =49 ! 1</span>
<a name="ln-582"></a><span class="c">!integer,parameter ::  =50 ! 2</span>
<a name="ln-583"></a><span class="c">!integer,parameter ::  =51 ! 3</span>
<a name="ln-584"></a><span class="c">!integer,parameter ::  =52 ! 4</span>
<a name="ln-585"></a><span class="c">!integer,parameter ::  =53 ! 5</span>
<a name="ln-586"></a><span class="c">!integer,parameter ::  =54 ! 6</span>
<a name="ln-587"></a><span class="c">!integer,parameter ::  =55 ! 7</span>
<a name="ln-588"></a><span class="c">!integer,parameter ::  =56 ! 8</span>
<a name="ln-589"></a><span class="c">!integer,parameter ::  =57 ! 9</span>
<a name="ln-590"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">colon</span><span class="o">=</span><span class="mi">58</span>  <span class="c">! :</span>
<a name="ln-591"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">semi</span><span class="o">=</span><span class="mi">59</span>   <span class="c">! ;</span>
<a name="ln-592"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">less</span><span class="o">=</span><span class="mi">60</span>   <span class="c">! &lt;</span>
<a name="ln-593"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">equal</span><span class="o">=</span><span class="mi">61</span>  <span class="c">! =</span>
<a name="ln-594"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">great</span><span class="o">=</span><span class="mi">62</span>  <span class="c">! &gt;</span>
<a name="ln-595"></a><span class="c">!integer,parameter ::  =63 ! ?</span>
<a name="ln-596"></a><span class="c">!integer,parameter ::  =64 ! @</span>
<a name="ln-597"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">a_up</span><span class="o">=</span><span class="mi">65</span>   <span class="c">! A</span>
<a name="ln-598"></a><span class="c">!integer,parameter ::  =66 ! B</span>
<a name="ln-599"></a><span class="c">!integer,parameter ::  =67 ! C</span>
<a name="ln-600"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">d_up</span><span class="o">=</span><span class="mi">68</span>   <span class="c">! D</span>
<a name="ln-601"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">e_up</span><span class="o">=</span><span class="mi">69</span>   <span class="c">! E</span>
<a name="ln-602"></a><span class="c">!integer,parameter ::  =70 ! F</span>
<a name="ln-603"></a><span class="c">!integer,parameter ::  =71 ! G</span>
<a name="ln-604"></a><span class="c">!integer,parameter ::  =72 ! H</span>
<a name="ln-605"></a><span class="c">!integer,parameter ::  =73 ! I</span>
<a name="ln-606"></a><span class="c">!integer,parameter ::  =74 ! J</span>
<a name="ln-607"></a><span class="c">!integer,parameter ::  =75 ! K</span>
<a name="ln-608"></a><span class="c">!integer,parameter ::  =76 ! L</span>
<a name="ln-609"></a><span class="c">!integer,parameter ::  =77 ! M</span>
<a name="ln-610"></a><span class="c">!integer,parameter ::  =78 ! N</span>
<a name="ln-611"></a><span class="c">!integer,parameter ::  =79 ! O</span>
<a name="ln-612"></a><span class="c">!integer,parameter ::  =80 ! P</span>
<a name="ln-613"></a><span class="c">!integer,parameter ::  =81 ! Q</span>
<a name="ln-614"></a><span class="c">!integer,parameter ::  =82 ! R</span>
<a name="ln-615"></a><span class="c">!integer,parameter ::  =83 ! S</span>
<a name="ln-616"></a><span class="c">!integer,parameter ::  =84 ! T</span>
<a name="ln-617"></a><span class="c">!integer,parameter ::  =85 ! U</span>
<a name="ln-618"></a><span class="c">!integer,parameter ::  =86 ! V</span>
<a name="ln-619"></a><span class="c">!integer,parameter ::  =87 ! W</span>
<a name="ln-620"></a><span class="c">!integer,parameter ::  =88 ! X</span>
<a name="ln-621"></a><span class="c">!integer,parameter ::  =89 ! Y</span>
<a name="ln-622"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">z_up</span><span class="o">=</span><span class="mi">90</span>   <span class="c">! Z</span>
<a name="ln-623"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">lbracket</span><span class="o">=</span><span class="mi">91</span> <span class="c">! [</span>
<a name="ln-624"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">bslash</span><span class="o">=</span><span class="mi">92</span> <span class="c">! backslash</span>
<a name="ln-625"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">rbracket</span><span class="o">=</span><span class="mi">93</span> <span class="c">! ]</span>
<a name="ln-626"></a><span class="c">!integer,parameter ::  =94 ! ^</span>
<a name="ln-627"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">score</span><span class="o">=</span><span class="mi">95</span>  <span class="c">! _</span>
<a name="ln-628"></a><span class="c">!integer,parameter ::  =96 ! `</span>
<a name="ln-629"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">a_low</span><span class="o">=</span><span class="mi">97</span>  <span class="c">! a</span>
<a name="ln-630"></a><span class="c">!integer,parameter ::  =98 ! b</span>
<a name="ln-631"></a><span class="c">!integer,parameter ::  =99 ! c</span>
<a name="ln-632"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">d_low</span><span class="o">=</span><span class="mi">100</span> <span class="c">! d</span>
<a name="ln-633"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">e_low</span><span class="o">=</span><span class="mi">101</span> <span class="c">! e</span>
<a name="ln-634"></a><span class="c">!integer,parameter ::  =102 ! f</span>
<a name="ln-635"></a><span class="c">!integer,parameter ::  =103 ! g</span>
<a name="ln-636"></a><span class="c">!integer,parameter ::  =104 ! h</span>
<a name="ln-637"></a><span class="c">!integer,parameter ::  =105 ! i</span>
<a name="ln-638"></a><span class="c">!integer,parameter ::  =106 ! j</span>
<a name="ln-639"></a><span class="c">!integer,parameter ::  =107 ! k</span>
<a name="ln-640"></a><span class="c">!integer,parameter ::  =108 ! l</span>
<a name="ln-641"></a><span class="c">!integer,parameter ::  =109 ! m</span>
<a name="ln-642"></a><span class="c">!integer,parameter ::  =110 ! n</span>
<a name="ln-643"></a><span class="c">!integer,parameter ::  =111 ! o</span>
<a name="ln-644"></a><span class="c">!integer,parameter ::  =112 ! p</span>
<a name="ln-645"></a><span class="c">!integer,parameter ::  =113 ! q</span>
<a name="ln-646"></a><span class="c">!integer,parameter ::  =114 ! r</span>
<a name="ln-647"></a><span class="c">!integer,parameter ::  =115 ! s</span>
<a name="ln-648"></a><span class="c">!integer,parameter ::  =116 ! t</span>
<a name="ln-649"></a><span class="c">!integer,parameter ::  =117 ! u</span>
<a name="ln-650"></a><span class="c">!integer,parameter ::  =118 ! v</span>
<a name="ln-651"></a><span class="c">!integer,parameter ::  =119 ! w</span>
<a name="ln-652"></a><span class="c">!integer,parameter ::  =120 ! x</span>
<a name="ln-653"></a><span class="c">!integer,parameter ::  =121 ! y</span>
<a name="ln-654"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">z_low</span><span class="o">=</span><span class="mi">122</span> <span class="c">! z</span>
<a name="ln-655"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">lbrace</span><span class="o">=</span><span class="mi">123</span> <span class="c">! {</span>
<a name="ln-656"></a><span class="c">!integer,parameter ::  =124 ! |</span>
<a name="ln-657"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span>  <span class="n">rbrace</span><span class="o">=</span><span class="mi">125</span> <span class="c">! }</span>
<a name="ln-658"></a><span class="c">!integer,parameter ::  =126 ! ~</span>
<a name="ln-659"></a>
<a name="ln-660"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">GG_PAD</span><span class="p">(</span><span class="mi">63</span><span class="p">)</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-661"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-662"></a><span class="c">! allow for a user-defined subroutine.</span>
<a name="ln-663"></a><span class="c">! ??? expand this to allow for multiple routines and a user-specified name for the procedure</span>
<a name="ln-664"></a><span class="c">! ??? and a variable specifically for returning a user error</span>
<a name="ln-665"></a><span class="k">private</span> <span class="kd">::</span> <span class="n">usersub_placeholder</span>
<a name="ln-666"></a>
<a name="ln-667"></a><span class="k">abstract interface</span>
<a name="ln-668"></a><span class="k">   subroutine </span><span class="n">usersub_interface</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<a name="ln-669"></a>      <span class="k">import </span><span class="n">dp</span>
<a name="ln-670"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">m</span><span class="p">,</span><span class="n">n</span>
<a name="ln-671"></a>      <span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">a</span><span class="p">(:)</span>
<a name="ln-672"></a>      <span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">s</span><span class="p">,</span><span class="n">t</span>
<a name="ln-673"></a>   <span class="k">end subroutine </span><span class="n">usersub_interface</span>
<a name="ln-674"></a><span class="k">end interface</span>
<a name="ln-675"></a>
<a name="ln-676"></a><span class="k">public </span><span class="n">usersub_interface</span>
<a name="ln-677"></a>
<a name="ln-678"></a><span class="k">procedure</span><span class="p">(</span><span class="n">usersub_interface</span><span class="p">),</span><span class="k">pointer</span> <span class="kd">::</span> <span class="n">usersub</span> <span class="o">=&gt;</span> <span class="n">usersub_placeholder</span>
<a name="ln-679"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-680"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-681"></a>
<a name="ln-682"></a><span class="k">contains</span>
<a name="ln-683"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-684"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-685"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-686"></a><span class="k">subroutine </span><span class="n">set_usersub</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>
<a name="ln-687"></a><span class="k">procedure</span><span class="p">(</span><span class="n">usersub_interface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">proc</span>
<a name="ln-688"></a>   <span class="n">usersub</span> <span class="o">=&gt;</span> <span class="n">proc</span>
<a name="ln-689"></a><span class="k">end subroutine </span><span class="n">set_usersub</span>
<a name="ln-690"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-691"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-692"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-693"></a><span class="k">subroutine </span><span class="n">usersub_placeholder</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>  <span class="c">! sample usersub_placeholder routine</span>
<a name="ln-694"></a><span class="k">implicit none</span>
<a name="ln-695"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">m</span><span class="p">,</span><span class="n">n</span>
<a name="ln-696"></a><span class="n">doubleprecision</span>            <span class="kd">::</span> <span class="n">a</span><span class="p">(:)</span>
<a name="ln-697"></a><span class="n">doubleprecision</span>            <span class="kd">::</span> <span class="n">s</span><span class="p">,</span><span class="n">t</span>
<a name="ln-698"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-699"></a><span class="c">!  allowing for m and n to be changed complicates dimensioning a(m,n)</span>
<a name="ln-700"></a><span class="c">!  on most compilers overindexing would probably not be a problem in actuality</span>
<a name="ln-701"></a><span class="c">!  and dimensioning would not be either but not standard unless make allocatable.</span>
<a name="ln-702"></a><span class="c">!  See RESHAPE() and PACK() if passing to other routines</span>
<a name="ln-703"></a>   <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;M=&#39;</span><span class="p">,</span><span class="n">m</span>
<a name="ln-704"></a>   <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;N=&#39;</span><span class="p">,</span><span class="n">n</span>
<a name="ln-705"></a>   <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;S=&#39;</span><span class="p">,</span><span class="n">s</span>
<a name="ln-706"></a>   <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;T=&#39;</span><span class="p">,</span><span class="n">t</span>
<a name="ln-707"></a>   <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-708"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-709"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-710"></a>         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-711"></a>         <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-712"></a>      <span class="k">enddo</span>
<a name="ln-713"></a><span class="k">   enddo</span>
<a name="ln-714"></a><span class="k">   </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-715"></a>   <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-716"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-717"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-718"></a>         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-719"></a>         <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="o">+</span><span class="n">t</span>
<a name="ln-720"></a>      <span class="k">enddo</span>
<a name="ln-721"></a><span class="k">   enddo</span>
<a name="ln-722"></a><span class="k">end subroutine </span><span class="n">usersub_placeholder</span>
<a name="ln-723"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-724"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-725"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-726"></a><span class="c">!&gt;</span>
<a name="ln-727"></a><span class="c">!!##NAME</span>
<a name="ln-728"></a><span class="c">!!    LALA(3f) - [M_matrix] initialize and/or pass commands to matrix</span>
<a name="ln-729"></a><span class="c">!!    laboratory interpreter</span>
<a name="ln-730"></a><span class="c">!!    LICENSE(MIT)</span>
<a name="ln-731"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-732"></a><span class="c">!!</span>
<a name="ln-733"></a><span class="c">!!</span>
<a name="ln-734"></a><span class="c">!!     subroutine lala(init,cmd)</span>
<a name="ln-735"></a><span class="c">!!</span>
<a name="ln-736"></a><span class="c">!!      integer,intent(in),optional :: init</span>
<a name="ln-737"></a><span class="c">!!      character(len=*),intent(in),optional :: cmd</span>
<a name="ln-738"></a><span class="c">!!         or</span>
<a name="ln-739"></a><span class="c">!!      character(len=*),intent(in),optional :: cmd(:)</span>
<a name="ln-740"></a><span class="c">!!</span>
<a name="ln-741"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-742"></a><span class="c">!!    LALA(3f) is modeled on MATLAB(3f) (MATrix LABoratory), a FORTRAN</span>
<a name="ln-743"></a><span class="c">!!    package developed by Argonne National Laboratories for in-house use.</span>
<a name="ln-744"></a><span class="c">!!    It provides comprehensive vector and tensor operations in a package</span>
<a name="ln-745"></a><span class="c">!!    which may be programmed, either through a macro language or through</span>
<a name="ln-746"></a><span class="c">!!    execution of script files.</span>
<a name="ln-747"></a><span class="c">!!</span>
<a name="ln-748"></a><span class="c">!!    LALA(3f) Functions supported include (but are not by any means limited</span>
<a name="ln-749"></a><span class="c">!!    to) sin, cos, tan, arcfunctions, upper triangular, lower triangular,</span>
<a name="ln-750"></a><span class="c">!!    determinants, matrix multiplication, identity, Hilbert matrices,</span>
<a name="ln-751"></a><span class="c">!!    eigenvalues and eigenvectors, matrix roots and products, inversion</span>
<a name="ln-752"></a><span class="c">!!    and so on and so forth.</span>
<a name="ln-753"></a><span class="c">!!</span>
<a name="ln-754"></a><span class="c">!!    LALA() can be used</span>
<a name="ln-755"></a><span class="c">!!       + as a stand-alone utility for working with lala() files and</span>
<a name="ln-756"></a><span class="c">!!         for basic computations.</span>
<a name="ln-757"></a><span class="c">!!       + embedded in a Fortran program, passing variables back and forth</span>
<a name="ln-758"></a><span class="c">!!         between the calling program and the utility.</span>
<a name="ln-759"></a><span class="c">!!       + to read configuration and data files that contain expressions</span>
<a name="ln-760"></a><span class="c">!!         and conditionally selected values.</span>
<a name="ln-761"></a><span class="c">!!       + for interactively inspecting data generated by the calling program.</span>
<a name="ln-762"></a><span class="c">!!       + for creating unit tests that allow for further interactive examination.</span>
<a name="ln-763"></a><span class="c">!!</span>
<a name="ln-764"></a><span class="c">!!    The HELP command describes using the interpreter.</span>
<a name="ln-765"></a><span class="c">!!</span>
<a name="ln-766"></a><span class="c">!!##OPTIONS</span>
<a name="ln-767"></a><span class="c">!!    INIT    indicate size of scratch space to allocate and (re)initialize</span>
<a name="ln-768"></a><span class="c">!!            LALA.</span>
<a name="ln-769"></a><span class="c">!!</span>
<a name="ln-770"></a><span class="c">!!    CMD     LALA command(s) to perform. May be CHARACTER scalar or vector</span>
<a name="ln-771"></a><span class="c">!!</span>
<a name="ln-772"></a><span class="c">!!    INIT and CMD cannot be combined on a single call.</span>
<a name="ln-773"></a><span class="c">!!</span>
<a name="ln-774"></a><span class="c">!!    The first call may be an initialization declaring the number of</span>
<a name="ln-775"></a><span class="c">!!    doubleprecision complex values to allocate for the combined scratch</span>
<a name="ln-776"></a><span class="c">!!    and variable storage area. This form may be repeated and reinitializes</span>
<a name="ln-777"></a><span class="c">!!    the utility at each call. A size of zero will deallocate any allocated</span>
<a name="ln-778"></a><span class="c">!!    storage (after which the routine cannot be called with commands until</span>
<a name="ln-779"></a><span class="c">!!    reallocated by another call to lala()).</span>
<a name="ln-780"></a><span class="c">!!</span>
<a name="ln-781"></a><span class="c">!!    If no parameters are supplied interactive mode is entered.</span>
<a name="ln-782"></a><span class="c">!!</span>
<a name="ln-783"></a><span class="c">!!    If a CMD is passed and no previous initialization call was made the</span>
<a name="ln-784"></a><span class="c">!!    scratch space will be allocated to 200000.</span>
<a name="ln-785"></a><span class="c">!!</span>
<a name="ln-786"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-787"></a><span class="c">!!</span>
<a name="ln-788"></a><span class="c">!!</span>
<a name="ln-789"></a><span class="c">!!   Example 1:</span>
<a name="ln-790"></a><span class="c">!!</span>
<a name="ln-791"></a><span class="c">!!       program demo_LALA</span>
<a name="ln-792"></a><span class="c">!!       use M_matrix, only : lala</span>
<a name="ln-793"></a><span class="c">!!</span>
<a name="ln-794"></a><span class="c">!!          write(*,&#39;(a)&#39;)&#39;optionally initialize scratch area size&#39;</span>
<a name="ln-795"></a><span class="c">!!          call LALA(20000)</span>
<a name="ln-796"></a><span class="c">!!</span>
<a name="ln-797"></a><span class="c">!!          write(*,&#39;(a)&#39;)&#39;do some commands&#39;</span>
<a name="ln-798"></a><span class="c">!!          call LALA([character(len=80) :: &amp;</span>
<a name="ln-799"></a><span class="c">!!          &amp; &#39;semi;                         &#39;,&amp;</span>
<a name="ln-800"></a><span class="c">!!          &amp; &#39;a=magic(4),b=-a               &#39;,&amp;</span>
<a name="ln-801"></a><span class="c">!!          &amp; &#39;a+b;a;b                       &#39;,&amp;</span>
<a name="ln-802"></a><span class="c">!!          &amp; &quot;display(&#39;That is all Folks!&#39;) &quot;])</span>
<a name="ln-803"></a><span class="c">!!</span>
<a name="ln-804"></a><span class="c">!!          write(*,&#39;(a)&#39;)&#39;do a single command&#39;</span>
<a name="ln-805"></a><span class="c">!!          call LALA(&#39;who&#39;)</span>
<a name="ln-806"></a><span class="c">!!</span>
<a name="ln-807"></a><span class="c">!!          write(*,&#39;(a)&#39;)&#39;enter interactive mode&#39;</span>
<a name="ln-808"></a><span class="c">!!          call LALA()</span>
<a name="ln-809"></a><span class="c">!!</span>
<a name="ln-810"></a><span class="c">!!          write(*,&#39;(a)&#39;)&#39;ending program&#39;</span>
<a name="ln-811"></a><span class="c">!!       end program demo_LALA</span>
<a name="ln-812"></a><span class="c">!!</span>
<a name="ln-813"></a><span class="c">!!   Example 2:</span>
<a name="ln-814"></a><span class="c">!!</span>
<a name="ln-815"></a><span class="c">!!    program bigmat</span>
<a name="ln-816"></a><span class="c">!!    use M_matrix, only : lala</span>
<a name="ln-817"></a><span class="c">!!       ! pass strings to LALA but do not enter interactive mode</span>
<a name="ln-818"></a><span class="c">!!       call lala(20000)                  ! initialize silently</span>
<a name="ln-819"></a><span class="c">!!       call lala( &#39;a=[1 2 3 4; 5 6 7 8]&#39;)</span>
<a name="ln-820"></a><span class="c">!!       call lala( [character(len=80) :: &amp;</span>
<a name="ln-821"></a><span class="c">!!        &amp; &#39;semi;lines(999999)                                    &#39;,&amp;</span>
<a name="ln-822"></a><span class="c">!!        &amp; &#39;// create a magic square and add 100 to all the values&#39;,&amp;</span>
<a name="ln-823"></a><span class="c">!!        &amp; &#39;A=magic(4),&lt;X,Y&gt;=shape(A)                             &#39;,&amp;</span>
<a name="ln-824"></a><span class="c">!!        &amp; &#39;B=A+ones(X,Y)*100                                     &#39;,&amp;</span>
<a name="ln-825"></a><span class="c">!!        &amp; &#39;// save all current values to a file                  &#39;,&amp;</span>
<a name="ln-826"></a><span class="c">!!        &amp; &quot;save(&#39;sample.laf&#39;)                                    &quot;,&amp;</span>
<a name="ln-827"></a><span class="c">!!        &amp; &#39;// clear all user values                              &#39;,&amp;</span>
<a name="ln-828"></a><span class="c">!!        &amp; &#39;clear                                                 &#39;,&amp;</span>
<a name="ln-829"></a><span class="c">!!        &amp; &#39;// show variable names, load values from file         &#39;,&amp;</span>
<a name="ln-830"></a><span class="c">!!        &amp; &#39;// and show again to show the variables are restored  &#39;,&amp;</span>
<a name="ln-831"></a><span class="c">!!        &amp; &quot;who;load(&#39;sample.laf&#39;);who                            &quot;])</span>
<a name="ln-832"></a><span class="c">!!    end program bigmat</span>
<a name="ln-833"></a><span class="c">!!</span>
<a name="ln-834"></a><span class="c">!!   Example 3: Sample program with custom user function</span>
<a name="ln-835"></a><span class="c">!!</span>
<a name="ln-836"></a><span class="c">!!       program custom_user</span>
<a name="ln-837"></a><span class="c">!!       use M_matrix</span>
<a name="ln-838"></a><span class="c">!!       implicit none</span>
<a name="ln-839"></a><span class="c">!!       call set_usersub(lala_user)</span>
<a name="ln-840"></a><span class="c">!!       call lala()</span>
<a name="ln-841"></a><span class="c">!!       contains</span>
<a name="ln-842"></a><span class="c">!!       !-------------------------------------------------------------</span>
<a name="ln-843"></a><span class="c">!!       subroutine lala_user(a,m,n,s,t)  ! sample user routine</span>
<a name="ln-844"></a><span class="c">!!       ! Allows personal  Fortran  subroutines  to  be  linked  into</span>
<a name="ln-845"></a><span class="c">!!       ! LALA. The subroutine should have the heading</span>
<a name="ln-846"></a><span class="c">!!       !</span>
<a name="ln-847"></a><span class="c">!!       !    subroutine name(a,m,n,s,t)</span>
<a name="ln-848"></a><span class="c">!!       !    integer :: m,n</span>
<a name="ln-849"></a><span class="c">!!       !    doubleprecision a(:),s,t</span>
<a name="ln-850"></a><span class="c">!!       !</span>
<a name="ln-851"></a><span class="c">!!       ! The LALA statement Y = USER(X,s,t) results in a call to</span>
<a name="ln-852"></a><span class="c">!!       ! the subroutine with a copy of the matrix X stored in the</span>
<a name="ln-853"></a><span class="c">!!       ! argument A, its column and row dimensions in M and N,</span>
<a name="ln-854"></a><span class="c">!!       ! and the scalar parameters S and T stored in S and T.</span>
<a name="ln-855"></a><span class="c">!!       ! If S and T are omitted, they are set to 0.0. After</span>
<a name="ln-856"></a><span class="c">!!       ! the return, A is stored in Y. The dimensions M and</span>
<a name="ln-857"></a><span class="c">!!       ! N may be reset within the subroutine. The statement Y =</span>
<a name="ln-858"></a><span class="c">!!       ! USER(K) results in a call with M = 1, N = 1 and A(1,1) =</span>
<a name="ln-859"></a><span class="c">!!       ! FLOAT(K). After the subroutine has been written, it must</span>
<a name="ln-860"></a><span class="c">!!       ! be compiled and linked to the LALA object code within the</span>
<a name="ln-861"></a><span class="c">!!       ! local programming environment.</span>
<a name="ln-862"></a><span class="c">!!       !</span>
<a name="ln-863"></a><span class="c">!!       implicit none</span>
<a name="ln-864"></a><span class="c">!!       integer                    :: m,n</span>
<a name="ln-865"></a><span class="c">!!       doubleprecision            :: a(:)</span>
<a name="ln-866"></a><span class="c">!!       doubleprecision            :: s,t</span>
<a name="ln-867"></a><span class="c">!!       integer                    :: i, j, k</span>
<a name="ln-868"></a><span class="c">!!          write(*,*)&#39;MY ROUTINE&#39;</span>
<a name="ln-869"></a><span class="c">!!          write(*,*)&#39;M=&#39;,m</span>
<a name="ln-870"></a><span class="c">!!          write(*,*)&#39;N=&#39;,n</span>
<a name="ln-871"></a><span class="c">!!          write(*,*)&#39;S=&#39;,s</span>
<a name="ln-872"></a><span class="c">!!          write(*,*)&#39;T=&#39;,t</span>
<a name="ln-873"></a><span class="c">!!          k=0</span>
<a name="ln-874"></a><span class="c">!!          do i = 1, m</span>
<a name="ln-875"></a><span class="c">!!             do j = 1, n</span>
<a name="ln-876"></a><span class="c">!!                k=k+1</span>
<a name="ln-877"></a><span class="c">!!                write(*,*)i,j,a(k)</span>
<a name="ln-878"></a><span class="c">!!             enddo</span>
<a name="ln-879"></a><span class="c">!!          enddo</span>
<a name="ln-880"></a><span class="c">!!          k=0</span>
<a name="ln-881"></a><span class="c">!!          if(s.eq.0)s=1</span>
<a name="ln-882"></a><span class="c">!!          do i = 1, m</span>
<a name="ln-883"></a><span class="c">!!             do j = 1, n</span>
<a name="ln-884"></a><span class="c">!!                k=k+1</span>
<a name="ln-885"></a><span class="c">!!                a(k)=a(k)*s+t</span>
<a name="ln-886"></a><span class="c">!!             enddo</span>
<a name="ln-887"></a><span class="c">!!          enddo</span>
<a name="ln-888"></a><span class="c">!!       end subroutine lala_user</span>
<a name="ln-889"></a><span class="c">!!       end program custom_user</span>
<a name="ln-890"></a><span class="c">!!</span>
<a name="ln-891"></a><span class="c">!!  Example inputs</span>
<a name="ln-892"></a><span class="c">!!</span>
<a name="ln-893"></a><span class="c">!!      &gt;:avg:</span>
<a name="ln-894"></a><span class="c">!!</span>
<a name="ln-895"></a><span class="c">!!      &gt;for i = 2:2:n, for j = 2:2:n, t = (a(i-1,j-1)+a(i-1,j)+a(i,j-1)+a(i,j))/4; ...</span>
<a name="ln-896"></a><span class="c">!!      &gt;a(i-1,j-1) = t; a(i,j-1) = t; a(i-1,j) = t; a(i,j) = t;</span>
<a name="ln-897"></a><span class="c">!!</span>
<a name="ln-898"></a><span class="c">!!      &gt;:cdiv:</span>
<a name="ln-899"></a><span class="c">!!</span>
<a name="ln-900"></a><span class="c">!!      &gt;// ======================================================</span>
<a name="ln-901"></a><span class="c">!!      &gt;// cdiv</span>
<a name="ln-902"></a><span class="c">!!      &gt;a=sqrt(random(8))</span>
<a name="ln-903"></a><span class="c">!!      &gt;ar = real(a); ai = imag(a); br = real(b); bi = imag(b);</span>
<a name="ln-904"></a><span class="c">!!      &gt;p = bi/br;</span>
<a name="ln-905"></a><span class="c">!!      &gt;t = (ai - p*ar)/(br + p*bi);</span>
<a name="ln-906"></a><span class="c">!!      &gt;cr = p*t + ar/br;</span>
<a name="ln-907"></a><span class="c">!!      &gt;ci = t;</span>
<a name="ln-908"></a><span class="c">!!      &gt;p2 = br/bi;</span>
<a name="ln-909"></a><span class="c">!!      &gt;t2 = (ai + p2*ar)/(bi + p2*br);</span>
<a name="ln-910"></a><span class="c">!!      &gt;ci2 = p2*t2 - ar/bi;</span>
<a name="ln-911"></a><span class="c">!!      &gt;cr2 = t2;</span>
<a name="ln-912"></a><span class="c">!!      &gt;s = abs(br) + abs(bi);</span>
<a name="ln-913"></a><span class="c">!!      &gt;ars = ar/s;</span>
<a name="ln-914"></a><span class="c">!!      &gt;ais = ai/s;</span>
<a name="ln-915"></a><span class="c">!!      &gt;brs = br/s;</span>
<a name="ln-916"></a><span class="c">!!      &gt;bis = bi/s;</span>
<a name="ln-917"></a><span class="c">!!      &gt;s = brs**2 + bis**2;</span>
<a name="ln-918"></a><span class="c">!!      &gt;cr3 = (ars*brs + ais*bis)/s;</span>
<a name="ln-919"></a><span class="c">!!      &gt;ci3 = (ais*brs - ars*bis)/s;</span>
<a name="ln-920"></a><span class="c">!!      &gt;[cr ci; cr2 ci2; cr3 ci3]</span>
<a name="ln-921"></a><span class="c">!!      &gt;// ======================================================</span>
<a name="ln-922"></a><span class="c">!!</span>
<a name="ln-923"></a><span class="c">!!      &gt;:exp:</span>
<a name="ln-924"></a><span class="c">!!</span>
<a name="ln-925"></a><span class="c">!!      &gt;t = 0*x + eye; s = 0*eye(x); n = 1;</span>
<a name="ln-926"></a><span class="c">!!      &gt;while abs(s+t-s) &gt; 0, s = s+t, t = x*t/n, n = n + 1</span>
<a name="ln-927"></a><span class="c">!!</span>
<a name="ln-928"></a><span class="c">!!      &gt;:four:</span>
<a name="ln-929"></a><span class="c">!!      &gt; n</span>
<a name="ln-930"></a><span class="c">!!      &gt; pi = 4*atan(1);</span>
<a name="ln-931"></a><span class="c">!!      &gt; i = sqrt(-1);</span>
<a name="ln-932"></a><span class="c">!!      &gt; w = exp(2*pi*i/n);</span>
<a name="ln-933"></a><span class="c">!!      &gt; F = [];</span>
<a name="ln-934"></a><span class="c">!!      &gt; for k = 1:n, for j = 1:n, F(k,j) = w**((j-1)*(k-1));</span>
<a name="ln-935"></a><span class="c">!!      &gt; F = F/sqrt(n);</span>
<a name="ln-936"></a><span class="c">!!      &gt; alpha = r*pi;</span>
<a name="ln-937"></a><span class="c">!!      &gt; rho = exp(i*alpha);</span>
<a name="ln-938"></a><span class="c">!!      &gt; S = log(rho*F)/i - alpha*eye;</span>
<a name="ln-939"></a><span class="c">!!      &gt; serr = norm(imag(S),1);</span>
<a name="ln-940"></a><span class="c">!!      &gt; S = real(S);</span>
<a name="ln-941"></a><span class="c">!!      &gt; serr = serr + norm(S-S&#39;,1)</span>
<a name="ln-942"></a><span class="c">!!      &gt; S = (S + S&#39;)/2;</span>
<a name="ln-943"></a><span class="c">!!      &gt; ferr = norm(F-exp(i*S),1)</span>
<a name="ln-944"></a><span class="c">!!</span>
<a name="ln-945"></a><span class="c">!!      &gt; :gs:</span>
<a name="ln-946"></a><span class="c">!!      &gt; for k = 1:n, for j = 1:k-1, d = x(k,:)*x(j,:)&#39;; x(k,:) = x(k,:) - d*x(j,:); ...</span>
<a name="ln-947"></a><span class="c">!!      &gt; end, s = norm(x(k,:)), x(k,:) = x(k,:)/s;</span>
<a name="ln-948"></a><span class="c">!!</span>
<a name="ln-949"></a><span class="c">!!      &gt; :jacobi:</span>
<a name="ln-950"></a><span class="c">!!      &gt; [n, n] = shape(A);</span>
<a name="ln-951"></a><span class="c">!!      &gt; X = eye(n);</span>
<a name="ln-952"></a><span class="c">!!      &gt; anorm = norm(A,&#39;fro&#39;);</span>
<a name="ln-953"></a><span class="c">!!      &gt; cnt = 1;</span>
<a name="ln-954"></a><span class="c">!!      &gt; while cnt &gt; 0, ...</span>
<a name="ln-955"></a><span class="c">!!      &gt;   cnt = 0; ...</span>
<a name="ln-956"></a><span class="c">!!      &gt;   for p = 1:n-1, ...</span>
<a name="ln-957"></a><span class="c">!!      &gt;     for q = p+1:n, ...</span>
<a name="ln-958"></a><span class="c">!!      &gt;       if anorm + abs(a(p,q)) &gt; anorm, ...</span>
<a name="ln-959"></a><span class="c">!!      &gt;         cnt = cnt + 1; ...</span>
<a name="ln-960"></a><span class="c">!!      &gt;         exec(&#39;jacstep&#39;); ...</span>
<a name="ln-961"></a><span class="c">!!      &gt;       end, ...</span>
<a name="ln-962"></a><span class="c">!!      &gt;     end, ...</span>
<a name="ln-963"></a><span class="c">!!      &gt;   end, ...</span>
<a name="ln-964"></a><span class="c">!!      &gt;   display(rat(A)), ...</span>
<a name="ln-965"></a><span class="c">!!      &gt; end</span>
<a name="ln-966"></a><span class="c">!!</span>
<a name="ln-967"></a><span class="c">!!      &gt; :jacstep:</span>
<a name="ln-968"></a><span class="c">!!</span>
<a name="ln-969"></a><span class="c">!!      &gt; d = (a(q,q)-a(p,p))*0.5/a(p,q);</span>
<a name="ln-970"></a><span class="c">!!      &gt; t = 1/(abs(d)+sqrt(d*d+1));</span>
<a name="ln-971"></a><span class="c">!!      &gt; if d &lt; 0, t = -t; end;</span>
<a name="ln-972"></a><span class="c">!!      &gt; c = 1/sqrt(1+t*t);  s = t*c;</span>
<a name="ln-973"></a><span class="c">!!      &gt; R = eye(n); r(p,p)=c; r(q,q)=c; r(p,q)=s; r(q,p)=-s;</span>
<a name="ln-974"></a><span class="c">!!      &gt; X = X*R;</span>
<a name="ln-975"></a><span class="c">!!      &gt; A = R&#39;*A*R;</span>
<a name="ln-976"></a><span class="c">!!</span>
<a name="ln-977"></a><span class="c">!!      &gt; :kron:</span>
<a name="ln-978"></a><span class="c">!!</span>
<a name="ln-979"></a><span class="c">!!      &gt; //  C = Kronecker product of A and B</span>
<a name="ln-980"></a><span class="c">!!      &gt; [m, n] = shape(A);</span>
<a name="ln-981"></a><span class="c">!!      &gt; for i = 1:m, ...</span>
<a name="ln-982"></a><span class="c">!!      &gt;    ci = a(i,1)*B; ...</span>
<a name="ln-983"></a><span class="c">!!      &gt;    for j = 2:n, ci = [ci a(i,j)*B]; end ...</span>
<a name="ln-984"></a><span class="c">!!      &gt;    if i = 1, C = ci; else, C = [C; ci];</span>
<a name="ln-985"></a><span class="c">!!</span>
<a name="ln-986"></a><span class="c">!!      &gt; :lanczos:</span>
<a name="ln-987"></a><span class="c">!!</span>
<a name="ln-988"></a><span class="c">!!      &gt; [n,n] = shape(A);</span>
<a name="ln-989"></a><span class="c">!!      &gt; q1 = rand(n,1);</span>
<a name="ln-990"></a><span class="c">!!      &gt; ort</span>
<a name="ln-991"></a><span class="c">!!      &gt; alpha = []; beta = [];</span>
<a name="ln-992"></a><span class="c">!!      &gt; q = q1/norm(q1); r = A*q(:,1);</span>
<a name="ln-993"></a><span class="c">!!      &gt; for j = 1:n, exec(&#39;lanstep&#39;,0);</span>
<a name="ln-994"></a><span class="c">!!</span>
<a name="ln-995"></a><span class="c">!!      &gt; :lanstep:</span>
<a name="ln-996"></a><span class="c">!!</span>
<a name="ln-997"></a><span class="c">!!      &gt; alpha(j) = q(:,j)&#39;*r;</span>
<a name="ln-998"></a><span class="c">!!      &gt; r = r - alpha(j)*q(:,j);</span>
<a name="ln-999"></a><span class="c">!!      &gt; if ort &lt;&gt; 0, for k = 1:j-1, r = r - r&#39;*q(:,k)*q(:,k);</span>
<a name="ln-1000"></a><span class="c">!!      &gt; beta(j) = norm(r);</span>
<a name="ln-1001"></a><span class="c">!!      &gt; q(:,j+1) = r/beta(j);</span>
<a name="ln-1002"></a><span class="c">!!      &gt; r = A*q(:,j+1) - beta(j)*q(:,j);</span>
<a name="ln-1003"></a><span class="c">!!      &gt; if j &gt; 1, T = diag(beta(1:j-1),1); T = diag(alpha) + T + T&#39;; eig(T)</span>
<a name="ln-1004"></a><span class="c">!!</span>
<a name="ln-1005"></a><span class="c">!!      &gt; :mgs:</span>
<a name="ln-1006"></a><span class="c">!!</span>
<a name="ln-1007"></a><span class="c">!!      &gt; for k = 1:n, s = norm(x(k,:)), x(k,:) = x(k,:)/s; ...</span>
<a name="ln-1008"></a><span class="c">!!      &gt;    for j = k+1:n, d = x(j,:)*x(k,:)&#39;; x(j,:) = x(j,:) - d*x(k,:);</span>
<a name="ln-1009"></a><span class="c">!!</span>
<a name="ln-1010"></a><span class="c">!!      &gt; :net:</span>
<a name="ln-1011"></a><span class="c">!!</span>
<a name="ln-1012"></a><span class="c">!!      &gt; C = [</span>
<a name="ln-1013"></a><span class="c">!!      &gt; 1   2   15  .   .   .</span>
<a name="ln-1014"></a><span class="c">!!      &gt; 2   1   3   .   .   .</span>
<a name="ln-1015"></a><span class="c">!!      &gt; 3   2   4   11  .   .</span>
<a name="ln-1016"></a><span class="c">!!      &gt; 4   3   5   .   .   .</span>
<a name="ln-1017"></a><span class="c">!!      &gt; 5   4   6   7   .   .</span>
<a name="ln-1018"></a><span class="c">!!      &gt; 6   5   8   .   .   .</span>
<a name="ln-1019"></a><span class="c">!!      &gt; 7   5   9   30  .   .</span>
<a name="ln-1020"></a><span class="c">!!      &gt; 8   6   9   10  11  .</span>
<a name="ln-1021"></a><span class="c">!!      &gt; 9   7   8   30  .   .</span>
<a name="ln-1022"></a><span class="c">!!      &gt; 10  8   12  30  31  34</span>
<a name="ln-1023"></a><span class="c">!!      &gt; 11  3   8   12  13  .</span>
<a name="ln-1024"></a><span class="c">!!      &gt; 12  10  11  34  36  .</span>
<a name="ln-1025"></a><span class="c">!!      &gt; 13  11  14  .   .   .</span>
<a name="ln-1026"></a><span class="c">!!      &gt; 14  13  15  16  38  .</span>
<a name="ln-1027"></a><span class="c">!!      &gt; 15  1   14  .   .   .</span>
<a name="ln-1028"></a><span class="c">!!      &gt; 16  14  17  20  35  37</span>
<a name="ln-1029"></a><span class="c">!!      &gt; 17  16  18  .   .   .</span>
<a name="ln-1030"></a><span class="c">!!      &gt; 18  17  19  .   .   .</span>
<a name="ln-1031"></a><span class="c">!!      &gt; 19  18  20  .   .   .</span>
<a name="ln-1032"></a><span class="c">!!      &gt; 20  16  19  21  .   .</span>
<a name="ln-1033"></a><span class="c">!!      &gt; 21  20  22  .   .   .</span>
<a name="ln-1034"></a><span class="c">!!      &gt; 22  21  23  .   .   .</span>
<a name="ln-1035"></a><span class="c">!!      &gt; 23  22  24  35  .   .</span>
<a name="ln-1036"></a><span class="c">!!      &gt; 24  23  25  39  .   .</span>
<a name="ln-1037"></a><span class="c">!!      &gt; 25  24  .   .   .   .</span>
<a name="ln-1038"></a><span class="c">!!      &gt; 26  27  33  39  .   .</span>
<a name="ln-1039"></a><span class="c">!!      &gt; 27  26  32  .   .   .</span>
<a name="ln-1040"></a><span class="c">!!      &gt; 28  29  32  .   .   .</span>
<a name="ln-1041"></a><span class="c">!!      &gt; 29  28  30  .   .   .</span>
<a name="ln-1042"></a><span class="c">!!      &gt; 30  7   9   10  29  .</span>
<a name="ln-1043"></a><span class="c">!!      &gt; 31  10  32  .   .   .</span>
<a name="ln-1044"></a><span class="c">!!      &gt; 32  27  28  31  34  .</span>
<a name="ln-1045"></a><span class="c">!!      &gt; 33  26  34  .   .   .</span>
<a name="ln-1046"></a><span class="c">!!      &gt; 34  10  12  32  33  35</span>
<a name="ln-1047"></a><span class="c">!!      &gt; 35  16  23  34  36  .</span>
<a name="ln-1048"></a><span class="c">!!      &gt; 36  12  35  38  .   .</span>
<a name="ln-1049"></a><span class="c">!!      &gt; 37  16  38  .   .   .</span>
<a name="ln-1050"></a><span class="c">!!      &gt; 38  14  36  37  .   .</span>
<a name="ln-1051"></a><span class="c">!!      &gt; 39  24  26  .   .   .</span>
<a name="ln-1052"></a><span class="c">!!      &gt; ];</span>
<a name="ln-1053"></a><span class="c">!!      &gt; [n, m] = shape(C);</span>
<a name="ln-1054"></a><span class="c">!!      &gt; A = 0*ones(n,n);</span>
<a name="ln-1055"></a><span class="c">!!      &gt; for i=1:n, for j=2:m, k=c(i,j); if k&gt;0, a(i,k)=1;</span>
<a name="ln-1056"></a><span class="c">!!      &gt; check = norm(A-A&#39;,1), if check &gt; 0, quit</span>
<a name="ln-1057"></a><span class="c">!!      &gt; [X,D] = eig(A+eye);</span>
<a name="ln-1058"></a><span class="c">!!      &gt; D = diag(D);  D = D(n:-1:1)</span>
<a name="ln-1059"></a><span class="c">!!      &gt; X = X(:,n:-1:1);</span>
<a name="ln-1060"></a><span class="c">!!      &gt; [x(:,1)/sum(x(:,1)) x(:,2) x(:,3) x(:,19)]</span>
<a name="ln-1061"></a><span class="c">!!</span>
<a name="ln-1062"></a><span class="c">!!      &gt; :pascal:</span>
<a name="ln-1063"></a><span class="c">!!</span>
<a name="ln-1064"></a><span class="c">!!      &gt; //Generate next Pascal matrix</span>
<a name="ln-1065"></a><span class="c">!!      &gt; [k,k] = shape(L);</span>
<a name="ln-1066"></a><span class="c">!!      &gt; k = k + 1;</span>
<a name="ln-1067"></a><span class="c">!!      &gt; L(k,1:k) = [L(k-1,:) 0] + [0 L(k-1,:)];</span>
<a name="ln-1068"></a><span class="c">!!</span>
<a name="ln-1069"></a><span class="c">!!      &gt; :pdq:</span>
<a name="ln-1070"></a><span class="c">!!</span>
<a name="ln-1071"></a><span class="c">!!      &gt; alpha = []; beta = 0; q = []; p = p(:,1)/norm(p(:,1));</span>
<a name="ln-1072"></a><span class="c">!!      &gt; t = A&#39;*p(:,1);</span>
<a name="ln-1073"></a><span class="c">!!      &gt; alpha(1) = norm(t);</span>
<a name="ln-1074"></a><span class="c">!!      &gt; q(:,1) = t/alpha(1);</span>
<a name="ln-1075"></a><span class="c">!!      &gt; X = p(:,1)*(alpha(1)*q(:,1))&#39;</span>
<a name="ln-1076"></a><span class="c">!!      &gt; e(1) = norm(A-X,1)</span>
<a name="ln-1077"></a><span class="c">!!      &gt; for j = 2:r, exec(&#39;pdqstep&#39;,ip); ...</span>
<a name="ln-1078"></a><span class="c">!!      &gt;    X = X + p(:,j)*(alpha(j)*q(:,j)+beta(j)*q(:,j-1))&#39;, ...</span>
<a name="ln-1079"></a><span class="c">!!      &gt;    e(j) = norm(A-X,1)</span>
<a name="ln-1080"></a><span class="c">!!</span>
<a name="ln-1081"></a><span class="c">!!      &gt; :pdqstep:</span>
<a name="ln-1082"></a><span class="c">!!</span>
<a name="ln-1083"></a><span class="c">!!      &gt; t = A*q(:,j-1) - alpha(j-1)*p(:,j-1);</span>
<a name="ln-1084"></a><span class="c">!!      &gt;    if ort&gt;0, for i = 1:j-1, t = t - t&#39;*p(:,i)*p(:,i);</span>
<a name="ln-1085"></a><span class="c">!!      &gt; beta(j) = norm(t);</span>
<a name="ln-1086"></a><span class="c">!!      &gt; p(:,j) = t/beta(j);</span>
<a name="ln-1087"></a><span class="c">!!      &gt; t = A&#39;*p(:,j) - beta(j)*q(:,j-1);</span>
<a name="ln-1088"></a><span class="c">!!      &gt;    if ort&gt;0, for i = 1:j-1, t = t - t&#39;*q(:,i)*q(:,i);</span>
<a name="ln-1089"></a><span class="c">!!      &gt; alpha(j) = norm(t);</span>
<a name="ln-1090"></a><span class="c">!!      &gt; q(:,j) = t/alpha(j);</span>
<a name="ln-1091"></a><span class="c">!!</span>
<a name="ln-1092"></a><span class="c">!!      &gt; :pop:</span>
<a name="ln-1093"></a><span class="c">!!</span>
<a name="ln-1094"></a><span class="c">!!      &gt; y = [ 75.995   91.972  105.711  123.203   ...</span>
<a name="ln-1095"></a><span class="c">!!      &gt;      131.669  150.697  179.323  203.212]&#39;</span>
<a name="ln-1096"></a><span class="c">!!      &gt; t = [ 1900:10:1970 ]&#39;</span>
<a name="ln-1097"></a><span class="c">!!      &gt; t = (t - 1940*ones(t))/40;   [t y]</span>
<a name="ln-1098"></a><span class="c">!!      &gt; n = 8;  A(:,1) = ones(t);  for j = 2:n, A(:,j) = t .* A(:,j-1);</span>
<a name="ln-1099"></a><span class="c">!!      &gt; A</span>
<a name="ln-1100"></a><span class="c">!!      &gt; c = A\y</span>
<a name="ln-1101"></a><span class="c">!!</span>
<a name="ln-1102"></a><span class="c">!!      &gt; :qr:</span>
<a name="ln-1103"></a><span class="c">!!</span>
<a name="ln-1104"></a><span class="c">!!      &gt; scale = s(m);</span>
<a name="ln-1105"></a><span class="c">!!      &gt; sm = s(m)/scale; smm1 = s(m-1)/scale; emm1 = e(m-1)/scale;</span>
<a name="ln-1106"></a><span class="c">!!      &gt; sl = s(l)/scale; el = e(l)/scale;</span>
<a name="ln-1107"></a><span class="c">!!      &gt; b = ((smm1 + sm)*(smm1 - sm) + emm1**2)/2;</span>
<a name="ln-1108"></a><span class="c">!!      &gt; c = (sm*emm1)**2;</span>
<a name="ln-1109"></a><span class="c">!!      &gt; shift = sqrt(b**2+c); if b &lt; 0, shift = -shift;</span>
<a name="ln-1110"></a><span class="c">!!      &gt; shift = c/(b + shift)</span>
<a name="ln-1111"></a><span class="c">!!      &gt; f = (sl + sm)*(sl-sm) - shift</span>
<a name="ln-1112"></a><span class="c">!!      &gt; g = sl*el</span>
<a name="ln-1113"></a><span class="c">!!      &gt; for k = l: m-1, exec(&#39;qrstep&#39;,ip)</span>
<a name="ln-1114"></a><span class="c">!!      &gt; e(m-1) = f</span>
<a name="ln-1115"></a><span class="c">!!</span>
<a name="ln-1116"></a><span class="c">!!      &gt; :qrstep:</span>
<a name="ln-1117"></a><span class="c">!!</span>
<a name="ln-1118"></a><span class="c">!!      &gt; exec(&#39;rot&#39;);</span>
<a name="ln-1119"></a><span class="c">!!      &gt; if k &lt;&gt; l, e(k-1) = f</span>
<a name="ln-1120"></a><span class="c">!!      &gt; f = cs*s(k) + sn*e(k)</span>
<a name="ln-1121"></a><span class="c">!!      &gt; e(k) = cs*e(k) - sn*s(k)</span>
<a name="ln-1122"></a><span class="c">!!      &gt; g = sn*s(k+1)</span>
<a name="ln-1123"></a><span class="c">!!      &gt; s(k+1) = cs*s(k+1)</span>
<a name="ln-1124"></a><span class="c">!!      &gt; exec(&#39;rot&#39;);</span>
<a name="ln-1125"></a><span class="c">!!      &gt; s(k) = f</span>
<a name="ln-1126"></a><span class="c">!!      &gt; f = cs*e(k) + sn*s(k+1)</span>
<a name="ln-1127"></a><span class="c">!!      &gt; s(k+1) = -sn*e(k) + cs*s(k+1)</span>
<a name="ln-1128"></a><span class="c">!!      &gt; g = sn*e(k+1)</span>
<a name="ln-1129"></a><span class="c">!!      &gt; e(k+1) = cs*e(k+1)</span>
<a name="ln-1130"></a><span class="c">!!</span>
<a name="ln-1131"></a><span class="c">!!      &gt; :rho:</span>
<a name="ln-1132"></a><span class="c">!!</span>
<a name="ln-1133"></a><span class="c">!!      &gt; //Conductivity example.</span>
<a name="ln-1134"></a><span class="c">!!      &gt; //Parameters ---</span>
<a name="ln-1135"></a><span class="c">!!      &gt;    rho       //radius of cylindrical inclusion</span>
<a name="ln-1136"></a><span class="c">!!      &gt;    n         //number of terms in solution</span>
<a name="ln-1137"></a><span class="c">!!      &gt;    m         //number of boundary points</span>
<a name="ln-1138"></a><span class="c">!!      &gt; //initialize operation counter</span>
<a name="ln-1139"></a><span class="c">!!      &gt;    flop = [0 0];</span>
<a name="ln-1140"></a><span class="c">!!      &gt; //initialize variables</span>
<a name="ln-1141"></a><span class="c">!!      &gt;    m1 = round(m/3);   //number of points on each straight edge</span>
<a name="ln-1142"></a><span class="c">!!      &gt;    m2 = m - m1;       //number of points with Dirichlet conditions</span>
<a name="ln-1143"></a><span class="c">!!      &gt;    pi = 4*atan(1);</span>
<a name="ln-1144"></a><span class="c">!!      &gt; //generate points in Cartesian coordinates</span>
<a name="ln-1145"></a><span class="c">!!      &gt;    //right hand edge</span>
<a name="ln-1146"></a><span class="c">!!      &gt;    for i = 1:m1, x(i) = 1; y(i) = (1-rho)*(i-1)/(m1-1);</span>
<a name="ln-1147"></a><span class="c">!!      &gt;    //top edge</span>
<a name="ln-1148"></a><span class="c">!!      &gt;    for i = m2+1:m, x(i) = (1-rho)*(m-i)/(m-m2-1); y(i) = 1;</span>
<a name="ln-1149"></a><span class="c">!!      &gt;    //circular edge</span>
<a name="ln-1150"></a><span class="c">!!      &gt;    for i = m1+1:m2, t = pi/2*(i-m1)/(m2-m1+1); ...</span>
<a name="ln-1151"></a><span class="c">!!      &gt;       x(i) = 1-rho*sin(t);  y(i) = 1-rho*cos(t);</span>
<a name="ln-1152"></a><span class="c">!!      &gt; //convert to polar coordinates</span>
<a name="ln-1153"></a><span class="c">!!      &gt;    for i = 1:m-1, th(i) = atan(y(i)/x(i));  ...</span>
<a name="ln-1154"></a><span class="c">!!      &gt;       r(i) = sqrt(x(i)**2+y(i)**2);</span>
<a name="ln-1155"></a><span class="c">!!      &gt;    th(m) = pi/2;  r(m) = 1;</span>
<a name="ln-1156"></a><span class="c">!!      &gt; //generate matrix</span>
<a name="ln-1157"></a><span class="c">!!      &gt;    //Dirichlet conditions</span>
<a name="ln-1158"></a><span class="c">!!      &gt;    for i = 1:m2, for j = 1:n, k = 2*j-1; ...</span>
<a name="ln-1159"></a><span class="c">!!      &gt;       a(i,j) = r(i)**k*cos(k*th(i));</span>
<a name="ln-1160"></a><span class="c">!!      &gt;    //Neumann conditions</span>
<a name="ln-1161"></a><span class="c">!!      &gt;    for i = m2+1:m, for j = 1:n, k = 2*j-1; ...</span>
<a name="ln-1162"></a><span class="c">!!      &gt;       a(i,j) = k*r(i)**(k-1)*sin((k-1)*th(i));</span>
<a name="ln-1163"></a><span class="c">!!      &gt; //generate right hand side</span>
<a name="ln-1164"></a><span class="c">!!      &gt;    for i = 1:m2, b(i) = 1;</span>
<a name="ln-1165"></a><span class="c">!!      &gt;    for i = m2+1:m, b(i) = 0;</span>
<a name="ln-1166"></a><span class="c">!!      &gt; //solve for coefficients</span>
<a name="ln-1167"></a><span class="c">!!      &gt;    c = A\b</span>
<a name="ln-1168"></a><span class="c">!!      &gt; //compute effective conductivity</span>
<a name="ln-1169"></a><span class="c">!!      &gt;    c(2:2:n) = -c(2:2:n)</span>
<a name="ln-1170"></a><span class="c">!!      &gt;    sigma = sum(c)</span>
<a name="ln-1171"></a><span class="c">!!      &gt; //output total operation count</span>
<a name="ln-1172"></a><span class="c">!!      &gt;    ops = flop(2)</span>
<a name="ln-1173"></a><span class="c">!!</span>
<a name="ln-1174"></a><span class="c">!!      &gt; :rogers.exec:</span>
<a name="ln-1175"></a><span class="c">!!</span>
<a name="ln-1176"></a><span class="c">!!      &gt; exec(&#39;d.boug&#39;);                // reads data</span>
<a name="ln-1177"></a><span class="c">!!      &gt; [g,k] = shape(p);              // p is matrix of gene frequencies</span>
<a name="ln-1178"></a><span class="c">!!      &gt; wv = ncen/sum(ncen);           // ncen contains population sizes</span>
<a name="ln-1179"></a><span class="c">!!      &gt; pbar = wv*p;                   // weighted average of p</span>
<a name="ln-1180"></a><span class="c">!!      &gt; p = p - ones(g,1)*pbar;        // deviations from mean</span>
<a name="ln-1181"></a><span class="c">!!      &gt; p = sqrt(diag(wv)) * p;        // weight rows of p by sqrt of pop size</span>
<a name="ln-1182"></a><span class="c">!!      &gt; h = diag(pbar); h = h*(eye-h); // diagonal contains binomial variance: p*(1-p)</span>
<a name="ln-1183"></a><span class="c">!!      &gt; r = p*inv(h)*p&#39;/k;             // normalized covariance matrix</span>
<a name="ln-1184"></a><span class="c">!!      &gt; eig(r)&#39;</span>
<a name="ln-1185"></a><span class="c">!!</span>
<a name="ln-1186"></a><span class="c">!!      &gt; :rosser:</span>
<a name="ln-1187"></a><span class="c">!!</span>
<a name="ln-1188"></a><span class="c">!!      &gt; A  = [</span>
<a name="ln-1189"></a><span class="c">!!      &gt;   611.  196. -192.  407.   -8.  -52.  -49.   29.</span>
<a name="ln-1190"></a><span class="c">!!      &gt;   196.  899.  113. -192.  -71.  -43.   -8.  -44.</span>
<a name="ln-1191"></a><span class="c">!!      &gt;  -192.  113.  899.  196.   61.   49.    8.   52.</span>
<a name="ln-1192"></a><span class="c">!!      &gt;   407. -192.  196.  611.    8.   44.   59.  -23.</span>
<a name="ln-1193"></a><span class="c">!!      &gt;    -8.  -71.   61.    8.  411. -599.  208.  208.</span>
<a name="ln-1194"></a><span class="c">!!      &gt;   -52.  -43.   49.   44. -599.  411.  208.  208.</span>
<a name="ln-1195"></a><span class="c">!!      &gt;   -49.   -8.    8.   59.  208.  208.   99. -911.</span>
<a name="ln-1196"></a><span class="c">!!      &gt;    29.  -44.   52.  -23.  208.  208. -911.   99.  ];</span>
<a name="ln-1197"></a><span class="c">!!</span>
<a name="ln-1198"></a><span class="c">!!      &gt; :rot:</span>
<a name="ln-1199"></a><span class="c">!!</span>
<a name="ln-1200"></a><span class="c">!!      &gt; // subexec rot(f,g,cs,sn)</span>
<a name="ln-1201"></a><span class="c">!!      &gt;    rho = g; if abs(f) &gt; abs(g), rho = f;</span>
<a name="ln-1202"></a><span class="c">!!      &gt;    cs = 1.0; sn = 0.0; z = 1.0;</span>
<a name="ln-1203"></a><span class="c">!!      &gt;    r = norm([f g]); if rho &lt; 0, r = -r; r</span>
<a name="ln-1204"></a><span class="c">!!      &gt;    if r &lt;&gt; 0.0, cs = f/r</span>
<a name="ln-1205"></a><span class="c">!!      &gt;    if r &lt;&gt; 0.0, sn = g/r</span>
<a name="ln-1206"></a><span class="c">!!      &gt;    if abs(f) &gt; abs(g), z = sn;</span>
<a name="ln-1207"></a><span class="c">!!      &gt;    if abs(g) &gt;= abs(f), if cs &lt;&gt; 0, z = 1/cs;</span>
<a name="ln-1208"></a><span class="c">!!      &gt;    f = r;</span>
<a name="ln-1209"></a><span class="c">!!      &gt;    g = z;</span>
<a name="ln-1210"></a><span class="c">!!</span>
<a name="ln-1211"></a><span class="c">!!      &gt; :rqi:</span>
<a name="ln-1212"></a><span class="c">!!</span>
<a name="ln-1213"></a><span class="c">!!      &gt; rho = (x&#39;*A*x)</span>
<a name="ln-1214"></a><span class="c">!!      &gt; x = (A-rho*eye)\x;</span>
<a name="ln-1215"></a><span class="c">!!      &gt; x = x/norm(x)</span>
<a name="ln-1216"></a><span class="c">!!</span>
<a name="ln-1217"></a><span class="c">!!      &gt; :setup:</span>
<a name="ln-1218"></a><span class="c">!!</span>
<a name="ln-1219"></a><span class="c">!!      &gt; diary(&#39;xxx&#39;)</span>
<a name="ln-1220"></a><span class="c">!!      &gt; !tail -f xxx &gt; /dev/tty1 &amp;</span>
<a name="ln-1221"></a><span class="c">!!      &gt; !tail -f xxx &gt; /dev/tty2 &amp;</span>
<a name="ln-1222"></a><span class="c">!!</span>
<a name="ln-1223"></a><span class="c">!!      &gt; :sigma:</span>
<a name="ln-1224"></a><span class="c">!!</span>
<a name="ln-1225"></a><span class="c">!!      &gt; RHO = .5  M = 20  N = 10   SIGMA =  1.488934271883534</span>
<a name="ln-1226"></a><span class="c">!!      &gt; RHO = .5  M = 40  N = 20   SIGMA =  1.488920312974229</span>
<a name="ln-1227"></a><span class="c">!!      &gt; RHO = .5  M = 60  N = 30   SIGMA =  1.488920697912116</span>
<a name="ln-1228"></a><span class="c">!!</span>
<a name="ln-1229"></a><span class="c">!!      &gt; :strut.laf:</span>
<a name="ln-1230"></a><span class="c">!!</span>
<a name="ln-1231"></a><span class="c">!!      &gt; // Structure problem, Forsythe, Malcolm and Moler, p. 62</span>
<a name="ln-1232"></a><span class="c">!!      &gt; s =  sqrt(2)/2;</span>
<a name="ln-1233"></a><span class="c">!!      &gt; A = [</span>
<a name="ln-1234"></a><span class="c">!!      &gt; -s  .  .  1  s   .  .  .  .  .  .  .  .  .  .  .  .</span>
<a name="ln-1235"></a><span class="c">!!      &gt; -s  . -1  . -s   .  .  .  .  .  .  .  .  .  .  .  .</span>
<a name="ln-1236"></a><span class="c">!!      &gt;  . -1  .  .  .   1  .  .  .  .  .  .  .  .  .  .  .</span>
<a name="ln-1237"></a><span class="c">!!      &gt;  .  .  1  .  .   .  .  .  .  .  .  .  .  .  .  .  .</span>
<a name="ln-1238"></a><span class="c">!!      &gt;  .  .  . -1  .   .  .  1  .  .  .  .  .  .  .  .  .</span>
<a name="ln-1239"></a><span class="c">!!      &gt;  .  .  .  .  .   . -1  .  .  .  .  .  .  .  .  .  .</span>
<a name="ln-1240"></a><span class="c">!!      &gt;  .  .  .  . -s -1  .  .  s  1  .  .  .   .  .  .  .</span>
<a name="ln-1241"></a><span class="c">!!      &gt;  .  .  .  .  s   .  1  .  s  .  .  .  .  .  .  .  .</span>
<a name="ln-1242"></a><span class="c">!!      &gt;  .  .  .  .  .   .  . -1 -s  .  .  1  s  .  .  .  .</span>
<a name="ln-1243"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  . -s  . -1  . -s  .  .  .  .</span>
<a name="ln-1244"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  .  . -1  .  .  .  1  .  .  .</span>
<a name="ln-1245"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  .  .  .  1  .  .  .  .  .  .</span>
<a name="ln-1246"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  .  .  .  . -1  .  .  .  s  .</span>
<a name="ln-1247"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  .  .  .  .  .  .  . -1 -s  .</span>
<a name="ln-1248"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  .  .  .  .  . -s -1  .  .  1</span>
<a name="ln-1249"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  .  .  .  .  .  s  .  1  .  .</span>
<a name="ln-1250"></a><span class="c">!!      &gt;  .  .  .  .  .   .  .  .  .  .  .  .  .  .  . -s -1];</span>
<a name="ln-1251"></a><span class="c">!!      &gt; b = [</span>
<a name="ln-1252"></a><span class="c">!!      &gt;  .  .  . 10  .   .  . 15  .  .  .  .  .  .  . 10  .]&#39;;</span>
<a name="ln-1253"></a><span class="c">!!</span>
<a name="ln-1254"></a><span class="c">!!      &gt; :test1:</span>
<a name="ln-1255"></a><span class="c">!!</span>
<a name="ln-1256"></a><span class="c">!!      &gt; // -----------------------------------------------------------------</span>
<a name="ln-1257"></a><span class="c">!!      &gt; // start a new log file</span>
<a name="ln-1258"></a><span class="c">!!      &gt; sh rm -fv log.txt</span>
<a name="ln-1259"></a><span class="c">!!      &gt; diary(&#39;log.txt&#39;)</span>
<a name="ln-1260"></a><span class="c">!!      &gt; // -----------------------------------------------------------------</span>
<a name="ln-1261"></a><span class="c">!!      &gt; titles=[&#39;GNP deflator&#39;</span>
<a name="ln-1262"></a><span class="c">!!      &gt;  &#39;GNP         &#39;</span>
<a name="ln-1263"></a><span class="c">!!      &gt;  &#39;Unemployment&#39;</span>
<a name="ln-1264"></a><span class="c">!!      &gt;  &#39;Armed Force &#39;</span>
<a name="ln-1265"></a><span class="c">!!      &gt;  &#39;Population  &#39;</span>
<a name="ln-1266"></a><span class="c">!!      &gt;  &#39;Year        &#39;</span>
<a name="ln-1267"></a><span class="c">!!      &gt;  &#39;Employment  &#39;];</span>
<a name="ln-1268"></a><span class="c">!!      &gt; data = ...</span>
<a name="ln-1269"></a><span class="c">!!      &gt; [ 83.0  234.289  235.6  159.0  107.608  1947  60.323</span>
<a name="ln-1270"></a><span class="c">!!      &gt;   88.5  259.426  232.5  145.6  108.632  1948  61.122</span>
<a name="ln-1271"></a><span class="c">!!      &gt;   88.2  258.054  368.2  161.6  109.773  1949  60.171</span>
<a name="ln-1272"></a><span class="c">!!      &gt;   89.5  284.599  335.1  165.0  110.929  1950  61.187</span>
<a name="ln-1273"></a><span class="c">!!      &gt;   96.2  328.975  209.9  309.9  112.075  1951  63.221</span>
<a name="ln-1274"></a><span class="c">!!      &gt;   98.1  346.999  193.2  359.4  113.270  1952  63.639</span>
<a name="ln-1275"></a><span class="c">!!      &gt;   99.0  365.385  187.0  354.7  115.094  1953  64.989</span>
<a name="ln-1276"></a><span class="c">!!      &gt;  100.0  363.112  357.8  335.0  116.219  1954  63.761</span>
<a name="ln-1277"></a><span class="c">!!      &gt;  101.2  397.469  290.4  304.8  117.388  1955  66.019</span>
<a name="ln-1278"></a><span class="c">!!      &gt;  104.6  419.180  282.2  285.7  118.734  1956  67.857</span>
<a name="ln-1279"></a><span class="c">!!      &gt;  108.4  442.769  293.6  279.8  120.445  1957  68.169</span>
<a name="ln-1280"></a><span class="c">!!      &gt;  110.8  444.546  468.1  263.7  121.950  1958  66.513</span>
<a name="ln-1281"></a><span class="c">!!      &gt;  112.6  482.704  381.3  255.2  123.366  1959  68.655</span>
<a name="ln-1282"></a><span class="c">!!      &gt;  114.2  502.601  393.1  251.4  125.368  1960  69.564</span>
<a name="ln-1283"></a><span class="c">!!      &gt;  115.7  518.173  480.6  257.2  127.852  1961  69.331</span>
<a name="ln-1284"></a><span class="c">!!      &gt;  116.9  554.894  400.7  282.7  130.081  1962  70.551];</span>
<a name="ln-1285"></a><span class="c">!!      &gt; short</span>
<a name="ln-1286"></a><span class="c">!!      &gt; X = data;</span>
<a name="ln-1287"></a><span class="c">!!      &gt; [n,p] = shape(X)</span>
<a name="ln-1288"></a><span class="c">!!      &gt; mu = ones(1,n)*X/n</span>
<a name="ln-1289"></a><span class="c">!!      &gt; X = X - ones(n,1)*mu;  X = X/diag(sqrt(diag(X&#39;*X)))</span>
<a name="ln-1290"></a><span class="c">!!      &gt; corr = X&#39;*X</span>
<a name="ln-1291"></a><span class="c">!!      &gt; y = data(:,p); X = [ones(y) data(:,1:p-1)];</span>
<a name="ln-1292"></a><span class="c">!!      &gt; long e</span>
<a name="ln-1293"></a><span class="c">!!      &gt; beta = X\y</span>
<a name="ln-1294"></a><span class="c">!!      &gt; expected = [ ...</span>
<a name="ln-1295"></a><span class="c">!!      &gt;    -3.482258634594421D+03</span>
<a name="ln-1296"></a><span class="c">!!      &gt;     1.506187227124484D-02</span>
<a name="ln-1297"></a><span class="c">!!      &gt;    -3.581917929257409D-02</span>
<a name="ln-1298"></a><span class="c">!!      &gt;    -2.020229803816908D-02</span>
<a name="ln-1299"></a><span class="c">!!      &gt;    -1.033226867173703D-02</span>
<a name="ln-1300"></a><span class="c">!!      &gt;    -5.110410565317738D-02</span>
<a name="ln-1301"></a><span class="c">!!      &gt;     1.829151464612817D+00</span>
<a name="ln-1302"></a><span class="c">!!      &gt; ]</span>
<a name="ln-1303"></a><span class="c">!!      &gt; display(&#39;EXPE and BETA should be the same&#39;)</span>
<a name="ln-1304"></a><span class="c">!!</span>
<a name="ln-1305"></a><span class="c">!!      &gt; :tryall:</span>
<a name="ln-1306"></a><span class="c">!!</span>
<a name="ln-1307"></a><span class="c">!!      &gt; diary(&#39;log.txt&#39;)</span>
<a name="ln-1308"></a><span class="c">!!      &gt; a=magic(8)</span>
<a name="ln-1309"></a><span class="c">!!      &gt; n=3</span>
<a name="ln-1310"></a><span class="c">!!      &gt; exec(&#39;avg&#39;)</span>
<a name="ln-1311"></a><span class="c">!!      &gt; b=random(8,8)</span>
<a name="ln-1312"></a><span class="c">!!      &gt; exec(&#39;cdiv&#39;)</span>
<a name="ln-1313"></a><span class="c">!!      &gt; exec(&#39;exp&#39;)</span>
<a name="ln-1314"></a><span class="c">!!      &gt; exec(&#39;four&#39;)</span>
<a name="ln-1315"></a><span class="c">!!      &gt; exec(&#39;gs&#39;)</span>
<a name="ln-1316"></a><span class="c">!!      &gt; exec(&#39;jacobi&#39;)</span>
<a name="ln-1317"></a><span class="c">!!      &gt; // jacstep</span>
<a name="ln-1318"></a><span class="c">!!      &gt; exec(&#39;kron&#39;)</span>
<a name="ln-1319"></a><span class="c">!!      &gt; exec(&#39;lanczos&#39;)</span>
<a name="ln-1320"></a><span class="c">!!      &gt; // lanstep</span>
<a name="ln-1321"></a><span class="c">!!      &gt; exec(&#39;longley&#39;)</span>
<a name="ln-1322"></a><span class="c">!!      &gt; exec(&#39;mgs&#39;)</span>
<a name="ln-1323"></a><span class="c">!!      &gt; exec(&#39;net&#39;)</span>
<a name="ln-1324"></a><span class="c">!!      &gt; exec(&#39;pascal&#39;)</span>
<a name="ln-1325"></a><span class="c">!!      &gt; exec(&#39;pdq&#39;)</span>
<a name="ln-1326"></a><span class="c">!!      &gt; // pdqstep</span>
<a name="ln-1327"></a><span class="c">!!      &gt; exec(&#39;pop&#39;)</span>
<a name="ln-1328"></a><span class="c">!!      &gt; exec(&#39;qr&#39;)</span>
<a name="ln-1329"></a><span class="c">!!      &gt; // qrstep</span>
<a name="ln-1330"></a><span class="c">!!      &gt; exec(&#39;rho&#39;)</span>
<a name="ln-1331"></a><span class="c">!!      &gt; exec(&#39;rosser&#39;)</span>
<a name="ln-1332"></a><span class="c">!!      &gt; // rot</span>
<a name="ln-1333"></a><span class="c">!!      &gt; exec(&#39;rqi&#39;)</span>
<a name="ln-1334"></a><span class="c">!!      &gt; exec(&#39;setup&#39;)</span>
<a name="ln-1335"></a><span class="c">!!      &gt; exec(&#39;sigma&#39;)</span>
<a name="ln-1336"></a><span class="c">!!      &gt; exec(&#39;strut.laf&#39;)</span>
<a name="ln-1337"></a><span class="c">!!      &gt; exec(&#39;w5&#39;)</span>
<a name="ln-1338"></a><span class="c">!!      &gt; exec(&#39;rogers.exec</span>
<a name="ln-1339"></a><span class="c">!!      &gt; exec(&#39;rogers.load</span>
<a name="ln-1340"></a><span class="c">!!</span>
<a name="ln-1341"></a><span class="c">!!      &gt; :w5:</span>
<a name="ln-1342"></a><span class="c">!!</span>
<a name="ln-1343"></a><span class="c">!!      &gt; w5 = [</span>
<a name="ln-1344"></a><span class="c">!!      &gt;         1.     1.      0.      0.      0.</span>
<a name="ln-1345"></a><span class="c">!!      &gt;       -10.     1.      1.      0.      0.</span>
<a name="ln-1346"></a><span class="c">!!      &gt;        40.     0.      1.      1.      0.</span>
<a name="ln-1347"></a><span class="c">!!      &gt;       205.     0.      0.      1.      1.</span>
<a name="ln-1348"></a><span class="c">!!      &gt;       024.     0.      0.      0.     -4.</span>
<a name="ln-1349"></a><span class="c">!!      &gt;      ]</span>
<a name="ln-1350"></a><span class="k">subroutine </span><span class="n">LALA_init</span><span class="p">(</span><span class="n">init</span><span class="p">,</span><span class="n">echo</span><span class="p">)</span>
<a name="ln-1351"></a>
<a name="ln-1352"></a><span class="c">! ident_1=&quot;@(#)M_matrix::lala(3f): initialize and/or pass commands to matrix laboratory interpreter&quot;</span>
<a name="ln-1353"></a>
<a name="ln-1354"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">init</span>
<a name="ln-1355"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">echo</span>
<a name="ln-1356"></a><span class="n">doubleprecision</span>             <span class="kd">::</span> <span class="n">s</span><span class="p">,</span><span class="n">t</span>
<a name="ln-1357"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>           <span class="kd">::</span> <span class="n">EPS</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span><span class="o">=</span>   <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">6</span><span class="p">:)]</span>
<a name="ln-1358"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>           <span class="kd">::</span> <span class="n">FLOPS</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span><span class="o">=</span> <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">6</span><span class="p">:)]</span>
<a name="ln-1359"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>           <span class="kd">::</span> <span class="n">EYE</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span><span class="o">=</span>   <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">6</span><span class="p">:)]</span>
<a name="ln-1360"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>           <span class="kd">::</span> <span class="nb">RAND</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span><span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">6</span><span class="p">:)]</span>
<a name="ln-1361"></a>
<a name="ln-1362"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">echo</span><span class="p">))</span> <span class="n">G_ECHO</span><span class="o">=</span><span class="n">echo</span>
<a name="ln-1363"></a>
<a name="ln-1364"></a>   <span class="n">G_PROMPT</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1365"></a>   <span class="n">G_ERR</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1366"></a>
<a name="ln-1367"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">)</span>
<a name="ln-1368"></a>   <span class="k">allocate</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-1369"></a>
<a name="ln-1370"></a>   <span class="n">G_LIN</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-1371"></a>   <span class="n">G_VAR_IDS</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-1372"></a>
<a name="ln-1373"></a>   <span class="n">GM_BIGMEM</span><span class="o">=</span><span class="n">INIT</span>
<a name="ln-1374"></a>   <span class="k">if</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="n">GM_BIGMEM</span><span class="o">=</span><span class="mi">200000</span>
<a name="ln-1375"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">)</span> <span class="p">)</span><span class="k">deallocate</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">)</span>
<a name="ln-1376"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">)</span> <span class="p">)</span><span class="k">deallocate</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">)</span>
<a name="ln-1377"></a>   <span class="k">allocate</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">))</span>                      <span class="c">! set to size of GM_BIGMEM</span>
<a name="ln-1378"></a>
<a name="ln-1379"></a>   <span class="n">G_INPUT_LUN</span> <span class="o">=</span> <span class="n">STDIN</span>                                                    <span class="c">! unit number for terminal input</span>
<a name="ln-1380"></a>   <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="n">G_INPUT_LUN</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-1381"></a>   <span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_INPUT_LUN</span>                                                    <span class="c">! current file to read commands from</span>
<a name="ln-1382"></a>   <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="n">STDOUT</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-1383"></a>
<a name="ln-1384"></a>   <span class="k">call </span><span class="n">mat_help_text</span><span class="p">()</span>                                                   <span class="c">! initialize help text</span>
<a name="ln-1385"></a>   <span class="n">G_CURRENT_RANDOM_SEED</span> <span class="o">=</span> <span class="mi">0</span>                                              <span class="c">! random number seed</span>
<a name="ln-1386"></a>   <span class="n">G_CURRENT_RANDOM_TYPE</span> <span class="o">=</span> <span class="mi">0</span>                                              <span class="c">! set the type of random numbers to compute</span>
<a name="ln-1387"></a>   <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">23</span>                                                    <span class="c">! initial line limit for paging output</span>
<a name="ln-1388"></a>
<a name="ln-1389"></a>   <span class="n">G_TOP_OF_SAVED</span> <span class="o">=</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">3</span>  <span class="c">! move up to allow room for the built-in values eps, flops, eye, rand</span>
<a name="ln-1390"></a>
<a name="ln-1391"></a>   <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1392"></a>
<a name="ln-1393"></a>   <span class="k">call </span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;eps&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1394"></a>      <span class="c">!=============================================================</span>
<a name="ln-1395"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span><span class="n">EPS</span><span class="p">)</span>
<a name="ln-1396"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-1397"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1398"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1399"></a>      <span class="c">!=============================================================</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a>   <span class="c">! interesting way to calculate the epsilon value of a machine</span>
<a name="ln-1402"></a>   <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1403"></a>   <span class="n">SET_ST</span><span class="p">:</span> <span class="k">do</span>
<a name="ln-1404"></a><span class="k">      </span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="mf">2.0D0</span>
<a name="ln-1405"></a>      <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">s</span>
<a name="ln-1406"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1407"></a><span class="k">   enddo </span><span class="n">SET_ST</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a>   <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">s</span>
<a name="ln-1410"></a>
<a name="ln-1411"></a>   <span class="k">call </span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;flops&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1412"></a>      <span class="c">!=============================================================</span>
<a name="ln-1413"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="n">flops</span><span class="p">)</span>
<a name="ln-1414"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">3</span>
<a name="ln-1415"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1416"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1417"></a>      <span class="c">!=============================================================</span>
<a name="ln-1418"></a>
<a name="ln-1419"></a>   <span class="k">call </span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;eye&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1420"></a>      <span class="c">!=============================================================</span>
<a name="ln-1421"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">eye</span><span class="p">)</span>
<a name="ln-1422"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1423"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1424"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1425"></a>      <span class="c">!=============================================================</span>
<a name="ln-1426"></a>
<a name="ln-1427"></a>   <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-1428"></a>
<a name="ln-1429"></a>   <span class="k">call </span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;rand&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_BIGMEM</span><span class="p">)</span>
<a name="ln-1430"></a>      <span class="c">!=============================================================</span>
<a name="ln-1431"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">),</span> <span class="nb">rand</span><span class="p">)</span>
<a name="ln-1432"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_BIGMEM</span>
<a name="ln-1433"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1434"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1435"></a>      <span class="c">!=============================================================</span>
<a name="ln-1436"></a>
<a name="ln-1437"></a>   <span class="n">G_FMT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1438"></a>   <span class="n">G_FLOP_COUNTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1439"></a>   <span class="n">G_FLOP_COUNTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1440"></a>   <span class="n">G_DEBUG_LEVEL</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1441"></a>   <span class="n">G_PTZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1442"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PTZ</span>
<a name="ln-1443"></a>
<a name="ln-1444"></a>   <span class="n">G_FORTRAN_TEXT</span><span class="o">=</span><span class="n">help_intrinsics</span><span class="p">(</span><span class="s1">&#39;manual&#39;</span><span class="p">,</span><span class="n">m_help</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>  <span class="c">! load Fortran documentation</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a><span class="k">end subroutine </span><span class="n">LALA_init</span>
<a name="ln-1447"></a><span class="c">!==================================================================================================================================</span>
<a name="ln-1448"></a><span class="k">subroutine </span><span class="n">LALA_cmd</span><span class="p">(</span><span class="n">input_string</span><span class="p">,</span><span class="n">echo</span><span class="p">)</span>
<a name="ln-1449"></a>
<a name="ln-1450"></a><span class="c">! ident_2=&quot;@(#)M_matrix::lala(3f): run a single command in matrix laboratory interpreter and return to calling program&quot;</span>
<a name="ln-1451"></a>
<a name="ln-1452"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">input_string</span>
<a name="ln-1453"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">echo</span>
<a name="ln-1454"></a>
<a name="ln-1455"></a>   <span class="k">call </span><span class="n">lala_cmds</span><span class="p">(</span> <span class="p">[</span><span class="n">input_string</span><span class="p">],</span><span class="n">echo</span><span class="o">=</span><span class="n">echo</span><span class="p">)</span>
<a name="ln-1456"></a>
<a name="ln-1457"></a><span class="k">end subroutine </span><span class="n">LALA_cmd</span>
<a name="ln-1458"></a><span class="c">!==================================================================================================================================</span>
<a name="ln-1459"></a><span class="k">subroutine </span><span class="n">LALA_cmds</span><span class="p">(</span><span class="n">pseudo_file</span><span class="p">,</span><span class="n">echo</span><span class="p">)</span>
<a name="ln-1460"></a>
<a name="ln-1461"></a><span class="c">! ident_3=&quot;@(#)M_matrix::lala(3f): run an array of commands in matrix laboratory interpreter and return to calling program&quot;</span>
<a name="ln-1462"></a>
<a name="ln-1463"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">pseudo_file</span><span class="p">(:)</span>
<a name="ln-1464"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>          <span class="kd">::</span> <span class="n">echo</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">echo</span><span class="p">))</span> <span class="n">G_ECHO</span><span class="o">=</span><span class="n">echo</span>
<a name="ln-1467"></a>
<a name="ln-1468"></a>   <span class="k">if</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1469"></a><span class="k">      call </span><span class="n">lala_init</span><span class="p">(</span><span class="mi">200000</span><span class="p">)</span>
<a name="ln-1470"></a>   <span class="k">else</span>
<a name="ln-1471"></a><span class="k">      </span><span class="n">G_INPUT_LUN</span> <span class="o">=</span> <span class="n">STDIN</span>                                                    <span class="c">! unit number for terminal input</span>
<a name="ln-1472"></a>      <span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_INPUT_LUN</span>                                                    <span class="c">! current file to read commands from</span>
<a name="ln-1473"></a>      <span class="n">G_PROMPT</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1474"></a>   <span class="k">endif</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a><span class="k">   if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pseudo_file</span><span class="p">))</span><span class="k">then</span>
<a name="ln-1477"></a><span class="k">      </span><span class="n">G_PSEUDO_FILE</span><span class="o">=</span><span class="p">[</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pseudo_file</span><span class="p">,</span><span class="s1">&#39;quit;&#39;</span><span class="p">]</span>
<a name="ln-1478"></a>      <span class="n">G_PROMPT</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1479"></a>   <span class="k">else</span>
<a name="ln-1480"></a><span class="k">      if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">)</span>
<a name="ln-1481"></a>      <span class="k">allocate</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-1482"></a>   <span class="k">endif</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a><span class="k">   </span><span class="n">PARSE_LINE</span> <span class="p">:</span> <span class="k">do</span>
<a name="ln-1485"></a><span class="k">      call </span><span class="n">mat_parse</span><span class="p">()</span>
<a name="ln-1486"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">G_FUN</span><span class="p">)</span>
<a name="ln-1487"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="k">call </span><span class="n">mat_matfn1</span><span class="p">()</span>
<a name="ln-1488"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="k">call </span><span class="n">mat_matfn2</span><span class="p">()</span>
<a name="ln-1489"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">;</span> <span class="k">call </span><span class="n">mat_matfn3</span><span class="p">()</span>
<a name="ln-1490"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">;</span> <span class="k">call </span><span class="n">mat_matfn4</span><span class="p">()</span>
<a name="ln-1491"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">;</span> <span class="k">call </span><span class="n">mat_matfn5</span><span class="p">()</span>
<a name="ln-1492"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span> <span class="k">call </span><span class="n">mat_matfn6</span><span class="p">()</span>
<a name="ln-1493"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">21</span><span class="p">);</span> <span class="k">call </span><span class="n">mat_matfn1</span><span class="p">()</span>
<a name="ln-1494"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span> <span class="k">exit </span><span class="n">PARSE_LINE</span>
<a name="ln-1495"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-1496"></a>      <span class="k">end select</span>
<a name="ln-1497"></a><span class="k">   enddo </span><span class="n">PARSE_LINE</span>
<a name="ln-1498"></a>
<a name="ln-1499"></a><span class="k">end subroutine </span><span class="n">LALA_cmds</span>
<a name="ln-1500"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1501"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1502"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1503"></a><span class="k">subroutine </span><span class="n">mat_err</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1504"></a>
<a name="ln-1505"></a><span class="c">! ident_4=&quot;@(#)M_matrix::mat_err(3fp): given error number, write associated error message and set G_ERR&quot;</span>
<a name="ln-1506"></a>
<a name="ln-1507"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">n</span>
<a name="ln-1508"></a>
<a name="ln-1509"></a><span class="kt">integer</span>              <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1510"></a><span class="kt">integer</span>              <span class="kd">::</span> <span class="n">k</span>
<a name="ln-1511"></a><span class="kt">integer</span>              <span class="kd">::</span> <span class="n">lb</span>
<a name="ln-1512"></a><span class="kt">integer</span>              <span class="kd">::</span> <span class="n">lt</span>
<a name="ln-1513"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-1514"></a>
<a name="ln-1515"></a>   <span class="n">G_ERR</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-1516"></a>   <span class="k">select case</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1517"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper multiple assignment&#39;</span>
<a name="ln-1518"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper factor&#39;</span>
<a name="ln-1519"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Expected right parenthesis&#39;</span>
<a name="ln-1520"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Undefined variable: &#39;</span><span class="o">//</span><span class="n">ade2str</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(:,</span><span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="c">! extract variable name into buffer</span>
<a name="ln-1521"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Column lengths do not match&#39;</span>
<a name="ln-1522"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Row lengths do not match&#39;</span>
<a name="ln-1523"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Text too long&#39;</span>
<a name="ln-1524"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Incompatible for ADDITION&#39;</span>
<a name="ln-1525"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>  <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Incompatible for SUBTRACTION&#39;</span>
<a name="ln-1526"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Incompatible for MULTIPLICATION&#39;</span>
<a name="ln-1527"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Incompatible for RIGHT DIVISION&#39;</span>
<a name="ln-1528"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Incompatible for LEFT DIVISION&#39;</span>
<a name="ln-1529"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">13</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper assignment to PERMANENT VARIABLE&#39;</span>
<a name="ln-1530"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;EYE-dentity undefined by CONTEXT&#39;</span>
<a name="ln-1531"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper assignment to submatrix&#39;</span>
<a name="ln-1532"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper command&#39;</span>
<a name="ln-1533"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-1534"></a>      <span class="n">lb</span> <span class="o">=</span> <span class="n">GM_BIGMEM</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1535"></a>      <span class="n">lt</span> <span class="o">=</span> <span class="n">g_err</span> <span class="o">+</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span>
<a name="ln-1536"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; Too much memory required&#39;</span><span class="p">)</span>
<a name="ln-1537"></a>      <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(1X,I7,&#39;&#39; Variables,&#39;&#39;,I7,&#39;&#39; Temporaries,&#39;&#39;,I7,&#39;&#39; Available.&#39;&#39;)&#39;</span><span class="p">)</span> <span class="n">lb</span><span class="p">,</span><span class="n">lt</span><span class="p">,</span><span class="n">GM_BIGMEM</span>
<a name="ln-1538"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">18</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Too many names&#39;</span>
<a name="ln-1539"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">19</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Matrix is singular to working precision&#39;</span>
<a name="ln-1540"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Matrix must be square&#39;</span>
<a name="ln-1541"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">21</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Subscript out of range&#39;</span>
<a name="ln-1542"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">22</span><span class="p">);</span> <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s1">&#39;(1x,&quot;Recursion difficulties&quot;,*(i4))&#39;</span><span class="p">)</span> <span class="p">(</span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-1543"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">23</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Only 1, 2 or INF norm of matrix&#39;</span>
<a name="ln-1544"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">24</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;No convergence&#39;</span>
<a name="ln-1545"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">25</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Can not use function name as variable&#39;</span>
<a name="ln-1546"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">26</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Too complicated (STACK OVERFLOW)&#39;</span>
<a name="ln-1547"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">27</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Division by zero is a NO-NO&#39;</span>
<a name="ln-1548"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">28</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Empty macro&#39;</span>
<a name="ln-1549"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">29</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Not positive definite&#39;</span>
<a name="ln-1550"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">30</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper exponent&#39;</span>
<a name="ln-1551"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">31</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper string&#39;</span>
<a name="ln-1552"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Singularity of LOG or ATAN&#39;</span>
<a name="ln-1553"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">33</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Too many colons&#39;</span>
<a name="ln-1554"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">34</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper FOR clause&#39;</span>
<a name="ln-1555"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">35</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper WHILE or IF clause&#39;</span>
<a name="ln-1556"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">36</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Argument out of range&#39;</span>
<a name="ln-1557"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">37</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper MACROS&#39;</span>
<a name="ln-1558"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">38</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Improper file name&#39;</span>
<a name="ln-1559"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">39</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Incorrect number of arguments&#39;</span>
<a name="ln-1560"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Expecting statement terminator&#39;</span>
<a name="ln-1561"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-1562"></a>       <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;*mat_err* internal error: unknown error code=&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1563"></a>       <span class="k">return</span>
<a name="ln-1564"></a><span class="k">   end select</span>
<a name="ln-1565"></a>
<a name="ln-1566"></a><span class="k">   </span><span class="n">k</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c">! number of spaces to shift arrow by</span>
<a name="ln-1567"></a>   <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/\--ERROR:&#39;</span><span class="o">//</span><span class="n">msg</span><span class="p">)</span>
<a name="ln-1568"></a>
<a name="ln-1569"></a><span class="k">end subroutine </span><span class="n">mat_err</span>
<a name="ln-1570"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1571"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1572"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1573"></a><span class="k">subroutine </span><span class="n">mat_files</span><span class="p">(</span><span class="n">lunit</span><span class="p">,</span><span class="n">iname</span><span class="p">,</span><span class="n">status</span><span class="p">)</span>
<a name="ln-1574"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">lunit</span>             <span class="c">! logical unit number</span>
<a name="ln-1575"></a>                                                  <span class="c">! if LUNIT is zero, return</span>
<a name="ln-1576"></a>                                                  <span class="c">! if LUNIT = standard input, return</span>
<a name="ln-1577"></a>                                                  <span class="c">! if LUNIT = standard output, return</span>
<a name="ln-1578"></a>                                                  <span class="c">! if LUNIT is positive, open the unit to file name INAME</span>
<a name="ln-1579"></a>                                                  <span class="c">! if LUNIT is negative, close the unit number</span>
<a name="ln-1580"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">iname</span><span class="p">(</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="c">! INAME = FILE NAME, 1 character per word</span>
<a name="ln-1581"></a>                                                  <span class="c">! how to know length of iname?</span>
<a name="ln-1582"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1583"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">status</span>
<a name="ln-1584"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">status_local</span>
<a name="ln-1585"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-1586"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">status</span><span class="p">))</span><span class="k">then</span>
<a name="ln-1587"></a><span class="k">      </span><span class="n">status_local</span><span class="o">=</span><span class="n">status</span>
<a name="ln-1588"></a>   <span class="k">else</span>
<a name="ln-1589"></a><span class="k">      </span><span class="n">status_local</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span>
<a name="ln-1590"></a>   <span class="k">endif</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a><span class="k">   </span><span class="n">G_FILE_OPEN_ERROR</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1593"></a>   <span class="k">select case</span><span class="p">(</span><span class="n">lunit</span><span class="p">)</span>
<a name="ln-1594"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="c">! error catcher</span>
<a name="ln-1595"></a>    <span class="k">case</span><span class="p">(</span><span class="n">stdin</span><span class="p">)</span>  <span class="c">! if unit is standard input return</span>
<a name="ln-1596"></a>    <span class="k">case</span><span class="p">(</span><span class="n">stdout</span><span class="p">)</span> <span class="c">! if unit is standard output return</span>
<a name="ln-1597"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>      <span class="c">! diary file</span>
<a name="ln-1598"></a>       <span class="k">call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">iname</span><span class="p">,</span><span class="n">GG_LINELEN</span><span class="p">)</span>
<a name="ln-1599"></a>       <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="c">! open up trail file</span>
<a name="ln-1600"></a>    <span class="k">case</span><span class="p">(:</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1601"></a>      <span class="k">if</span><span class="p">(</span><span class="n">lunit</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1602"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>                                        <span class="c">! close trail file</span>
<a name="ln-1603"></a>      <span class="k">else</span>                                                           <span class="c">! if LUNIT is negative, close the unit</span>
<a name="ln-1604"></a>         <span class="n">ios</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1605"></a>         <span class="nb">flush</span><span class="p">(</span><span class="n">unit</span><span class="o">=-</span><span class="n">lunit</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span>
<a name="ln-1606"></a>         <span class="k">if</span><span class="p">(</span><span class="o">-</span><span class="n">lunit</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">STDIN</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1607"></a><span class="k">            close</span><span class="p">(</span><span class="n">unit</span><span class="o">=-</span><span class="n">lunit</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span>
<a name="ln-1608"></a>         <span class="k">endif</span>
<a name="ln-1609"></a><span class="k">      endif</span>
<a name="ln-1610"></a><span class="k">    case </span><span class="n">default</span>                                                     <span class="c">!  ALL OTHER FILES</span>
<a name="ln-1611"></a>      <span class="k">call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">iname</span><span class="p">,</span><span class="n">GG_LINELEN</span><span class="p">)</span>
<a name="ln-1612"></a>      <span class="k">if</span><span class="p">(</span><span class="n">lunit</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">STDIN</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1613"></a><span class="k">         open</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">lunit</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="n">status_local</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span>      <span class="c">! open a file</span>
<a name="ln-1614"></a>         <span class="k">if</span><span class="p">(</span><span class="n">ios</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>                                               <span class="c">! general file open failure</span>
<a name="ln-1615"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;OPEN failed on file &#39;</span><span class="o">//</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1616"></a>            <span class="n">G_FILE_OPEN_ERROR</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>                                    <span class="c">! set the flag a file error occurred</span>
<a name="ln-1617"></a>            <span class="n">G_RIO</span><span class="o">=</span><span class="n">G_INPUT_LUN</span>                                           <span class="c">! set current file to read input lines from/to G_INPUT_LUN</span>
<a name="ln-1618"></a>         <span class="k">else</span>
<a name="ln-1619"></a><span class="k">            </span><span class="n">G_FILE_OPEN_ERROR</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>                                   <span class="c">! set the flag a file error did not occur</span>
<a name="ln-1620"></a>         <span class="k">endif</span>
<a name="ln-1621"></a><span class="k">      endif</span>
<a name="ln-1622"></a><span class="k">   end select</span>
<a name="ln-1623"></a><span class="k">end subroutine </span><span class="n">mat_files</span>
<a name="ln-1624"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1625"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1626"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1627"></a><span class="k">subroutine </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-1628"></a>
<a name="ln-1629"></a><span class="c">! ident_5=&quot;@(#)M_matrix::mat_getsym(3fp): get a symbol&quot;</span>
<a name="ln-1630"></a>
<a name="ln-1631"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">syv</span>
<a name="ln-1632"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">s</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="nb">sign</span>
<a name="ln-1635"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="n">chcnt</span>
<a name="ln-1636"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="n">ss</span>
<a name="ln-1637"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1638"></a><span class="c">!.......................................................................</span>
<a name="ln-1639"></a>   <span class="n">INFINITE</span> <span class="p">:</span> <span class="k">do</span>
<a name="ln-1640"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">blank</span><span class="p">)</span> <span class="k">exit </span><span class="n">INFINITE</span>
<a name="ln-1641"></a>      <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character</span>
<a name="ln-1642"></a>   <span class="k">enddo </span><span class="n">INFINITE</span>
<a name="ln-1643"></a><span class="c">!.......................................................................</span>
<a name="ln-1644"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1645"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1646"></a>   <span class="k">if</span> <span class="p">(</span> <span class="nb">verify</span><span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">),</span><span class="n">digit</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1647"></a><span class="k">      call </span><span class="n">mat_getval</span><span class="p">(</span><span class="n">syv</span><span class="p">)</span>
<a name="ln-1648"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">dot</span><span class="p">)</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-1649"></a>      <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character</span>
<a name="ln-1650"></a>   <span class="n">elseif</span> <span class="p">(</span><span class="nb">verify</span><span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">),</span><span class="n">digit</span><span class="o">//</span><span class="n">big</span><span class="o">//</span><span class="n">little</span><span class="o">//</span><span class="nb">achar</span><span class="p">(</span><span class="n">score</span><span class="p">))</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span> <span class="c">! alphameric (0-9a-zA-Z_)</span>
<a name="ln-1651"></a>      <span class="c">! name</span>
<a name="ln-1652"></a>      <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">isname</span>
<a name="ln-1653"></a>      <span class="n">G_SYN</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-1654"></a>      <span class="n">G_SYN</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_CHRA</span>
<a name="ln-1655"></a>      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">GG_MAX_NAME_LENGTH</span>
<a name="ln-1656"></a>         <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character</span>
<a name="ln-1657"></a>         <span class="c">! if not alphanumeric and not special like eol</span>
<a name="ln-1658"></a>         <span class="k">if</span> <span class="p">(</span><span class="nb">verify</span><span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">),</span><span class="n">digit</span><span class="o">//</span><span class="n">big</span><span class="o">//</span><span class="n">little</span><span class="o">//</span><span class="nb">achar</span><span class="p">(</span><span class="n">score</span><span class="p">))</span><span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1659"></a><span class="k">            </span><span class="n">G_SYN</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_CHRA</span>
<a name="ln-1660"></a>         <span class="k">else</span>
<a name="ln-1661"></a><span class="k">            exit</span>
<a name="ln-1662"></a><span class="k">         endif</span>
<a name="ln-1663"></a><span class="k">      enddo</span>
<a name="ln-1664"></a>
<a name="ln-1665"></a><span class="k">      goto </span><span class="mi">90</span>
<a name="ln-1666"></a>   <span class="k">else</span> <span class="c">! special character</span>
<a name="ln-1667"></a>      <span class="n">ss</span> <span class="o">=</span> <span class="n">G_SYM</span>
<a name="ln-1668"></a>      <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">G_CHRA</span>
<a name="ln-1669"></a>      <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character</span>
<a name="ln-1670"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">dot</span><span class="p">)</span> <span class="k">goto </span><span class="mi">90</span>
<a name="ln-1671"></a>      <span class="c">! is dot part of number or operator</span>
<a name="ln-1672"></a>      <span class="n">syv</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1673"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="nb">verify</span><span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">),</span><span class="n">digit</span><span class="p">)</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span> <span class="c">! not a number character</span>
<a name="ln-1674"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">star</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">slash</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">bslash</span><span class="p">)</span> <span class="k">goto </span><span class="mi">90</span>
<a name="ln-1675"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">star</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ss</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">slash</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ss</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">bslash</span><span class="p">)</span> <span class="k">goto </span><span class="mi">90</span>
<a name="ln-1676"></a>      <span class="k">endif</span>
<a name="ln-1677"></a><span class="k">   endif</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>   <span class="c">! number</span>
<a name="ln-1680"></a>   <span class="n">chcnt</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1681"></a>   <span class="k">call </span><span class="n">mat_getval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="ln-1682"></a>   <span class="n">chcnt</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">chcnt</span>
<a name="ln-1683"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="n">chcnt</span> <span class="o">=</span> <span class="n">chcnt</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1684"></a>   <span class="n">syv</span> <span class="o">=</span> <span class="n">syv</span> <span class="o">+</span> <span class="n">s</span><span class="o">/</span><span class="mi">1</span><span class="mf">0.0d0</span><span class="o">**</span><span class="n">chcnt</span>
<a name="ln-1685"></a>   <span class="k">goto </span><span class="mi">60</span>
<a name="ln-1686"></a>
<a name="ln-1687"></a><span class="mi">60</span> <span class="k">continue</span>
<a name="ln-1688"></a>
<a name="ln-1689"></a><span class="k">   if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">d_low</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">e_low</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">d_up</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">e_up</span><span class="p">)</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-1690"></a><span class="k">      call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character</span>
<a name="ln-1691"></a>      <span class="nb">sign</span> <span class="o">=</span> <span class="n">G_CHRA</span>
<a name="ln-1692"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">sign</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">minus</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">sign</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">plus</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character</span>
<a name="ln-1693"></a>      <span class="k">call </span><span class="n">mat_getval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="ln-1694"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">sign</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">minus</span><span class="p">)</span> <span class="n">syv</span> <span class="o">=</span> <span class="n">syv</span><span class="o">*</span><span class="mi">1</span><span class="mf">0.0d0</span><span class="o">**</span><span class="n">s</span>
<a name="ln-1695"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">sign</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minus</span><span class="p">)</span> <span class="n">syv</span> <span class="o">=</span> <span class="n">syv</span><span class="o">/</span><span class="mi">1</span><span class="mf">0.0d0</span><span class="o">**</span><span class="n">s</span>
<a name="ln-1696"></a>   <span class="k">endif</span>
<a name="ln-1697"></a><span class="k">   </span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">syv</span><span class="p">)</span>
<a name="ln-1698"></a>   <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">isnum</span>
<a name="ln-1699"></a>   <span class="k">goto </span><span class="mi">90</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a><span class="mi">90</span> <span class="k">continue</span>
<a name="ln-1702"></a>
<a name="ln-1703"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">blank</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1704"></a><span class="k">      call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character till a non-blank is found</span>
<a name="ln-1705"></a>      <span class="k">goto </span><span class="mi">90</span>
<a name="ln-1706"></a>   <span class="k">endif</span>
<a name="ln-1707"></a>
<a name="ln-1708"></a><span class="k">end subroutine </span><span class="n">mat_getsym</span>
<a name="ln-1709"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1710"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1711"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1712"></a><span class="k">subroutine </span><span class="n">mat_str2buf</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">buf</span><span class="p">,</span><span class="n">lrecl</span><span class="p">)</span>
<a name="ln-1713"></a>
<a name="ln-1714"></a><span class="c">! ident_6=&quot;@(#)M_matrix::mat_str2buf(3fp): convert string to hollerith&quot;</span>
<a name="ln-1715"></a>
<a name="ln-1716"></a><span class="c">! g95 compiler does not support Hollerith, this is a KLUDGE to give time to think about it</span>
<a name="ln-1717"></a>
<a name="ln-1718"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-1719"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">lrecl</span>
<a name="ln-1720"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">buf</span><span class="p">(:)</span>
<a name="ln-1721"></a><span class="kt">integer</span>                     <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1722"></a>
<a name="ln-1723"></a>   <span class="n">buf</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1724"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">lrecl</span><span class="p">,</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-1725"></a>      <span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1726"></a>   <span class="k">enddo</span>
<a name="ln-1727"></a>
<a name="ln-1728"></a><span class="k">end subroutine </span><span class="n">mat_str2buf</span>
<a name="ln-1729"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1730"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1731"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1732"></a><span class="k">function </span><span class="n">str2ade</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<a name="ln-1733"></a>
<a name="ln-1734"></a><span class="c">! ident_7=&quot;@(#)M_matrix::mat_str2buf(3fp): convert CHARACTER TO ADE array vector&quot;</span>
<a name="ln-1735"></a>
<a name="ln-1736"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">string</span>
<a name="ln-1737"></a><span class="kt">integer</span><span class="p">,</span><span class="k">allocatable</span>          <span class="kd">::</span> <span class="n">vec</span><span class="p">(:)</span>
<a name="ln-1738"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1739"></a>   <span class="k">allocate</span><span class="p">(</span><span class="n">vec</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)))</span>
<a name="ln-1740"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-1741"></a>      <span class="n">vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1742"></a>   <span class="k">enddo</span>
<a name="ln-1743"></a><span class="k">end function </span><span class="n">str2ade</span>
<a name="ln-1744"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1745"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1746"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1747"></a><span class="k">function </span><span class="n">ade2str</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-1748"></a>
<a name="ln-1749"></a><span class="c">! ident_8=&quot;@(#)M_matrix::mat_str2buf(3fp): convert ADE array to CHARACTER&quot;</span>
<a name="ln-1750"></a>
<a name="ln-1751"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-1752"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">buf</span><span class="p">(:)</span>
<a name="ln-1753"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1754"></a>   <span class="n">string</span><span class="o">=</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-1755"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
<a name="ln-1756"></a>      <span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">255</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1757"></a><span class="k">         </span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1758"></a>      <span class="k">else</span>
<a name="ln-1759"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;ADE2STR:string contains unacceptable characters, position=&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;ADE=&#39;</span><span class="p">,</span><span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1760"></a>      <span class="k">endif</span>
<a name="ln-1761"></a><span class="k">   enddo</span>
<a name="ln-1762"></a><span class="k">end function </span><span class="n">ade2str</span>
<a name="ln-1763"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1764"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1765"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1766"></a><span class="k">subroutine </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">buf</span><span class="p">,</span><span class="n">lrecl</span><span class="p">)</span>
<a name="ln-1767"></a>
<a name="ln-1768"></a><span class="c">! ident_9=&quot;@(#)M_matrix::mat_buf2string(3fp): convert hollerith to string&quot;</span>
<a name="ln-1769"></a>
<a name="ln-1770"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">lrecl</span>
<a name="ln-1771"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">buf</span><span class="p">(:)</span>
<a name="ln-1772"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">string</span>
<a name="ln-1773"></a><span class="kt">integer</span>                <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1774"></a><span class="kt">integer</span>                <span class="kd">::</span> <span class="n">ilen</span>
<a name="ln-1775"></a>   <span class="n">string</span><span class="p">(:)</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1776"></a>   <span class="n">ilen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-1777"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">lrecl</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-1778"></a>      <span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1779"></a>   <span class="k">enddo</span>
<a name="ln-1780"></a><span class="k">end subroutine </span><span class="n">mat_buf2str</span>
<a name="ln-1781"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1782"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1783"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1784"></a><span class="k">subroutine </span><span class="n">ints2str</span><span class="p">(</span><span class="n">ints</span><span class="p">,</span><span class="n">string</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-1785"></a>
<a name="ln-1786"></a><span class="c">! ident_10=&quot;@(#)M_matrix::ints2str(3f): convert lala integers to a character variable&quot;</span>
<a name="ln-1787"></a>
<a name="ln-1788"></a><span class="c">! temporary procedure while writing ASCII-based upgrade</span>
<a name="ln-1789"></a>
<a name="ln-1790"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ints</span><span class="p">(:)</span>
<a name="ln-1791"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-1792"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-1793"></a><span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1794"></a>
<a name="ln-1795"></a>   <span class="n">ierr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1796"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">string</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-1797"></a>   <span class="k">allocate</span><span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">size</span><span class="p">(</span><span class="n">ints</span><span class="p">))</span> <span class="kd">::</span> <span class="n">string</span><span class="p">)</span>
<a name="ln-1798"></a>   <span class="n">string</span><span class="p">(:)</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1799"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">ints</span><span class="p">)</span>
<a name="ln-1800"></a>      <span class="k">if</span><span class="p">(</span> <span class="n">ints</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="n">G_CHARSET_SIZE</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ints</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-1801"></a><span class="k">         </span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="n">ints</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1802"></a>      <span class="k">else</span>
<a name="ln-1803"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39; function name contains unacceptable characters:&#39;</span><span class="p">,</span><span class="n">ints</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-1804"></a>         <span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1805"></a>      <span class="k">endif</span>
<a name="ln-1806"></a><span class="k">   enddo</span>
<a name="ln-1807"></a>
<a name="ln-1808"></a><span class="k">end subroutine </span><span class="n">ints2str</span>
<a name="ln-1809"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1810"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1811"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1812"></a><span class="k">subroutine </span><span class="n">mat_matfn6</span><span class="p">()</span>
<a name="ln-1813"></a><span class="c">!</span>
<a name="ln-1814"></a><span class="c">! ident_11=&quot;@(#)M_matrix::mat_matfn6(3f):evaluate utility functions&quot;</span>
<a name="ln-1815"></a><span class="c">!</span>
<a name="ln-1816"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-1817"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-1818"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ib</span>
<a name="ln-1819"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ja</span>
<a name="ln-1820"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">jb</span>
<a name="ln-1821"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">location</span>
<a name="ln-1822"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">la</span>
<a name="ln-1823"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">lb</span>
<a name="ln-1824"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ld</span>
<a name="ln-1825"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">lj</span>
<a name="ln-1826"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-1827"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-1828"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">m</span>
<a name="ln-1829"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ma</span>
<a name="ln-1830"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">mn</span>
<a name="ln-1831"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-1832"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span>
<a name="ln-1833"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">nn</span>
<a name="ln-1834"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">unifor</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-1835"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">normal</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-1836"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">seed</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>   <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-1837"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-1838"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">eps0</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">t</span>
<a name="ln-1839"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span> <span class="kd">::</span> <span class="n">message</span>
<a name="ln-1840"></a>
<a name="ln-1841"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1842"></a>   <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1843"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a><span class="c">!  functions/G_FIN</span>
<a name="ln-1846"></a><span class="c">!  magi diag sum  prod user eye  rand ones chop shape kron  tril triu zeros</span>
<a name="ln-1847"></a><span class="c">!    1    2    3    4    5    6    7    8    9   10   11-13  14   15   16</span>
<a name="ln-1848"></a>
<a name="ln-1849"></a>   <span class="n">FUN6</span><span class="p">:</span> <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-1850"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1851"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! COMMAND::MAGIC</span>
<a name="ln-1852"></a>      <span class="n">N</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-1853"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">N</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1854"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">N</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_magic</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-1855"></a>      <span class="k">call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1856"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-1857"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-1858"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1859"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="c">!  COMMAND::KRONECKER PRODUCT</span>
<a name="ln-1860"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1861"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span> <span class="c">! Incorrect number of arguments</span>
<a name="ln-1862"></a>         <span class="k">return</span>
<a name="ln-1863"></a><span class="k">      endif</span>
<a name="ln-1864"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1865"></a>      <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1866"></a>      <span class="n">MA</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1867"></a>      <span class="n">NA</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1868"></a>      <span class="n">LA</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">MA</span><span class="o">*</span><span class="n">NA</span><span class="p">,</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">MA</span><span class="o">*</span><span class="n">NA</span><span class="p">)</span>
<a name="ln-1869"></a>      <span class="n">LB</span> <span class="o">=</span> <span class="n">LA</span> <span class="o">+</span> <span class="n">MA</span><span class="o">*</span><span class="n">NA</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span><span class="n">LB</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">))</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-1872"></a>
<a name="ln-1873"></a><span class="c">!     MOVE A AND B ABOVE RESULT</span>
<a name="ln-1874"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">MA</span><span class="o">*</span><span class="n">NA</span><span class="o">+</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LA</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LA</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1875"></a>      <span class="k">DO </span><span class="n">JA</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NA</span>
<a name="ln-1876"></a>        <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-1877"></a>          <span class="n">LJ</span> <span class="o">=</span> <span class="n">LB</span> <span class="o">+</span> <span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">M</span>
<a name="ln-1878"></a>          <span class="k">DO </span><span class="n">IA</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MA</span>
<a name="ln-1879"></a><span class="c">!           GET J-TH COLUMN OF B</span>
<a name="ln-1880"></a>            <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LJ</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LJ</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1881"></a><span class="c">!           ADDRESS OF A(IA,JA)</span>
<a name="ln-1882"></a>            <span class="n">LS</span> <span class="o">=</span> <span class="n">LA</span> <span class="o">+</span> <span class="n">IA</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">JA</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">MA</span>
<a name="ln-1883"></a>            <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">M</span>
<a name="ln-1884"></a><span class="c">!             A(IA,JA) OP B(I,J)</span>
<a name="ln-1885"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">11</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1886"></a>              <span class="k">call </span><span class="n">mat_wmul</span><span class="p">(</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1887"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1888"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-1889"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">12</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1890"></a>              <span class="k">call </span><span class="n">mat_wdiv</span><span class="p">(</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1891"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1892"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-1893"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">13</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1894"></a>              <span class="k">call </span><span class="n">mat_wdiv</span><span class="p">(</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1895"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1896"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>  <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-1897"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-1898"></a><span class="k">              </span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1899"></a>            <span class="k">enddo</span>
<a name="ln-1900"></a><span class="k">          enddo</span>
<a name="ln-1901"></a><span class="k">        enddo</span>
<a name="ln-1902"></a><span class="k">      enddo</span>
<a name="ln-1903"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">MA</span>
<a name="ln-1904"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="o">*</span><span class="n">NA</span>
<a name="ln-1905"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1906"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="c">! COMMAND::CHOP</span>
<a name="ln-1907"></a>
<a name="ln-1908"></a>      <span class="n">eps0</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1909"></a>      <span class="k">do</span>                                                                  <span class="c">! recalculate epsilon</span>
<a name="ln-1910"></a>         <span class="n">eps0</span> <span class="o">=</span> <span class="n">eps0</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-1911"></a>         <span class="n">t</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">eps0</span><span class="p">)</span>
<a name="ln-1912"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1913"></a><span class="k">      enddo</span>
<a name="ln-1914"></a><span class="k">      </span><span class="n">eps0</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">eps0</span>
<a name="ln-1915"></a>
<a name="ln-1916"></a>      <span class="n">G_FLOP_COUNTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-1917"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">SEMI</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1918"></a><span class="k">         write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;CHOP &#39;&#39;,I2,&#39;&#39; PLACES.&#39;&#39;)&#39;</span><span class="p">)</span> <span class="n">G_FLOP_COUNTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1919"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-1920"></a>      <span class="k">endif</span>
<a name="ln-1921"></a>
<a name="ln-1922"></a><span class="k">      </span><span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1923"></a>      <span class="k">do</span>                                                                  <span class="c">! recalculate epsilon</span>
<a name="ln-1924"></a>         <span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-1925"></a>         <span class="n">t</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
<a name="ln-1926"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-1927"></a><span class="k">      enddo</span>
<a name="ln-1928"></a><span class="k">      </span><span class="n">eps</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">eps</span>
<a name="ln-1929"></a>
<a name="ln-1930"></a>      <span class="n">t</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1931"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">eps</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">t</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">eps0</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">eps</span>
<a name="ln-1932"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1933"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1934"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! COMMAND::SUM</span>
<a name="ln-1935"></a>      <span class="n">sr</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1936"></a>      <span class="n">si</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1937"></a>      <span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-1938"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-1939"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1940"></a>         <span class="n">sr</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">SR</span><span class="o">+</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">))</span>
<a name="ln-1941"></a>         <span class="n">si</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">SI</span><span class="o">+</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">))</span>
<a name="ln-1942"></a>      <span class="k">enddo</span>
<a name="ln-1943"></a><span class="k">      </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">sr</span>
<a name="ln-1944"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">si</span>
<a name="ln-1945"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1946"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1947"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1948"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">! COMMAND::PROD</span>
<a name="ln-1949"></a>      <span class="n">SR</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-1950"></a>      <span class="n">SI</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1951"></a>      <span class="n">MN</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-1952"></a>      <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MN</span>
<a name="ln-1953"></a>         <span class="n">LS</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1954"></a>         <span class="k">call </span><span class="n">mat_wmul</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">SR</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">SR</span><span class="p">,</span><span class="n">SI</span><span class="p">)</span>
<a name="ln-1955"></a>      <span class="k">enddo</span>
<a name="ln-1956"></a><span class="k">      </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">SR</span>
<a name="ln-1957"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">SI</span>
<a name="ln-1958"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1959"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1960"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1961"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c">! COMMAND::USER</span>
<a name="ln-1962"></a>      <span class="c">! The LALA statement &quot;Y = user(X,s,t)&quot; results in a call to the</span>
<a name="ln-1963"></a>      <span class="c">! subroutine with a copy of the matrix X stored in the argument A,</span>
<a name="ln-1964"></a>      <span class="c">! its column and row dimensions in M and N, and the scalar parameters</span>
<a name="ln-1965"></a>      <span class="c">! s and t stored in S and T. If s and t are omitted, they are set</span>
<a name="ln-1966"></a>      <span class="c">! to 0.0. After the return, A is stored in Y. The dimensions M and</span>
<a name="ln-1967"></a>      <span class="c">! N may be reset within the subroutine. The statement Y = user(K)&quot;</span>
<a name="ln-1968"></a>      <span class="c">! results in a call with M = 1, N = 1 and A(1,1) = &quot;float(K)&quot;.</span>
<a name="ln-1969"></a>
<a name="ln-1970"></a>      <span class="c">! all of the arguments are in a vector that is part of the stack.</span>
<a name="ln-1971"></a>      <span class="c">! the location points to the last value and M and N are set to the</span>
<a name="ln-1972"></a>      <span class="c">! the row and column size of the last argument. G_RHS is the number</span>
<a name="ln-1973"></a>      <span class="c">! of arguments.</span>
<a name="ln-1974"></a>      <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1975"></a>      <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1976"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1977"></a><span class="k">         </span><span class="n">s</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-1978"></a>         <span class="c">! back up the stack one argument</span>
<a name="ln-1979"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1980"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>   <span class="c">! the end of argument X</span>
<a name="ln-1981"></a>         <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>            <span class="c">! the size of X(M,N)</span>
<a name="ln-1982"></a>         <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1983"></a>      <span class="n">elseif</span><span class="p">(</span><span class="n">G_RHS</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1984"></a><span class="k">         </span><span class="n">t</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-1985"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>       <span class="c">! back up to s</span>
<a name="ln-1986"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1987"></a>         <span class="n">s</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-1988"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>       <span class="c">! back up to X</span>
<a name="ln-1989"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1990"></a>         <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1991"></a>         <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-1992"></a>      <span class="k">else</span>  <span class="c">! if not 1,2,3 should it be an error???</span>
<a name="ln-1993"></a>      <span class="k">endif</span>
<a name="ln-1994"></a>      <span class="c">! ??? if user routine changes size of array and/or should pass vector instead of address ???</span>
<a name="ln-1995"></a>      <span class="c">! ??? user routine cannot do complex values? Just REAL ???</span>
<a name="ln-1996"></a>      <span class="k">call </span><span class="n">usersub</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">:),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<a name="ln-1997"></a>      <span class="k">call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>      <span class="c">! set the imaginary values to zero</span>
<a name="ln-1998"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>               <span class="c">! store the possibly new size</span>
<a name="ln-1999"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-2000"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2001"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c">! COMMAND::SHAPE</span>
<a name="ln-2002"></a>      <span class="c">! store the two output values onto stack</span>
<a name="ln-2003"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-2004"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2005"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-2006"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2007"></a>      <span class="k">if</span><span class="p">(</span><span class="n">G_LHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2008"></a>         <span class="c">! output is a 1x2 array so store values indicating the shape of the new stack value</span>
<a name="ln-2009"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2010"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-2011"></a>      <span class="k">else</span>
<a name="ln-2012"></a>         <span class="c">! output is two scalars</span>
<a name="ln-2013"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2014"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2017"></a>         <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2018"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2019"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2020"></a>      <span class="k">endif</span>
<a name="ln-2021"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2022"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span> <span class="c">! COMMAND::DIAG=2</span>
<a name="ln-2023"></a>                 <span class="c">! COMMAND::TRIL=14</span>
<a name="ln-2024"></a>                 <span class="c">! COMMAND::TRIU=15</span>
<a name="ln-2025"></a>      <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2026"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2027"></a><span class="k">         </span><span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-2028"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2029"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2030"></a>         <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2031"></a>         <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2032"></a>      <span class="k">endif</span>
<a name="ln-2033"></a>
<a name="ln-2034"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">14</span><span class="p">)</span> <span class="k">then</span> <span class="c">! COMMAND::TRIL, COMMAND::TRIU</span>
<a name="ln-2035"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-2036"></a>               <span class="n">ld</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">j</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-2037"></a>               <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-2038"></a>               <span class="k">case</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-2039"></a>                        <span class="n">ll</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-2040"></a>                        <span class="n">ls</span> <span class="o">=</span> <span class="n">ld</span> <span class="o">-</span> <span class="n">ll</span>
<a name="ln-2041"></a>               <span class="k">case</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-2042"></a>                        <span class="n">ll</span> <span class="o">=</span> <span class="n">m</span> <span class="o">-</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span>
<a name="ln-2043"></a>                        <span class="n">ls</span> <span class="o">=</span> <span class="n">ld</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2044"></a>               <span class="k">end select</span>
<a name="ln-2045"></a><span class="k">               if</span> <span class="p">(</span><span class="n">ll</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2046"></a>            <span class="k">enddo</span>
<a name="ln-2047"></a><span class="k">      </span><span class="n">elseif</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">n</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2048"></a><span class="k">         </span><span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="nb">iabs</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2049"></a>
<a name="ln-2050"></a>         <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">location</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">))</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a><span class="k">         </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2053"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2054"></a>         <span class="k">do </span><span class="n">jb</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-2055"></a>            <span class="k">do </span><span class="n">ib</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-2056"></a>               <span class="n">j</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">jb</span>
<a name="ln-2057"></a>               <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">ib</span>
<a name="ln-2058"></a>               <span class="n">sr</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2059"></a>               <span class="n">si</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2060"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2061"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2062"></a>               <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-2063"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2064"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2065"></a>               <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">sr</span>
<a name="ln-2066"></a>               <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">si</span>
<a name="ln-2067"></a>            <span class="k">enddo</span>
<a name="ln-2068"></a><span class="k">         enddo</span>
<a name="ln-2069"></a><span class="k">      else</span>
<a name="ln-2070"></a><span class="k">         if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">mn</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2071"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">mn</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-2072"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2073"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2074"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">mn</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit </span><span class="n">FUN6</span>
<a name="ln-2075"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-2076"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-2077"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-2078"></a>            <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2079"></a>            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2080"></a>            <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2081"></a>         <span class="k">enddo</span>
<a name="ln-2082"></a><span class="k">      endif</span>
<a name="ln-2083"></a><span class="k">      exit </span><span class="n">FUN6</span>
<a name="ln-2084"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-2085"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="c">! COMMAND::EYE,</span>
<a name="ln-2086"></a>                  <span class="c">! COMMAND::RAND,</span>
<a name="ln-2087"></a>                  <span class="c">! COMMAND::ONES,</span>
<a name="ln-2088"></a>                  <span class="c">! COMMAND::ZEROS</span>
<a name="ln-2089"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">m</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_RHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2092"></a><span class="k">            </span><span class="n">nn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-2093"></a>            <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2094"></a>            <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2095"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2096"></a>         <span class="k">endif</span>
<a name="ln-2097"></a>
<a name="ln-2098"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_FIN</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">7.</span><span class="nb">and</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span><span class="k">then</span>        <span class="c">! a call to RAND might be RAND(&#39;UNIFORM&#39;|&#39;SEED&#39;|&#39;NORMAL&#39;)</span>
<a name="ln-2099"></a>            <span class="n">id</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-2100"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>  <span class="c">! in case it is one of these words store it in the ID array to test if it matches</span>
<a name="ln-2101"></a>               <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2102"></a>               <span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span>
<a name="ln-2103"></a>            <span class="k">enddo</span>
<a name="ln-2104"></a><span class="k">            if</span><span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">unifor</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">normal</span><span class="p">))</span><span class="k">then</span> <span class="c">! SWITCH UNIFORM AND NORMAL(if a matrix just happens to match, a bug)</span>
<a name="ln-2105"></a>               <span class="n">G_CURRENT_RANDOM_TYPE</span> <span class="o">=</span> <span class="n">id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">unifor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>        <span class="c">! set random type to generate by seeing if first letter is a &quot;u&quot;</span>
<a name="ln-2106"></a>               <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2107"></a>               <span class="k">exit </span><span class="n">FUN6</span>
<a name="ln-2108"></a>            <span class="n">elseif</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">seed</span><span class="p">))</span> <span class="k">then</span>                     <span class="c">! if a matrix just happens to match &quot;seed&quot; , a bug)</span>
<a name="ln-2109"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">G_CURRENT_RANDOM_SEED</span> <span class="o">=</span> <span class="n">nn</span>
<a name="ln-2110"></a>               <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_CURRENT_RANDOM_SEED</span>
<a name="ln-2111"></a>               <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2112"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2113"></a>               <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2114"></a>               <span class="k">exit </span><span class="n">FUN6</span>
<a name="ln-2115"></a>            <span class="k">endif</span>
<a name="ln-2116"></a><span class="k">         endif</span>
<a name="ln-2117"></a>
<a name="ln-2118"></a><span class="k">         if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2119"></a><span class="k">            </span><span class="n">m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2120"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2121"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">n</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-2122"></a>
<a name="ln-2123"></a>            <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">location</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)))</span> <span class="k">return</span>
<a name="ln-2124"></a>
<a name="ln-2125"></a><span class="k">            </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-2126"></a>            <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2127"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit </span><span class="n">FUN6</span>
<a name="ln-2128"></a>         <span class="k">endif</span>
<a name="ln-2129"></a>
<a name="ln-2130"></a><span class="k">      endif</span>
<a name="ln-2131"></a>
<a name="ln-2132"></a><span class="k">      do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-2133"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-2134"></a>
<a name="ln-2135"></a>           <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>             <span class="c">! location to place value</span>
<a name="ln-2136"></a>
<a name="ln-2137"></a>           <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! all of these functions set imaginary values to zero</span>
<a name="ln-2138"></a>
<a name="ln-2139"></a>           <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-2140"></a>           <span class="k">case</span><span class="p">(</span> <span class="mi">6</span> <span class="p">)</span> <span class="c">!::EYE</span>
<a name="ln-2141"></a>              <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">j</span><span class="p">)</span><span class="k">then</span>               <span class="c">! on the diagonal</span>
<a name="ln-2142"></a>                 <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2143"></a>              <span class="k">else</span>
<a name="ln-2144"></a><span class="k">                 </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2145"></a>              <span class="k">endif</span>
<a name="ln-2146"></a><span class="k">           case</span><span class="p">(</span> <span class="mi">7</span> <span class="p">)</span> <span class="c">!::RAND</span>
<a name="ln-2147"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">G_CURRENT_RANDOM_TYPE</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2148"></a><span class="k">                 </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">=</span><span class="n">mat_flop</span><span class="p">(</span><span class="n">mat_urand</span><span class="p">(</span><span class="n">G_CURRENT_RANDOM_SEED</span><span class="p">))</span>
<a name="ln-2149"></a>              <span class="k">else</span>
<a name="ln-2150"></a><span class="k">                 do</span>
<a name="ln-2151"></a><span class="k">                    </span><span class="n">sr</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">mat_urand</span><span class="p">(</span><span class="n">G_CURRENT_RANDOM_SEED</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-2152"></a>                    <span class="n">si</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">mat_urand</span><span class="p">(</span><span class="n">G_CURRENT_RANDOM_SEED</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-2153"></a>                    <span class="n">t</span> <span class="o">=</span> <span class="n">sr</span><span class="o">*</span><span class="n">sr</span> <span class="o">+</span> <span class="n">si</span><span class="o">*</span><span class="n">si</span>
<a name="ln-2154"></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-2155"></a><span class="k">                 enddo</span>
<a name="ln-2156"></a>
<a name="ln-2157"></a><span class="k">                 </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">sr</span><span class="o">*</span><span class="nb">dsqrt</span><span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="nb">dlog</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span><span class="o">/</span><span class="n">t</span><span class="p">))</span>
<a name="ln-2158"></a>              <span class="k">endif</span>
<a name="ln-2159"></a><span class="k">           case</span><span class="p">(</span> <span class="mi">8</span> <span class="p">)</span> <span class="c">!::ONES</span>
<a name="ln-2160"></a>              <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2161"></a>           <span class="k">case</span><span class="p">(</span> <span class="mi">16</span><span class="p">)</span> <span class="c">!::ZEROS</span>
<a name="ln-2162"></a>              <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2163"></a>           <span class="k">case </span><span class="n">default</span>
<a name="ln-2164"></a>              <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;should not get here: internal error&#39;</span><span class="p">)</span>
<a name="ln-2165"></a>           <span class="k">end select</span>
<a name="ln-2166"></a><span class="k">         enddo</span>
<a name="ln-2167"></a><span class="k">      enddo</span>
<a name="ln-2168"></a><span class="k">      exit </span><span class="n">FUN6</span>
<a name="ln-2169"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2170"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="c">! COMMAND::GETENV JSU</span>
<a name="ln-2171"></a>      <span class="nb">GETENV</span> <span class="p">:</span> <span class="k">block</span>
<a name="ln-2172"></a><span class="k">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">answers</span><span class="p">(:)</span>
<a name="ln-2173"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-2174"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">env_value</span>
<a name="ln-2175"></a>      <span class="k">allocate</span><span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">answers</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2176"></a>      <span class="c">! sort out what to do with an array of input later, for now concatenating into one string</span>
<a name="ln-2177"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_RHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2178"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;ERROR&gt;getenv:needs an argument:rows=&#39;</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39; arg_count=&#39;</span><span class="p">,</span><span class="n">G_RHS</span><span class="p">)</span>
<a name="ln-2179"></a>         <span class="n">G_ERR</span><span class="o">=</span><span class="mi">999</span>
<a name="ln-2180"></a>         <span class="k">return</span>
<a name="ln-2181"></a><span class="k">      endif</span>
<a name="ln-2182"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_RHS</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2183"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;ERROR&gt;getenv:too many arguments:arg_count=&#39;</span><span class="p">,</span><span class="n">G_RHS</span><span class="p">)</span>
<a name="ln-2184"></a>         <span class="n">G_ERR</span><span class="o">=</span><span class="mi">999</span>
<a name="ln-2185"></a>         <span class="k">return</span>
<a name="ln-2186"></a><span class="k">      endif</span>
<a name="ln-2187"></a>
<a name="ln-2188"></a><span class="k">      </span><span class="n">ll</span><span class="o">=</span><span class="n">location</span>
<a name="ln-2189"></a>      <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span>
<a name="ln-2190"></a>         <span class="n">varname</span><span class="o">=</span><span class="n">ade2str</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">:</span><span class="n">ll</span><span class="o">+</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2191"></a>         <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">mat_is_name</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span><span class="k">then</span>
<a name="ln-2192"></a><span class="k">               call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39; function name contains unacceptable characters&#39;</span><span class="p">)</span>
<a name="ln-2193"></a>               <span class="k">return</span>
<a name="ln-2194"></a><span class="k">         endif</span>
<a name="ln-2195"></a><span class="k">         </span><span class="n">ll</span><span class="o">=</span><span class="n">ll</span><span class="o">+</span><span class="n">n</span>
<a name="ln-2196"></a>         <span class="n">env_value</span><span class="o">=</span><span class="n">system_getenv</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span>
<a name="ln-2197"></a>         <span class="c">! do not leave it undefined or any variable on LHS will not be defined so make sure at least 1</span>
<a name="ln-2198"></a>         <span class="n">answers</span><span class="o">=</span><span class="p">[</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">answers</span><span class="p">),</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">env_value</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span> <span class="kd">::</span> <span class="n">answers</span><span class="p">,</span><span class="n">env_value</span><span class="p">]</span>
<a name="ln-2199"></a>      <span class="k">enddo</span>
<a name="ln-2200"></a>
<a name="ln-2201"></a><span class="k">      </span><span class="n">m</span><span class="o">=</span><span class="n">size</span><span class="p">(</span><span class="n">answers</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2202"></a>      <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">answers</span><span class="p">)</span>
<a name="ln-2203"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">location</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">))</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-2204"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-2205"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2206"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit </span><span class="n">FUN6</span>
<a name="ln-2207"></a>
<a name="ln-2208"></a>      <span class="c">! so starting at GM_REALS(location) convert the characters to numbers and store the M x N number of characters</span>
<a name="ln-2209"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-2210"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-2211"></a>           <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>             <span class="c">! location to place value</span>
<a name="ln-2212"></a>           <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! all of these functions set imaginary values to zero</span>
<a name="ln-2213"></a>           <span class="n">nn</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="n">answers</span><span class="p">(</span><span class="n">m</span><span class="p">)(</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="p">))</span>
<a name="ln-2214"></a>           <span class="k">if</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2215"></a><span class="k">              </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
<a name="ln-2216"></a>           <span class="k">else</span>
<a name="ln-2217"></a><span class="k">              call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;bad character&#39;</span><span class="p">)</span>
<a name="ln-2218"></a>              <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2219"></a>           <span class="k">endif</span>
<a name="ln-2220"></a><span class="k">         enddo</span>
<a name="ln-2221"></a><span class="k">      enddo</span>
<a name="ln-2222"></a><span class="k">      endblock </span><span class="nb">GETENV</span>
<a name="ln-2223"></a><span class="nb">      </span><span class="k">exit </span><span class="n">FUN6</span>
<a name="ln-2224"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2225"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="c">! COMMAND::DAT</span>
<a name="ln-2226"></a>      <span class="n">DATETIME</span><span class="p">:</span> <span class="k">block</span>
<a name="ln-2227"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">time_values</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2228"></a>      <span class="c">! store the two output values onto stack</span>
<a name="ln-2229"></a>      <span class="k">call </span><span class="nb">date_and_time</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">time_values</span><span class="p">)</span>
<a name="ln-2230"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">:</span><span class="n">location</span><span class="o">+</span><span class="mi">8</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">time_values</span><span class="p">)</span>
<a name="ln-2231"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">:</span><span class="n">location</span><span class="o">+</span><span class="mi">8</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2232"></a>      <span class="c">! output is a 1x8 array so store values indicating the size of the new stack value</span>
<a name="ln-2233"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2234"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-2235"></a>      <span class="k">endblock </span><span class="n">DATETIME</span>
<a name="ln-2236"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2237"></a>   <span class="k">end select </span><span class="n">FUN6</span>
<a name="ln-2238"></a><span class="k">end subroutine </span><span class="n">mat_matfn6</span>
<a name="ln-2239"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2240"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2241"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2242"></a><span class="k">subroutine </span><span class="n">mat_funs</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-2243"></a>
<a name="ln-2244"></a><span class="c">! ident_12=&quot;@(#)M_matrix::ml_funcs(3fp):scan function list and set G_FUN and G_FIN&quot;</span>
<a name="ln-2245"></a>
<a name="ln-2246"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-2247"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">selector</span>
<a name="ln-2248"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-2249"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2250"></a>
<a name="ln-2251"></a>   <span class="n">name</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-2252"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-2253"></a>      <span class="k">if</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">exit</span>
<a name="ln-2254"></a><span class="k">      if</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="n">G_CHARSET_SIZE</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2255"></a><span class="k">         </span><span class="n">name</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-2256"></a>      <span class="k">else</span>
<a name="ln-2257"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39; function name contains unacceptable characters:&#39;</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;... ADE=&#39;</span><span class="p">,</span><span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;position=&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2258"></a>         <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2259"></a>         <span class="k">return</span>
<a name="ln-2260"></a><span class="k">      endif</span>
<a name="ln-2261"></a><span class="k">   enddo</span>
<a name="ln-2262"></a>   <span class="c">!</span>
<a name="ln-2263"></a>   <span class="c">!  find value for given function name to determine what to call for each name.</span>
<a name="ln-2264"></a>   <span class="c">!     o first digit indicates which routine to call (SUBROUTINE MAT_MATFN[1-6])</span>
<a name="ln-2265"></a>   <span class="c">!     o remaining digits indicate nth number in computed goto in called routine</span>
<a name="ln-2266"></a>   <span class="k">select case</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a name="ln-2267"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;eps&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">000</span>
<a name="ln-2268"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;flop&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">000</span>
<a name="ln-2269"></a>
<a name="ln-2270"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;inv&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">101</span>
<a name="ln-2271"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;det&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">102</span>
<a name="ln-2272"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;rcond&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">103</span>
<a name="ln-2273"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lu&#39;</span><span class="p">);</span>              <span class="n">selector</span><span class="o">=</span><span class="mi">104</span>
<a name="ln-2274"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;invh&#39;</span><span class="p">,</span><span class="s1">&#39;inverse_hilbert&#39;</span><span class="p">,</span><span class="s1">&#39;invhilb&#39;</span><span class="p">);</span>  <span class="n">selector</span><span class="o">=</span><span class="mi">105</span>
<a name="ln-2275"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;chol&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">106</span>
<a name="ln-2276"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;rref&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">107</span>
<a name="ln-2277"></a>
<a name="ln-2278"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">201</span>
<a name="ln-2279"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;cos&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">202</span>
<a name="ln-2280"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;atan&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">203</span>
<a name="ln-2281"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;exp&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">204</span>
<a name="ln-2282"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sqrt&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">205</span>
<a name="ln-2283"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">206</span>
<a name="ln-2284"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;eig&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">211</span>
<a name="ln-2285"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;schur&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">212</span>
<a name="ln-2286"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;hess&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">213</span>
<a name="ln-2287"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;poly&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">214</span>
<a name="ln-2288"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;roots&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">215</span>
<a name="ln-2289"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;abs&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">221</span>  <span class="c">!  calling  codes  corresponding  to  the  function  names</span>
<a name="ln-2290"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;round&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">222</span>
<a name="ln-2291"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">223</span>
<a name="ln-2292"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;imag&#39;</span><span class="p">,</span><span class="s1">&#39;aimag&#39;</span><span class="p">);</span>    <span class="n">selector</span><span class="o">=</span><span class="mi">224</span>
<a name="ln-2293"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;conjg&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">225</span>
<a name="ln-2294"></a>
<a name="ln-2295"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;svd&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">301</span>
<a name="ln-2296"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;pinv&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">302</span>
<a name="ln-2297"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">303</span>
<a name="ln-2298"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">304</span>
<a name="ln-2299"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;rank&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">305</span>
<a name="ln-2300"></a>
<a name="ln-2301"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;qr&#39;</span><span class="p">);</span>              <span class="n">selector</span><span class="o">=</span><span class="mi">401</span>
<a name="ln-2302"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;orth&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">402</span>
<a name="ln-2303"></a>
<a name="ln-2304"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span><span class="s1">&#39;include&#39;</span><span class="p">,</span><span class="s1">&#39;source&#39;</span><span class="p">,</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>  <span class="n">selector</span><span class="o">=</span><span class="mi">501</span>
<a name="ln-2305"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;save&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">502</span>
<a name="ln-2306"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">503</span>
<a name="ln-2307"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;print&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">504</span>
<a name="ln-2308"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;diary&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">505</span>
<a name="ln-2309"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;disp&#39;</span><span class="p">,</span><span class="s1">&#39;display&#39;</span><span class="p">,</span><span class="s1">&#39;echo&#39;</span><span class="p">);</span>  <span class="n">selector</span><span class="o">=</span><span class="mi">506</span>
<a name="ln-2310"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;base&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">507</span>
<a name="ln-2311"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">508</span>
<a name="ln-2312"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">509</span>
<a name="ln-2313"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;plot&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">510</span>
<a name="ln-2314"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;rat&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">511</span>
<a name="ln-2315"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">512</span>
<a name="ln-2316"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;show&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">513</span>
<a name="ln-2317"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;delete&#39;</span><span class="p">);</span>          <span class="n">selector</span><span class="o">=</span><span class="mi">514</span>
<a name="ln-2318"></a>
<a name="ln-2319"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;magic&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">601</span>
<a name="ln-2320"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;diag&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">602</span>
<a name="ln-2321"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">603</span>
<a name="ln-2322"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;prod&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">604</span>
<a name="ln-2323"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">605</span>
<a name="ln-2324"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;eye&#39;</span><span class="p">);</span>             <span class="n">selector</span><span class="o">=</span><span class="mi">606</span>
<a name="ln-2325"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;rand&#39;</span><span class="p">,</span><span class="s1">&#39;random&#39;</span><span class="p">);</span>   <span class="n">selector</span><span class="o">=</span><span class="mi">607</span>
<a name="ln-2326"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ones&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">608</span>
<a name="ln-2327"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;chop&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">609</span>
<a name="ln-2328"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;shape&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">610</span>
<a name="ln-2329"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;kron&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">611</span>
<a name="ln-2330"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;tril&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">614</span>
<a name="ln-2331"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;triu&#39;</span><span class="p">);</span>            <span class="n">selector</span><span class="o">=</span><span class="mi">615</span>
<a name="ln-2332"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;zeros&#39;</span><span class="p">);</span>           <span class="n">selector</span><span class="o">=</span><span class="mi">616</span>
<a name="ln-2333"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;getenv&#39;</span><span class="p">);</span>          <span class="n">selector</span><span class="o">=</span><span class="mi">617</span>
<a name="ln-2334"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;dat&#39;</span><span class="p">,</span><span class="s1">&#39;date_and_time&#39;</span><span class="p">);</span>   <span class="n">selector</span><span class="o">=</span><span class="mi">618</span>
<a name="ln-2335"></a>
<a name="ln-2336"></a>   <span class="k">case </span><span class="n">default</span> <span class="c">!  function name was not found</span>
<a name="ln-2337"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2338"></a>      <span class="k">return</span>
<a name="ln-2339"></a><span class="k">   end select</span>
<a name="ln-2340"></a>
<a name="ln-2341"></a><span class="c">!  found name so get G_FIN and G_FUN value from corresponding code</span>
<a name="ln-2342"></a>
<a name="ln-2343"></a>   <span class="n">G_FIN</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c">! which case to select in called procedure</span>
<a name="ln-2344"></a>   <span class="n">G_FUN</span> <span class="o">=</span> <span class="n">selector</span><span class="o">/</span><span class="mi">100</span>      <span class="c">! which routine to call (SUBROUTINE MAT_MATFN[1-6])</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">selector</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">606</span><span class="p">)</span> <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2347"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">selector</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">607</span><span class="p">)</span> <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2348"></a><span class="k">end subroutine </span><span class="n">mat_funs</span>
<a name="ln-2349"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2350"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2351"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2352"></a><span class="k">subroutine </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a><span class="c">! ident_13=&quot;@(#)M_matrix::mat_copyid(3fp): copy a name to allow an easy way to store a name&quot;</span>
<a name="ln-2355"></a>
<a name="ln-2356"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-2357"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">y</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-2358"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2359"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">GG_MAX_NAME_LENGTH</span>
<a name="ln-2360"></a>         <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2361"></a>      <span class="k">enddo</span>
<a name="ln-2362"></a><span class="k">end subroutine </span><span class="n">mat_copyid</span>
<a name="ln-2363"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2364"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2365"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2366"></a><span class="k">subroutine </span><span class="n">mat_getval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="ln-2367"></a>
<a name="ln-2368"></a><span class="c">! ident_14=&quot;@(#)M_matrix::mat_getval(3fp): form numerical value from string of integer characters&quot;</span>
<a name="ln-2369"></a>
<a name="ln-2370"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">s</span>
<a name="ln-2371"></a>      <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2372"></a>      <span class="n">INFINITE</span><span class="p">:</span> <span class="k">do</span>
<a name="ln-2373"></a><span class="k">         select case</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">)</span>
<a name="ln-2374"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">0.0d0</span>
<a name="ln-2375"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">1.0d0</span>
<a name="ln-2376"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">2.0d0</span>
<a name="ln-2377"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">3.0d0</span>
<a name="ln-2378"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">4.0d0</span>
<a name="ln-2379"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">5.0d0</span>
<a name="ln-2380"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">6.0d0</span>
<a name="ln-2381"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;7&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">7.0d0</span>
<a name="ln-2382"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">8.0d0</span>
<a name="ln-2383"></a>         <span class="k">case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;9&#39;</span><span class="p">));</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mf">9.0d0</span>
<a name="ln-2384"></a>         <span class="k">case </span><span class="n">default</span>
<a name="ln-2385"></a>            <span class="k">exit </span><span class="n">INFINITE</span>
<a name="ln-2386"></a>         <span class="k">end select</span>
<a name="ln-2387"></a><span class="k">         call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! get next character</span>
<a name="ln-2388"></a>      <span class="k">enddo </span><span class="n">INFINITE</span>
<a name="ln-2389"></a><span class="k">end subroutine </span><span class="n">mat_getval</span>
<a name="ln-2390"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2391"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2392"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2393"></a><span class="k">subroutine </span><span class="n">mat_getch</span><span class="p">()</span>
<a name="ln-2394"></a>
<a name="ln-2395"></a><span class="c">! ident_15=&quot;@(#)M_matrix::mat_getch(3f): get next character from input line into G_CHRA&quot;</span>
<a name="ln-2396"></a>
<a name="ln-2397"></a>   <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-2398"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2399"></a>
<a name="ln-2400"></a><span class="k">end subroutine </span><span class="n">mat_getch</span>
<a name="ln-2401"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2402"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2403"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2404"></a><span class="k">subroutine </span><span class="n">mat_base</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-2405"></a>
<a name="ln-2406"></a><span class="c">! ident_16=&quot;@(#)M_matrix::mat_base(3fp): store representation of x in s(1:n) using specified base&quot;</span>
<a name="ln-2407"></a>
<a name="ln-2408"></a><span class="n">doubleprecision</span>            <span class="kd">::</span> <span class="n">x</span>
<a name="ln-2409"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">base</span>
<a name="ln-2410"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eps</span>
<a name="ln-2411"></a><span class="n">doubleprecision</span>            <span class="kd">::</span> <span class="n">s</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-2412"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">n</span>
<a name="ln-2413"></a>
<a name="ln-2414"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">t</span>
<a name="ln-2415"></a>
<a name="ln-2416"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="n">l</span>
<a name="ln-2417"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="n">j</span>
<a name="ln-2418"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="n">k</span>
<a name="ln-2419"></a><span class="kt">integer</span>      <span class="kd">::</span> <span class="n">m</span>
<a name="ln-2420"></a>
<a name="ln-2421"></a>   <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2422"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2423"></a><span class="k">      </span><span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">plus</span>
<a name="ln-2424"></a>   <span class="k">else</span>
<a name="ln-2425"></a><span class="k">      </span><span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">minus</span>
<a name="ln-2426"></a>   <span class="k">endif</span>
<a name="ln-2427"></a><span class="k">   </span><span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
<a name="ln-2428"></a>   <span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">dot</span>
<a name="ln-2429"></a>   <span class="n">x</span> <span class="o">=</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2430"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2431"></a><span class="k">      </span><span class="n">k</span> <span class="o">=</span> <span class="nb">dlog</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nb">dlog</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
<a name="ln-2432"></a>   <span class="k">else</span>
<a name="ln-2433"></a><span class="k">      </span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2434"></a>   <span class="k">endif</span>
<a name="ln-2435"></a><span class="k">   if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2436"></a>   <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">base</span><span class="o">**</span><span class="n">k</span>
<a name="ln-2437"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">base</span><span class="o">*</span><span class="n">x</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">base</span><span class="p">)</span> <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2438"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">base</span><span class="o">*</span><span class="n">x</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">base</span><span class="p">)</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">base</span>
<a name="ln-2439"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">eps</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2440"></a><span class="k">      </span><span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">dlog</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="nb">dlog</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span>
<a name="ln-2441"></a>   <span class="k">else</span>
<a name="ln-2442"></a><span class="k">      </span><span class="n">m</span> <span class="o">=</span> <span class="mi">54</span>
<a name="ln-2443"></a>   <span class="k">endif</span>
<a name="ln-2444"></a><span class="k">   do </span><span class="n">l</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-2445"></a>      <span class="n">x</span> <span class="o">=</span> <span class="n">base</span><span class="o">*</span><span class="n">x</span>
<a name="ln-2446"></a>      <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2447"></a>      <span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2448"></a>      <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a name="ln-2449"></a>      <span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">=</span><span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span>
<a name="ln-2450"></a>   <span class="k">enddo</span>
<a name="ln-2451"></a><span class="k">   </span><span class="n">s</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">comma</span>
<a name="ln-2452"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">s</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plus</span>
<a name="ln-2453"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">s</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">minus</span>
<a name="ln-2454"></a>   <span class="n">t</span> <span class="o">=</span> <span class="nb">dabs</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<a name="ln-2455"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">3</span>
<a name="ln-2456"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">base</span><span class="p">)</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="nb">dlog</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="nb">dlog</span><span class="p">(</span><span class="n">base</span><span class="p">))</span>
<a name="ln-2457"></a>   <span class="n">l</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2458"></a>   <span class="n">INFINITE</span><span class="p">:</span> <span class="k">do</span>
<a name="ln-2459"></a><span class="k">      </span><span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">dmod</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">base</span><span class="p">))</span>
<a name="ln-2460"></a>      <span class="n">s</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">48</span><span class="p">)</span>
<a name="ln-2461"></a>      <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-2462"></a>      <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">/</span><span class="n">base</span>
<a name="ln-2463"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">m</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-2464"></a><span class="k">   enddo </span><span class="n">INFINITE</span>
<a name="ln-2465"></a><span class="k">end subroutine </span><span class="n">mat_base</span>
<a name="ln-2466"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2467"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2468"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2469"></a><span class="k">subroutine </span><span class="n">mat_print</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
<a name="ln-2470"></a>
<a name="ln-2471"></a><span class="c">! ident_17=&quot;@(#)M_matrix::mat_print(3fp): primary output routine&quot;</span>
<a name="ln-2472"></a>
<a name="ln-2473"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-2474"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">k</span>
<a name="ln-2475"></a>
<a name="ln-2476"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">81</span><span class="p">)</span> <span class="kd">::</span> <span class="n">message</span>
<a name="ln-2477"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span> <span class="kd">::</span> <span class="n">form</span>
<a name="ln-2478"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ls_char</span>
<a name="ln-2479"></a>
<a name="ln-2480"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">s</span>
<a name="ln-2481"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">tr</span>
<a name="ln-2482"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">ti</span>
<a name="ln-2483"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">pr</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2484"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">pi</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2485"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">sig</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2486"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">typ</span>
<a name="ln-2487"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">f</span>
<a name="ln-2488"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">location</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mn</span>
<a name="ln-2489"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ks</span>
<a name="ln-2490"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2491"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-2492"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">istep</span>
<a name="ln-2493"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j</span>
<a name="ln-2494"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j1</span>
<a name="ln-2495"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j2</span>
<a name="ln-2496"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j3</span>
<a name="ln-2497"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">jinc</span>
<a name="ln-2498"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">jm</span>
<a name="ln-2499"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-2500"></a><span class="kt">integer</span><span class="p">,</span><span class="k">save</span>      <span class="kd">::</span> <span class="n">fno</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a name="ln-2501"></a><span class="kt">integer</span><span class="p">,</span><span class="k">save</span>      <span class="kd">::</span> <span class="n">fnl</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<a name="ln-2502"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">itype</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a><span class="c">! FORMAT NUMBERS AND LENGTHS</span>
<a name="ln-2505"></a><span class="c">! G_FMT   1       2       3       4       5</span>
<a name="ln-2506"></a><span class="c">!       SHORT   LONG   SHORT E  LONG E    Z</span>
<a name="ln-2507"></a><span class="c">! TYP   1       2       3</span>
<a name="ln-2508"></a><span class="c">!    INTEGER  REAL   COMPLEX</span>
<a name="ln-2509"></a><span class="c">!.......................................................................</span>
<a name="ln-2510"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-2511"></a><span class="c">!.......................................................................</span>
<a name="ln-2512"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2513"></a>   <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2514"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2515"></a>   <span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-2516"></a>   <span class="n">typ</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2517"></a>   <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2518"></a>   <span class="n">itype</span><span class="o">=-</span><span class="mi">9999</span>
<a name="ln-2519"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-2520"></a>      <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2521"></a>      <span class="n">tr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2522"></a>      <span class="n">ti</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2523"></a>      <span class="n">s</span> <span class="o">=</span> <span class="n">dmax1</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="nb">dabs</span><span class="p">(</span><span class="n">tr</span><span class="p">),</span><span class="nb">dabs</span><span class="p">(</span><span class="n">ti</span><span class="p">))</span>
<a name="ln-2524"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">mat_round</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">tr</span><span class="p">)</span> <span class="n">typ</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">typ</span><span class="p">)</span>
<a name="ln-2525"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">ti</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">typ</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-2526"></a>   <span class="k">enddo</span>
<a name="ln-2527"></a><span class="k">   if</span> <span class="p">(</span><span class="n">s</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">s</span> <span class="o">=</span> <span class="n">dlog10</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="ln-2528"></a>   <span class="n">ks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="ln-2529"></a>   <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">ks</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ks</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ks</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2530"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ks</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_FMT</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">typ</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">ks</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2531"></a>
<a name="ln-2532"></a>   <span class="n">f</span><span class="o">=</span><span class="mi">0</span>                          <span class="c">! initialize to bad value</span>
<a name="ln-2533"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">typ</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>         <span class="c">! if output type is integer</span>
<a name="ln-2534"></a>      <span class="k">if</span><span class="p">(</span> <span class="n">ks</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">2</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-2535"></a><span class="k">         </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2536"></a>      <span class="k">else</span>
<a name="ln-2537"></a><span class="k">         </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-2538"></a>      <span class="k">endif</span>
<a name="ln-2539"></a><span class="k">   endif</span>
<a name="ln-2540"></a><span class="k">   if</span> <span class="p">(</span><span class="n">typ</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ks</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">9</span><span class="p">)</span> <span class="n">typ</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">!change type from integer to real</span>
<a name="ln-2541"></a>
<a name="ln-2542"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">typ</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">f</span> <span class="o">=</span> <span class="n">G_FMT</span> <span class="o">+</span> <span class="mi">2</span>   <span class="c">! if type is real</span>
<a name="ln-2543"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">typ</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="n">f</span> <span class="o">=</span> <span class="n">G_FMT</span> <span class="o">+</span> <span class="mi">6</span>   <span class="c">! if type is complex</span>
<a name="ln-2544"></a>   <span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2545"></a><span class="k">      call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;*mat_print* internal error - bad type&#39;</span><span class="p">)</span>
<a name="ln-2546"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-2547"></a>   <span class="k">endif</span>
<a name="ln-2548"></a>
<a name="ln-2549"></a><span class="k">   if</span> <span class="p">(</span><span class="n">mn</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ks</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_FMT</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">3</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">typ</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-2550"></a>
<a name="ln-2551"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_FMT</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">11</span>
<a name="ln-2552"></a>
<a name="ln-2553"></a>   <span class="n">jinc</span> <span class="o">=</span> <span class="n">fnl</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a name="ln-2554"></a>   <span class="n">f</span> <span class="o">=</span> <span class="n">fno</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a name="ln-2555"></a>
<a name="ln-2556"></a>   <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2557"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">21</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">f</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">22</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">f</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">31</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">f</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">32</span><span class="p">)</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0D0</span><span class="o">**</span><span class="n">ks</span>
<a name="ln-2558"></a>   <span class="n">ls</span> <span class="o">=</span> <span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">jinc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-2559"></a><span class="c">!.......................................................................</span>
<a name="ln-2560"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">LS</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2561"></a><span class="k">      </span><span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2562"></a>
<a name="ln-2563"></a>      <span class="k">if</span><span class="p">(</span><span class="n">G_PROMPT</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2564"></a><span class="k">         WRITE</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;(&#39; AT LEAST &#39;,I5,&#39; MORE LINES.&#39;,&#39;  ENTER BLANK LINE TO CONTINUE OUTPUT.&#39;)&quot;</span><span class="p">)</span> <span class="n">LS</span>
<a name="ln-2565"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-2566"></a>
<a name="ln-2567"></a>         <span class="k">READ</span><span class="p">(</span><span class="n">G_INPUT_LUN</span><span class="p">,</span><span class="s1">&#39;(a1)&#39;</span><span class="p">,</span><span class="k">END</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span> <span class="n">LS_CHAR</span>  <span class="c">! read response to pause from standard input</span>
<a name="ln-2568"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">LS_CHAR</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">goto </span><span class="mi">20</span>      <span class="c">! if blank or a return display the values</span>
<a name="ln-2569"></a>         <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2570"></a>         <span class="k">goto </span><span class="mi">99</span>
<a name="ln-2571"></a>      <span class="k">else</span>
<a name="ln-2572"></a><span class="k">         </span><span class="n">LS_CHAR</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-2573"></a>         <span class="k">goto </span><span class="mi">20</span>
<a name="ln-2574"></a>      <span class="k">endif</span>
<a name="ln-2575"></a><span class="k">   </span><span class="mi">19</span> <span class="k">continue</span>
<a name="ln-2576"></a><span class="k">      call </span><span class="n">mat_files</span><span class="p">(</span><span class="o">-</span><span class="n">G_INPUT_LUN</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-2577"></a>   <span class="k">endif</span>
<a name="ln-2578"></a><span class="k">   </span><span class="mi">20</span> <span class="k">continue</span>
<a name="ln-2579"></a><span class="c">!.......................................................................</span>
<a name="ln-2580"></a>   <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-2581"></a>   <span class="k">call </span><span class="n">mat_print_id</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2582"></a>   <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-2583"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2584"></a><span class="k">      write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;  &#39;&#39;,1PD9.1,&quot; *&quot;)&#39;</span><span class="p">)</span> <span class="n">s</span>
<a name="ln-2585"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-2586"></a>   <span class="k">endif</span>
<a name="ln-2587"></a><span class="k">   do </span><span class="n">j1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">jinc</span>
<a name="ln-2588"></a>      <span class="n">j2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j1</span><span class="o">+</span><span class="n">jinc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2589"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">jinc</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2590"></a><span class="k">         write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;     COLUMNS&#39;&#39;,I6,&#39;&#39; THRU&#39;&#39;,I6)&#39;</span><span class="p">)</span> <span class="n">j1</span><span class="p">,</span><span class="n">j2</span>
<a name="ln-2591"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-2592"></a>      <span class="k">endif</span>
<a name="ln-2593"></a><span class="k">      do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-2594"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j2</span><span class="o">-</span><span class="n">j1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2595"></a>         <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jm</span>
<a name="ln-2596"></a>            <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">j1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-2597"></a>            <span class="n">pr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span><span class="o">/</span><span class="n">s</span>
<a name="ln-2598"></a>            <span class="n">pi</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
<a name="ln-2599"></a>            <span class="n">sig</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">plus</span>
<a name="ln-2600"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">sig</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">minus</span>
<a name="ln-2601"></a>         <span class="k">enddo</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a><span class="k">         select case</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<a name="ln-2604"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-2605"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,12F6.0)&#39;</span>          <span class="c">! integer</span>
<a name="ln-2606"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">12</span>
<a name="ln-2607"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">777</span>
<a name="ln-2608"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2609"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,6F12.0)&#39;</span>          <span class="c">! integer</span>
<a name="ln-2610"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">6</span>
<a name="ln-2611"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">777</span>
<a name="ln-2612"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-2613"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,F9.4,7F10.4)&#39;</span>     <span class="c">! 8 numbers</span>
<a name="ln-2614"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">8</span>
<a name="ln-2615"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">999</span>
<a name="ln-2616"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-2617"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,F19.15,3F20.15)&#39;</span>  <span class="c">! 4 numbers</span>
<a name="ln-2618"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-2619"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">999</span>
<a name="ln-2620"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<a name="ln-2621"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,1P6D13.4)&#39;</span>        <span class="c">! 6 numbers</span>
<a name="ln-2622"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">6</span>
<a name="ln-2623"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">999</span>
<a name="ln-2624"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-2625"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,1P3D24.15)&#39;</span>       <span class="c">! 3 numbers</span>
<a name="ln-2626"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-2627"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">999</span>
<a name="ln-2628"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<a name="ln-2629"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,4(F9.4,1X,A1,F7.4,&#39;&#39;i&#39;&#39;))&#39;</span>                       <span class="c">! 4x3</span>
<a name="ln-2630"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">12</span>
<a name="ln-2631"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">888</span>
<a name="ln-2632"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a name="ln-2633"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,F19.15,A1,F18.15,&#39;&#39;i&#39;&#39;,F20.15,A1,F18.15,&#39;&#39;i&#39;&#39;)&#39;</span>  <span class="c">! 6</span>
<a name="ln-2634"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">6</span>
<a name="ln-2635"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">888</span>
<a name="ln-2636"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<a name="ln-2637"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,3(1PD13.4,1X,A1,1PD10.4,&#39;&#39;i&#39;&#39;))&#39;</span>                 <span class="c">! 9</span>
<a name="ln-2638"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">9</span>
<a name="ln-2639"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">888</span>
<a name="ln-2640"></a>         <span class="k">case</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>
<a name="ln-2641"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;(1X,1PD24.15,1X,A1,1PD21.15,&#39;&#39;i&#39;&#39;)&#39;</span>                  <span class="c">! 3</span>
<a name="ln-2642"></a>            <span class="n">istep</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-2643"></a>            <span class="n">itype</span><span class="o">=</span> <span class="mi">888</span>
<a name="ln-2644"></a>         <span class="k">case</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2645"></a>            <span class="k">call </span><span class="n">mat_formz</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span>
<a name="ln-2646"></a>            <span class="n">istep</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-2647"></a>            <span class="n">itype</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-2648"></a>         <span class="k">case </span><span class="n">default</span>
<a name="ln-2649"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;*internal error*&#39;</span><span class="p">)</span>
<a name="ln-2650"></a>            <span class="k">goto </span><span class="mi">99</span>
<a name="ln-2651"></a>         <span class="k">end select</span>
<a name="ln-2652"></a>
<a name="ln-2653"></a>         <span class="c">! print data based on type</span>
<a name="ln-2654"></a>         <span class="k">if</span><span class="p">(</span><span class="n">itype</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2655"></a><span class="k">            do </span><span class="n">j3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jm</span><span class="p">,</span><span class="n">istep</span>
<a name="ln-2656"></a>               <span class="k">select case</span><span class="p">(</span><span class="n">itype</span><span class="p">)</span>
<a name="ln-2657"></a>               <span class="k">case</span><span class="p">(</span><span class="mi">777</span><span class="p">);</span> <span class="k">write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">form</span><span class="p">)(</span><span class="n">pr</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">j3</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">j3</span><span class="o">+</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">jm</span><span class="p">))</span>
<a name="ln-2658"></a>               <span class="k">case</span><span class="p">(</span><span class="mi">999</span><span class="p">);</span> <span class="k">write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">form</span><span class="p">)(</span><span class="n">pr</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">j3</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">j3</span><span class="o">+</span><span class="n">istep</span><span class="p">,</span><span class="n">jm</span><span class="p">))</span>
<a name="ln-2659"></a>               <span class="k">case</span><span class="p">(</span><span class="mi">888</span><span class="p">);</span> <span class="k">write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">form</span><span class="p">)(</span><span class="n">pr</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">sig</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">pi</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">j3</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">j3</span><span class="o">+</span><span class="n">istep</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">jm</span><span class="p">))</span>
<a name="ln-2660"></a>               <span class="k">end select</span>
<a name="ln-2661"></a><span class="k">               call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-2662"></a>            <span class="k">enddo</span>
<a name="ln-2663"></a><span class="k">         endif</span>
<a name="ln-2664"></a>
<a name="ln-2665"></a><span class="k">         </span><span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2666"></a>      <span class="k">enddo</span>
<a name="ln-2667"></a><span class="k">   enddo</span>
<a name="ln-2668"></a>
<a name="ln-2669"></a><span class="mi">99</span> <span class="k">continue</span>
<a name="ln-2670"></a><span class="k">   </span><span class="nb">flush</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">STDOUT</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span>
<a name="ln-2671"></a>
<a name="ln-2672"></a><span class="k">end subroutine </span><span class="n">mat_print</span>
<a name="ln-2673"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2674"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2675"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2676"></a><span class="k">subroutine </span><span class="n">mat_formz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-2677"></a>
<a name="ln-2678"></a><span class="c">! ident_18=&quot;@(#)M_matrix::mat_formz: system dependent routine to print with z format&quot;</span>
<a name="ln-2679"></a>
<a name="ln-2680"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span>
<a name="ln-2681"></a>
<a name="ln-2682"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">mline</span>
<a name="ln-2683"></a>
<a name="ln-2684"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2685"></a><span class="k">      write</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="s1">&#39;(2z18)&#39;</span><span class="p">)</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span>
<a name="ln-2686"></a>   <span class="k">else</span>
<a name="ln-2687"></a><span class="k">      write</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="s1">&#39;(z18)&#39;</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-2688"></a>   <span class="k">endif</span>
<a name="ln-2689"></a>
<a name="ln-2690"></a><span class="k">   call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-2691"></a>
<a name="ln-2692"></a><span class="k">end subroutine </span><span class="n">mat_formz</span>
<a name="ln-2693"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2694"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2695"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2696"></a><span class="k">subroutine </span><span class="n">mat_prompt</span><span class="p">(</span><span class="k">pause</span><span class="p">)</span>
<a name="ln-2697"></a>
<a name="ln-2698"></a><span class="c">! ident_19=&quot;@(#)M_matrix::mat_prompt(3f): issue interactive prompt with optional pause&quot;</span>
<a name="ln-2699"></a>
<a name="ln-2700"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="k">pause</span>
<a name="ln-2701"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-2702"></a>
<a name="ln-2703"></a>   <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">G_PROMPT</span><span class="p">)</span><span class="k">return</span> <span class="c">! in batch mode</span>
<a name="ln-2704"></a>   <span class="c">! write prompt using format that stays on current line</span>
<a name="ln-2705"></a>   <span class="k">if</span><span class="p">(</span><span class="n">G_INPUT_LUN</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">STDIN</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2706"></a><span class="k">     WRITE</span><span class="p">(</span><span class="n">STDOUT</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;&lt;&gt;&#39;&#39;)&#39;</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span>   <span class="c">! write prompt to interactive input</span>
<a name="ln-2707"></a>     <span class="k">if</span> <span class="p">(</span><span class="k">pause</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">read</span><span class="p">(</span><span class="n">G_INPUT_LUN</span><span class="p">,</span><span class="s1">&#39;(a1)&#39;</span><span class="p">)</span> <span class="n">dummy</span>
<a name="ln-2708"></a>   <span class="k">endif</span>
<a name="ln-2709"></a>
<a name="ln-2710"></a><span class="k">end subroutine </span><span class="n">mat_prompt</span>
<a name="ln-2711"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2712"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2713"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2714"></a><span class="k">subroutine </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
<a name="ln-2715"></a>
<a name="ln-2716"></a><span class="c">! ident_20=&quot;@(#)M_matrix::mat_stack1(3f): Unary Operations&quot;</span>
<a name="ln-2717"></a>
<a name="ln-2718"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">op</span>
<a name="ln-2719"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2720"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j</span>
<a name="ln-2721"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">location</span>
<a name="ln-2722"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-2723"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-2724"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">m</span>
<a name="ln-2725"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">mn</span>
<a name="ln-2726"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n</span>
<a name="ln-2727"></a>
<a name="ln-2728"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2729"></a>   <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2730"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2731"></a>   <span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-2732"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">mn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2733"></a><span class="k">   </span><span class="n">elseif</span> <span class="p">(</span><span class="n">op</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">quote</span><span class="p">)</span> <span class="k">then</span>                                 <span class="c">! unary minus</span>
<a name="ln-2734"></a>      <span class="k">call </span><span class="n">mat_wrscal</span><span class="p">(</span><span class="n">MN</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2735"></a>   <span class="k">else</span>                                                        <span class="c">! transpose</span>
<a name="ln-2736"></a>      <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">mn</span>
<a name="ln-2737"></a>
<a name="ln-2738"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">ll</span><span class="o">+</span><span class="n">mn</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">))</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-2739"></a>
<a name="ln-2740"></a><span class="k">      call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">MN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2741"></a>      <span class="n">M</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2742"></a>      <span class="n">N</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2743"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-2744"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2745"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-2746"></a>         <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-2747"></a>            <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">mn</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-2748"></a>            <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-2749"></a>            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2750"></a>            <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-2751"></a>         <span class="k">enddo</span>
<a name="ln-2752"></a><span class="k">      enddo</span>
<a name="ln-2753"></a><span class="k">   endif</span>
<a name="ln-2754"></a><span class="k">end subroutine </span><span class="n">mat_stack1</span>
<a name="ln-2755"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2756"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2757"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2758"></a><span class="k">subroutine </span><span class="n">mat_print_id</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">argcnt</span><span class="p">)</span>
<a name="ln-2759"></a>
<a name="ln-2760"></a><span class="c">! ident_21=&quot;@(#)M_matrix::mat_print_id(3fp): print table of variable id names (up to) eight per line&quot;</span>
<a name="ln-2761"></a>
<a name="ln-2762"></a><span class="c">!     ID     Is array of GG_MAX_NAME_LENGTH character IDs to print</span>
<a name="ln-2763"></a><span class="c">!     ARGCNT is number of IDs to print</span>
<a name="ln-2764"></a><span class="c">!            If = -1, print one ID with an &quot;  =&quot; suffix</span>
<a name="ln-2765"></a><span class="c">!</span>
<a name="ln-2766"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-2767"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">argcnt</span>
<a name="ln-2768"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">id_counter</span>                               <span class="c">!</span>
<a name="ln-2769"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-2770"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">line_position</span>                            <span class="c">! pointer into output line being built</span>
<a name="ln-2771"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">linebuf</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>      <span class="c">! scratch buffer for building up line</span>
<a name="ln-2772"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="kd">::</span> <span class="n">mline</span>           <span class="c">! scratch space for building line to print</span>
<a name="ln-2773"></a>
<a name="ln-2774"></a>   <span class="n">id_counter</span> <span class="o">=</span> <span class="mi">1</span>                                         <span class="c">! which ID to start the line with</span>
<a name="ln-2775"></a>   <span class="n">INFINITE</span> <span class="p">:</span> <span class="k">do</span>
<a name="ln-2776"></a><span class="k">      </span><span class="n">linebuf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">blank</span>                                    <span class="c">! put a space at beginning of line</span>
<a name="ln-2777"></a>      <span class="n">line_position</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-2778"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">id_counter</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">id_counter</span><span class="o">+</span><span class="mi">7</span><span class="p">,</span><span class="nb">iabs</span><span class="p">(</span><span class="n">argcnt</span><span class="p">))</span>    <span class="c">! copy up to eight names into buffer</span>
<a name="ln-2779"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">GG_MAX_NAME_LENGTH</span>                     <span class="c">! copy one name into buffer</span>
<a name="ln-2780"></a>            <span class="n">k</span> <span class="o">=</span> <span class="n">id</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>                                   <span class="c">! this is the kth letter of the set</span>
<a name="ln-2781"></a>            <span class="n">linebuf</span><span class="p">(</span><span class="n">line_position</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-2782"></a>            <span class="k">if</span><span class="p">(</span><span class="n">linebuf</span><span class="p">(</span><span class="n">line_position</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="n">blank</span><span class="p">)</span><span class="n">line_position</span> <span class="o">=</span> <span class="n">line_position</span><span class="o">+</span><span class="mi">1</span>   <span class="c">! increment pointer into output</span>
<a name="ln-2783"></a>         <span class="k">enddo</span>
<a name="ln-2784"></a><span class="k">         </span><span class="n">linebuf</span><span class="p">(</span><span class="n">line_position</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="n">blank</span>         <span class="c">! put two spaces between names</span>
<a name="ln-2785"></a>         <span class="n">linebuf</span><span class="p">(</span><span class="n">line_position</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-2786"></a>         <span class="n">line_position</span><span class="o">=</span><span class="n">line_position</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-2787"></a>      <span class="k">enddo</span>
<a name="ln-2788"></a><span class="k">      if</span> <span class="p">(</span><span class="n">argcnt</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>                            <span class="c">! special flag to print one word and  =</span>
<a name="ln-2789"></a>         <span class="n">linebuf</span><span class="p">(</span><span class="n">line_position</span><span class="p">)</span> <span class="o">=</span> <span class="n">equal</span>                   <span class="c">! put value for equal sign into buffer</span>
<a name="ln-2790"></a>      <span class="k">else</span>
<a name="ln-2791"></a><span class="k">         </span><span class="n">line_position</span><span class="o">=</span><span class="n">line_position</span><span class="o">-</span><span class="mi">3</span>                    <span class="c">! was prepared for another ID with two blanks</span>
<a name="ln-2792"></a>      <span class="k">endif</span>
<a name="ln-2793"></a>
<a name="ln-2794"></a><span class="k">      call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="n">linebuf</span><span class="p">,</span><span class="n">line_position</span><span class="p">)</span>       <span class="c">! write LINEBUF(1:line_position) line to a character variable</span>
<a name="ln-2795"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>                                 <span class="c">! print the line to stdout</span>
<a name="ln-2796"></a>
<a name="ln-2797"></a>      <span class="n">id_counter</span> <span class="o">=</span> <span class="n">id_counter</span><span class="o">+</span><span class="mi">8</span>                           <span class="c">! prepare to get up to eight more IDs</span>
<a name="ln-2798"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">id_counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="nb">iabs</span><span class="p">(</span><span class="n">argcnt</span><span class="p">))</span> <span class="k">exit </span><span class="n">INFINITE</span>     <span class="c">! if not done do another line</span>
<a name="ln-2799"></a>   <span class="k">enddo </span><span class="n">INFINITE</span>
<a name="ln-2800"></a><span class="k">end subroutine </span><span class="n">mat_print_id</span>
<a name="ln-2801"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2802"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2803"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-2804"></a><span class="k">subroutine </span><span class="n">mat_stack_put</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a><span class="c">! ident_22=&quot;@(#)M_matrix::mat_stack_put(3fp): put variables into storage&quot;</span>
<a name="ln-2807"></a>
<a name="ln-2808"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-2809"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-2810"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">ib</span>
<a name="ln-2811"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">km1</span>
<a name="ln-2812"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">location</span>
<a name="ln-2813"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span> <span class="n">li</span><span class="p">,</span><span class="n">lj</span><span class="p">,</span><span class="n">lk</span><span class="p">,</span> <span class="n">ll</span><span class="p">,</span><span class="n">ls</span><span class="p">,</span><span class="n">lt</span>
<a name="ln-2814"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">m</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span> <span class="n">mk</span>
<a name="ln-2815"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">mn</span><span class="p">,</span> <span class="n">mn1</span><span class="p">,</span> <span class="n">mn2</span><span class="p">,</span> <span class="n">mnk</span>
<a name="ln-2816"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">mt</span>
<a name="ln-2817"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">n</span><span class="p">,</span> <span class="n">nk</span><span class="p">,</span> <span class="n">nt</span>
<a name="ln-2818"></a>
<a name="ln-2819"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2820"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Improper multiple assignment</span>
<a name="ln-2821"></a>      <span class="k">return</span>
<a name="ln-2822"></a><span class="k">   endif</span>
<a name="ln-2823"></a>
<a name="ln-2824"></a><span class="k">   call </span><span class="n">mat_funs</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-2825"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2826"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c">! Can not use function name as variable</span>
<a name="ln-2827"></a>      <span class="k">return</span>
<a name="ln-2828"></a><span class="k">   endif</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a><span class="k">   </span><span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2831"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2832"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2833"></a><span class="k">      </span><span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-2834"></a>   <span class="n">elseif</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2835"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="c">! EYE-dentity undefined by CONTEXT</span>
<a name="ln-2836"></a>      <span class="k">return</span>
<a name="ln-2837"></a><span class="k">   </span><span class="n">elseif</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">n</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2838"></a><span class="k">      goto </span><span class="mi">99</span>
<a name="ln-2839"></a>   <span class="k">else</span>  <span class="c">! what about m zero and n not zero???</span>
<a name="ln-2840"></a>   <span class="k">endif</span>
<a name="ln-2841"></a>
<a name="ln-2842"></a><span class="k">   </span><span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-2843"></a>   <span class="n">lk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2844"></a>   <span class="n">mk</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2845"></a>   <span class="n">nk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2846"></a>   <span class="n">lt</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2847"></a>   <span class="n">mt</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2848"></a>   <span class="n">nt</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2849"></a>
<a name="ln-2850"></a>   <span class="c">! unconditionally add name to end of list</span>
<a name="ln-2851"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">)</span>
<a name="ln-2852"></a>
<a name="ln-2853"></a>   <span class="c">! did variable already exist (knowing name is there at least once)</span>
<a name="ln-2854"></a>   <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2855"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">:,</span><span class="n">k</span><span class="p">),</span><span class="n">id</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-2856"></a><span class="k">   enddo</span>
<a name="ln-2857"></a>
<a name="ln-2858"></a><span class="k">   if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>        <span class="c">! variable exists</span>
<a name="ln-2859"></a>      <span class="n">lk</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2860"></a>      <span class="n">mk</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2861"></a>      <span class="n">nk</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2862"></a>      <span class="n">mnk</span> <span class="o">=</span> <span class="n">mk</span><span class="o">*</span><span class="n">nk</span>
<a name="ln-2863"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2864"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>                   <span class="c">! Improper assignment to submatrix</span>
<a name="ln-2865"></a>         <span class="k">return</span>
<a name="ln-2866"></a><span class="k">      </span><span class="n">elseif</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2867"></a><span class="k">         </span><span class="n">mt</span> <span class="o">=</span> <span class="n">mk</span>
<a name="ln-2868"></a>         <span class="n">nt</span> <span class="o">=</span> <span class="n">nk</span>
<a name="ln-2869"></a>         <span class="n">lt</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">mn</span>
<a name="ln-2870"></a>         <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">lt</span> <span class="o">+</span> <span class="n">mnk</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-2871"></a><span class="k">            return</span>
<a name="ln-2872"></a><span class="k">         endif</span>
<a name="ln-2873"></a><span class="k">         call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">mnk</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lt</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lt</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2874"></a>      <span class="k">endif</span>
<a name="ln-2875"></a>
<a name="ln-2876"></a>      <span class="c">! does it fit</span>
<a name="ln-2877"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">mn</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">mnk</span><span class="p">)</span> <span class="k">then</span>    <span class="c">! size of existing array did not change</span>
<a name="ln-2878"></a>         <span class="k">goto </span><span class="mi">40</span>
<a name="ln-2879"></a>      <span class="k">endif</span>
<a name="ln-2880"></a>
<a name="ln-2881"></a><span class="k">      if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2882"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c">! Improper assignment to PERMANENT VARIABLE</span>
<a name="ln-2883"></a>         <span class="k">return</span>
<a name="ln-2884"></a><span class="k">      endif</span>
<a name="ln-2885"></a>
<a name="ln-2886"></a><span class="k">      if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2887"></a>         <span class="c">! shift storage</span>
<a name="ln-2888"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span>
<a name="ln-2889"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="n">ls</span> <span class="o">+</span> <span class="n">mnk</span>
<a name="ln-2890"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">lk</span><span class="o">-</span><span class="n">ls</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2891"></a>         <span class="n">km1</span> <span class="o">=</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2892"></a>         <span class="k">do </span><span class="n">ib</span> <span class="o">=</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">,</span> <span class="n">km1</span>
<a name="ln-2893"></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">+</span><span class="n">km1</span><span class="o">-</span><span class="n">ib</span>
<a name="ln-2894"></a>            <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-2895"></a>            <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2896"></a>            <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2897"></a>            <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">mnk</span>
<a name="ln-2898"></a>         <span class="k">enddo</span>
<a name="ln-2899"></a><span class="k">      endif</span>
<a name="ln-2900"></a>
<a name="ln-2901"></a>      <span class="c">! destroy old variable</span>
<a name="ln-2902"></a>      <span class="n">G_TOP_OF_SAVED</span> <span class="o">=</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2903"></a>   <span class="k">endif</span>
<a name="ln-2904"></a><span class="c">!</span>
<a name="ln-2905"></a>   <span class="c">! create new variable</span>
<a name="ln-2906"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">mn</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2907"></a><span class="k">      goto </span><span class="mi">99</span>
<a name="ln-2908"></a>   <span class="k">endif</span>
<a name="ln-2909"></a>
<a name="ln-2910"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">2</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2911"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="c">! Too many names</span>
<a name="ln-2912"></a>      <span class="k">return</span>
<a name="ln-2913"></a><span class="k">   endif</span>
<a name="ln-2914"></a>
<a name="ln-2915"></a><span class="k">   </span><span class="n">k</span> <span class="o">=</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2916"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">id</span><span class="p">)</span>
<a name="ln-2917"></a>
<a name="ln-2918"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2919"></a>      <span class="c">!  vect(arg)</span>
<a name="ln-2920"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2921"></a><span class="k">         goto </span><span class="mi">59</span>
<a name="ln-2922"></a>      <span class="k">endif</span>
<a name="ln-2923"></a><span class="k">      </span><span class="n">mn1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2924"></a>      <span class="n">mn2</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2925"></a>      <span class="n">l1</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2926"></a>      <span class="n">l2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2927"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">nk</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2928"></a><span class="k">         if</span> <span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mk</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2929"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="c">! Improper assignment to submatrix</span>
<a name="ln-2930"></a>            <span class="k">return</span>
<a name="ln-2931"></a><span class="k">         endif</span>
<a name="ln-2932"></a><span class="k">         </span><span class="n">l2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2933"></a>         <span class="n">m2</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2934"></a>         <span class="n">mn2</span> <span class="o">=</span> <span class="n">m2</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2935"></a>         <span class="n">m1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2936"></a>         <span class="k">goto </span><span class="mi">60</span>
<a name="ln-2937"></a>      <span class="k">endif</span>
<a name="ln-2938"></a><span class="k">      </span><span class="n">l1</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2939"></a>      <span class="n">m1</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2940"></a>      <span class="n">mn1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2941"></a>      <span class="n">m2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2942"></a>      <span class="k">goto </span><span class="mi">60</span>
<a name="ln-2943"></a>   <span class="n">elseif</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2944"></a>      <span class="c">! matrix(arg,arg)</span>
<a name="ln-2945"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">2</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2946"></a><span class="k">         goto </span><span class="mi">59</span>
<a name="ln-2947"></a>      <span class="k">endif</span>
<a name="ln-2948"></a><span class="k">      </span><span class="n">l2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2949"></a>      <span class="n">m2</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2950"></a>      <span class="n">mn2</span> <span class="o">=</span> <span class="n">m2</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2951"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">mn2</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2952"></a>      <span class="n">l1</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2953"></a>      <span class="n">m1</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2954"></a>      <span class="n">mn1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2955"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m1</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">mn1</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-2956"></a>      <span class="k">goto </span><span class="mi">60</span>
<a name="ln-2957"></a>   <span class="k">endif</span>
<a name="ln-2958"></a><span class="c">!</span>
<a name="ln-2959"></a><span class="c">!  STORE</span>
<a name="ln-2960"></a><span class="mi">40</span> <span class="k">continue</span>
<a name="ln-2961"></a><span class="k">   if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">mn</span>
<a name="ln-2962"></a>   <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-2963"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-2964"></a>
<a name="ln-2965"></a>   <span class="n">lk</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2966"></a>   <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2967"></a>   <span class="k">goto </span><span class="mi">90</span>
<a name="ln-2968"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2969"></a><span class="mi">59</span> <span class="k">continue</span>
<a name="ln-2970"></a><span class="k">   if</span> <span class="p">(</span><span class="n">mn</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">mnk</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2971"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="c">! Improper assignment to submatrix</span>
<a name="ln-2972"></a>      <span class="k">return</span>
<a name="ln-2973"></a><span class="k">   endif</span>
<a name="ln-2974"></a>
<a name="ln-2975"></a><span class="k">   </span><span class="n">lk</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-2976"></a>   <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2977"></a>   <span class="k">goto </span><span class="mi">90</span>
<a name="ln-2978"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2979"></a><span class="mi">60</span> <span class="k">continue</span>
<a name="ln-2980"></a><span class="k">   if</span> <span class="p">(</span><span class="n">mn1</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">m</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mn2</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2981"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="c">! Improper assignment to submatrix</span>
<a name="ln-2982"></a>      <span class="k">return</span>
<a name="ln-2983"></a><span class="k">   endif</span>
<a name="ln-2984"></a><span class="k">   </span><span class="n">ll</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2985"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">m1</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2986"></a><span class="k">      do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn1</span>
<a name="ln-2987"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">l1</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2988"></a>         <span class="n">mk</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mk</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)))</span>
<a name="ln-2989"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)))</span>
<a name="ln-2990"></a>      <span class="k">enddo</span>
<a name="ln-2991"></a><span class="k">   endif</span>
<a name="ln-2992"></a>
<a name="ln-2993"></a><span class="k">   </span><span class="n">mk</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mk</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
<a name="ln-2994"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2995"></a><span class="k">      do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn2</span>
<a name="ln-2996"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2997"></a>         <span class="n">nk</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nk</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)))</span>
<a name="ln-2998"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)))</span>
<a name="ln-2999"></a>      <span class="k">enddo</span>
<a name="ln-3000"></a><span class="k">   endif</span>
<a name="ln-3001"></a><span class="k">   </span><span class="n">nk</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nk</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-3002"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ll</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3003"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="c">! Subscript out of range</span>
<a name="ln-3004"></a>      <span class="k">return</span>
<a name="ln-3005"></a><span class="k">   endif</span>
<a name="ln-3006"></a><span class="k">   </span><span class="n">mnk</span> <span class="o">=</span> <span class="n">mk</span><span class="o">*</span><span class="n">nk</span>
<a name="ln-3007"></a>   <span class="n">lk</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">mnk</span>
<a name="ln-3008"></a>
<a name="ln-3009"></a>   <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">lt</span> <span class="o">+</span> <span class="n">mt</span><span class="o">*</span><span class="n">nt</span> <span class="o">-</span> <span class="n">lk</span><span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-3010"></a>
<a name="ln-3011"></a><span class="k">   </span><span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">lk</span>
<a name="ln-3012"></a>   <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">mk</span>
<a name="ln-3013"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">nk</span>
<a name="ln-3014"></a>   <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">mnk</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3015"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">nt</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3016"></a><span class="k">      do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nt</span>
<a name="ln-3017"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">lt</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mt</span>
<a name="ln-3018"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="n">lk</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mk</span>
<a name="ln-3019"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">mt</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3020"></a>      <span class="k">enddo</span>
<a name="ln-3021"></a><span class="k">   endif</span>
<a name="ln-3022"></a>
<a name="ln-3023"></a><span class="k">   do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3024"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-3025"></a>         <span class="n">li</span> <span class="o">=</span> <span class="n">l1</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3026"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">m1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">li</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">li</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-3027"></a>         <span class="n">lj</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3028"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">lj</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lj</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-3029"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="n">lk</span><span class="o">+</span><span class="n">li</span><span class="o">-</span><span class="n">l1</span><span class="o">+</span><span class="p">(</span><span class="n">lj</span><span class="o">-</span><span class="n">l2</span><span class="p">)</span><span class="o">*</span><span class="n">mk</span>
<a name="ln-3030"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-3031"></a>         <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-3032"></a>         <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-3033"></a>      <span class="k">enddo</span>
<a name="ln-3034"></a><span class="k">   enddo</span>
<a name="ln-3035"></a><span class="k">   goto </span><span class="mi">90</span>
<a name="ln-3036"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3037"></a><span class="c">! print if desired and pop stack</span>
<a name="ln-3038"></a><span class="mi">90</span> <span class="k">continue</span>
<a name="ln-3039"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">semi</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_print</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="c">! if not a semi-colon and &quot;semi&quot; mode print</span>
<a name="ln-3040"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">semi</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_print</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="c">! if a semi-colon and &quot;semi&quot; mode off print</span>
<a name="ln-3041"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">G_TOP_OF_SAVED</span> <span class="o">=</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3042"></a>
<a name="ln-3043"></a><span class="mi">99</span> <span class="k">continue</span>
<a name="ln-3044"></a><span class="k">   if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3045"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-3046"></a>   <span class="k">else</span>
<a name="ln-3047"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">G_RHS</span>
<a name="ln-3048"></a>   <span class="k">endif</span>
<a name="ln-3049"></a><span class="k">end subroutine </span><span class="n">MAT_STACK_PUT</span>
<a name="ln-3050"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3051"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-3052"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3053"></a><span class="c">!&gt;</span>
<a name="ln-3054"></a><span class="c">!!##THE PARSER-INTERPRETER (10)</span>
<a name="ln-3055"></a><span class="c">!!</span>
<a name="ln-3056"></a><span class="c">!!    The structure of the parser-interpreter is similar to that of Wirth&#39;s</span>
<a name="ln-3057"></a><span class="c">!!    compiler [6] for his simple language, PL/0 , except that LALA is</span>
<a name="ln-3058"></a><span class="c">!!    programmed in Fortran, which does not have explicit recursion. The</span>
<a name="ln-3059"></a><span class="c">!!    interrelation of the primary subroutines is shown in the following</span>
<a name="ln-3060"></a><span class="c">!!    diagram.</span>
<a name="ln-3061"></a><span class="c">!!</span>
<a name="ln-3062"></a><span class="c">!!          MAIN</span>
<a name="ln-3063"></a><span class="c">!!            |</span>
<a name="ln-3064"></a><span class="c">!!          LALA     |--CLAUSE</span>
<a name="ln-3065"></a><span class="c">!!            |       |    |</span>
<a name="ln-3066"></a><span class="c">!!          PARSE-----|--EXPR----TERM----FACTOR</span>
<a name="ln-3067"></a><span class="c">!!                    |    |       |       |</span>
<a name="ln-3068"></a><span class="c">!!                    |    |-------|-------|</span>
<a name="ln-3069"></a><span class="c">!!                    |    |       |       |</span>
<a name="ln-3070"></a><span class="c">!!                    |  STACK1  STACK2  STACKG</span>
<a name="ln-3071"></a><span class="c">!!                    |</span>
<a name="ln-3072"></a><span class="c">!!                    |--STACKP--PRINT</span>
<a name="ln-3073"></a><span class="c">!!                    |</span>
<a name="ln-3074"></a><span class="c">!!                    |--COMAND</span>
<a name="ln-3075"></a><span class="c">!!                    |</span>
<a name="ln-3076"></a><span class="c">!!                    |</span>
<a name="ln-3077"></a><span class="c">!!                    |          |--CGECO</span>
<a name="ln-3078"></a><span class="c">!!                    |          |</span>
<a name="ln-3079"></a><span class="c">!!                    |          |--CGEFA</span>
<a name="ln-3080"></a><span class="c">!!                    |          |</span>
<a name="ln-3081"></a><span class="c">!!                    |--MATFN1--|--CGESL</span>
<a name="ln-3082"></a><span class="c">!!                    |          |</span>
<a name="ln-3083"></a><span class="c">!!                    |          |--CGEDI</span>
<a name="ln-3084"></a><span class="c">!!                    |          |</span>
<a name="ln-3085"></a><span class="c">!!                    |          |--CPOFA</span>
<a name="ln-3086"></a><span class="c">!!                    |</span>
<a name="ln-3087"></a><span class="c">!!                    |</span>
<a name="ln-3088"></a><span class="c">!!                    |          |--IMTQL2</span>
<a name="ln-3089"></a><span class="c">!!                    |          |</span>
<a name="ln-3090"></a><span class="c">!!                    |          |--HTRIDI</span>
<a name="ln-3091"></a><span class="c">!!                    |          |</span>
<a name="ln-3092"></a><span class="c">!!                    |--MATFN2--|--HTRIBK</span>
<a name="ln-3093"></a><span class="c">!!                    |          |</span>
<a name="ln-3094"></a><span class="c">!!                    |          |--CORTH</span>
<a name="ln-3095"></a><span class="c">!!                    |          |</span>
<a name="ln-3096"></a><span class="c">!!                    |          |--COMQR3</span>
<a name="ln-3097"></a><span class="c">!!                    |</span>
<a name="ln-3098"></a><span class="c">!!                    |</span>
<a name="ln-3099"></a><span class="c">!!                    |--MATFN3-----CSVDC</span>
<a name="ln-3100"></a><span class="c">!!                    |</span>
<a name="ln-3101"></a><span class="c">!!                    |</span>
<a name="ln-3102"></a><span class="c">!!                    |          |--CQRDC</span>
<a name="ln-3103"></a><span class="c">!!                    |--MATFN4--|</span>
<a name="ln-3104"></a><span class="c">!!                    |          |--CQRSL</span>
<a name="ln-3105"></a><span class="c">!!                    |</span>
<a name="ln-3106"></a><span class="c">!!                    |</span>
<a name="ln-3107"></a><span class="c">!!                    |          |--FILES</span>
<a name="ln-3108"></a><span class="c">!!                    |--MATFN5--|</span>
<a name="ln-3109"></a><span class="c">!!                               |--SAVLOD</span>
<a name="ln-3110"></a><span class="c">!!</span>
<a name="ln-3111"></a><span class="c">!!    Subroutine MAT_PARSE controls the interpretation of each statement. It</span>
<a name="ln-3112"></a><span class="c">!!    calls subroutines that process the various syntactic quantities such</span>
<a name="ln-3113"></a><span class="c">!!    as command, expression, term and factor. A fairly simple program</span>
<a name="ln-3114"></a><span class="c">!!    stack mechanism allows these subroutines to recursively &quot;call&quot;</span>
<a name="ln-3115"></a><span class="c">!!    each other along the lines allowed by the syntax diagrams. The four</span>
<a name="ln-3116"></a><span class="c">!!    STACK subroutines manage the variable memory and perform elementary</span>
<a name="ln-3117"></a><span class="c">!!    operations, such as matrix addition and transposition.</span>
<a name="ln-3118"></a><span class="c">!!</span>
<a name="ln-3119"></a><span class="c">!!    The four subroutines MATFN1 though MATFN4 are called whenever &quot;serious&quot;</span>
<a name="ln-3120"></a><span class="c">!!    matrix computations are required. They are interface routines which</span>
<a name="ln-3121"></a><span class="c">!!    call the various LINPACK and EISPACK subroutines. MATFN5 primarily</span>
<a name="ln-3122"></a><span class="c">!!    handles the file access tasks.</span>
<a name="ln-3123"></a><span class="k">SUBROUTINE </span><span class="n">mat_parse</span><span class="p">()</span>
<a name="ln-3124"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-3125"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">excnt</span>
<a name="ln-3126"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">pts</span>
<a name="ln-3127"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">ans</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>  <span class="o">=</span> <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-3128"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">ennd</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-3129"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="k">else</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-3130"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3131"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">r</span>
<a name="ln-3132"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">i5</span>
<a name="ln-3133"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-3134"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">j</span>
<a name="ln-3135"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">k</span>
<a name="ln-3136"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">location</span>
<a name="ln-3137"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-3138"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">n</span>
<a name="ln-3139"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">symbol</span>
<a name="ln-3140"></a><span class="c">!</span>
<a name="ln-3141"></a>   <span class="mi">01</span> <span class="k">continue</span>
<a name="ln-3142"></a><span class="k">      </span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3143"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">G_PTZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3144"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_PT</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">G_PTZ</span><span class="p">)</span> <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3145"></a>
<a name="ln-3146"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">15</span><span class="p">)</span> <span class="k">goto </span><span class="mi">93</span>
<a name="ln-3147"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">16</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">r</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">17</span><span class="p">)</span> <span class="k">goto </span><span class="mi">94</span>
<a name="ln-3148"></a>      <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">GG_EOL</span>
<a name="ln-3149"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3150"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RIO</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">G_INPUT_LUN</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="o">-</span><span class="n">G_RIO</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-3151"></a>      <span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_INPUT_LUN</span>
<a name="ln-3152"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3153"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-3154"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3155"></a>   <span class="mi">10</span> <span class="k">continue</span>  <span class="c">! get a new line if the current line has ended</span>
<a name="ln-3156"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">mod</span><span class="p">(</span><span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_prompt</span><span class="p">(</span><span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3157"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getlin</span><span class="p">()</span>
<a name="ln-3158"></a>      <span class="n">G_ERR</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3159"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PTZ</span>
<a name="ln-3160"></a>
<a name="ln-3161"></a>   <span class="mi">15</span> <span class="k">continue</span>   <span class="c">! (continue) processing current line</span>
<a name="ln-3162"></a>      <span class="n">excnt</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3163"></a>      <span class="n">G_LHS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3164"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">ans</span><span class="p">)</span> <span class="c">! copy ans to id</span>
<a name="ln-3165"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3166"></a>
<a name="ln-3167"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">colon</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3168"></a><span class="k">         call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3169"></a>      <span class="k">endif</span>
<a name="ln-3170"></a>
<a name="ln-3171"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">SEMI</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">COMMA</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">goto </span><span class="mi">80</span>
<a name="ln-3172"></a>
<a name="ln-3173"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">isname</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3174"></a>         <span class="c">! lhs begins with name</span>
<a name="ln-3175"></a>         <span class="k">call </span><span class="n">ints2str</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">symbol</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>              <span class="c">! convert ID to a character variable</span>
<a name="ln-3176"></a>         <span class="k">call </span><span class="n">mat_comand</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
<a name="ln-3177"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3178"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_FUN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">99</span><span class="p">)</span> <span class="k">goto </span><span class="mi">95</span>
<a name="ln-3179"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="o">-</span><span class="mi">15</span><span class="p">)</span> <span class="k">goto </span><span class="mi">80</span>
<a name="ln-3180"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">91</span>
<a name="ln-3181"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">70</span>
<a name="ln-3182"></a>         <span class="c">! if name is a function, must be rhs</span>
<a name="ln-3183"></a>         <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3184"></a>         <span class="k">call </span><span class="n">mat_funs</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-3185"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3186"></a><span class="k">            goto </span><span class="mi">50</span>
<a name="ln-3187"></a>         <span class="k">endif</span>
<a name="ln-3188"></a>         <span class="c">! peek one character ahead</span>
<a name="ln-3189"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SEMI</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">COMMA</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-3190"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">EQUAL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3191"></a>            <span class="c">! lhs is simple variable</span>
<a name="ln-3192"></a>            <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-3193"></a>            <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3194"></a>            <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3195"></a>            <span class="k">goto </span><span class="mi">50</span>
<a name="ln-3196"></a>         <span class="k">endif</span>
<a name="ln-3197"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">LPAREN</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">LBRACE</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3198"></a>            <span class="c">! lhs is name(...)</span>
<a name="ln-3199"></a>            <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3200"></a>            <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-3201"></a>            <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3202"></a>            <span class="k">goto </span><span class="mi">32</span>
<a name="ln-3203"></a>         <span class="k">endif</span>
<a name="ln-3204"></a><span class="k">         goto </span><span class="mi">50</span>
<a name="ln-3205"></a>      <span class="k">endif</span>
<a name="ln-3206"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">less</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">lbracket</span><span class="p">)</span> <span class="k">goto </span><span class="mi">40</span>
<a name="ln-3207"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">great</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">rbracket</span><span class="p">)</span> <span class="k">goto </span><span class="mi">45</span>
<a name="ln-3208"></a>      <span class="k">goto </span><span class="mi">50</span>
<a name="ln-3209"></a><span class="c">!.......................................................................</span>
<a name="ln-3210"></a><span class="c">!     lhs is name(...)</span>
<a name="ln-3211"></a>   <span class="mi">32</span> <span class="k">continue</span>
<a name="ln-3212"></a><span class="k">      call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3213"></a>      <span class="n">excnt</span> <span class="o">=</span> <span class="n">excnt</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3214"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3215"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">),</span> <span class="n">id</span><span class="p">)</span>
<a name="ln-3216"></a>      <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">excnt</span>
<a name="ln-3217"></a>      <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3218"></a><span class="c">!     *call* expr</span>
<a name="ln-3219"></a>      <span class="k">goto </span><span class="mi">92</span>
<a name="ln-3220"></a><span class="c">!.......................................................................</span>
<a name="ln-3221"></a>   <span class="mi">35</span> <span class="k">continue</span>
<a name="ln-3222"></a><span class="k">      call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">))</span>
<a name="ln-3223"></a>      <span class="n">excnt</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3224"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3225"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">comma</span><span class="p">)</span> <span class="k">goto </span><span class="mi">32</span>
<a name="ln-3226"></a>      <span class="k">if</span> <span class="p">((</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">rparen</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">rbrace</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3227"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3228"></a>         <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3229"></a>         <span class="k">return</span>  <span class="c">! ???? cannot unconditionally goto and return</span>
<a name="ln-3230"></a>      <span class="k">endif</span>
<a name="ln-3231"></a><span class="k">      if</span> <span class="p">((</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">rparen</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">rbrace</span><span class="p">))</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3232"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">equal</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-3233"></a><span class="c">!     lhs is really rhs, forget scan just done</span>
<a name="ln-3234"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="n">excnt</span>
<a name="ln-3235"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3236"></a>      <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">lparen</span>
<a name="ln-3237"></a>      <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">isname</span>
<a name="ln-3238"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">id</span><span class="p">)</span>
<a name="ln-3239"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">ans</span><span class="p">)</span>
<a name="ln-3240"></a>      <span class="n">excnt</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3241"></a>      <span class="k">goto </span><span class="mi">50</span>
<a name="ln-3242"></a><span class="c">!.......................................................................</span>
<a name="ln-3243"></a><span class="c">!     multiple lhs</span>
<a name="ln-3244"></a>   <span class="mi">40</span> <span class="k">continue</span>
<a name="ln-3245"></a><span class="k">      </span><span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3246"></a>      <span class="n">pts</span> <span class="o">=</span> <span class="n">G_PT</span>
<a name="ln-3247"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3248"></a>   <span class="mi">41</span> <span class="k">continue</span>
<a name="ln-3249"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">isname</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3250"></a><span class="k">         goto </span><span class="mi">43</span>
<a name="ln-3251"></a>      <span class="k">endif</span>
<a name="ln-3252"></a><span class="k">      call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-3253"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3254"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">great</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">rbracket</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3255"></a><span class="k">         call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3256"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">equal</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-3257"></a>         <span class="k">goto </span><span class="mi">43</span>
<a name="ln-3258"></a>      <span class="k">endif</span>
<a name="ln-3259"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">comma</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3260"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3261"></a>      <span class="n">G_LHS</span> <span class="o">=</span> <span class="n">G_LHS</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3262"></a>      <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3263"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">),</span><span class="n">id</span><span class="p">)</span>
<a name="ln-3264"></a>      <span class="k">goto </span><span class="mi">41</span>
<a name="ln-3265"></a><span class="c">!.......................................................................</span>
<a name="ln-3266"></a>   <span class="mi">43</span> <span class="k">continue</span>
<a name="ln-3267"></a><span class="k">      </span><span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3268"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">pts</span>
<a name="ln-3269"></a>      <span class="n">G_LHS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3270"></a>      <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">less</span>
<a name="ln-3271"></a>      <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3272"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">ans</span><span class="p">)</span>
<a name="ln-3273"></a>      <span class="k">goto </span><span class="mi">50</span>
<a name="ln-3274"></a><span class="c">!.......................................................................</span>
<a name="ln-3275"></a><span class="c">!     macros string</span>
<a name="ln-3276"></a>   <span class="mi">45</span> <span class="k">continue</span>
<a name="ln-3277"></a><span class="k">      call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3278"></a>      <span class="k">if</span> <span class="p">((</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">less</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3279"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="c">! Empty macro</span>
<a name="ln-3280"></a>         <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3281"></a>      <span class="k">endif</span>
<a name="ln-3282"></a><span class="k">      </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3283"></a>      <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">20</span>
<a name="ln-3284"></a><span class="c">!     *call* expr</span>
<a name="ln-3285"></a>      <span class="k">goto </span><span class="mi">92</span>
<a name="ln-3286"></a><span class="c">!.......................................................................</span>
<a name="ln-3287"></a>   <span class="mi">46</span> <span class="k">continue</span>
<a name="ln-3288"></a><span class="k">      </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3289"></a>      <span class="k">if</span> <span class="p">((</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">less</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3290"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="c">! Improper MACROS</span>
<a name="ln-3291"></a>         <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3292"></a>      <span class="k">endif</span>
<a name="ln-3293"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">less</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">lbracket</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3294"></a>      <span class="n">k</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3295"></a>      <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3296"></a>      <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3297"></a>      <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3298"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">4</span>
<a name="ln-3299"></a><span class="c">!     transfer stack to input line</span>
<a name="ln-3300"></a>      <span class="n">k</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3301"></a>      <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-3302"></a>      <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-3303"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3304"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3305"></a>         <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span>
<a name="ln-3306"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">ge</span><span class="p">.</span><span class="n">G_CHARSET_SIZE</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3307"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="c">! improper MACROS</span>
<a name="ln-3308"></a>            <span class="k">return</span>
<a name="ln-3309"></a><span class="k">         endif</span>
<a name="ln-3310"></a><span class="k">         if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1024</span><span class="p">)</span> <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3311"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1024</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3312"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39; input buffer limit is&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;characters&#39;</span><span class="p">)</span>
<a name="ln-3313"></a>          <span class="k">endif</span>
<a name="ln-3314"></a><span class="k">      enddo</span>
<a name="ln-3315"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3316"></a>      <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">GG_EOL</span><span class="p">;</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-3317"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-3318"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3319"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3320"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3321"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3322"></a>      <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">blank</span>
<a name="ln-3323"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3324"></a>      <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3325"></a>      <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">21</span>
<a name="ln-3326"></a><span class="c">!     *call* parse</span>
<a name="ln-3327"></a>      <span class="k">goto </span><span class="mi">15</span>
<a name="ln-3328"></a><span class="c">!.......................................................................</span>
<a name="ln-3329"></a>   <span class="mi">49</span> <span class="k">continue</span>
<a name="ln-3330"></a><span class="k">      </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3331"></a>      <span class="n">k</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
<a name="ln-3332"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3333"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3334"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3335"></a>      <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">BLANK</span>
<a name="ln-3336"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3337"></a>      <span class="k">goto </span><span class="mi">80</span>
<a name="ln-3338"></a><span class="c">!.......................................................................</span>
<a name="ln-3339"></a><span class="c">!     lhs finished, start rhs</span>
<a name="ln-3340"></a>   <span class="mi">50</span> <span class="k">continue</span>
<a name="ln-3341"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">equal</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3342"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3343"></a>      <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">),</span><span class="n">id</span><span class="p">)</span>
<a name="ln-3344"></a>      <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">excnt</span>
<a name="ln-3345"></a>      <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-3346"></a><span class="c">!     *call* expr</span>
<a name="ln-3347"></a>      <span class="k">goto </span><span class="mi">92</span>
<a name="ln-3348"></a><span class="c">!.......................................................................</span>
<a name="ln-3349"></a><span class="c">!     store results</span>
<a name="ln-3350"></a>   <span class="mi">60</span> <span class="k">continue</span>
<a name="ln-3351"></a><span class="k">      </span><span class="n">G_RHS</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3352"></a>      <span class="k">call </span><span class="n">MAT_STACK_PUT</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">))</span>
<a name="ln-3353"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3354"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3355"></a>      <span class="n">G_LHS</span> <span class="o">=</span> <span class="n">G_LHS</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3356"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LHS</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-3357"></a>      <span class="k">goto </span><span class="mi">70</span>
<a name="ln-3358"></a><span class="c">!.......................................................................</span>
<a name="ln-3359"></a><span class="c">!     update and possibly print operation counts</span>
<a name="ln-3360"></a>   <span class="mi">70</span> <span class="k">continue</span>
<a name="ln-3361"></a><span class="k">      </span><span class="n">k</span> <span class="o">=</span> <span class="n">G_FLOP_COUNTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3362"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-3363"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">dble</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-3364"></a>      <span class="n">G_FLOP_COUNTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3365"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">comma</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">comma</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)))</span><span class="k">goto </span><span class="mi">80</span>
<a name="ln-3366"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3367"></a>      <span class="n">i5</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span>
<a name="ln-3368"></a>
<a name="ln-3369"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3370"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;   no flops&#39;</span><span class="p">)</span>
<a name="ln-3371"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3372"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;    1 flop&#39;</span><span class="p">)</span>
<a name="ln-3373"></a>      <span class="k">else</span>
<a name="ln-3374"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39; flops&#39;</span><span class="p">)</span>
<a name="ln-3375"></a>      <span class="k">endif</span>
<a name="ln-3376"></a><span class="k">      goto </span><span class="mi">80</span>
<a name="ln-3377"></a><span class="c">!.......................................................................</span>
<a name="ln-3378"></a><span class="c">!     finish statement</span>
<a name="ln-3379"></a>   <span class="mi">80</span> <span class="k">continue</span>
<a name="ln-3380"></a><span class="k">      </span><span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3381"></a>      <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3382"></a>      <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3383"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_PT</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">p</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3384"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_PT</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3385"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">comma</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">semi</span><span class="p">)</span> <span class="k">goto </span><span class="mi">15</span>
<a name="ln-3386"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">21</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">p</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">goto </span><span class="mi">49</span>
<a name="ln-3387"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_PT</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">G_PTZ</span><span class="p">)</span> <span class="k">goto </span><span class="mi">91</span>
<a name="ln-3388"></a>      <span class="k">goto </span><span class="mi">10</span>
<a name="ln-3389"></a><span class="c">!.......................................................................</span>
<a name="ln-3390"></a><span class="c">!     simulate recursion</span>
<a name="ln-3391"></a><span class="c">!.......................................................................</span>
<a name="ln-3392"></a>   <span class="mi">91</span> <span class="k">continue</span>
<a name="ln-3393"></a><span class="k">      call </span><span class="n">mat_clause</span><span class="p">()</span>
<a name="ln-3394"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3395"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_PT</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">G_PTZ</span><span class="p">)</span> <span class="k">goto </span><span class="mi">15</span>
<a name="ln-3396"></a>      <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3397"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a name="ln-3398"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">);</span>   <span class="k">goto </span><span class="mi">92</span>
<a name="ln-3399"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">13</span><span class="p">:</span><span class="mi">14</span><span class="p">);</span> <span class="k">goto </span><span class="mi">15</span>
<a name="ln-3400"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">21</span><span class="p">);</span>    <span class="k">goto </span><span class="mi">49</span>
<a name="ln-3401"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-3402"></a>         <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;INTERNAL ERROR 91&#39;</span>
<a name="ln-3403"></a>         <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="c">! recursion difficulties</span>
<a name="ln-3404"></a>         <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3405"></a>      <span class="k">end select</span>
<a name="ln-3406"></a><span class="c">!.......................................................................</span>
<a name="ln-3407"></a>   <span class="mi">92</span> <span class="k">CONTINUE</span>
<a name="ln-3408"></a><span class="k">      call </span><span class="n">mat_expr</span><span class="p">()</span>
<a name="ln-3409"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3410"></a>      <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3411"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a name="ln-3412"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>     <span class="k">goto </span><span class="mi">35</span>
<a name="ln-3413"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3414"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">semi</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">comma</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-3415"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">isname</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="k">else</span><span class="p">))</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-3416"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">isname</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">ennd</span><span class="p">))</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-3417"></a>         <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<a name="ln-3418"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3419"></a>         <span class="k">goto </span><span class="mi">60</span>
<a name="ln-3420"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">);</span>   <span class="k">goto </span><span class="mi">91</span>
<a name="ln-3421"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">);</span>   <span class="k">goto </span><span class="mi">93</span>
<a name="ln-3422"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">11</span><span class="p">);</span> <span class="k">goto </span><span class="mi">94</span>
<a name="ln-3423"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">18</span><span class="p">:</span><span class="mi">19</span><span class="p">);</span> <span class="k">goto </span><span class="mi">94</span>
<a name="ln-3424"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>    <span class="k">goto </span><span class="mi">46</span>
<a name="ln-3425"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-3426"></a>         <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;Internal error 92&#39;</span>
<a name="ln-3427"></a>         <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="c">! recursion difficulties</span>
<a name="ln-3428"></a>         <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3429"></a>      <span class="k">end select</span>
<a name="ln-3430"></a><span class="c">!.......................................................................</span>
<a name="ln-3431"></a>   <span class="mi">93</span> <span class="k">continue</span>
<a name="ln-3432"></a><span class="k">      call </span><span class="n">mat_term</span><span class="p">()</span>
<a name="ln-3433"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3434"></a>      <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3435"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a name="ln-3436"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">);</span>   <span class="k">goto </span><span class="mi">92</span>
<a name="ln-3437"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">9</span><span class="p">);</span>   <span class="k">goto </span><span class="mi">94</span>
<a name="ln-3438"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>    <span class="k">goto </span><span class="mi">95</span>
<a name="ln-3439"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-3440"></a>         <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;INTERNAL ERROR 93&#39;</span>
<a name="ln-3441"></a>         <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="c">! recursion difficulties</span>
<a name="ln-3442"></a>         <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3443"></a>      <span class="k">end select</span>
<a name="ln-3444"></a><span class="c">!.......................................................................</span>
<a name="ln-3445"></a>   <span class="mi">94</span> <span class="k">continue</span>
<a name="ln-3446"></a><span class="k">      call </span><span class="n">mat_factor</span><span class="p">()</span>
<a name="ln-3447"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3448"></a>      <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-3449"></a>      <span class="k">select case</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a name="ln-3450"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">9</span><span class="p">);</span>   <span class="k">goto </span><span class="mi">93</span>
<a name="ln-3451"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">11</span><span class="p">);</span> <span class="k">goto </span><span class="mi">92</span>
<a name="ln-3452"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span>    <span class="k">goto </span><span class="mi">94</span>
<a name="ln-3453"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">16</span><span class="p">:</span><span class="mi">17</span><span class="p">);</span> <span class="k">goto </span><span class="mi">95</span>
<a name="ln-3454"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">18</span><span class="p">:</span><span class="mi">19</span><span class="p">);</span> <span class="k">goto </span><span class="mi">92</span>
<a name="ln-3455"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-3456"></a>         <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;INTERNAL ERROR 94&#39;</span>
<a name="ln-3457"></a>         <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="c">! recursion difficulties</span>
<a name="ln-3458"></a>         <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3459"></a>      <span class="k">end select</span>
<a name="ln-3460"></a><span class="c">!.......................................................................</span>
<a name="ln-3461"></a><span class="c">!     call mat_matfns by returning to LALA</span>
<a name="ln-3462"></a>   <span class="mi">95</span> <span class="k">continue</span>
<a name="ln-3463"></a><span class="k">      if</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3464"></a>         <span class="c">!call journal(&#39;sc&#39;,&#39;*mat_parse* stack emptied&#39;,G_ARGUMENT_POINTER)</span>
<a name="ln-3465"></a>      <span class="k">else</span>
<a name="ln-3466"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_FIN</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-3467"></a>      <span class="k">endif</span>
<a name="ln-3468"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-3469"></a>      <span class="k">return</span>
<a name="ln-3470"></a><span class="c">!.......................................................................</span>
<a name="ln-3471"></a><span class="k">end subroutine </span><span class="n">mat_parse</span>
<a name="ln-3472"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3473"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-3474"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3475"></a><span class="k">subroutine </span><span class="n">mat_comand</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-3476"></a>
<a name="ln-3477"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">id</span>
<a name="ln-3478"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">chr</span>
<a name="ln-3479"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-3480"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">l</span>
<a name="ln-3481"></a>
<a name="ln-3482"></a><span class="c">! a list of names this procedure matches to use for some preliminary tests</span>
<a name="ln-3483"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">cmd</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">=</span><span class="p">[</span> <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="p">&amp;</span>
<a name="ln-3484"></a> <span class="p">&amp;</span> <span class="s1">&#39;clear&#39;</span><span class="p">,</span> <span class="s1">&#39;else&#39;</span><span class="p">,</span>  <span class="s1">&#39;end&#39;</span><span class="p">,</span>      <span class="s1">&#39;exit&#39;</span><span class="p">,</span>   <span class="s1">&#39;for&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3485"></a> <span class="p">&amp;</span> <span class="s1">&#39;help&#39;</span><span class="p">,</span>  <span class="s1">&#39;if&#39;</span><span class="p">,</span>    <span class="s1">&#39;long&#39;</span><span class="p">,</span>     <span class="s1">&#39;quit&#39;</span><span class="p">,</span>   <span class="s1">&#39;semi&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3486"></a> <span class="p">&amp;</span> <span class="s1">&#39;short&#39;</span><span class="p">,</span> <span class="s1">&#39;what&#39;</span><span class="p">,</span>  <span class="s1">&#39;while&#39;</span><span class="p">,</span>    <span class="s1">&#39;who&#39;</span><span class="p">,</span>    <span class="s1">&#39;sh&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3487"></a> <span class="p">&amp;</span> <span class="s1">&#39;lala&#39;</span><span class="p">,</span>  <span class="s1">&#39;shell&#39;</span><span class="p">,</span> <span class="s1">&#39;continue&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="s1">&#39;fhelp&#39;</span>   <span class="p">&amp;</span>
<a name="ln-3488"></a> <span class="p">&amp;</span> <span class="p">]</span>
<a name="ln-3489"></a>
<a name="ln-3490"></a><span class="n">FINISHED</span><span class="p">:</span> <span class="k">block</span>
<a name="ln-3491"></a><span class="k">   </span><span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3492"></a>
<a name="ln-3493"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">cmd</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3494"></a>     <span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>                          <span class="c">! did not match anything</span>
<a name="ln-3495"></a>        <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3496"></a>        <span class="k">return</span>
<a name="ln-3497"></a><span class="k">     </span><span class="n">elseif</span> <span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">cmd</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="k">then</span>               <span class="c">! found match to command</span>
<a name="ln-3498"></a>
<a name="ln-3499"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">)</span>                  <span class="c">! check next character</span>
<a name="ln-3500"></a>        <span class="k">case</span><span class="p">(</span><span class="n">comma</span><span class="p">,</span><span class="n">semi</span><span class="p">,</span><span class="n">GG_EOL</span><span class="p">)</span>               <span class="c">! next character is end of a command so good to go</span>
<a name="ln-3501"></a>           <span class="k">exit</span>
<a name="ln-3502"></a><span class="k">        case</span><span class="p">(</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;9&#39;</span><span class="p">),</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">):</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">):</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">),</span><span class="n">score</span><span class="p">)</span> <span class="c">! alphanumeric or a HELP command so good to go</span>
<a name="ln-3503"></a>           <span class="k">exit</span>
<a name="ln-3504"></a><span class="k">        end select</span>
<a name="ln-3505"></a>
<a name="ln-3506"></a><span class="k">        if</span> <span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;help&#39;</span><span class="p">)</span><span class="k">then</span>                <span class="c">! special case where anything after the help could be a topic</span>
<a name="ln-3507"></a>           <span class="k">exit</span>
<a name="ln-3508"></a><span class="k">        </span><span class="n">elseif</span><span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;fhelp&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3509"></a><span class="k">           exit</span>
<a name="ln-3510"></a><span class="k">        else</span>
<a name="ln-3511"></a><span class="k">           call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>                  <span class="c">! improper command</span>
<a name="ln-3512"></a>           <span class="k">return</span>
<a name="ln-3513"></a><span class="k">        endif</span>
<a name="ln-3514"></a>
<a name="ln-3515"></a><span class="k">     endif</span>
<a name="ln-3516"></a><span class="k">   enddo</span>
<a name="ln-3517"></a>
<a name="ln-3518"></a><span class="k">   </span><span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">1</span>                                 <span class="c">! found a match and next character passed tests</span>
<a name="ln-3519"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3520"></a>   <span class="n">COMAND</span> <span class="p">:</span> <span class="k">select case</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-3521"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3522"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;clear&#39;</span><span class="p">)</span>
<a name="ln-3523"></a>   <span class="c">! alphameric character</span>
<a name="ln-3524"></a>      <span class="k">if</span><span class="p">(</span><span class="nb">verify</span><span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">),</span><span class="n">big</span><span class="o">//</span><span class="n">little</span><span class="o">//</span><span class="n">digit</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span> <span class="c">! is alphanumeric so good to go by name</span>
<a name="ln-3525"></a>         <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3526"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3527"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3528"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3529"></a>         <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3530"></a>         <span class="k">call </span><span class="n">mat_stack_put</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-3531"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3532"></a><span class="k">         </span><span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3533"></a>      <span class="k">else</span>
<a name="ln-3534"></a><span class="k">         </span><span class="n">G_TOP_OF_SAVED</span> <span class="o">=</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">3</span>
<a name="ln-3535"></a>      <span class="k">endif</span>
<a name="ln-3536"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3537"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">)</span>
<a name="ln-3538"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span>
<a name="ln-3539"></a>      <span class="k">exit </span><span class="n">FINISHED</span>
<a name="ln-3540"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;while&#39;</span><span class="p">)</span>
<a name="ln-3541"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span>
<a name="ln-3542"></a>      <span class="k">exit </span><span class="n">FINISHED</span>
<a name="ln-3543"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;if&#39;</span><span class="p">)</span>
<a name="ln-3544"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">13</span>
<a name="ln-3545"></a>      <span class="k">exit </span><span class="n">FINISHED</span>
<a name="ln-3546"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;else&#39;</span><span class="p">)</span>
<a name="ln-3547"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span>
<a name="ln-3548"></a>      <span class="k">exit </span><span class="n">FINISHED</span>
<a name="ln-3549"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<a name="ln-3550"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span>
<a name="ln-3551"></a>      <span class="k">exit </span><span class="n">FINISHED</span>
<a name="ln-3552"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3553"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;exit&#39;</span><span class="p">)</span>
<a name="ln-3554"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_PT</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">G_PTZ</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3555"></a><span class="k">         </span><span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">16</span>
<a name="ln-3556"></a>         <span class="k">exit </span><span class="n">COMAND</span>
<a name="ln-3557"></a>      <span class="k">endif</span>
<a name="ln-3558"></a><span class="k">      </span><span class="n">K</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3559"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39; total flops &#39;</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-3560"></a>
<a name="ln-3561"></a>      <span class="k">select case</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span><span class="n">mat_urand</span><span class="p">(</span><span class="n">G_CURRENT_RANDOM_SEED</span><span class="p">)</span><span class="o">*</span><span class="mi">9</span><span class="p">)</span> <span class="p">)</span>    <span class="c">! for serendipity&#39;s sake randomly pick a sign-off</span>
<a name="ln-3562"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; adios&#39;</span><span class="p">)</span>
<a name="ln-3563"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; adieu&#39;</span><span class="p">)</span>
<a name="ln-3564"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; arrivederci&#39;</span><span class="p">)</span>
<a name="ln-3565"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; au revior&#39;</span><span class="p">)</span>
<a name="ln-3566"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; so long&#39;</span><span class="p">)</span>
<a name="ln-3567"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; sayonara&#39;</span><span class="p">)</span>
<a name="ln-3568"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; auf wiedersehen&#39;</span><span class="p">)</span>
<a name="ln-3569"></a>      <span class="k">case </span><span class="n">default</span>
<a name="ln-3570"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; cheerio&#39;</span><span class="p">)</span>
<a name="ln-3571"></a>      <span class="k">end select</span>
<a name="ln-3572"></a>
<a name="ln-3573"></a><span class="k">      </span><span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">99</span>
<a name="ln-3574"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3575"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;quit&#39;</span><span class="p">,</span><span class="s1">&#39;return&#39;</span><span class="p">)</span>
<a name="ln-3576"></a>      <span class="n">K</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">7</span>
<a name="ln-3577"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">K</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3578"></a><span class="k">         </span><span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">99</span>
<a name="ln-3579"></a>         <span class="k">exit </span><span class="n">COMAND</span>
<a name="ln-3580"></a>      <span class="k">endif</span>
<a name="ln-3581"></a><span class="k">      call </span><span class="n">mat_files</span><span class="p">(</span><span class="o">-</span><span class="n">G_RIO</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-3582"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3583"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3584"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3585"></a>      <span class="n">G_PTZ</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3586"></a>      <span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3587"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3588"></a>      <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">BLANK</span>
<a name="ln-3589"></a>      <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">COMMA</span>
<a name="ln-3590"></a>      <span class="k">exit </span><span class="n">FINISHED</span>
<a name="ln-3591"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3592"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;continue&#39;</span><span class="p">)</span>
<a name="ln-3593"></a>      <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">99</span>
<a name="ln-3594"></a>      <span class="k">exit </span><span class="n">FINISHED</span>
<a name="ln-3595"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3596"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;lala&#39;</span><span class="p">)</span>
<a name="ln-3597"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;QUIT SINGING AND GET BACK TO WORK.&#39;</span><span class="p">)</span>
<a name="ln-3598"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3599"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;shell&#39;</span><span class="p">)</span>
<a name="ln-3600"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; Your place or mine?&#39;</span><span class="p">)</span>
<a name="ln-3601"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3602"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;short&#39;</span><span class="p">,</span><span class="s1">&#39;long&#39;</span><span class="p">)</span>
<a name="ln-3603"></a>      <span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">11</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3604"></a><span class="k">         </span><span class="n">G_FMT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3605"></a>      <span class="k">else</span>
<a name="ln-3606"></a><span class="k">         </span><span class="n">G_FMT</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-3607"></a>      <span class="k">endif</span>
<a name="ln-3608"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">e_low</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">d_low</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">e_up</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">chr</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">d_up</span> <span class="p">)</span> <span class="n">G_FMT</span> <span class="o">=</span> <span class="n">G_FMT</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-3609"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">z_low</span><span class="p">)</span> <span class="n">G_FMT</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-3610"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">e_low</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">d_low</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">z_low</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3611"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">e_UP</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">d_up</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">z_up</span> <span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3612"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3613"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;semi&#39;</span><span class="p">)</span>
<a name="ln-3614"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c">! toggle &quot;semi&quot; mode</span>
<a name="ln-3615"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3616"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;who&#39;</span><span class="p">)</span>
<a name="ln-3617"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; Your current variables are...&#39;</span><span class="p">)</span>
<a name="ln-3618"></a>      <span class="k">call </span><span class="n">mat_print_id</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_TOP_OF_SAVED</span><span class="p">),</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="n">G_TOP_OF_SAVED</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3619"></a>      <span class="c">!x!do i=1,size(keywords)</span>
<a name="ln-3620"></a>      <span class="c">!x!   write(*,*)keywords(i),rows(i),cols(i),locs(i)</span>
<a name="ln-3621"></a>      <span class="c">!x!enddo</span>
<a name="ln-3622"></a>      <span class="n">l</span> <span class="o">=</span> <span class="n">GM_BIGMEM</span><span class="o">-</span><span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3623"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;using&#39;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="s1">&#39;out of&#39;</span><span class="p">,</span><span class="n">GM_BIGMEM</span><span class="p">,</span><span class="s1">&#39;elements&#39;</span><span class="p">)</span>
<a name="ln-3624"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3625"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;what&#39;</span><span class="p">)</span>
<a name="ln-3626"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3627"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">)</span>
<a name="ln-3628"></a>      <span class="k">call </span><span class="n">sh_command</span><span class="p">()</span>
<a name="ln-3629"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3630"></a>   <span class="k">case</span><span class="p">(</span><span class="s1">&#39;help&#39;</span><span class="p">,</span><span class="s1">&#39;fhelp&#39;</span><span class="p">)</span>
<a name="ln-3631"></a>      <span class="n">HELP_</span> <span class="p">:</span> <span class="k">block</span>
<a name="ln-3632"></a><span class="k">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">topic_name</span>
<a name="ln-3633"></a>         <span class="n">G_BUF</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-3634"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>                                <span class="c">! if no topic</span>
<a name="ln-3635"></a>            <span class="n">topic_name</span><span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-3636"></a>         <span class="k">else</span>
<a name="ln-3637"></a><span class="k">            call </span><span class="n">mat_getsym</span><span class="p">()</span>                                       <span class="c">! get next symbol or name</span>
<a name="ln-3638"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">isname</span><span class="p">)</span><span class="k">then</span>                              <span class="c">! use next word on line as topic</span>
<a name="ln-3639"></a>                 <span class="n">G_BUF</span><span class="p">(:</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_SYN</span>
<a name="ln-3640"></a>            <span class="k">else</span>                                                    <span class="c">! use next non-blank character as topic</span>
<a name="ln-3641"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">dot</span>
<a name="ln-3642"></a>               <span class="n">G_BUF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">G_SYM</span>
<a name="ln-3643"></a>               <span class="n">G_BUF</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span> <span class="o">=</span> <span class="n">blank</span>
<a name="ln-3644"></a>            <span class="k">endif</span>
<a name="ln-3645"></a><span class="k">            call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">topic_name</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">topic_name</span><span class="p">))</span>      <span class="c">! convert ADE array to string</span>
<a name="ln-3646"></a>         <span class="k">endif</span>
<a name="ln-3647"></a><span class="k">         if</span><span class="p">(</span><span class="n">topic_name</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;search&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3648"></a><span class="k">            </span><span class="n">topic_name</span><span class="o">=</span><span class="n">ade2str</span><span class="p">(</span><span class="nb">pack</span><span class="p">(</span><span class="n">G_LIN</span><span class="p">,</span><span class="n">G_LIN</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">G_LIN</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">255</span><span class="p">))</span>
<a name="ln-3649"></a>            <span class="n">i</span><span class="o">=</span><span class="nb">index</span><span class="p">(</span><span class="n">topic_name</span><span class="p">,</span><span class="s1">&#39;search&#39;</span><span class="p">)</span>                            <span class="c">! assuming help command on line by itself to some extent</span>
<a name="ln-3650"></a>            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="n">topic_name</span><span class="o">=</span><span class="n">topic_name</span><span class="p">(</span><span class="n">i</span><span class="p">:)</span>
<a name="ln-3651"></a>         <span class="k">endif</span>
<a name="ln-3652"></a><span class="k">         if</span><span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;help&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3653"></a><span class="k">            call </span><span class="n">help_command</span><span class="p">(</span><span class="n">G_HELP_TEXT</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">topic_name</span><span class="p">),&amp;</span>
<a name="ln-3654"></a>            <span class="p">&amp;</span> <span class="nb">merge</span><span class="p">(</span><span class="n">G_LINECOUNT</span><span class="p">(:</span><span class="mi">2</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="nb">huge</span><span class="p">(</span><span class="mi">0</span><span class="p">)],&amp;</span>                      <span class="c">! page length</span>
<a name="ln-3655"></a>            <span class="p">&amp;</span> <span class="n">G_PROMPT</span><span class="p">))</span>
<a name="ln-3656"></a>         <span class="k">else</span>
<a name="ln-3657"></a><span class="k">            call </span><span class="n">help_command</span><span class="p">(</span><span class="n">G_FORTRAN_TEXT</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">topic_name</span><span class="p">),&amp;</span>
<a name="ln-3658"></a>            <span class="p">&amp;</span> <span class="nb">merge</span><span class="p">(</span><span class="n">G_LINECOUNT</span><span class="p">(:</span><span class="mi">2</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="nb">huge</span><span class="p">(</span><span class="mi">0</span><span class="p">)],&amp;</span>                      <span class="c">! page length</span>
<a name="ln-3659"></a>            <span class="p">&amp;</span> <span class="n">G_PROMPT</span><span class="p">))</span>
<a name="ln-3660"></a>         <span class="k">endif</span>
<a name="ln-3661"></a><span class="k">      endblock </span><span class="n">HELP_</span>
<a name="ln-3662"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3663"></a>   <span class="k">case </span><span class="n">default</span> <span class="c">! did not find a match</span>
<a name="ln-3664"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3665"></a>      <span class="k">return</span>
<a name="ln-3666"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3667"></a>   <span class="k">end select </span><span class="n">COMAND</span>
<a name="ln-3668"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3669"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-3670"></a><span class="k">endblock </span><span class="n">FINISHED</span>
<a name="ln-3671"></a><span class="k">end subroutine </span><span class="n">mat_comand</span>
<a name="ln-3672"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3673"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-3674"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3675"></a><span class="k">subroutine </span><span class="n">sh_command</span><span class="p">()</span>
<a name="ln-3676"></a>
<a name="ln-3677"></a><span class="c">! ident_23=&quot;@(#)M_matrix::sh_command(3f): start system shell interactively&quot;</span>
<a name="ln-3678"></a>
<a name="ln-3679"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">line</span>
<a name="ln-3680"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-3681"></a>
<a name="ln-3682"></a>   <span class="k">call </span><span class="nb">get_environment_variable</span><span class="p">(</span><span class="s1">&#39;SHELL&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>               <span class="c">! get command to execute</span>
<a name="ln-3683"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span> <span class="p">)</span><span class="k">then</span>                               <span class="c">! if next character on stack is end-of-line call interactive shell</span>
<a name="ln-3684"></a>      <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">cmdstat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>          <span class="c">! call shell interactively</span>
<a name="ln-3685"></a>   <span class="k">else</span>                                                      <span class="c">! there were characters after SH on the line</span>
<a name="ln-3686"></a>      <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">cmdstat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>          <span class="c">! call shell interactively</span>
<a name="ln-3687"></a>   <span class="k">endif</span>
<a name="ln-3688"></a>
<a name="ln-3689"></a><span class="k">end subroutine </span><span class="n">sh_command</span>
<a name="ln-3690"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3691"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-3692"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3693"></a><span class="k">subroutine </span><span class="n">mat_plot</span><span class="p">(</span><span class="n">lplot</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-3694"></a>
<a name="ln-3695"></a><span class="c">! ident_24=&quot;@(#)M_matrix::mat_plot(3fp): Plot X vs. Y on LPLOT.  If K is nonzero, then P(1),...,P(K) are extra parameters&quot;</span>
<a name="ln-3696"></a>
<a name="ln-3697"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">lplot</span>
<a name="ln-3698"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n</span>
<a name="ln-3699"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-3700"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-3701"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">p</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-3702"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">k</span>
<a name="ln-3703"></a>
<a name="ln-3704"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">lets</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-3705"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">string</span>
<a name="ln-3706"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">xmin</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y0</span>
<a name="ln-3707"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">79</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pbuf</span>                             <span class="c">! work space for ascii plot</span>
<a name="ln-3708"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">h</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="mi">79</span>                        <span class="c">! h = height, w = width</span>
<a name="ln-3709"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">tlun</span>
<a name="ln-3710"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-3711"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ch</span>
<a name="ln-3712"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">i</span>
<a name="ln-3713"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j</span>
<a name="ln-3714"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">jmax</span>
<a name="ln-3715"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">l</span>
<a name="ln-3716"></a>
<a name="ln-3717"></a><span class="c">!!      if (k .gt. 0) write(lplot,01) (p(i), i=1,k)</span>
<a name="ln-3718"></a><span class="c">!!   01 FORMAT(&#39;Extra parameters&#39;,*(f5.1,/))</span>
<a name="ln-3719"></a>
<a name="ln-3720"></a>   <span class="n">xmin</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3721"></a>   <span class="n">xmax</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3722"></a>   <span class="n">ymin</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3723"></a>   <span class="n">ymax</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3724"></a>
<a name="ln-3725"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3726"></a>      <span class="n">xmin</span> <span class="o">=</span> <span class="n">dmin1</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-3727"></a>      <span class="n">xmax</span> <span class="o">=</span> <span class="n">dmax1</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-3728"></a>      <span class="n">ymin</span> <span class="o">=</span> <span class="n">dmin1</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-3729"></a>      <span class="n">ymax</span> <span class="o">=</span> <span class="n">dmax1</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-3730"></a>   <span class="k">enddo</span>
<a name="ln-3731"></a>
<a name="ln-3732"></a><span class="k">   </span><span class="n">dx</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
<a name="ln-3733"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">dx</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3734"></a>   <span class="n">dy</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>
<a name="ln-3735"></a>   <span class="k">write</span><span class="p">(</span><span class="n">lplot</span><span class="p">,</span><span class="s1">&#39;(80x)&#39;</span><span class="p">)</span>
<a name="ln-3736"></a>   <span class="k">do </span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">h</span>
<a name="ln-3737"></a>      <span class="n">pbuf</span><span class="p">(:)</span><span class="o">=</span><span class="s1">&#39; &#39;</span>  <span class="c">! blank out the line</span>
<a name="ln-3738"></a>      <span class="n">y1</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="o">/</span><span class="n">h</span>
<a name="ln-3739"></a>      <span class="n">y0</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="o">/</span><span class="n">h</span>
<a name="ln-3740"></a>      <span class="n">jmax</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3741"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3742"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">y1</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-3743"></a><span class="k">         if</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">h</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="n">y0</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-3744"></a><span class="k">         </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span>
<a name="ln-3745"></a>         <span class="n">pbuf</span><span class="p">(</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<a name="ln-3746"></a>         <span class="n">jmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">jmax</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-3747"></a>      <span class="k">enddo</span>
<a name="ln-3748"></a><span class="k">      write</span><span class="p">(</span><span class="n">lplot</span><span class="p">,</span><span class="s1">&#39;(1x,a)&#39;</span><span class="p">)</span> <span class="n">pbuf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">jmax</span><span class="p">)</span>
<a name="ln-3749"></a>   <span class="k">enddo</span>
<a name="ln-3750"></a>
<a name="ln-3751"></a>   <span class="c">! set up the data file</span>
<a name="ln-3752"></a>   <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">tlun</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;xy.dat&#39;</span><span class="p">)</span>
<a name="ln-3753"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
<a name="ln-3754"></a>      <span class="k">write</span><span class="p">(</span><span class="n">tlun</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-3755"></a>   <span class="k">enddo</span>
<a name="ln-3756"></a><span class="k">   </span><span class="nb">flush</span><span class="p">(</span><span class="n">tlun</span><span class="p">)</span>
<a name="ln-3757"></a>
<a name="ln-3758"></a>   <span class="n">string</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-3759"></a>   <span class="n">lets</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3760"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span>
<a name="ln-3761"></a>      <span class="n">ch</span><span class="o">=</span><span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-3762"></a>      <span class="k">if</span> <span class="p">((</span><span class="n">ch</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">G_CHARSET_SIZE</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3763"></a><span class="k">         </span><span class="n">lets</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">ch</span>
<a name="ln-3764"></a>      <span class="k">endif</span>
<a name="ln-3765"></a><span class="k">   enddo</span>
<a name="ln-3766"></a><span class="k">   call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">lets</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-3767"></a>
<a name="ln-3768"></a>   <span class="c">! call the external program xy(1) converting the parameters to a string of options</span>
<a name="ln-3769"></a>   <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;xy xy.dat &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
<a name="ln-3770"></a>   <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s1">&#39;xy xy.dat &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
<a name="ln-3771"></a>   <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">tlun</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span>
<a name="ln-3772"></a>
<a name="ln-3773"></a><span class="k">end subroutine </span><span class="n">mat_plot</span>
<a name="ln-3774"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3775"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-3776"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-3777"></a><span class="k">subroutine </span><span class="n">mat_matfn1</span><span class="p">()</span>
<a name="ln-3778"></a>
<a name="ln-3779"></a><span class="c">! ident_25=&quot;@(#)M_matrix::mat_matfn1(3fp): evaluate functions involving gaussian elimination&quot;</span>
<a name="ln-3780"></a>
<a name="ln-3781"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">dtr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3782"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">dti</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3783"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3784"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3785"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">rcond</span>
<a name="ln-3786"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">t</span>
<a name="ln-3787"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">t0</span>
<a name="ln-3788"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">t1</span>
<a name="ln-3789"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">eps</span>
<a name="ln-3790"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">mline</span>
<a name="ln-3791"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">i</span>
<a name="ln-3792"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">info</span>
<a name="ln-3793"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j</span>
<a name="ln-3794"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">k</span>
<a name="ln-3795"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ka</span>
<a name="ln-3796"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">kb</span>
<a name="ln-3797"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">location</span>
<a name="ln-3798"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">l2</span>
<a name="ln-3799"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">l3</span>
<a name="ln-3800"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">li</span>
<a name="ln-3801"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">lj</span>
<a name="ln-3802"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">lk</span>
<a name="ln-3803"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-3804"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-3805"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">lu</span>
<a name="ln-3806"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">m</span>
<a name="ln-3807"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">m2</span>
<a name="ln-3808"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n</span>
<a name="ln-3809"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n2</span>
<a name="ln-3810"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">nn</span>
<a name="ln-3811"></a><span class="c">!</span>
<a name="ln-3812"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-3813"></a>   <span class="n">M</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-3814"></a>   <span class="n">N</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-3815"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3816"></a>   <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-3817"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3818"></a>    <span class="k">case</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">! MATRIX RIGHT DIVISION, A/A2</span>
<a name="ln-3819"></a>      <span class="n">l2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3820"></a>      <span class="n">m2</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3821"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3822"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3823"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-3824"></a>         <span class="k">return</span>
<a name="ln-3825"></a><span class="k">      endif</span>
<a name="ln-3826"></a><span class="k">      if</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3827"></a><span class="k">         if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3828"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3829"></a>            <span class="k">return</span>
<a name="ln-3830"></a><span class="k">         endif</span>
<a name="ln-3831"></a><span class="k">         </span><span class="n">l3</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">+</span> <span class="n">m2</span><span class="o">*</span><span class="n">n2</span>
<a name="ln-3832"></a>
<a name="ln-3833"></a>         <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l3</span><span class="o">+</span><span class="n">n2</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-3834"></a>
<a name="ln-3835"></a><span class="k">         call </span><span class="n">ml_wgeco</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">m2</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">rcond</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l3</span><span class="p">))</span>
<a name="ln-3836"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">rcond</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3837"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3838"></a>            <span class="k">return</span>
<a name="ln-3839"></a><span class="k">         endif</span>
<a name="ln-3840"></a><span class="k">         </span><span class="n">t</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rcond</span><span class="p">)</span>
<a name="ln-3841"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_FUN</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">21</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3842"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;WARNING:&#39;</span><span class="p">)</span>
<a name="ln-3843"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;MATRIX IS CLOSE TO SINGULAR OR BADLY SCALED.&#39;</span><span class="p">)</span>
<a name="ln-3844"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;RESULTS MAY BE INACCURATE. RCOND=&#39;&#39;,1PD13.4)&#39;</span><span class="p">)</span> <span class="n">RCOND</span>
<a name="ln-3845"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-3846"></a>         <span class="k">endif</span>
<a name="ln-3847"></a><span class="k">         if</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_FUN</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">21</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3848"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
<a name="ln-3849"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;EIGENVECTORS ARE BADLY CONDITIONED.&#39;</span><span class="p">)</span>
<a name="ln-3850"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;RESULTS MAY BE INACCURATE. RCOND=&#39;&#39;,1PD13.4)&#39;</span><span class="p">)</span> <span class="n">RCOND</span>
<a name="ln-3851"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-3852"></a>         <span class="k">endif</span>
<a name="ln-3853"></a><span class="k">         do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-3854"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3855"></a>               <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-3856"></a>               <span class="n">ll</span> <span class="o">=</span> <span class="n">l3</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3857"></a>               <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-3858"></a>               <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-3859"></a>            <span class="k">enddo</span>
<a name="ln-3860"></a><span class="k">            call </span><span class="n">ml_wgesl</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">m2</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3861"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3862"></a>               <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-3863"></a>               <span class="n">ls</span> <span class="o">=</span> <span class="n">l3</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3864"></a>               <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-3865"></a>               <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-3866"></a>            <span class="k">enddo</span>
<a name="ln-3867"></a><span class="k">         enddo</span>
<a name="ln-3868"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_FUN</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">21</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-3869"></a>   <span class="c">!</span>
<a name="ln-3870"></a>   <span class="c">!     CHECK FOR IMAGINARY ROUNDOFF IN MATRIX FUNCTIONS</span>
<a name="ln-3871"></a>         <span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wasum</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3872"></a>         <span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wasum</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3873"></a>         <span class="n">eps</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3874"></a>         <span class="n">t</span> <span class="o">=</span> <span class="n">eps</span><span class="o">*</span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3875"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">eps</span><span class="o">*</span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3876"></a>         <span class="k">goto </span><span class="mi">99</span>
<a name="ln-3877"></a>   <span class="c">!</span>
<a name="ln-3878"></a>      <span class="k">endif</span>
<a name="ln-3879"></a>
<a name="ln-3880"></a><span class="k">      </span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-3881"></a>      <span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-3882"></a>      <span class="n">n</span> <span class="o">=</span> <span class="n">n2</span>
<a name="ln-3883"></a>      <span class="n">m</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-3884"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-3885"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-3886"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3887"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3888"></a>    <span class="k">case</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="c">! MATRIX LEFT DIVISION A BACKSLASH A2</span>
<a name="ln-3889"></a>      <span class="n">l2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3890"></a>      <span class="n">m2</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3891"></a>      <span class="n">n2</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3892"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3893"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-3894"></a>         <span class="k">return</span>
<a name="ln-3895"></a><span class="k">      endif</span>
<a name="ln-3896"></a><span class="k">      if</span> <span class="p">(</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3897"></a><span class="k">         </span><span class="n">l3</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">+</span> <span class="n">m2</span><span class="o">*</span><span class="n">n2</span>
<a name="ln-3898"></a>
<a name="ln-3899"></a>         <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l3</span><span class="o">+</span><span class="n">n</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-3900"></a>
<a name="ln-3901"></a><span class="k">         call </span><span class="n">ml_wgeco</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">rcond</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l3</span><span class="p">))</span>
<a name="ln-3902"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">rcond</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3903"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3904"></a>            <span class="k">return</span>
<a name="ln-3905"></a><span class="k">         endif</span>
<a name="ln-3906"></a><span class="k">         </span><span class="n">t</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rcond</span><span class="p">)</span>
<a name="ln-3907"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3908"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;WARNING:&#39;</span><span class="p">)</span>
<a name="ln-3909"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;MATRIX IS CLOSE TO SINGULAR OR BADLY SCALED.&#39;</span><span class="p">)</span>
<a name="ln-3910"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;RESULTS MAY BE INACCURATE. RCOND=&#39;&#39;,1PD13.4)&#39;</span><span class="p">)</span> <span class="n">RCOND</span>
<a name="ln-3911"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-3912"></a>         <span class="k">endif</span>
<a name="ln-3913"></a><span class="k">         if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3914"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3915"></a>            <span class="k">return</span>
<a name="ln-3916"></a><span class="k">         endif</span>
<a name="ln-3917"></a><span class="k">         do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-3918"></a>            <span class="n">lj</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m2</span>
<a name="ln-3919"></a>            <span class="k">call </span><span class="n">ml_wgesl</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lj</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lj</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-3920"></a>         <span class="k">enddo</span>
<a name="ln-3921"></a><span class="k">         </span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n2</span>
<a name="ln-3922"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3923"></a>         <span class="k">goto </span><span class="mi">99</span>
<a name="ln-3924"></a>      <span class="k">endif</span>
<a name="ln-3925"></a><span class="k">      </span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-3926"></a>      <span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-3927"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3928"></a>   <span class="k">end select</span>
<a name="ln-3929"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3930"></a>   <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-3931"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3932"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! COMMAND::INV</span>
<a name="ln-3933"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3934"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-3935"></a>         <span class="k">return</span>
<a name="ln-3936"></a><span class="k">      endif</span>
<a name="ln-3937"></a><span class="k">      do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3938"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-3939"></a>            <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-3940"></a>            <span class="n">t0</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-3941"></a>            <span class="n">t1</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3942"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">t0</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">t1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">32</span>
<a name="ln-3943"></a>         <span class="k">enddo</span>
<a name="ln-3944"></a><span class="k">      enddo</span>
<a name="ln-3945"></a><span class="k">      call </span><span class="n">mat_inverse_hilbert</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-3946"></a>      <span class="k">call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3947"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_wscal</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3948"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-3949"></a><span class="mi">32</span>    <span class="k">continue</span>
<a name="ln-3950"></a><span class="k">      </span><span class="n">l3</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">n</span><span class="o">*</span><span class="n">n</span>
<a name="ln-3951"></a>
<a name="ln-3952"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l3</span><span class="o">+</span><span class="n">n</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-3953"></a>
<a name="ln-3954"></a><span class="k">      call </span><span class="n">ml_wgeco</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">rcond</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l3</span><span class="p">))</span>
<a name="ln-3955"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">rcond</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3956"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3957"></a>         <span class="k">return</span>
<a name="ln-3958"></a><span class="k">      endif</span>
<a name="ln-3959"></a><span class="k">      </span><span class="n">t</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rcond</span><span class="p">)</span>
<a name="ln-3960"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3961"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;warning:&#39;</span><span class="p">)</span>
<a name="ln-3962"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;matrix is close to singular or badly scaled.&#39;</span><span class="p">)</span>
<a name="ln-3963"></a>         <span class="k">write</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39;results may be inaccurate. rcond=&#39;&#39;,1pd13.4)&#39;</span><span class="p">)</span> <span class="n">rcond</span>
<a name="ln-3964"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-3965"></a>      <span class="k">endif</span>
<a name="ln-3966"></a><span class="k">      call </span><span class="n">ml_wgedi</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">dtr</span><span class="p">,</span><span class="n">dti</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3967"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_wscal</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3968"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-3969"></a>    <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c">! COMMAND::DET</span>
<a name="ln-3970"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3971"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-3972"></a>         <span class="k">return</span>
<a name="ln-3973"></a><span class="k">      endif</span>
<a name="ln-3974"></a><span class="k">      call </span><span class="n">ml_wgefa</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-3975"></a>      <span class="c">!SUBROUTINE ML_WGEDI(ar,ai,LDA,N,ipvt,detr,deti,workr,worki,JOB)</span>
<a name="ln-3976"></a>      <span class="k">call </span><span class="n">ml_wgedi</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">dtr</span><span class="p">,</span><span class="n">dti</span><span class="p">,</span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3977"></a>      <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dtr</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3978"></a>      <span class="n">ka</span> <span class="o">=</span> <span class="nb">iabs</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-3979"></a>      <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3980"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ka</span>
<a name="ln-3981"></a>         <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">/</span><span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-3982"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">42</span>
<a name="ln-3983"></a>      <span class="k">enddo</span>
<a name="ln-3984"></a><span class="k">      </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">dtr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="mf">0.d0</span><span class="o">**</span><span class="n">k</span>
<a name="ln-3985"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">dti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="mf">0.d0</span><span class="o">**</span><span class="n">k</span>
<a name="ln-3986"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3987"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3988"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-3989"></a><span class="mi">42</span>    <span class="k">continue</span>
<a name="ln-3990"></a><span class="k">      if</span> <span class="p">(</span><span class="n">dti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-3991"></a><span class="k">         write</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="mi">43</span><span class="p">)</span> <span class="n">dtr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">k</span>
<a name="ln-3992"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-3993"></a>      <span class="k">else</span>
<a name="ln-3994"></a><span class="k">         write</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="mi">44</span><span class="p">)</span> <span class="n">dtr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">dti</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">k</span>
<a name="ln-3995"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-3996"></a>      <span class="k">endif</span>
<a name="ln-3997"></a><span class="k">      </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">dtr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3998"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">dti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3999"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dtr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4000"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4001"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4002"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-4003"></a><span class="mi">43</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; det =  &#39;</span><span class="p">,</span><span class="n">f7</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="n">h</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span>
<a name="ln-4004"></a><span class="mi">44</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; det =  &#39;</span><span class="p">,</span><span class="n">f7</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39; + &#39;</span><span class="p">,</span><span class="n">f7</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39; i &#39;</span><span class="p">,</span><span class="mi">7</span><span class="n">h</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span>
<a name="ln-4005"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4006"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! COMMAND::RCOND</span>
<a name="ln-4007"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4008"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-4009"></a>         <span class="k">return</span>
<a name="ln-4010"></a><span class="k">      endif</span>
<a name="ln-4011"></a><span class="k">      </span><span class="n">l3</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">n</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4012"></a>
<a name="ln-4013"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l3</span><span class="o">+</span><span class="n">n</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4014"></a>
<a name="ln-4015"></a><span class="k">      call </span><span class="n">ml_wgeco</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">rcond</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l3</span><span class="p">))</span>
<a name="ln-4016"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcond</span>
<a name="ln-4017"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4018"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4019"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4020"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_lhs</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4021"></a><span class="k">         </span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4022"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l3</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4023"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4024"></a>         <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-4025"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4026"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4027"></a>      <span class="k">endif</span>
<a name="ln-4028"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4029"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">! COMMAND::LU</span>
<a name="ln-4030"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4031"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-4032"></a>         <span class="k">return</span>
<a name="ln-4033"></a><span class="k">      endif</span>
<a name="ln-4034"></a><span class="k">      call </span><span class="n">ml_wgefa</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-4035"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_lhs</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4036"></a>      <span class="n">nn</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4037"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4038"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4039"></a>         <span class="k">return</span>
<a name="ln-4040"></a><span class="k">      endif</span>
<a name="ln-4041"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4042"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">nn</span>
<a name="ln-4043"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4044"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4045"></a>
<a name="ln-4046"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">location</span><span class="o">+</span><span class="n">nn</span><span class="o">+</span><span class="n">nn</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4047"></a>
<a name="ln-4048"></a><span class="k">      do </span><span class="n">kb</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4049"></a>         <span class="n">k</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">kb</span>
<a name="ln-4050"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4051"></a>            <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4052"></a>            <span class="n">lu</span> <span class="o">=</span> <span class="n">ll</span> <span class="o">+</span> <span class="n">nn</span>
<a name="ln-4053"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">lu</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<a name="ln-4054"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lu</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<a name="ln-4055"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">lu</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4056"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lu</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4057"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4058"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4059"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4060"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4061"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<a name="ln-4062"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<a name="ln-4063"></a>         <span class="k">enddo</span>
<a name="ln-4064"></a><span class="k">         </span><span class="n">i</span> <span class="o">=</span> <span class="n">G_BUF</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-4065"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">k</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-4066"></a><span class="k">         </span><span class="n">li</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4067"></a>         <span class="n">lk</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4068"></a>         <span class="k">call </span><span class="n">mat_wswap</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">li</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">li</span><span class="p">),</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lk</span><span class="p">),</span><span class="n">n</span><span class="p">)</span>
<a name="ln-4069"></a>      <span class="k">enddo</span>
<a name="ln-4070"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4071"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c">! COMMAND::inverse_hilbert</span>
<a name="ln-4072"></a>      <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-4073"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4074"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4075"></a>      <span class="k">call </span><span class="n">mat_inverse_hilbert</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-4076"></a>      <span class="k">call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4077"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_wscal</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">sr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">si</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4078"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4079"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="c">! COMMAND::CHOLESKY</span>
<a name="ln-4080"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4081"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-4082"></a>         <span class="k">return</span>
<a name="ln-4083"></a><span class="k">      endif</span>
<a name="ln-4084"></a><span class="k">      call </span><span class="n">mat_wpofa</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">G_err</span><span class="p">)</span>
<a name="ln-4085"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_err</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4086"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<a name="ln-4087"></a>         <span class="k">return</span>
<a name="ln-4088"></a><span class="k">      endif</span>
<a name="ln-4089"></a><span class="k">      do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4090"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-4091"></a>         <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4092"></a>      <span class="k">enddo</span>
<a name="ln-4093"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4094"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c">! COMMAND::RREF</span>
<a name="ln-4095"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4096"></a><span class="k">         </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4097"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4098"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">m</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4099"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4100"></a>            <span class="k">return</span>
<a name="ln-4101"></a><span class="k">         endif</span>
<a name="ln-4102"></a><span class="k">         </span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4103"></a>      <span class="k">endif</span>
<a name="ln-4104"></a><span class="k">      call </span><span class="n">mat_rref</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-4105"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4106"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4107"></a>   <span class="k">end select</span>
<a name="ln-4108"></a><span class="c">!</span>
<a name="ln-4109"></a><span class="mi">99</span> <span class="k">continue</span>
<a name="ln-4110"></a><span class="k">end subroutine </span><span class="n">mat_matfn1</span>
<a name="ln-4111"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4112"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-4113"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4114"></a><span class="k">subroutine </span><span class="n">mat_matfn2</span><span class="p">()</span>
<a name="ln-4115"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">i</span>
<a name="ln-4116"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">inc</span>
<a name="ln-4117"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">j</span>
<a name="ln-4118"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">job</span>
<a name="ln-4119"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">k</span>
<a name="ln-4120"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">location</span>
<a name="ln-4121"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">l1</span>
<a name="ln-4122"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">l2</span>
<a name="ln-4123"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">ld</span>
<a name="ln-4124"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">le</span>
<a name="ln-4125"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">lj</span>
<a name="ln-4126"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-4127"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-4128"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">lw</span>
<a name="ln-4129"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">m</span>
<a name="ln-4130"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">n</span>
<a name="ln-4131"></a><span class="kt">integer</span>          <span class="kd">::</span> <span class="n">nn</span>
<a name="ln-4132"></a><span class="c">!</span>
<a name="ln-4133"></a><span class="c">!     evaluate elementary functions and functions involving eigenvalues and eigenvectors</span>
<a name="ln-4134"></a><span class="c">!</span>
<a name="ln-4135"></a>      <span class="n">doubleprecision</span> <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">powr</span><span class="p">,</span><span class="n">powi</span>
<a name="ln-4136"></a>      <span class="kt">logical </span><span class="n">herm</span><span class="p">,</span><span class="n">schur</span><span class="p">,</span><span class="n">vect</span><span class="p">,</span><span class="n">hess</span>
<a name="ln-4137"></a><span class="c">!</span>
<a name="ln-4138"></a><span class="c">!     functions/G_FIN</span>
<a name="ln-4139"></a><span class="c">!     **   SIN  COS ATAN  EXP  SQRT LOG</span>
<a name="ln-4140"></a><span class="c">!      0    1    2    3    4    5    6</span>
<a name="ln-4141"></a><span class="c">!    EIG  SCHU HESS POLY ROOT</span>
<a name="ln-4142"></a><span class="c">!     11   12   13   14   15</span>
<a name="ln-4143"></a><span class="c">!    ABS  ROUN REAL IMAG CONJ</span>
<a name="ln-4144"></a><span class="c">!     21   22   23   24   25</span>
<a name="ln-4145"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">05</span>
<a name="ln-4146"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4147"></a>         <span class="n">powr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-4148"></a>         <span class="n">powi</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-4149"></a>   <span class="mi">05</span> <span class="k">continue</span>
<a name="ln-4150"></a><span class="k">      </span><span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4151"></a>      <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4152"></a>      <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4153"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">11</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_FIN</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">13</span><span class="p">)</span> <span class="k">goto </span><span class="mi">10</span>
<a name="ln-4154"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">14</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">n</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="k">then</span>
<a name="ln-4155"></a><span class="k">         goto </span><span class="mi">50</span>
<a name="ln-4156"></a>      <span class="k">endif</span>
<a name="ln-4157"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">14</span><span class="p">)</span> <span class="k">goto </span><span class="mi">10</span>
<a name="ln-4158"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">15</span><span class="p">)</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-4159"></a>
<a name="ln-4160"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">20</span><span class="p">)</span> <span class="k">goto </span><span class="mi">40</span>
<a name="ln-4161"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">n</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">40</span>
<a name="ln-4162"></a>      <span class="c">! what about fall-though?</span>
<a name="ln-4163"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4164"></a><span class="c">!     EIGENVALUES AND VECTORS</span>
<a name="ln-4165"></a>   <span class="mi">10</span> <span class="k">continue</span>
<a name="ln-4166"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">M</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">N</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4167"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-4168"></a>         <span class="k">return</span>
<a name="ln-4169"></a><span class="k">      endif</span>
<a name="ln-4170"></a><span class="k">      </span><span class="n">SCHUR</span> <span class="o">=</span> <span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">12</span>
<a name="ln-4171"></a>      <span class="n">HESS</span> <span class="o">=</span> <span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">13</span>
<a name="ln-4172"></a>      <span class="n">VECT</span> <span class="o">=</span> <span class="n">G_LHS</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">2</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">G_FIN</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mi">10</span>
<a name="ln-4173"></a>      <span class="n">NN</span> <span class="o">=</span> <span class="n">N</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4174"></a>      <span class="n">L2</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">NN</span>
<a name="ln-4175"></a>      <span class="n">LD</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">+</span> <span class="n">NN</span>
<a name="ln-4176"></a>      <span class="n">LE</span> <span class="o">=</span> <span class="n">LD</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-4177"></a>      <span class="n">LW</span> <span class="o">=</span> <span class="n">LE</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-4178"></a>
<a name="ln-4179"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">LW</span><span class="o">+</span><span class="n">N</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4180"></a>
<a name="ln-4181"></a><span class="k">      call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4182"></a><span class="c">!</span>
<a name="ln-4183"></a><span class="c">!     CHECK IF HERMITIAN</span>
<a name="ln-4184"></a>      <span class="n">HERM</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4185"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4186"></a>         <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">J</span>
<a name="ln-4187"></a>            <span class="n">LS</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4188"></a>            <span class="n">LL</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4189"></a>            <span class="n">HERM</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-4190"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HERM</span><span class="p">)</span> <span class="k">goto </span><span class="mi">30</span>
<a name="ln-4191"></a>         <span class="k">enddo</span>
<a name="ln-4192"></a><span class="k">      enddo</span>
<a name="ln-4193"></a><span class="c">!</span>
<a name="ln-4194"></a><span class="c">!     HERMITIAN EIGENVALUE PROBLEM</span>
<a name="ln-4195"></a>      <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4196"></a>      <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mf">1.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4197"></a>      <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LE</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4198"></a>      <span class="n">job</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4199"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VECT</span><span class="p">)</span> <span class="n">JOB</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4200"></a>      <span class="k">call </span><span class="n">ML_HTRIDI</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4201"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4202"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LE</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4203"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LE</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LW</span><span class="p">))</span>
<a name="ln-4204"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">HESS</span><span class="p">)</span><span class="k">call </span><span class="n">ML_IMTQL2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LE</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">G_ERR</span><span class="p">,</span><span class="n">JOB</span><span class="p">)</span>
<a name="ln-4205"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4206"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4207"></a>         <span class="k">return</span>
<a name="ln-4208"></a><span class="k">      endif</span>
<a name="ln-4209"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">JOB</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">ML_HTRIBK</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4210"></a>                                         <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LW</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4211"></a>                                         <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-4212"></a>      <span class="k">goto </span><span class="mi">31</span>
<a name="ln-4213"></a><span class="c">!</span>
<a name="ln-4214"></a><span class="c">!     NON-HERMITIAN EIGENVALUE PROBLEM</span>
<a name="ln-4215"></a>   <span class="mi">30</span> <span class="k">continue</span>
<a name="ln-4216"></a><span class="k">      call </span><span class="n">ML_CORTH</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4217"></a>                            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LW</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LW</span><span class="p">))</span>
<a name="ln-4218"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">VECT</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HESS</span><span class="p">)</span> <span class="k">goto </span><span class="mi">31</span>
<a name="ln-4219"></a>      <span class="n">JOB</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4220"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VECT</span><span class="p">)</span> <span class="n">JOB</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-4221"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VECT</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SCHUR</span><span class="p">)</span> <span class="n">JOB</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4222"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HESS</span><span class="p">)</span> <span class="n">JOB</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-4223"></a>      <span class="k">call </span><span class="n">ML_COMQR3</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LW</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LW</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4224"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-4225"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4226"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4227"></a>                             <span class="n">G_ERR</span><span class="p">,</span><span class="n">JOB</span><span class="p">)</span>
<a name="ln-4228"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4229"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4230"></a>         <span class="k">return</span>
<a name="ln-4231"></a><span class="k">      endif</span>
<a name="ln-4232"></a><span class="c">!</span>
<a name="ln-4233"></a><span class="c">!     VECTORS</span>
<a name="ln-4234"></a>   <span class="mi">31</span> <span class="k">continue</span>
<a name="ln-4235"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">VECT</span><span class="p">)</span> <span class="k">goto </span><span class="mi">34</span>
<a name="ln-4236"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4237"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4238"></a>         <span class="k">return</span>
<a name="ln-4239"></a><span class="k">      endif</span>
<a name="ln-4240"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4241"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">L2</span>
<a name="ln-4242"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4243"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4244"></a><span class="c">!</span>
<a name="ln-4245"></a><span class="c">!     DIAGONAL OF VALUES OR CANONICAL FORMS</span>
<a name="ln-4246"></a>   <span class="mi">34</span> <span class="k">continue</span>
<a name="ln-4247"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">VECT</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SCHUR</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">HESS</span><span class="p">)</span> <span class="k">goto </span><span class="mi">37</span>
<a name="ln-4248"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4249"></a>         <span class="n">LJ</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4250"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">SCHUR</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">HERM</span><span class="p">))</span> <span class="n">LJ</span> <span class="o">=</span> <span class="n">LJ</span><span class="o">+</span><span class="n">J</span>
<a name="ln-4251"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">HESS</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">HERM</span><span class="p">))</span> <span class="n">LJ</span> <span class="o">=</span> <span class="n">LJ</span><span class="o">+</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4252"></a>         <span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">J</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="n">LJ</span>
<a name="ln-4253"></a>         <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">LL</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LJ</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LJ</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4254"></a>      <span class="k">enddo</span>
<a name="ln-4255"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">HESS</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HERM</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4256"></a>      <span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4257"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HESS</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HERM</span><span class="p">)</span><span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LE</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LE</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4258"></a>      <span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">N</span>
<a name="ln-4259"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HESS</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HERM</span><span class="p">)</span><span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LE</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LE</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4260"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">10</span><span class="p">)</span> <span class="k">goto </span><span class="mi">42</span>
<a name="ln-4261"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VECT</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.(</span><span class="n">SCHUR</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">HESS</span><span class="p">))</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4262"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4263"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4264"></a><span class="c">!</span>
<a name="ln-4265"></a><span class="c">!     VECTOR OF EIGENVALUES</span>
<a name="ln-4266"></a>   <span class="mi">37</span> <span class="k">continue</span>
<a name="ln-4267"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">14</span><span class="p">)</span> <span class="k">goto </span><span class="mi">52</span>
<a name="ln-4268"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4269"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4270"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4271"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4272"></a><span class="c">!     elementary functions</span>
<a name="ln-4273"></a><span class="c">!     for matrices.. x,d = eig(a), fun(a) = x*fun(d)/x</span>
<a name="ln-4274"></a>   <span class="mi">40</span> <span class="k">continue</span>
<a name="ln-4275"></a><span class="k">      </span><span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4276"></a>      <span class="n">n</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4277"></a>      <span class="n">l2</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-4278"></a>      <span class="k">goto </span><span class="mi">44</span>
<a name="ln-4279"></a>
<a name="ln-4280"></a>   <span class="mi">42</span> <span class="k">continue</span>
<a name="ln-4281"></a><span class="k">      </span><span class="n">INC</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4282"></a>
<a name="ln-4283"></a>   <span class="mi">44</span> <span class="k">continue</span>
<a name="ln-4284"></a><span class="k">      do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4285"></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">inc</span>
<a name="ln-4286"></a>        <span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-4287"></a>        <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-4288"></a>        <span class="n">ti</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4289"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4290"></a><span class="k">          call </span><span class="n">mat_wlog</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4291"></a>          <span class="k">call </span><span class="n">mat_wmul</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">powr</span><span class="p">,</span><span class="n">powi</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4292"></a>          <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dexp</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span><span class="o">*</span><span class="nb">dcos</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4293"></a>          <span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dexp</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span><span class="o">*</span><span class="nb">dsin</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4294"></a>        <span class="k">endif</span>
<a name="ln-4295"></a>
<a name="ln-4296"></a><span class="k">        select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-4297"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span>                                      <span class="c">! sin</span>
<a name="ln-4298"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dsin</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span><span class="o">*</span><span class="nb">dcosh</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4299"></a>                 <span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dcos</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span><span class="o">*</span><span class="nb">dsinh</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4300"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">2</span><span class="p">)</span>                                      <span class="c">! cos</span>
<a name="ln-4301"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dcos</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span><span class="o">*</span><span class="nb">dcosh</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4302"></a>                 <span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="nb">dsin</span><span class="p">(</span><span class="n">sr</span><span class="p">))</span><span class="o">*</span><span class="nb">dsinh</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4303"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">3</span><span class="p">)</span>                                      <span class="c">! atan</span>
<a name="ln-4304"></a>                 <span class="k">call </span><span class="n">mat_watan</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4305"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">4</span><span class="p">)</span>                                      <span class="c">! exp</span>
<a name="ln-4306"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dexp</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span><span class="o">*</span><span class="nb">dcos</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4307"></a>                 <span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dexp</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span><span class="o">*</span><span class="nb">dsin</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4308"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">5</span><span class="p">)</span>                                      <span class="c">! sqrt</span>
<a name="ln-4309"></a>                 <span class="k">call </span><span class="n">mat_wsqrt</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4310"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">6</span><span class="p">)</span>                                      <span class="c">! log</span>
<a name="ln-4311"></a>                 <span class="k">call </span><span class="n">mat_wlog</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4312"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">21</span><span class="p">)</span>
<a name="ln-4313"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_pythag</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">)</span>
<a name="ln-4314"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">22</span><span class="p">)</span>
<a name="ln-4315"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_round</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span>
<a name="ln-4316"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">23</span><span class="p">)</span>
<a name="ln-4317"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sr</span>
<a name="ln-4318"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">24</span><span class="p">)</span>
<a name="ln-4319"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">si</span>
<a name="ln-4320"></a>        <span class="k">case</span><span class="p">(</span> <span class="mi">25</span><span class="p">)</span>
<a name="ln-4321"></a>                 <span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sr</span>
<a name="ln-4322"></a>                 <span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">si</span>
<a name="ln-4323"></a>        <span class="k">end select</span>
<a name="ln-4324"></a>
<a name="ln-4325"></a><span class="k">        if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4326"></a><span class="k">        </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">tr</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4327"></a>        <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4328"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">ti</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4329"></a>      <span class="k">enddo</span>
<a name="ln-4330"></a><span class="k">      if</span> <span class="p">(</span><span class="n">inc</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4331"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4332"></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">inc</span>
<a name="ln-4333"></a>        <span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-4334"></a>        <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<a name="ln-4335"></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4336"></a>        <span class="n">ll</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4337"></a>        <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4338"></a>        <span class="k">call </span><span class="n">mat_wscal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4339"></a>      <span class="k">enddo</span>
<a name="ln-4340"></a>      <span class="c">! signal matfn1 to divide by eigenvectors</span>
<a name="ln-4341"></a>      <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">21</span>
<a name="ln-4342"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-4343"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4344"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4345"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4346"></a><span class="c">!     POLY</span>
<a name="ln-4347"></a>      <span class="c">! form polynomial with given vector as roots</span>
<a name="ln-4348"></a>   <span class="mi">50</span> <span class="k">continue</span>
<a name="ln-4349"></a><span class="k">      </span><span class="n">N</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4350"></a>      <span class="n">LD</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4351"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4352"></a>      <span class="k">goto </span><span class="mi">52</span>
<a name="ln-4353"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4354"></a><span class="c">!     FORM CHARACTERISTIC POLYNOMIAL</span>
<a name="ln-4355"></a>   <span class="mi">52</span> <span class="k">continue</span>
<a name="ln-4356"></a><span class="k">      call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4357"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-4358"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4359"></a>         <span class="k">call </span><span class="n">matX_waxpy</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="o">-</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4360"></a>                            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4361"></a>                            <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4362"></a>                            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4363"></a>                            <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4364"></a>         <span class="n">LD</span> <span class="o">=</span> <span class="n">LD</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4365"></a>      <span class="k">enddo</span>
<a name="ln-4366"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4367"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4368"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4369"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4370"></a><span class="c">!     ROOTS</span>
<a name="ln-4371"></a>   <span class="mi">60</span> <span class="k">continue</span>
<a name="ln-4372"></a><span class="k">      </span><span class="n">LL</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4373"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0D0</span>
<a name="ln-4374"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4375"></a>      <span class="n">K</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-4376"></a>   <span class="mi">61</span> <span class="k">continue</span>
<a name="ln-4377"></a><span class="k">      </span><span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4378"></a>      <span class="n">L1</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">K</span>
<a name="ln-4379"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">DABS</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L1</span><span class="p">))</span><span class="o">+</span><span class="nb">DABS</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L1</span><span class="p">))</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">61</span>
<a name="ln-4380"></a>      <span class="n">N</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span> <span class="o">-</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-4381"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">N</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">65</span>
<a name="ln-4382"></a>      <span class="n">L2</span> <span class="o">=</span> <span class="n">L1</span><span class="o">+</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4383"></a>      <span class="n">LW</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">N</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4384"></a>
<a name="ln-4385"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">LW</span><span class="o">+</span><span class="n">N</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4386"></a>
<a name="ln-4387"></a><span class="k">      call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">N</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4388"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4389"></a>         <span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">J</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4390"></a>         <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-4391"></a>         <span class="n">LS</span> <span class="o">=</span> <span class="n">L1</span><span class="o">+</span><span class="n">J</span>
<a name="ln-4392"></a>         <span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4393"></a>         <span class="k">call </span><span class="n">mat_wdiv</span><span class="p">(</span><span class="o">-</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4394"></a>                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-4395"></a>                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">))</span>
<a name="ln-4396"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4397"></a><span class="k">      enddo</span>
<a name="ln-4398"></a><span class="k">      call </span><span class="n">ML_COMQR3</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LW</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LW</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4399"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4400"></a>                             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4401"></a>                             <span class="n">TR</span><span class="p">,</span><span class="n">TI</span><span class="p">,</span><span class="n">G_ERR</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-4402"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4403"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4404"></a>         <span class="k">return</span>
<a name="ln-4405"></a><span class="k">      endif</span>
<a name="ln-4406"></a><span class="k">   </span><span class="mi">65</span> <span class="k">continue</span>
<a name="ln-4407"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4408"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4409"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4410"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4411"></a>   <span class="mi">99</span> <span class="k">continue</span>
<a name="ln-4412"></a><span class="k">end subroutine </span><span class="n">mat_matfn2</span>
<a name="ln-4413"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4414"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-4415"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4416"></a><span class="k">subroutine </span><span class="n">mat_matfn3</span><span class="p">()</span>
<a name="ln-4417"></a>
<a name="ln-4418"></a><span class="c">! ident_26=&quot;@(#)M_matrix::mat_matfn3(3fp): evaluate functions involving singular value decomposition&quot;</span>
<a name="ln-4419"></a>
<a name="ln-4420"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">i</span>
<a name="ln-4421"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">j</span>
<a name="ln-4422"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">jb</span>
<a name="ln-4423"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">job</span>
<a name="ln-4424"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">k</span>
<a name="ln-4425"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">location</span>
<a name="ln-4426"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">l1</span>
<a name="ln-4427"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">l2</span>
<a name="ln-4428"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">ld</span>
<a name="ln-4429"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">li</span>
<a name="ln-4430"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">lj</span>
<a name="ln-4431"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-4432"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-4433"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">lu</span>
<a name="ln-4434"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">lv</span>
<a name="ln-4435"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">m</span>
<a name="ln-4436"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">mn</span>
<a name="ln-4437"></a><span class="kt">integer</span>         <span class="kd">::</span> <span class="n">n</span>
<a name="ln-4438"></a><span class="kt">logical</span>         <span class="kd">::</span> <span class="n">fro</span><span class="p">,</span><span class="n">inf</span>
<a name="ln-4439"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">p</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">tol</span><span class="p">,</span><span class="n">eps</span>
<a name="ln-4440"></a><span class="c">!</span>
<a name="ln-4441"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_RHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4442"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4443"></a>   <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4444"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4445"></a>   <span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4446"></a>   <span class="c">!      SVD PINV COND NORM RANK</span>
<a name="ln-4447"></a>   <span class="c">!        1    2    3    4    5</span>
<a name="ln-4448"></a>   <span class="n">FUN3</span><span class="p">:</span> <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-4449"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4450"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! COMMAND::COND</span>
<a name="ln-4451"></a>      <span class="n">ld</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4452"></a>      <span class="n">l1</span> <span class="o">=</span> <span class="n">ld</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-4453"></a>      <span class="n">l2</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">n</span>
<a name="ln-4454"></a>
<a name="ln-4455"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l2</span><span class="o">+</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4456"></a>
<a name="ln-4457"></a><span class="k">      call </span><span class="n">ml_wsvdc</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-4458"></a>                  <span class="p">&amp;</span> <span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span>                               <span class="p">&amp;</span>
<a name="ln-4459"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4460"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4461"></a>                  <span class="p">&amp;</span> <span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>                         <span class="p">&amp;</span>
<a name="ln-4462"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4463"></a>                  <span class="p">&amp;</span> <span class="mi">0</span><span class="p">,</span><span class="n">G_err</span><span class="p">)</span>
<a name="ln-4464"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_err</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4465"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4466"></a>         <span class="k">return</span>
<a name="ln-4467"></a><span class="k">      endif</span>
<a name="ln-4468"></a><span class="k">      </span><span class="n">s</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ld</span><span class="p">)</span>
<a name="ln-4469"></a>      <span class="n">ld</span> <span class="o">=</span> <span class="n">ld</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-4470"></a>      <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ld</span><span class="p">)</span>
<a name="ln-4471"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4472"></a><span class="k">         </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4473"></a>         <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4474"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4475"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4476"></a>      <span class="k">else</span>
<a name="ln-4477"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; CONDITION IS INFINITE&#39;</span><span class="p">)</span>
<a name="ln-4478"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4479"></a>      <span class="k">endif</span>
<a name="ln-4480"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4481"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">! command::norm</span>
<a name="ln-4482"></a>
<a name="ln-4483"></a>      <span class="n">p</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-4484"></a>      <span class="n">inf</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4485"></a>
<a name="ln-4486"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4487"></a><span class="k">         </span><span class="n">fro</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">mn</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span>
<a name="ln-4488"></a>         <span class="n">inf</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">mn</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span>
<a name="ln-4489"></a>         <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">fro</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4490"></a><span class="k">            </span><span class="n">p</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-4491"></a>         <span class="k">endif</span>
<a name="ln-4492"></a><span class="k">         </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4493"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4494"></a>         <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4495"></a>         <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4496"></a>         <span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4497"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">fro</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4498"></a><span class="k">            </span><span class="n">m</span> <span class="o">=</span> <span class="n">mn</span>
<a name="ln-4499"></a>            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4500"></a>         <span class="k">endif</span>
<a name="ln-4501"></a><span class="k">      endif</span>
<a name="ln-4502"></a>
<a name="ln-4503"></a><span class="k">      if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4504"></a>         <span class="c">! matrix norm</span>
<a name="ln-4505"></a>
<a name="ln-4506"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">inf</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4507"></a><span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4508"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-4509"></a>               <span class="n">li</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4510"></a>               <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wasum</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LI</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">li</span><span class="p">),</span><span class="n">m</span><span class="p">)</span>
<a name="ln-4511"></a>               <span class="n">s</span> <span class="o">=</span> <span class="n">dmax1</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4512"></a>            <span class="k">enddo</span>
<a name="ln-4513"></a><span class="k">         </span><span class="n">elseif</span> <span class="p">(</span><span class="n">p</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4514"></a><span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4515"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4516"></a>               <span class="n">lj</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-4517"></a>               <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wasum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LJ</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lj</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4518"></a>               <span class="n">s</span> <span class="o">=</span> <span class="n">dmax1</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4519"></a>            <span class="k">enddo</span>
<a name="ln-4520"></a><span class="k">         </span><span class="n">elseif</span> <span class="p">(</span><span class="n">p</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4521"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="c">! Only 1, 2 or INF norm of matrix</span>
<a name="ln-4522"></a>            <span class="k">return</span>
<a name="ln-4523"></a><span class="k">         else</span>
<a name="ln-4524"></a><span class="k">            </span><span class="n">ld</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4525"></a>            <span class="n">l1</span> <span class="o">=</span> <span class="n">ld</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-4526"></a>            <span class="n">l2</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">n</span>
<a name="ln-4527"></a>
<a name="ln-4528"></a>            <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l2</span><span class="o">+</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-4529"></a><span class="k">               return</span>
<a name="ln-4530"></a><span class="k">            endif</span>
<a name="ln-4531"></a>
<a name="ln-4532"></a><span class="k">            call </span><span class="n">ml_wsvdc</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4533"></a>                        <span class="p">&amp;</span> <span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4534"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4535"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4536"></a>                        <span class="p">&amp;</span> <span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4537"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4538"></a>                        <span class="p">&amp;</span> <span class="mi">0</span><span class="p">,</span><span class="n">G_err</span><span class="p">)</span>
<a name="ln-4539"></a>
<a name="ln-4540"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4541"></a><span class="k">               call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4542"></a>               <span class="k">return</span>
<a name="ln-4543"></a><span class="k">            endif</span>
<a name="ln-4544"></a>
<a name="ln-4545"></a><span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">)</span>
<a name="ln-4546"></a>         <span class="k">endif</span>
<a name="ln-4547"></a>
<a name="ln-4548"></a><span class="k">      </span><span class="n">elseif</span> <span class="p">(</span><span class="n">p</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4549"></a><span class="k">         </span><span class="n">s</span> <span class="o">=</span> <span class="n">mat_wasum</span><span class="p">(</span><span class="n">MN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4550"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">p</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4551"></a><span class="k">         </span><span class="n">s</span> <span class="o">=</span> <span class="n">mat_wnrm2</span><span class="p">(</span><span class="n">MN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4552"></a>      <span class="k">else</span>
<a name="ln-4553"></a><span class="k">         </span><span class="n">i</span> <span class="o">=</span> <span class="n">mat_iwamax</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">location</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-4554"></a>         <span class="n">s</span> <span class="o">=</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-4555"></a>
<a name="ln-4556"></a>         <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">inf</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">s</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span><span class="k">then</span>
<a name="ln-4557"></a><span class="k">            </span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4558"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-4559"></a>               <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4560"></a>               <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">mat_pythag</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">**</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4561"></a>            <span class="k">enddo</span>
<a name="ln-4562"></a><span class="k">            if</span> <span class="p">(</span><span class="n">p</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4563"></a><span class="k">               </span><span class="n">p</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">p</span>
<a name="ln-4564"></a>            <span class="k">endif</span>
<a name="ln-4565"></a><span class="k">            </span><span class="n">s</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4566"></a>         <span class="k">endif</span>
<a name="ln-4567"></a><span class="k">      endif</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a><span class="k">      </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span>
<a name="ln-4570"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4571"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4572"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4573"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4574"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">!     COMMAND::SVD</span>
<a name="ln-4575"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_LHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4576"></a><span class="k">         </span><span class="n">K</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-4577"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">K</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4578"></a>         <span class="n">LU</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4579"></a>         <span class="n">LD</span> <span class="o">=</span> <span class="n">LU</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">K</span>
<a name="ln-4580"></a>         <span class="n">LV</span> <span class="o">=</span> <span class="n">LD</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4581"></a>         <span class="n">L1</span> <span class="o">=</span> <span class="n">LV</span> <span class="o">+</span> <span class="n">N</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4582"></a>         <span class="n">L2</span> <span class="o">=</span> <span class="n">L1</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-4583"></a>
<a name="ln-4584"></a>         <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">L2</span><span class="o">+</span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4585"></a>
<a name="ln-4586"></a><span class="k">         </span><span class="n">JOB</span> <span class="o">=</span> <span class="mi">11</span>
<a name="ln-4587"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">JOB</span> <span class="o">=</span> <span class="mi">21</span>
<a name="ln-4588"></a>         <span class="k">call </span><span class="n">ml_wsvdc</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4589"></a>         <span class="p">&amp;</span> <span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4590"></a>         <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4591"></a>         <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4592"></a>         <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">lu</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lu</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4593"></a>         <span class="p">&amp;</span> <span class="n">m</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4594"></a>         <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">lv</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lv</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4595"></a>         <span class="p">&amp;</span> <span class="n">n</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4596"></a>         <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4597"></a>         <span class="p">&amp;</span> <span class="n">job</span><span class="p">,</span><span class="n">G_err</span><span class="p">)</span>
<a name="ln-4598"></a>         <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4599"></a>            <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">K</span>
<a name="ln-4600"></a>               <span class="n">J</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">JB</span>
<a name="ln-4601"></a>               <span class="n">LL</span> <span class="o">=</span> <span class="n">LD</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">K</span>
<a name="ln-4602"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="n">J</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4603"></a>               <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4604"></a>               <span class="n">LS</span> <span class="o">=</span> <span class="n">LD</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4605"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">J</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-4606"></a>               <span class="n">LS</span> <span class="o">=</span> <span class="n">L1</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4607"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">I</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-4608"></a>            <span class="k">enddo</span>
<a name="ln-4609"></a><span class="k">         enddo</span>
<a name="ln-4610"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4611"></a>         <span class="n">G_ERR</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4612"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">K</span><span class="o">+</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4613"></a>                      <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LU</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LU</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4614"></a>                      <span class="p">&amp;</span> <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4615"></a>                      <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4616"></a>                      <span class="p">&amp;</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4617"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-4618"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-4619"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4620"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4621"></a>            <span class="k">return</span>
<a name="ln-4622"></a><span class="k">         endif</span>
<a name="ln-4623"></a><span class="k">         </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4624"></a>         <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">K</span>
<a name="ln-4625"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-4626"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4627"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4628"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4629"></a>            <span class="k">return</span>
<a name="ln-4630"></a><span class="k">         endif</span>
<a name="ln-4631"></a><span class="k">         </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4632"></a>         <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4633"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4634"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4635"></a>      <span class="k">else</span>
<a name="ln-4636"></a><span class="k">         </span><span class="n">LD</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4637"></a>         <span class="n">L1</span> <span class="o">=</span> <span class="n">LD</span> <span class="o">+</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4638"></a>         <span class="n">L2</span> <span class="o">=</span> <span class="n">L1</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-4639"></a>
<a name="ln-4640"></a>         <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">L2</span><span class="o">+</span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4641"></a>
<a name="ln-4642"></a><span class="k">         call </span><span class="n">ml_wsvdc</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4643"></a>         <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ld</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4644"></a>         <span class="p">&amp;</span> <span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">G_err</span><span class="p">)</span>
<a name="ln-4645"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4646"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4647"></a>            <span class="k">return</span>
<a name="ln-4648"></a><span class="k">         endif</span>
<a name="ln-4649"></a><span class="k">         </span><span class="n">K</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4650"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4651"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-4652"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4653"></a>      <span class="k">endif</span>
<a name="ln-4654"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4655"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c">! COMMAND::PINV AND RANK</span>
<a name="ln-4656"></a>      <span class="n">TOL</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0D0</span>
<a name="ln-4657"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4658"></a><span class="k">         </span><span class="n">TOL</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-4659"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4660"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4661"></a>         <span class="n">M</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4662"></a>         <span class="n">N</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4663"></a>      <span class="k">endif</span>
<a name="ln-4664"></a><span class="k">      </span><span class="n">LU</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4665"></a>      <span class="n">LD</span> <span class="o">=</span> <span class="n">LU</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">M</span>
<a name="ln-4666"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="n">LD</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4667"></a>      <span class="n">LV</span> <span class="o">=</span> <span class="n">LD</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4668"></a>      <span class="n">L1</span> <span class="o">=</span> <span class="n">LV</span> <span class="o">+</span> <span class="n">N</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4669"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="n">L1</span> <span class="o">=</span> <span class="n">LD</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-4670"></a>      <span class="n">L2</span> <span class="o">=</span> <span class="n">L1</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-4671"></a>
<a name="ln-4672"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">L2</span><span class="o">+</span><span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4673"></a>
<a name="ln-4674"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">JOB</span> <span class="o">=</span> <span class="mi">11</span>
<a name="ln-4675"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="n">JOB</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4676"></a>      <span class="k">call </span><span class="n">ML_WSVDC</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4677"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LD</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4678"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4679"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LU</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LU</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4680"></a>                  <span class="p">&amp;</span> <span class="n">M</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4681"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LV</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LV</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4682"></a>                  <span class="p">&amp;</span> <span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4683"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4684"></a>                  <span class="p">&amp;</span> <span class="n">JOB</span><span class="p">,</span><span class="n">G_ERR</span><span class="p">)</span>
<a name="ln-4685"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4686"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-4687"></a>         <span class="k">return</span>
<a name="ln-4688"></a><span class="k">      endif</span>
<a name="ln-4689"></a><span class="k">      </span><span class="n">EPS</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4690"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TOL</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="n">TOL</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">*</span><span class="n">EPS</span><span class="o">*</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LD</span><span class="p">))</span>
<a name="ln-4691"></a>      <span class="n">MN</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4692"></a>      <span class="n">K</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4693"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MN</span>
<a name="ln-4694"></a>         <span class="n">LS</span> <span class="o">=</span> <span class="n">LD</span><span class="o">+</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4695"></a>         <span class="n">S</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-4696"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">S</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">TOL</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-4697"></a><span class="k">         </span><span class="n">K</span> <span class="o">=</span> <span class="n">J</span>
<a name="ln-4698"></a>         <span class="n">LL</span> <span class="o">=</span> <span class="n">LV</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4699"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_wrscal</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mf">1.0D0</span><span class="o">/</span><span class="n">S</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4700"></a>      <span class="k">enddo</span>
<a name="ln-4701"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4702"></a><span class="k">         do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-4703"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4704"></a>               <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4705"></a>               <span class="n">l1</span> <span class="o">=</span> <span class="n">lv</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4706"></a>               <span class="n">l2</span> <span class="o">=</span> <span class="n">lu</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4707"></a>               <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wdotcr</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">n</span><span class="p">)</span>
<a name="ln-4708"></a>               <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wdotci</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">n</span><span class="p">)</span>
<a name="ln-4709"></a>            <span class="k">enddo</span>
<a name="ln-4710"></a><span class="k">         enddo</span>
<a name="ln-4711"></a><span class="k">         </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4712"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-4713"></a>      <span class="k">else</span>
<a name="ln-4714"></a><span class="k">         </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-4715"></a>         <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4716"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4717"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4718"></a>      <span class="k">endif</span>
<a name="ln-4719"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4720"></a>   <span class="k">end select </span><span class="n">FUN3</span>
<a name="ln-4721"></a><span class="c">!</span>
<a name="ln-4722"></a><span class="k">end subroutine </span><span class="n">mat_matfn3</span>
<a name="ln-4723"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4724"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-4725"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4726"></a><span class="k">SUBROUTINE </span><span class="n">mat_matfn4</span><span class="p">()</span>
<a name="ln-4727"></a>
<a name="ln-4728"></a><span class="c">! ident_27=&quot;@(#)M_matrix::mat_matfn4(3fp): evaluate functions involving qr decomposition (least squares)&quot;</span>
<a name="ln-4729"></a>
<a name="ln-4730"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">info</span>
<a name="ln-4731"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">j</span>
<a name="ln-4732"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">jb</span>
<a name="ln-4733"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">job</span>
<a name="ln-4734"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">k</span>
<a name="ln-4735"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">location</span>
<a name="ln-4736"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">l2</span>
<a name="ln-4737"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">l3</span>
<a name="ln-4738"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">l4</span>
<a name="ln-4739"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">le</span>
<a name="ln-4740"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-4741"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-4742"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">m</span>
<a name="ln-4743"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">m2</span>
<a name="ln-4744"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">mm</span>
<a name="ln-4745"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">mn</span>
<a name="ln-4746"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n</span>
<a name="ln-4747"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n2</span>
<a name="ln-4748"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">81</span><span class="p">)</span> <span class="kd">::</span> <span class="n">message</span>
<a name="ln-4749"></a><span class="n">DOUBLEPRECISION</span>   <span class="kd">::</span> <span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">TOL</span><span class="p">,</span><span class="n">EPS</span>
<a name="ln-4750"></a><span class="c">!</span>
<a name="ln-4751"></a>      <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4752"></a>      <span class="n">M</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4753"></a>      <span class="n">N</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4754"></a>
<a name="ln-4755"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4756"></a><span class="k">         goto </span><span class="mi">10</span>
<a name="ln-4757"></a>      <span class="n">elseIF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4758"></a><span class="k">         goto </span><span class="mi">20</span>
<a name="ln-4759"></a>      <span class="k">else</span>
<a name="ln-4760"></a><span class="k">         goto </span><span class="mi">40</span>
<a name="ln-4761"></a>      <span class="k">endif</span>
<a name="ln-4762"></a><span class="c">!</span>
<a name="ln-4763"></a><span class="c">!     RECTANGULAR MATRIX RIGHT DIVISION, A/A2</span>
<a name="ln-4764"></a>   <span class="mi">10</span> <span class="k">continue</span>
<a name="ln-4765"></a><span class="k">      </span><span class="n">L2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4766"></a>      <span class="n">M2</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4767"></a>      <span class="n">N2</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4768"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4769"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">N</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">N</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="n">N2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4770"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-4771"></a>         <span class="k">return</span>
<a name="ln-4772"></a><span class="k">      endif</span>
<a name="ln-4773"></a><span class="k">      call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">QUOTE</span><span class="p">)</span>
<a name="ln-4774"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4775"></a><span class="k">      </span><span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">M2</span><span class="o">*</span><span class="n">N2</span>
<a name="ln-4776"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4777"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">M2</span><span class="o">*</span><span class="n">N2</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4778"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">M2</span><span class="o">*</span><span class="n">N2</span>
<a name="ln-4779"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-4780"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4781"></a>      <span class="k">call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">QUOTE</span><span class="p">)</span>
<a name="ln-4782"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4783"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-4784"></a>      <span class="n">M</span> <span class="o">=</span> <span class="n">N2</span>
<a name="ln-4785"></a>      <span class="n">N</span> <span class="o">=</span> <span class="n">M2</span>
<a name="ln-4786"></a>      <span class="k">goto </span><span class="mi">20</span>
<a name="ln-4787"></a><span class="c">!</span>
<a name="ln-4788"></a><span class="c">!     RECTANGULAR MATRIX LEFT DIVISION A BACKSLASH A2</span>
<a name="ln-4789"></a><span class="c">!</span>
<a name="ln-4790"></a>   <span class="mi">20</span> <span class="k">continue</span>
<a name="ln-4791"></a><span class="k">      </span><span class="n">L2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4792"></a>      <span class="n">M2</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4793"></a>      <span class="n">N2</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4794"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">M2</span><span class="o">*</span><span class="n">N2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">21</span>
<a name="ln-4795"></a>        <span class="n">M2</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-4796"></a>        <span class="n">N2</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-4797"></a>
<a name="ln-4798"></a>        <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">L2</span><span class="o">+</span><span class="n">M</span><span class="o">*</span><span class="n">M</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4799"></a>
<a name="ln-4800"></a><span class="k">        call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4801"></a>        <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4802"></a>   <span class="mi">21</span> <span class="k">continue</span>
<a name="ln-4803"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">M2</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">M</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4804"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-4805"></a>         <span class="k">return</span>
<a name="ln-4806"></a><span class="k">      endif</span>
<a name="ln-4807"></a><span class="k">      </span><span class="n">L3</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">N2</span>
<a name="ln-4808"></a>      <span class="n">L4</span> <span class="o">=</span> <span class="n">L3</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-4809"></a>
<a name="ln-4810"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">L4</span> <span class="o">+</span> <span class="n">N</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4811"></a>
<a name="ln-4812"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">M</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">N</span><span class="p">)</span> <span class="k">goto </span><span class="mi">23</span>
<a name="ln-4813"></a>      <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N2</span>
<a name="ln-4814"></a>        <span class="n">J</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">JB</span>
<a name="ln-4815"></a>        <span class="n">LS</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">+</span> <span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">M</span>
<a name="ln-4816"></a>        <span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">+</span> <span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4817"></a>        <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4818"></a>      <span class="k">enddo</span>
<a name="ln-4819"></a><span class="k">   </span><span class="mi">23</span> <span class="k">continue</span>
<a name="ln-4820"></a><span class="k">      DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4821"></a>        <span class="n">G_BUF</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4822"></a>      <span class="k">enddo</span>
<a name="ln-4823"></a><span class="k">      call </span><span class="n">ML_WQRDC</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4824"></a>                  <span class="p">&amp;</span> <span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4825"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L4</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L4</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4826"></a>                  <span class="p">&amp;</span> <span class="n">G_BUF</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4827"></a>                  <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4828"></a>                  <span class="p">&amp;</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4829"></a>      <span class="n">K</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4830"></a>      <span class="n">EPS</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4831"></a>      <span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DABS</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span><span class="o">+</span><span class="nb">DABS</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-4832"></a>      <span class="n">TOL</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">*</span><span class="n">EPS</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4833"></a>      <span class="n">MN</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4834"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MN</span>
<a name="ln-4835"></a>        <span class="n">LS</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">M</span>
<a name="ln-4836"></a>        <span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DABS</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">))</span> <span class="o">+</span> <span class="nb">DABS</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">))</span>
<a name="ln-4837"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">TOL</span><span class="p">)</span> <span class="n">K</span> <span class="o">=</span> <span class="n">J</span>
<a name="ln-4838"></a>      <span class="k">enddo</span>
<a name="ln-4839"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">K</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MN</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4840"></a><span class="k">         WRITE</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="s1">&#39;(&quot; RANK DEFICIENT,  RANK =&quot;,I4,&quot;,  TOL =&quot;,1PD13.4)&#39;</span><span class="p">)</span> <span class="n">K</span><span class="p">,</span><span class="n">TOL</span>
<a name="ln-4841"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-4842"></a>      <span class="k">endif</span>
<a name="ln-4843"></a><span class="k">      </span><span class="n">MN</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4844"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N2</span>
<a name="ln-4845"></a>        <span class="n">LS</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">MN</span>
<a name="ln-4846"></a>        <span class="k">call </span><span class="n">ML_WQRSL</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4847"></a>                        <span class="p">&amp;</span> <span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">K</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4848"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L4</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L4</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4849"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4850"></a>                        <span class="p">&amp;</span> <span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4851"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4852"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4853"></a>                        <span class="p">&amp;</span> <span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="n">INFO</span><span class="p">)</span>
<a name="ln-4854"></a>        <span class="n">LL</span> <span class="o">=</span> <span class="n">LS</span><span class="o">+</span><span class="n">K</span>
<a name="ln-4855"></a>        <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">K</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4856"></a>      <span class="k">enddo</span>
<a name="ln-4857"></a><span class="k">      DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4858"></a>        <span class="n">G_BUF</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-4859"></a>      <span class="k">enddo</span>
<a name="ln-4860"></a><span class="k">      DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-4861"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-4862"></a><span class="k">        </span><span class="n">K</span> <span class="o">=</span> <span class="o">-</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-4863"></a>        <span class="n">G_BUF</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-4864"></a>   <span class="mi">33</span>   <span class="k">CONTINUE</span>
<a name="ln-4865"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">K</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">J</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-4866"></a><span class="k">          </span><span class="n">LS</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4867"></a>          <span class="n">LL</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4868"></a>          <span class="k">call </span><span class="n">mat_wswap</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">MN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">MN</span><span class="p">)</span>
<a name="ln-4869"></a>          <span class="n">G_BUF</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-4870"></a>          <span class="n">K</span> <span class="o">=</span> <span class="n">G_BUF</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-4871"></a>          <span class="k">goto </span><span class="mi">33</span>
<a name="ln-4872"></a>      <span class="k">enddo</span>
<a name="ln-4873"></a><span class="k">      DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N2</span>
<a name="ln-4874"></a>        <span class="n">LS</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">MN</span>
<a name="ln-4875"></a>        <span class="n">LL</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-4876"></a>        <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4877"></a>      <span class="k">enddo</span>
<a name="ln-4878"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-4879"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N2</span>
<a name="ln-4880"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">QUOTE</span><span class="p">)</span>
<a name="ln-4881"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4882"></a><span class="k">      goto </span><span class="mi">99</span>
<a name="ln-4883"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4884"></a><span class="c">!     QR</span>
<a name="ln-4885"></a><span class="c">!</span>
<a name="ln-4886"></a>   <span class="mi">40</span> <span class="k">continue</span>
<a name="ln-4887"></a><span class="k">      </span><span class="n">mm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-4888"></a>      <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">mm</span><span class="o">*</span><span class="n">mm</span>
<a name="ln-4889"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_FIN</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-4890"></a>      <span class="n">le</span> <span class="o">=</span> <span class="n">ls</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4891"></a>      <span class="n">l4</span> <span class="o">=</span> <span class="n">le</span> <span class="o">+</span> <span class="n">mm</span>
<a name="ln-4892"></a>
<a name="ln-4893"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l4</span><span class="o">+</span><span class="n">mm</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-4894"></a>
<a name="ln-4895"></a><span class="k">      if</span> <span class="p">(</span><span class="n">ls</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">location</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4896"></a><span class="k">         call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4897"></a>      <span class="k">endif</span>
<a name="ln-4898"></a><span class="k">      </span><span class="n">job</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4899"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LHS</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span> <span class="n">job</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4900"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4901"></a>        <span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4902"></a>      <span class="k">enddo</span>
<a name="ln-4903"></a><span class="k">      call </span><span class="n">ml_wqrdc</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4904"></a>       <span class="p">&amp;</span> <span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4905"></a>       <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l4</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l4</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4906"></a>       <span class="p">&amp;</span> <span class="n">G_BUF</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4907"></a>       <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">le</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">le</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4908"></a>       <span class="p">&amp;</span> <span class="n">job</span><span class="p">)</span>
<a name="ln-4909"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LHS</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_FIN</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4910"></a>      <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4911"></a>      <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4912"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-4913"></a>        <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-4914"></a>        <span class="k">call </span><span class="n">ml_wqrsl</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l4</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l4</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-4915"></a>     <span class="p">&amp;</span>             <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-4916"></a>     <span class="p">&amp;</span>             <span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-4917"></a>      <span class="k">enddo</span>
<a name="ln-4918"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4919"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-4920"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4921"></a>        <span class="n">ll</span> <span class="o">=</span> <span class="n">ls</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-4922"></a>        <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4923"></a>      <span class="k">enddo</span>
<a name="ln-4924"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4925"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4926"></a>         <span class="k">return</span>
<a name="ln-4927"></a><span class="k">      endif</span>
<a name="ln-4928"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4929"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">ls</span>
<a name="ln-4930"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-4931"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4932"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4933"></a>      <span class="k">call </span><span class="n">mat_wset</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">le</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">le</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4934"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4935"></a>        <span class="n">ll</span> <span class="o">=</span> <span class="n">le</span><span class="o">+</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4936"></a>        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4937"></a>      <span class="k">enddo</span>
<a name="ln-4938"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4939"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4940"></a>         <span class="k">return</span>
<a name="ln-4941"></a><span class="k">      endif</span>
<a name="ln-4942"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4943"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">le</span>
<a name="ln-4944"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4945"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-4946"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-4947"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-4948"></a><span class="c">!</span>
<a name="ln-4949"></a>   <span class="mi">99</span> <span class="k">continue</span>
<a name="ln-4950"></a><span class="k">END SUBROUTINE </span><span class="n">mat_matfn4</span>
<a name="ln-4951"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4952"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-4953"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-4954"></a><span class="k">subroutine </span><span class="n">mat_matfn5</span><span class="p">()</span>
<a name="ln-4955"></a>
<a name="ln-4956"></a><span class="c">! ident_28=&quot;@(#)M_matrix::mat_matfn5(3fp):file handling and other I/O&quot;</span>
<a name="ln-4957"></a>
<a name="ln-4958"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">mline</span>
<a name="ln-4959"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">errmsg</span>
<a name="ln-4960"></a><span class="kt">integer</span><span class="p">,</span><span class="k">save</span>               <span class="kd">::</span> <span class="n">flag</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! should be saved or set at each call?</span>
<a name="ln-4961"></a><span class="kt">integer</span><span class="p">,</span><span class="k">save</span>               <span class="kd">::</span> <span class="n">lrat</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-4962"></a><span class="kt">integer</span><span class="p">,</span><span class="k">save</span>               <span class="kd">::</span> <span class="n">mrat</span><span class="o">=</span><span class="mi">100</span>
<a name="ln-4963"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">ch</span><span class="p">,</span><span class="n">top2</span>
<a name="ln-4964"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-4965"></a><span class="n">doubleprecision</span>            <span class="kd">::</span> <span class="n">eps</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">tdum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4966"></a><span class="kt">logical</span>                    <span class="kd">::</span> <span class="n">text</span>
<a name="ln-4967"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-4968"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">img</span>
<a name="ln-4969"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">space_left</span>
<a name="ln-4970"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">l2</span>
<a name="ln-4971"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-4972"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-4973"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">lun</span>
<a name="ln-4974"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">lunit</span>
<a name="ln-4975"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">lw</span>
<a name="ln-4976"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">lx</span>
<a name="ln-4977"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">ly</span>
<a name="ln-4978"></a><span class="kt">integer</span>                    <span class="kd">::</span> <span class="n">mn</span>
<a name="ln-4979"></a><span class="c">!</span>
<a name="ln-4980"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4981"></a>   <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4982"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-4983"></a>
<a name="ln-4984"></a>   <span class="c">!  functions/G_FIN</span>
<a name="ln-4985"></a>   <span class="c">!  exec save load prin diar disp base line char plot rat  debu doc  delete</span>
<a name="ln-4986"></a>   <span class="c">!    1    2    3    4    5    6    7    8    9   10   11   12   13      14</span>
<a name="ln-4987"></a>
<a name="ln-4988"></a>   <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-4989"></a>      <span class="k">case</span><span class="p">(:</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span> <span class="c">! setup for filename parameter</span>
<a name="ln-4990"></a>
<a name="ln-4991"></a>         <span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-4992"></a>
<a name="ln-4993"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">semi</span><span class="p">)</span><span class="k">then</span>
<a name="ln-4994"></a><span class="k">            </span><span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4995"></a>         <span class="k">else</span>
<a name="ln-4996"></a><span class="k">            </span><span class="n">flag</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-4997"></a>         <span class="k">endif</span>
<a name="ln-4998"></a>
<a name="ln-4999"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>            <span class="c">! if more than one parameter on exec(&#39;filename&#39;,flag) get value of FLAG</span>
<a name="ln-5000"></a>            <span class="n">flag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-5001"></a>            <span class="n">top2</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span>
<a name="ln-5002"></a>            <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5003"></a>            <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5004"></a>            <span class="n">mn</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5005"></a>         <span class="k">endif</span>
<a name="ln-5006"></a>
<a name="ln-5007"></a>         <span class="c">! if a single character and a digit set LUN to that so exec(0) works</span>
<a name="ln-5008"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">mn</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">).</span><span class="n">LT</span><span class="p">.</span><span class="mi">1</span><span class="mf">0.0d0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5009"></a><span class="k">            </span><span class="n">lun</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-5010"></a>         <span class="k">else</span>
<a name="ln-5011"></a><span class="k">            </span><span class="n">lun</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-5012"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">GG_LINELEN</span>
<a name="ln-5013"></a>               <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5014"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">mn</span><span class="p">)</span> <span class="n">ch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span>
<a name="ln-5015"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">mn</span><span class="p">)</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">blank</span>
<a name="ln-5016"></a>               <span class="k">if</span> <span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ch</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="n">g_charset_size</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5017"></a><span class="k">                  call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span>
<a name="ln-5018"></a>                  <span class="k">return</span>
<a name="ln-5019"></a><span class="k">               endif</span>
<a name="ln-5020"></a><span class="k">               </span><span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">ch</span>
<a name="ln-5021"></a>            <span class="k">enddo</span>
<a name="ln-5022"></a><span class="k">         endif</span>
<a name="ln-5023"></a><span class="k">      end select</span>
<a name="ln-5024"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5025"></a>      <span class="n">FUN5</span> <span class="p">:</span> <span class="k">select case</span><span class="p">(</span><span class="n">G_FIN</span><span class="p">)</span>
<a name="ln-5026"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5027"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                                               <span class="c">! command::exec</span>
<a name="ln-5028"></a>      <span class="n">EXEC_CMD</span> <span class="p">:</span> <span class="k">block</span>
<a name="ln-5029"></a><span class="k">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">filename</span>
<a name="ln-5030"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">lun</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>                                  <span class="c">! exec(0)</span>
<a name="ln-5031"></a>         <span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_INPUT_LUN</span>
<a name="ln-5032"></a>         <span class="n">G_ERR</span> <span class="o">=</span> <span class="mi">99</span>
<a name="ln-5033"></a>      <span class="k">else</span>
<a name="ln-5034"></a><span class="k">         </span><span class="n">k</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-5035"></a>         <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5036"></a>         <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5037"></a>         <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-5038"></a>         <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_PTZ</span>
<a name="ln-5039"></a>         <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_RIO</span>
<a name="ln-5040"></a>         <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-5041"></a>         <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">7</span>
<a name="ln-5042"></a>         <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">flag</span>
<a name="ln-5043"></a>         <span class="n">G_PTZ</span> <span class="o">=</span> <span class="n">G_PT</span> <span class="o">-</span> <span class="mi">4</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_RIO</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">G_INPUT_LUN</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5046"></a><span class="k">            </span><span class="n">G_RIO</span> <span class="o">=</span> <span class="mi">12</span>
<a name="ln-5047"></a>         <span class="k">endif</span>
<a name="ln-5048"></a>
<a name="ln-5049"></a><span class="k">         </span><span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_RIO</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5050"></a>
<a name="ln-5051"></a>         <span class="n">filename</span><span class="o">=</span><span class="n">find_exec_file</span><span class="p">(</span><span class="n">ade2str</span><span class="p">(</span><span class="n">G_BUF</span><span class="p">))</span>
<a name="ln-5052"></a>         <span class="k">call </span><span class="n">mat_str2buf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">GG_LINELEN</span><span class="p">)</span>    <span class="c">! convert input line to ADE buffer</span>
<a name="ln-5053"></a>         <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="n">G_RIO</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-5054"></a>         <span class="k">if</span><span class="p">(</span><span class="n">G_FILE_OPEN_ERROR</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5055"></a><span class="k">            </span><span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_INPUT_LUN</span>
<a name="ln-5056"></a>            <span class="n">G_ERR</span> <span class="o">=</span> <span class="mi">99</span>
<a name="ln-5057"></a>         <span class="k">endif</span>
<a name="ln-5058"></a>
<a name="ln-5059"></a><span class="k">         if</span> <span class="p">(</span><span class="n">flag</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5060"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39; PAUSE MODE. Enter blank lines.&#39;</span><span class="p">)</span>
<a name="ln-5061"></a>         <span class="k">endif</span>
<a name="ln-5062"></a>
<a name="ln-5063"></a><span class="k">         </span><span class="n">G_SYM</span> <span class="o">=</span> <span class="n">GG_EOL</span>
<a name="ln-5064"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5065"></a>      <span class="k">endif</span>
<a name="ln-5066"></a><span class="k">      endblock </span><span class="n">EXEC_CMD</span>
<a name="ln-5067"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5068"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c">! COMMAND::SAVE</span>
<a name="ln-5069"></a>      <span class="n">lunit</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5070"></a>      <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="n">lunit</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-5071"></a>      <span class="n">k</span> <span class="o">=</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-5072"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="n">k</span> <span class="o">=</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span>
<a name="ln-5073"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">k</span> <span class="o">=</span> <span class="n">top2</span>
<a name="ln-5074"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-5075"></a>      <span class="k">do</span>
<a name="ln-5076"></a><span class="k">         </span><span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-5077"></a>         <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-5078"></a>         <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-5079"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">GG_MAX_NAME_LENGTH</span>
<a name="ln-5080"></a>            <span class="n">j</span> <span class="o">=</span> <span class="n">G_VAR_IDS</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-5081"></a>            <span class="n">G_BUF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span>
<a name="ln-5082"></a>         <span class="k">enddo</span>
<a name="ln-5083"></a><span class="k">         </span><span class="n">img</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5084"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">mat_wasum</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">img</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5085"></a>         <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">G_FILE_OPEN_ERROR</span><span class="p">)</span><span class="k">call </span><span class="n">mat_savlod</span><span class="p">(</span><span class="n">lunit</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">img</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-5086"></a>         <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5087"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-5088"></a><span class="k">      enddo</span>
<a name="ln-5089"></a><span class="k">      call </span><span class="n">mat_files</span><span class="p">(</span><span class="o">-</span><span class="n">lunit</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span> <span class="c">! close unit</span>
<a name="ln-5090"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! do not set &quot;ans&quot; to filename</span>
<a name="ln-5091"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5092"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="c">! COMMAND::DELETE</span>
<a name="ln-5093"></a>         <span class="n">DELETE_IT</span><span class="p">:</span> <span class="k">block</span>
<a name="ln-5094"></a><span class="k">         </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">templun</span>
<a name="ln-5095"></a>         <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-5096"></a>         <span class="k">call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">GG_LINELEN</span><span class="p">)</span>
<a name="ln-5097"></a>         <span class="k">open</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">mline</span><span class="p">,</span><span class="n">newunit</span><span class="o">=</span><span class="n">templun</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">,</span><span class="n">iomsg</span><span class="o">=</span><span class="n">errmsg</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-5098"></a>         <span class="k">if</span><span class="p">(</span><span class="n">ios</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5099"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;ERROR:&#39;</span><span class="p">,</span><span class="n">errmsg</span><span class="p">)</span>
<a name="ln-5100"></a>            <span class="n">G_ERR</span><span class="o">=</span><span class="mi">999</span>
<a name="ln-5101"></a>            <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5102"></a>         <span class="k">endif</span>
<a name="ln-5103"></a><span class="k">         close</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">templun</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">,</span><span class="n">iomsg</span><span class="o">=</span><span class="n">errmsg</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
<a name="ln-5104"></a>         <span class="k">if</span><span class="p">(</span><span class="n">ios</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5105"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;ERROR:&#39;</span><span class="p">,</span><span class="n">errmsg</span><span class="p">)</span>
<a name="ln-5106"></a>            <span class="n">G_ERR</span><span class="o">=</span><span class="mi">999</span>
<a name="ln-5107"></a>            <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5108"></a>         <span class="k">endif</span>
<a name="ln-5109"></a><span class="k">         </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! do not set &quot;ans&quot; to filename</span>
<a name="ln-5110"></a>         <span class="k">endblock </span><span class="n">DELETE_IT</span>
<a name="ln-5111"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5112"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! command::load</span>
<a name="ln-5113"></a>      <span class="k">call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">GG_LINELEN</span><span class="p">)</span>
<a name="ln-5114"></a>
<a name="ln-5115"></a>      <span class="n">lunit</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5116"></a>      <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="n">LUNIT</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span> <span class="c">! open the unit</span>
<a name="ln-5117"></a>      <span class="k">call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">GG_LINELEN</span><span class="p">)</span>
<a name="ln-5118"></a>
<a name="ln-5119"></a>      <span class="k">do</span>
<a name="ln-5120"></a><span class="k">         </span><span class="n">space_left</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="o">-</span> <span class="n">location</span>
<a name="ln-5121"></a>         <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">G_FILE_OPEN_ERROR</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5122"></a><span class="k">            call </span><span class="n">mat_savlod</span><span class="p">(</span><span class="n">lunit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5123"></a>                <span class="p">&amp;</span> <span class="n">id</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5124"></a>                <span class="p">&amp;</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5125"></a>                <span class="p">&amp;</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5126"></a>                <span class="p">&amp;</span> <span class="n">img</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5127"></a>                <span class="p">&amp;</span> <span class="n">space_left</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5128"></a>                <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5129"></a>                <span class="p">&amp;</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-5130"></a>         <span class="k">endif</span>
<a name="ln-5131"></a>
<a name="ln-5132"></a><span class="k">         </span><span class="n">mn</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5133"></a>
<a name="ln-5134"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">mn</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5135"></a><span class="k">            if</span> <span class="p">(</span><span class="n">img</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5136"></a>
<a name="ln-5137"></a>            <span class="c">!do i = 1, GG_MAX_NAME_LENGTH</span>
<a name="ln-5138"></a>            <span class="c">!   do j=1,G_CHARSET_SIZE</span>
<a name="ln-5139"></a>            <span class="c">!      if(id(i).eq.blank)then</span>
<a name="ln-5140"></a>            <span class="c">!         id(i) = blank</span>
<a name="ln-5141"></a>            <span class="c">!         exit</span>
<a name="ln-5142"></a>            <span class="c">!      elseif (id(i).ne.J)then</span>
<a name="ln-5143"></a>            <span class="c">!         cycle</span>
<a name="ln-5144"></a>            <span class="c">!      else</span>
<a name="ln-5145"></a>            <span class="c">!         id(i) = j-1  ! ????</span>
<a name="ln-5146"></a>            <span class="c">!         exit</span>
<a name="ln-5147"></a>            <span class="c">!      endif</span>
<a name="ln-5148"></a>            <span class="c">!   enddo</span>
<a name="ln-5149"></a>            <span class="c">!enddo</span>
<a name="ln-5150"></a>
<a name="ln-5151"></a>            <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">semi</span>
<a name="ln-5152"></a>            <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5153"></a>            <span class="k">call </span><span class="n">MAT_STACK_PUT</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<a name="ln-5154"></a>            <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5155"></a>         <span class="k">else</span>
<a name="ln-5156"></a><span class="k">            exit</span>
<a name="ln-5157"></a><span class="k">         endif</span>
<a name="ln-5158"></a>
<a name="ln-5159"></a><span class="k">      enddo</span>
<a name="ln-5160"></a>
<a name="ln-5161"></a><span class="k">      call </span><span class="n">mat_files</span><span class="p">(</span><span class="o">-</span><span class="n">lunit</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span> <span class="c">! close unit</span>
<a name="ln-5162"></a>
<a name="ln-5163"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5164"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5165"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">! command::print</span>
<a name="ln-5166"></a>      <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-5167"></a>
<a name="ln-5168"></a>      <span class="n">location</span> <span class="o">=</span> <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                       <span class="c">! hold</span>
<a name="ln-5169"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">999999</span>                         <span class="c">! turn off paging of output</span>
<a name="ln-5170"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_print</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">top2</span><span class="p">)</span>
<a name="ln-5171"></a>
<a name="ln-5172"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span>                       <span class="c">! restore</span>
<a name="ln-5173"></a>
<a name="ln-5174"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5175"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5176"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c">! command::diary</span>
<a name="ln-5177"></a>      <span class="k">call </span><span class="n">mat_files</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">)</span>
<a name="ln-5178"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5179"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5180"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="c">!     COMMAND::DISPLAY</span>
<a name="ln-5181"></a><span class="mi">60</span>    <span class="k">continue</span>
<a name="ln-5182"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_FIN</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span><span class="k">goto </span><span class="mi">65</span>
<a name="ln-5183"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5184"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span>           <span class="c">! Incorrect number of arguments</span>
<a name="ln-5185"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">then</span>       <span class="c">! test if base is 0</span>
<a name="ln-5186"></a>            <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>                          <span class="c">! Argument out of range</span>
<a name="ln-5187"></a>            <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5188"></a>         <span class="k">endif</span>
<a name="ln-5189"></a><span class="k">         </span><span class="n">b</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5190"></a>         <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5191"></a><span class="k">            goto </span><span class="mi">65</span>
<a name="ln-5192"></a>         <span class="k">endif</span>
<a name="ln-5193"></a><span class="k">      else</span>
<a name="ln-5194"></a><span class="k">         </span><span class="n">b</span><span class="o">=</span><span class="mi">10</span>
<a name="ln-5195"></a>      <span class="k">endif</span>
<a name="ln-5196"></a><span class="k">      </span><span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-5197"></a>      <span class="n">text</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5198"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-5199"></a>        <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5200"></a>        <span class="n">ch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">))</span>
<a name="ln-5201"></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">G_CHARSET_SIZE</span><span class="p">)</span>
<a name="ln-5202"></a>        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">dble</span><span class="p">(</span><span class="n">ch</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5203"></a>      <span class="k">enddo</span>
<a name="ln-5204"></a><span class="k">      if</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="n">text</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! for forcing non-text display when values are in range of text</span>
<a name="ln-5205"></a>
<a name="ln-5206"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-5207"></a>         <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-5208"></a>           <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-5209"></a>           <span class="k">if</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">blank</span>
<a name="ln-5210"></a>           <span class="k">if</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">plus</span>
<a name="ln-5211"></a>           <span class="k">if</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">minus</span>
<a name="ln-5212"></a>           <span class="k">if</span> <span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="n">ch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span>
<a name="ln-5213"></a>           <span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">ch</span>
<a name="ln-5214"></a>         <span class="k">enddo</span>
<a name="ln-5215"></a><span class="k">         call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-5216"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-5217"></a>      <span class="k">enddo</span>
<a name="ln-5218"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5219"></a>      <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5220"></a><span class="c">!. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span>
<a name="ln-5221"></a><span class="c">!     command::base</span>
<a name="ln-5222"></a>   <span class="mi">65</span> <span class="k">CONTINUE</span>
<a name="ln-5223"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5224"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span>                         <span class="c">! Incorrect number of arguments</span>
<a name="ln-5225"></a>         <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5226"></a>      <span class="k">endif</span>
<a name="ln-5227"></a><span class="k">      if</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>     <span class="c">! test if base is &lt;= 0</span>
<a name="ln-5228"></a>         <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>                         <span class="c">! Argument out of range</span>
<a name="ln-5229"></a>         <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5230"></a>      <span class="k">endif</span>
<a name="ln-5231"></a><span class="k">      </span><span class="n">b</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5232"></a>      <span class="n">l2</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-5233"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5234"></a>      <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5235"></a>      <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5236"></a>      <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5237"></a>      <span class="n">eps</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-5238"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-5239"></a>         <span class="n">ls</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>
<a name="ln-5240"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5241"></a>         <span class="k">call </span><span class="n">mat_base</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">b</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">n</span><span class="p">)</span>
<a name="ln-5242"></a>      <span class="k">enddo</span>
<a name="ln-5243"></a><span class="k">      call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5244"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5245"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-5246"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-5247"></a>      <span class="k">call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">quote</span><span class="p">)</span>
<a name="ln-5248"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">6</span><span class="p">)</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-5249"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5250"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-5251"></a><span class="c">!     command::lines</span>
<a name="ln-5252"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-5253"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5254"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5255"></a>      <span class="c">!!! BROKEN BY GOING TO ASCII. ELIMINATE OR CORRECT</span>
<a name="ln-5256"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="c">!     COMMAND::CHAR                   ! does currently not do anything</span>
<a name="ln-5257"></a>      <span class="n">K</span> <span class="o">=</span> <span class="nb">IABS</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)))</span>
<a name="ln-5258"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">K</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">G_CHARSET_SIZE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5259"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="c">! Argument out of range</span>
<a name="ln-5260"></a>         <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5261"></a>      <span class="k">endif</span>
<a name="ln-5262"></a><span class="k">      </span><span class="n">CH</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-5263"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5264"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5265"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c">!     COMMAND::PLOT</span>
<a name="ln-5266"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">82</span>
<a name="ln-5267"></a>      <span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-5268"></a>      <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-5269"></a>         <span class="n">LL</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5270"></a>         <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5271"></a>      <span class="k">enddo</span>
<a name="ln-5272"></a><span class="k">      call </span><span class="n">mat_plot</span><span class="p">(</span><span class="n">STDOUT</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">TDUM</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-5273"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5274"></a>      <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5275"></a><span class="c">!. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span>
<a name="ln-5276"></a>
<a name="ln-5277"></a>   <span class="mi">82</span> <span class="k">continue</span>
<a name="ln-5278"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5279"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="n">K</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-5280"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="n">K</span> <span class="o">=</span> <span class="n">G_RHS</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-5281"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-5282"></a>      <span class="n">N</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5283"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">N</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5284"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-5285"></a>         <span class="k">exit </span><span class="n">FUN5</span>
<a name="ln-5286"></a>      <span class="k">endif</span>
<a name="ln-5287"></a><span class="k">      </span><span class="n">LX</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5288"></a>      <span class="n">LY</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5289"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5290"></a>      <span class="k">call </span><span class="n">mat_plot</span><span class="p">(</span><span class="n">STDOUT</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LX</span><span class="p">),</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LY</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5291"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5292"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5293"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c">! COMMAND::RAT</span>
<a name="ln-5294"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5295"></a><span class="k">         </span><span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-5296"></a>         <span class="n">l2</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-5297"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_lhs</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">mn</span>
<a name="ln-5298"></a>         <span class="n">lw</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">+</span> <span class="n">mn</span>
<a name="ln-5299"></a>
<a name="ln-5300"></a>         <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">lw</span> <span class="o">+</span> <span class="n">lrat</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-5301"></a>
<a name="ln-5302"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_lhs</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5303"></a>         <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">l2</span>
<a name="ln-5304"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-5305"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-5306"></a>         <span class="k">call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">G_lhs</span><span class="o">*</span><span class="n">mn</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5307"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-5308"></a>            <span class="k">call </span><span class="n">mat_rat</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">lrat</span><span class="p">,</span><span class="n">mrat</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lw</span><span class="p">))</span>
<a name="ln-5309"></a>            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span>
<a name="ln-5310"></a>            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span>
<a name="ln-5311"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">G_lhs</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="n">t</span><span class="p">)</span>
<a name="ln-5312"></a>            <span class="n">location</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5313"></a>            <span class="n">l2</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5314"></a>         <span class="k">enddo</span>
<a name="ln-5315"></a><span class="k">      else</span>
<a name="ln-5316"></a><span class="k">         </span><span class="n">mrat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-5317"></a>         <span class="n">lrat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5318"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-5319"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5320"></a>      <span class="k">endif</span>
<a name="ln-5321"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5322"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c">!     COMMAND::DEBUG</span>
<a name="ln-5323"></a>      <span class="n">G_DEBUG_LEVEL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
<a name="ln-5324"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39; DEBUG &#39;</span><span class="p">,</span><span class="n">G_DEBUG_LEVEL</span><span class="p">)</span>
<a name="ln-5325"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5326"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5327"></a>      <span class="k">case</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c">!     COMMAND::SHOW</span>
<a name="ln-5328"></a>      <span class="k">call </span><span class="n">printit</span><span class="p">()</span>
<a name="ln-5329"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5330"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5331"></a>      <span class="k">end select </span><span class="n">FUN5</span>
<a name="ln-5332"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-5333"></a><span class="k">end subroutine </span><span class="n">mat_matfn5</span>
<a name="ln-5334"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5335"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-5336"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5337"></a><span class="k">subroutine </span><span class="n">mat_stack_get</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-5338"></a>
<a name="ln-5339"></a><span class="c">! ident_29=&quot;@(#)M_matrix::mat_stack_get(3fp): get variables from storage&quot;</span>
<a name="ln-5340"></a>
<a name="ln-5341"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-5342"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">i</span>
<a name="ln-5343"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">j</span>
<a name="ln-5344"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">k</span>
<a name="ln-5345"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">location</span>
<a name="ln-5346"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">l2</span>
<a name="ln-5347"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">l3</span>
<a name="ln-5348"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">li</span>
<a name="ln-5349"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">lj</span>
<a name="ln-5350"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">current_location</span>
<a name="ln-5351"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">ll</span>
<a name="ln-5352"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-5353"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">m</span>
<a name="ln-5354"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">mk</span>
<a name="ln-5355"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">mn</span>
<a name="ln-5356"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">mnk</span>
<a name="ln-5357"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">n</span>
<a name="ln-5358"></a>
<a name="ln-5359"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">ID</span><span class="p">)</span>    <span class="c">! copy ID to next blank entry in G_VAR_IDS in case it is not there(?)</span>
<a name="ln-5360"></a>
<a name="ln-5361"></a>   <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>                      <span class="c">! start at bottom and search up through names till find the name</span>
<a name="ln-5362"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">:,</span><span class="n">k</span><span class="p">),</span> <span class="n">id</span><span class="p">))</span><span class="k">exit</span>             <span class="c">! if found name exit loop</span>
<a name="ln-5363"></a>   <span class="k">enddo</span>
<a name="ln-5364"></a>   <span class="c">! if (?)</span>
<a name="ln-5365"></a>   <span class="c">! or if matched the name inserted above did not find it.</span>
<a name="ln-5366"></a>   <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_RHS</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-5367"></a><span class="k">      </span><span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5368"></a>      <span class="k">return</span>
<a name="ln-5369"></a><span class="k">   endif</span>
<a name="ln-5370"></a>
<a name="ln-5371"></a><span class="k">   </span><span class="n">current_location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>                               <span class="c">! found it, so this is the location where the data begins</span>
<a name="ln-5372"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>                                             <span class="c">! VECT(ARG)</span>
<a name="ln-5373"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-5374"></a>      <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5375"></a>      <span class="n">MN</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5376"></a>      <span class="n">MNK</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>                            <span class="c">! number of values in this variable</span>
<a name="ln-5377"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">MN</span> <span class="o">=</span> <span class="n">MNK</span>
<a name="ln-5378"></a>      <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MN</span>
<a name="ln-5379"></a>        <span class="n">LL</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5380"></a>        <span class="n">LS</span> <span class="o">=</span> <span class="n">current_location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5381"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">LS</span> <span class="o">=</span> <span class="n">current_location</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-5382"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">LS</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">current_location</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LS</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">current_location</span><span class="o">+</span><span class="n">MNK</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5383"></a><span class="k">           call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>          <span class="c">! Subscript out of range</span>
<a name="ln-5384"></a>           <span class="k">return</span>
<a name="ln-5385"></a><span class="k">        endif</span>
<a name="ln-5386"></a><span class="k">        </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-5387"></a>        <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-5388"></a>      <span class="k">enddo</span>
<a name="ln-5389"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5390"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5391"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">MN</span>
<a name="ln-5392"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">MN</span>
<a name="ln-5393"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-5394"></a>   <span class="n">elseif</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>                                              <span class="c">! MATRIX(ARG,ARG)</span>
<a name="ln-5395"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5396"></a>      <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5397"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5398"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">99</span>
<a name="ln-5399"></a>      <span class="n">L2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5400"></a>      <span class="n">M</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5401"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">M</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5402"></a>      <span class="n">N</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5403"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">N</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5404"></a>      <span class="n">L3</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">+</span> <span class="n">N</span>
<a name="ln-5405"></a>      <span class="n">MK</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5406"></a>      <span class="n">MNK</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5407"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-5408"></a>         <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">M</span>
<a name="ln-5409"></a>           <span class="n">LI</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5410"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">LI</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LI</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-5411"></a>           <span class="n">LJ</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5412"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">LJ</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LJ</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-5413"></a>           <span class="n">LS</span> <span class="o">=</span> <span class="n">current_location</span> <span class="o">+</span> <span class="n">LI</span><span class="o">-</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">LJ</span><span class="o">-</span><span class="n">L2</span><span class="p">)</span><span class="o">*</span><span class="n">MK</span>
<a name="ln-5414"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">LS</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">current_location</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LS</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="n">current_location</span><span class="o">+</span><span class="n">MNK</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5415"></a><span class="k">              call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-5416"></a>              <span class="k">return</span>
<a name="ln-5417"></a><span class="k">           endif</span>
<a name="ln-5418"></a><span class="k">           </span><span class="n">LL</span> <span class="o">=</span> <span class="n">L3</span> <span class="o">+</span> <span class="n">I</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">M</span>
<a name="ln-5419"></a>           <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-5420"></a>           <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">)</span>
<a name="ln-5421"></a>         <span class="k">enddo</span>
<a name="ln-5422"></a><span class="k">      enddo</span>
<a name="ln-5423"></a><span class="k">      </span><span class="n">MN</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-5424"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">MN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5425"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span>
<a name="ln-5426"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-5427"></a>      <span class="k">goto </span><span class="mi">99</span>
<a name="ln-5428"></a>   <span class="n">elseif</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5429"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>                                                     <span class="c">! Subscript out of range</span>
<a name="ln-5430"></a>      <span class="k">return</span>
<a name="ln-5431"></a><span class="k">   else</span>                                                                    <span class="c">! SCALAR</span>
<a name="ln-5432"></a>      <span class="n">location</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5433"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5434"></a>        <span class="p">&amp;</span> <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5435"></a>        <span class="p">&amp;</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5436"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5437"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="c">! Too many names</span>
<a name="ln-5438"></a>         <span class="k">return</span>
<a name="ln-5439"></a><span class="k">      endif</span>
<a name="ln-5440"></a>
<a name="ln-5441"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5442"></a>
<a name="ln-5443"></a>      <span class="c">!  LOAD VARIABLE TO TOP OF STACK</span>
<a name="ln-5444"></a>      <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-5445"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5446"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5447"></a>      <span class="n">MN</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-5448"></a>
<a name="ln-5449"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">location</span><span class="o">+</span><span class="n">MN</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-5450"></a>
<a name="ln-5451"></a>      <span class="c">!  IF RAND, MATFN6 GENERATES RANDOM NUMBER</span>
<a name="ln-5452"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">K</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5453"></a><span class="k">         </span><span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">7</span>
<a name="ln-5454"></a>         <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-5455"></a>         <span class="k">return</span>
<a name="ln-5456"></a><span class="k">      endif</span>
<a name="ln-5457"></a><span class="k">      call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">MN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">current_location</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-5458"></a>                        <span class="p">&amp;</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">current_location</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5459"></a>                        <span class="p">&amp;</span> <span class="mi">1</span><span class="p">,</span>                               <span class="p">&amp;</span>
<a name="ln-5460"></a>                        <span class="p">&amp;</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>         <span class="p">&amp;</span>
<a name="ln-5461"></a>                        <span class="p">&amp;</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>         <span class="p">&amp;</span>
<a name="ln-5462"></a>                        <span class="p">&amp;</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-5463"></a>   <span class="k">endif</span>
<a name="ln-5464"></a>
<a name="ln-5465"></a><span class="mi">99</span> <span class="k">continue</span>
<a name="ln-5466"></a><span class="k">   </span><span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-5467"></a>   <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5468"></a>
<a name="ln-5469"></a><span class="k">END SUBROUTINE </span><span class="n">MAT_STACK_GET</span>
<a name="ln-5470"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5471"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-5472"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5473"></a><span class="k">subroutine </span><span class="n">mat_stack2</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
<a name="ln-5474"></a>
<a name="ln-5475"></a><span class="c">! ident_30=&quot;@(#)M_matrix::ml_stackp(3fp): binary and ternary operations&quot;</span>
<a name="ln-5476"></a>
<a name="ln-5477"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">op</span>
<a name="ln-5478"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">e1</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">e2</span>
<a name="ln-5479"></a>
<a name="ln-5480"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">i</span>
<a name="ln-5481"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">j</span>
<a name="ln-5482"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">k</span>
<a name="ln-5483"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">k1</span>
<a name="ln-5484"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">k2</span>
<a name="ln-5485"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">kexp</span>
<a name="ln-5486"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">location</span>
<a name="ln-5487"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">l1</span>
<a name="ln-5488"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">l2</span>
<a name="ln-5489"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">l3</span>
<a name="ln-5490"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">ll</span>
<a name="ln-5491"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">ls</span>
<a name="ln-5492"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">m</span>
<a name="ln-5493"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">m2</span>
<a name="ln-5494"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">mn</span>
<a name="ln-5495"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">n</span>
<a name="ln-5496"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">n2</span>
<a name="ln-5497"></a><span class="kt">integer</span>           <span class="kd">::</span>  <span class="n">nexp</span>
<a name="ln-5498"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">op_select</span>
<a name="ln-5499"></a>
<a name="ln-5500"></a>   <span class="n">l2</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5501"></a>   <span class="n">m2</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5502"></a>   <span class="n">n2</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5503"></a>   <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5504"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5505"></a>   <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5506"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5507"></a>   <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5508"></a>
<a name="ln-5509"></a>   <span class="k">if</span><span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">DSTAR</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5510"></a><span class="k">      </span><span class="n">op_select</span><span class="o">=-</span><span class="n">op</span>
<a name="ln-5511"></a>   <span class="k">else</span>
<a name="ln-5512"></a><span class="k">      </span><span class="n">op_select</span><span class="o">=</span><span class="n">op</span>
<a name="ln-5513"></a>   <span class="k">endif</span>
<a name="ln-5514"></a><span class="k">   </span><span class="n">DO_OP</span><span class="p">:</span> <span class="k">select case</span><span class="p">(</span><span class="n">op_select</span><span class="p">)</span>
<a name="ln-5515"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5516"></a>   <span class="k">case</span> <span class="p">(</span><span class="n">PLUS</span><span class="p">)</span> <span class="c">! ADDITION</span>
<a name="ln-5517"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5518"></a><span class="k">         if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5519"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-5520"></a>            <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5521"></a>         <span class="k">endif</span>
<a name="ln-5522"></a><span class="k">         </span><span class="n">m</span> <span class="o">=</span> <span class="n">m2</span>
<a name="ln-5523"></a>         <span class="n">n</span> <span class="o">=</span> <span class="n">n2</span>
<a name="ln-5524"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-5525"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-5526"></a>         <span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5527"></a>         <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5528"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5529"></a>         <span class="k">call </span><span class="n">finish</span><span class="p">()</span>
<a name="ln-5530"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5531"></a>      <span class="k">endif</span>
<a name="ln-5532"></a><span class="k">      if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5533"></a><span class="k">         if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5534"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-5535"></a>            <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5536"></a>         <span class="k">endif</span>
<a name="ln-5537"></a><span class="k">         </span><span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5538"></a>         <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5539"></a>         <span class="k">call </span><span class="n">finish</span><span class="p">()</span>
<a name="ln-5540"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5541"></a>      <span class="k">endif</span>
<a name="ln-5542"></a><span class="k">      if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">m2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5543"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-5544"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5545"></a>      <span class="k">endif</span>
<a name="ln-5546"></a><span class="k">      if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5547"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-5548"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5549"></a>      <span class="k">endif</span>
<a name="ln-5550"></a><span class="k">      call </span><span class="n">matX_waxpy</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5551"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5552"></a>   <span class="k">case</span> <span class="p">(</span><span class="n">MINUS</span><span class="p">)</span> <span class="c">! SUBTRACTION</span>
<a name="ln-5553"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5554"></a><span class="k">         if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5555"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-5556"></a>            <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5557"></a>         <span class="k">endif</span>
<a name="ln-5558"></a><span class="k">         </span><span class="n">m</span> <span class="o">=</span> <span class="n">m2</span>
<a name="ln-5559"></a>         <span class="n">n</span> <span class="o">=</span> <span class="n">n2</span>
<a name="ln-5560"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-5561"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-5562"></a>         <span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5563"></a>         <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5564"></a>         <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5565"></a>         <span class="k">call </span><span class="n">mat_wrscal</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5566"></a>         <span class="k">call </span><span class="n">finish</span><span class="p">()</span>
<a name="ln-5567"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5568"></a>      <span class="k">endif</span>
<a name="ln-5569"></a><span class="k">      if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5570"></a>         <span class="c">! add or subtract scalar</span>
<a name="ln-5571"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5572"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-5573"></a>            <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5574"></a>         <span class="k">endif</span>
<a name="ln-5575"></a><span class="k">         </span><span class="n">sr</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5576"></a>         <span class="n">si</span> <span class="o">=</span> <span class="o">-</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5577"></a>         <span class="k">call </span><span class="n">finish</span><span class="p">()</span>
<a name="ln-5578"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5579"></a>      <span class="k">endif</span>
<a name="ln-5580"></a><span class="k">      if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">m2</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5581"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-5582"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5583"></a>      <span class="k">endif</span>
<a name="ln-5584"></a><span class="k">      if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5585"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-5586"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5587"></a>      <span class="k">endif</span>
<a name="ln-5588"></a><span class="k">      call </span><span class="n">matX_waxpy</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0D0</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5589"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5590"></a>   <span class="k">case</span> <span class="p">(</span><span class="n">STAR</span><span class="p">)</span> <span class="c">! MULTIPLICATION</span>
<a name="ln-5591"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m2</span><span class="o">*</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">10</span>
<a name="ln-5592"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">11</span>
<a name="ln-5593"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">10</span>
<a name="ln-5594"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">m2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5595"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-5596"></a>         <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5597"></a>      <span class="k">endif</span>
<a name="ln-5598"></a><span class="k">      </span><span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n2</span>
<a name="ln-5599"></a>      <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">mn</span>
<a name="ln-5600"></a>
<a name="ln-5601"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">ll</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">))</span> <span class="p">)</span> <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5602"></a>
<a name="ln-5603"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5604"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-5605"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-5606"></a>            <span class="n">k1</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">mn</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5607"></a>            <span class="n">k2</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">+</span> <span class="n">mn</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m2</span>
<a name="ln-5608"></a>            <span class="n">k</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-5609"></a>            <span class="n">GM_REALS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wdotur</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">k1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">k1</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">k2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">k2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5610"></a>            <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_wdotui</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">k1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">k1</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">k2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">k2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5611"></a>         <span class="k">enddo</span>
<a name="ln-5612"></a><span class="k">      enddo</span>
<a name="ln-5613"></a><span class="k">      </span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n2</span>
<a name="ln-5614"></a>      <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5615"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5616"></a>   <span class="c">! multiplication by scalar</span>
<a name="ln-5617"></a>   <span class="mi">10</span> <span class="k">continue</span>
<a name="ln-5618"></a><span class="k">      </span><span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5619"></a>      <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5620"></a>      <span class="n">l1</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-5621"></a>      <span class="k">goto </span><span class="mi">13</span>
<a name="ln-5622"></a>   <span class="mi">11</span> <span class="k">continue</span>
<a name="ln-5623"></a><span class="k">      </span><span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5624"></a>      <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5625"></a>      <span class="n">l1</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5626"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m2</span>
<a name="ln-5627"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n2</span>
<a name="ln-5628"></a>   <span class="mi">13</span> <span class="k">continue</span>
<a name="ln-5629"></a><span class="k">      </span><span class="n">mn</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5630"></a>      <span class="k">call </span><span class="n">mat_wscal</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5631"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">l1</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">location</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5632"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5633"></a>   <span class="k">case</span> <span class="p">(</span><span class="o">-</span><span class="n">DSTAR</span><span class="p">)</span> <span class="c">! POWER</span>
<a name="ln-5634"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">M2</span><span class="o">*</span><span class="n">N2</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5635"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<a name="ln-5636"></a>         <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5637"></a>      <span class="k">endif</span>
<a name="ln-5638"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">M</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">N</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5639"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-5640"></a>         <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5641"></a>      <span class="k">endif</span>
<a name="ln-5642"></a><span class="k">      </span><span class="n">NEXP</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">))</span>
<a name="ln-5643"></a>
<a name="ln-5644"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="nb">dble</span><span class="p">(</span><span class="n">NEXP</span><span class="p">))</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">NEXP</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-5645"></a>         <span class="c">! NONINTEGER OR NONPOSITIVE POWER, USE EIGENVECTORS</span>
<a name="ln-5646"></a>         <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5647"></a>         <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5648"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5649"></a>      <span class="k">endif</span>
<a name="ln-5650"></a>
<a name="ln-5651"></a><span class="k">      </span><span class="n">MN</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span>
<a name="ln-5652"></a>
<a name="ln-5653"></a>      <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">L2</span><span class="o">+</span><span class="n">MN</span><span class="o">+</span><span class="n">N</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">))</span> <span class="p">)</span> <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5654"></a>
<a name="ln-5655"></a>      <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">MN</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5656"></a>      <span class="n">L3</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">MN</span>
<a name="ln-5657"></a>      <span class="k">DO </span><span class="n">KEXP</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NEXP</span>
<a name="ln-5658"></a>         <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-5659"></a>            <span class="n">LS</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-5660"></a>            <span class="k">call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5661"></a>            <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-5662"></a>               <span class="n">LS</span> <span class="o">=</span> <span class="n">L2</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5663"></a>               <span class="n">LL</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span>
<a name="ln-5664"></a>               <span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="o">=</span><span class="n">mat_wdotur</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5665"></a>               <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="o">=</span><span class="n">mat_wdotui</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LS</span><span class="p">),</span><span class="n">N</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">L3</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5666"></a>            <span class="k">enddo</span>
<a name="ln-5667"></a><span class="k">         enddo</span>
<a name="ln-5668"></a><span class="k">      enddo</span>
<a name="ln-5669"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5670"></a>   <span class="k">case</span> <span class="p">(</span><span class="n">SLASH</span><span class="p">)</span> <span class="c">! right division</span>
<a name="ln-5671"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5672"></a><span class="k">         if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span> <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5673"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">m2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n2</span><span class="p">)</span> <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-5674"></a>         <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-5675"></a>         <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5676"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5677"></a>      <span class="k">endif</span>
<a name="ln-5678"></a><span class="k">      </span><span class="n">sr</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5679"></a>      <span class="n">si</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a name="ln-5680"></a>      <span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-5681"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-5682"></a>         <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5683"></a>         <span class="k">call </span><span class="n">mat_wdiv</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">sr</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">))</span>
<a name="ln-5684"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-5685"></a><span class="k">      enddo</span>
<a name="ln-5686"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5687"></a>   <span class="k">case</span> <span class="p">(</span><span class="n">BSLASH</span><span class="p">)</span> <span class="c">! LEFT DIVISION</span>
<a name="ln-5688"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5689"></a><span class="k">         if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5690"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-5691"></a>         <span class="n">G_FIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<a name="ln-5692"></a>         <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5693"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5694"></a>      <span class="k">endif</span>
<a name="ln-5695"></a><span class="k">      </span><span class="n">SR</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5696"></a>      <span class="n">SI</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5697"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">M2</span>
<a name="ln-5698"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N2</span>
<a name="ln-5699"></a>      <span class="n">MN</span> <span class="o">=</span> <span class="n">M2</span><span class="o">*</span><span class="n">N2</span>
<a name="ln-5700"></a>      <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MN</span>
<a name="ln-5701"></a>         <span class="n">LL</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5702"></a>         <span class="k">call </span><span class="n">mat_wdiv</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">SR</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">))</span>
<a name="ln-5703"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-5704"></a><span class="k">      enddo</span>
<a name="ln-5705"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5706"></a>   <span class="k">case</span> <span class="p">(</span><span class="n">COLON</span><span class="p">)</span> <span class="c">! COLON</span>
<a name="ln-5707"></a>      <span class="n">E2</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
<a name="ln-5708"></a>      <span class="n">ST</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-5709"></a>      <span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5710"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_RHS</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5711"></a><span class="k">         </span><span class="n">ST</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5712"></a>         <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5713"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5714"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ST</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">63</span>
<a name="ln-5715"></a>      <span class="k">endif</span>
<a name="ln-5716"></a>
<a name="ln-5717"></a><span class="k">      </span><span class="n">E1</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-5718"></a>      <span class="c">! CHECK FOR CLAUSE</span>
<a name="ln-5719"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5720"></a>   <span class="c">!     FOR CLAUSE</span>
<a name="ln-5721"></a>         <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">E1</span>
<a name="ln-5722"></a>         <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ST</span>
<a name="ln-5723"></a>         <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">E2</span>
<a name="ln-5724"></a>         <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<a name="ln-5725"></a>         <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-5726"></a>         <span class="k">exit </span><span class="n">DO_OP</span>
<a name="ln-5727"></a>      <span class="k">endif</span>
<a name="ln-5728"></a>
<a name="ln-5729"></a><span class="k">      if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">location</span> <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">int</span><span class="p">((</span><span class="n">E2</span><span class="o">-</span><span class="n">E1</span><span class="p">)</span><span class="o">/</span><span class="n">ST</span><span class="p">))</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5730"></a>
<a name="ln-5731"></a>      <span class="k">do</span>
<a name="ln-5732"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">ST</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">E2</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-5733"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">ST</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">E2</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-5734"></a><span class="k">         </span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5735"></a>         <span class="n">location</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5736"></a>         <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">E1</span> <span class="o">+</span> <span class="nb">dble</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">ST</span>
<a name="ln-5737"></a>         <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-5738"></a>      <span class="k">enddo</span>
<a name="ln-5739"></a>
<a name="ln-5740"></a><span class="k">   </span><span class="mi">63</span> <span class="k">continue</span>
<a name="ln-5741"></a><span class="k">      </span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-5742"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5743"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">N</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5744"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5745"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">1000</span><span class="p">:</span><span class="mi">2000</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">! element-wise operations</span>
<a name="ln-5746"></a>      <span class="n">op</span> <span class="o">=</span> <span class="n">op</span> <span class="o">-</span><span class="mi">1000</span>
<a name="ln-5747"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">m2</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">n</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">n2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5748"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-5749"></a>         <span class="k">exit </span><span class="n">do_op</span>
<a name="ln-5750"></a>      <span class="k">endif</span>
<a name="ln-5751"></a><span class="k">      </span><span class="n">mn</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-5752"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mn</span>
<a name="ln-5753"></a>         <span class="n">j</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5754"></a>         <span class="n">k</span> <span class="o">=</span> <span class="n">l2</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5755"></a>         <span class="k">select case</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
<a name="ln-5756"></a>         <span class="k">case</span><span class="p">(</span><span class="n">STAR</span><span class="p">)</span>
<a name="ln-5757"></a>         <span class="k">call </span><span class="n">mat_wmul</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5758"></a>                                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">K</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5759"></a>                                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
<a name="ln-5760"></a>         <span class="k">case</span><span class="p">(</span><span class="n">SLASH</span><span class="p">)</span>
<a name="ln-5761"></a>         <span class="k">call </span><span class="n">mat_wdiv</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5762"></a>                                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">K</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5763"></a>                                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
<a name="ln-5764"></a>         <span class="k">case</span><span class="p">(</span><span class="n">BSLASH</span><span class="p">)</span>
<a name="ln-5765"></a>         <span class="k">call </span><span class="n">mat_wdiv</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">K</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5766"></a>                                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5767"></a>                                        <span class="n">GM_REALS</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
<a name="ln-5768"></a>         <span class="k">end select</span>
<a name="ln-5769"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-5770"></a><span class="k">      enddo</span>
<a name="ln-5771"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5772"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">2000</span><span class="p">:)</span> <span class="c">! kronecker</span>
<a name="ln-5773"></a>      <span class="n">G_FIN</span> <span class="o">=</span> <span class="n">op</span> <span class="o">-</span> <span class="mi">2000</span> <span class="o">-</span> <span class="n">star</span> <span class="o">+</span> <span class="mi">11</span>
<a name="ln-5774"></a>      <span class="n">G_FUN</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-5775"></a>      <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5776"></a>      <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5777"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5778"></a>   <span class="k">case </span><span class="n">default</span>
<a name="ln-5779"></a>      <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;&lt;ERROR&gt; unknown operator &#39;</span><span class="p">,</span><span class="n">op</span>
<a name="ln-5780"></a>      <span class="k">stop</span>
<a name="ln-5781"></a><span class="k">   end select </span><span class="n">DO_OP</span>
<a name="ln-5782"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-5783"></a><span class="k">contains</span>
<a name="ln-5784"></a><span class="k">subroutine </span><span class="n">finish</span><span class="p">()</span>
<a name="ln-5785"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-5786"></a>      <span class="n">ll</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5787"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="o">+</span><span class="n">sr</span><span class="p">)</span>
<a name="ln-5788"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="o">+</span><span class="n">si</span><span class="p">)</span>
<a name="ln-5789"></a>   <span class="k">enddo</span>
<a name="ln-5790"></a><span class="k">end subroutine </span><span class="n">finish</span>
<a name="ln-5791"></a><span class="k">end subroutine </span><span class="n">mat_stack2</span>
<a name="ln-5792"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5793"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-5794"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5795"></a><span class="k">subroutine </span><span class="n">mat_getlin</span><span class="p">()</span> <span class="c">! get a new input line</span>
<a name="ln-5796"></a>
<a name="ln-5797"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mline</span>
<a name="ln-5798"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">shift_mline</span>
<a name="ln-5799"></a>
<a name="ln-5800"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-5801"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>         <span class="kd">::</span> <span class="n">retu</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5802"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-5803"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">l</span>
<a name="ln-5804"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">n</span>
<a name="ln-5805"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-5806"></a><span class="c">!.......................................................................</span>
<a name="ln-5807"></a>   <span class="n">l</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5808"></a><span class="c">!.......................................................................</span>
<a name="ln-5809"></a>   <span class="mi">11</span> <span class="k">continue</span>
<a name="ln-5810"></a>
<a name="ln-5811"></a><span class="k">      </span><span class="n">G_BUF</span><span class="p">(:</span><span class="n">GG_LINELEN</span><span class="p">)</span><span class="o">=</span> <span class="n">blank</span>      <span class="c">! blank out buffer before reading into it</span>
<a name="ln-5812"></a>      <span class="n">n</span> <span class="o">=</span> <span class="n">GG_LINELEN</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5813"></a>
<a name="ln-5814"></a>      <span class="c">! get line of input and place it in line buffer</span>
<a name="ln-5815"></a>      <span class="k">if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">1.</span><span class="nb">and</span><span class="p">.</span><span class="n">G_RIO</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">STDIN</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5816"></a><span class="k">         </span><span class="n">mline</span><span class="o">=</span><span class="n">get_pseudo_line</span><span class="p">()</span>
<a name="ln-5817"></a>         <span class="n">G_RIO</span> <span class="o">=</span> <span class="n">G_INPUT_LUN</span>
<a name="ln-5818"></a>      <span class="n">elseif</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">G_RIO</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">STDIN</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5819"></a><span class="k">         </span><span class="n">mline</span><span class="o">=</span><span class="n">get_pseudo_line</span><span class="p">()</span>
<a name="ln-5820"></a>      <span class="k">else</span>
<a name="ln-5821"></a><span class="k">         </span><span class="n">mline</span><span class="p">(:)</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-5822"></a>         <span class="k">read</span><span class="p">(</span><span class="n">G_RIO</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span> <span class="n">mline</span>       <span class="c">! read input line from file</span>
<a name="ln-5823"></a>         <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">ios</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-5824"></a><span class="k">             if</span><span class="p">(</span><span class="nb">is_iostat_end</span><span class="p">(</span><span class="n">ios</span><span class="p">))</span><span class="k">then</span>           <span class="c">! hit end of file</span>
<a name="ln-5825"></a>                <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_LIN</span><span class="p">(</span><span class="n">l</span><span class="p">),</span><span class="n">retu</span><span class="p">)</span> <span class="c">! store QUIT onto G_LIN(L) to simulate RETURN command</span>
<a name="ln-5826"></a>                <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">4</span>
<a name="ln-5827"></a>                <span class="k">goto </span><span class="mi">45</span>
<a name="ln-5828"></a>             <span class="k">else</span>
<a name="ln-5829"></a><span class="k">                goto </span><span class="mi">15</span>
<a name="ln-5830"></a>             <span class="k">endif</span>
<a name="ln-5831"></a><span class="k">         endif</span>
<a name="ln-5832"></a><span class="k">      endif</span>
<a name="ln-5833"></a><span class="k">      if</span><span class="p">(</span><span class="n">G_ECHO</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(*(g0))&#39;</span><span class="p">)</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-5834"></a>      <span class="n">shift_mline</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-5835"></a>      <span class="k">if</span><span class="p">(</span><span class="n">shift_mline</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;??&#39;</span><span class="p">)</span><span class="k">then</span>            <span class="c">! edit command line history</span>
<a name="ln-5836"></a>         <span class="n">mline</span><span class="o">=</span><span class="s1">&#39;. &#39;</span><span class="o">//</span><span class="n">mline</span><span class="p">(</span><span class="mi">3</span><span class="p">:)</span>
<a name="ln-5837"></a>      <span class="k">endif</span>
<a name="ln-5838"></a>
<a name="ln-5839"></a><span class="k">      if</span><span class="p">(</span><span class="n">G_RIO</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">stdin</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5840"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="n">mline</span><span class="p">)</span>   <span class="c">! reading from standard input, so copy to trail file</span>
<a name="ln-5841"></a>      <span class="k">else</span>
<a name="ln-5842"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">mline</span><span class="p">)</span>   <span class="c">! reading from an exec() command, so write as a comment</span>
<a name="ln-5843"></a>      <span class="k">endif</span>
<a name="ln-5844"></a><span class="k">      call </span><span class="n">redo</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>         <span class="c">! pass line to REDO(3f). This is a no-op except for storing the line into the input history</span>
<a name="ln-5845"></a>                                   <span class="c">! (unless the input line is the &quot;r&quot; command)</span>
<a name="ln-5846"></a>
<a name="ln-5847"></a>      <span class="c">! look for other lines to immediately process and then ignore</span>
<a name="ln-5848"></a>      <span class="n">shift_mline</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">mline</span><span class="p">)</span>
<a name="ln-5849"></a>      <span class="k">if</span><span class="p">(</span><span class="n">shift_mline</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;#&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5850"></a><span class="k">         </span><span class="n">mline</span><span class="o">=</span><span class="s1">&#39;&#39;</span>                                                      <span class="c">! ignore lines with a # as first non-blank character</span>
<a name="ln-5851"></a>      <span class="n">elseif</span><span class="p">(</span><span class="n">shift_mline</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;!&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5852"></a><span class="k">         if</span><span class="p">(</span><span class="n">shift_mline</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;!&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5853"></a><span class="k">            call </span><span class="nb">get_environment_variable</span><span class="p">(</span><span class="s1">&#39;SHELL&#39;</span><span class="p">,</span><span class="n">shift_mline</span><span class="p">)</span>         <span class="c">! get command to execute</span>
<a name="ln-5854"></a>            <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="n">shift_mline</span><span class="p">,</span><span class="n">cmdstat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>       <span class="c">! call system shell</span>
<a name="ln-5855"></a>         <span class="k">else</span>
<a name="ln-5856"></a><span class="k">            call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="n">shift_mline</span><span class="p">(</span><span class="mi">2</span><span class="p">:),</span><span class="n">cmdstat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>   <span class="c">! call system shell</span>
<a name="ln-5857"></a>         <span class="k">endif</span>
<a name="ln-5858"></a><span class="k">         </span><span class="n">mline</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<a name="ln-5859"></a>      <span class="k">endif</span>
<a name="ln-5860"></a>
<a name="ln-5861"></a><span class="k">      call </span><span class="n">mat_str2buf</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">GG_LINELEN</span><span class="p">)</span>    <span class="c">! convert input line to &quot;Hollerith&quot; buffer</span>
<a name="ln-5862"></a><span class="c">!.......................................................................</span>
<a name="ln-5863"></a>   <span class="mi">15</span> <span class="k">continue</span>
<a name="ln-5864"></a><span class="k">      </span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5865"></a>      <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5866"></a><span class="k">         </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-5867"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">blank</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5868"></a><span class="k">         goto </span><span class="mi">15</span> <span class="c">! trim off trailing spaces</span>
<a name="ln-5869"></a>      <span class="k">endif</span>
<a name="ln-5870"></a>
<a name="ln-5871"></a><span class="k">      if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5872"></a><span class="k">              call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">mline</span><span class="p">,</span><span class="n">G_BUF</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="c">! convert ADE buffer to character</span>
<a name="ln-5873"></a>              <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">mline</span><span class="p">)</span> <span class="c">! just to standard output</span>
<a name="ln-5874"></a>      <span class="k">endif</span>
<a name="ln-5875"></a><span class="c">!.......................................................................</span>
<a name="ln-5876"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-5877"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">G_CHARSET_SIZE</span>  <span class="c">! make sure this letter is in set of LALA characters and get its LALA number</span>
<a name="ln-5878"></a>           <span class="k">if</span> <span class="p">(</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="n">k</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">30</span>
<a name="ln-5879"></a>         <span class="k">enddo</span>
<a name="ln-5880"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;Unknown character at column &#39;</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="c">! this is not a known character</span>
<a name="ln-5881"></a>         <span class="n">k</span> <span class="o">=</span> <span class="n">GG_EOL</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5882"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5883"></a><span class="k">            </span><span class="n">l</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5884"></a>            <span class="k">goto </span><span class="mi">11</span>   <span class="c">! Unknown character , K not changed. get new line</span>
<a name="ln-5885"></a>         <span class="k">endif</span>
<a name="ln-5886"></a><span class="k">         if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-5887"></a><span class="k">         if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5888"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-5889"></a><span class="c">!</span>
<a name="ln-5890"></a>   <span class="mi">30</span>    <span class="k">continue</span>
<a name="ln-5891"></a><span class="k">         if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">slash</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">exit</span>     <span class="c">! if // rest is comment</span>
<a name="ln-5892"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">dot</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="n">G_BUF</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">goto </span><span class="mi">11</span>    <span class="c">! if .. line continuation</span>
<a name="ln-5893"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">bslash</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">n</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>                    <span class="c">! if \ in column 1</span>
<a name="ln-5894"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5895"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-5896"></a>               <span class="n">k</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5897"></a>               <span class="n">G_BUF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-5898"></a>            <span class="k">enddo</span>
<a name="ln-5899"></a><span class="k">            goto </span><span class="mi">15</span>
<a name="ln-5900"></a>         <span class="k">endif</span>
<a name="ln-5901"></a><span class="k">         </span><span class="n">G_LIN</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-5902"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1024</span><span class="p">)</span> <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5903"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1024</span><span class="p">)</span> <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;input buffer limit exceeded=&#39;</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
<a name="ln-5904"></a>      <span class="k">enddo</span>
<a name="ln-5905"></a><span class="c">!.......................................................................</span>
<a name="ln-5906"></a>   <span class="mi">45</span> <span class="k">CONTINUE</span>      <span class="c">! line is ready, reset line pointers</span>
<a name="ln-5907"></a>      <span class="n">G_LIN</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">GG_EOL</span><span class="p">;</span><span class="n">G_LIN</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-5908"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-5909"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5910"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5911"></a>      <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5912"></a>      <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5913"></a>      <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span> <span class="c">! load first character onto G_CHRA</span>
<a name="ln-5914"></a>
<a name="ln-5915"></a><span class="k">contains</span>
<a name="ln-5916"></a>
<a name="ln-5917"></a><span class="k">function </span><span class="n">get_pseudo_line</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-5918"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">line</span>
<a name="ln-5919"></a><span class="c">! reallocating all the time is inefficient</span>
<a name="ln-5920"></a>   <span class="n">line</span><span class="o">=</span><span class="n">G_PSEUDO_FILE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5921"></a>   <span class="k">if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-5922"></a><span class="k">      </span><span class="n">G_PSEUDO_FILE</span><span class="o">=</span><span class="n">G_PSEUDO_FILE</span><span class="p">(</span><span class="mi">2</span><span class="p">:)</span>
<a name="ln-5923"></a>   <span class="k">else</span>
<a name="ln-5924"></a><span class="k">      </span><span class="n">G_PSEUDO_FILE</span><span class="o">=</span><span class="p">[</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_LINELEN</span><span class="p">)</span> <span class="kd">::</span> <span class="p">]</span>
<a name="ln-5925"></a>   <span class="k">endif</span>
<a name="ln-5926"></a><span class="k">end function </span><span class="n">get_pseudo_line</span>
<a name="ln-5927"></a>
<a name="ln-5928"></a><span class="k">end subroutine </span><span class="n">mat_getlin</span>
<a name="ln-5929"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5930"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-5931"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-5932"></a><span class="k">subroutine </span><span class="n">mat_clause</span><span class="p">()</span>
<a name="ln-5933"></a><span class="n">doubleprecision</span>    <span class="kd">::</span> <span class="n">e1</span><span class="p">,</span><span class="n">e2</span>
<a name="ln-5934"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">op</span>
<a name="ln-5935"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">r</span>
<a name="ln-5936"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">for</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>   <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5937"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="k">while</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5938"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">iff</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>   <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5939"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="k">else</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>  <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5940"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">ennd</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>  <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5941"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="k">do</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>    <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5942"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">thenn</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-5943"></a>
<a name="ln-5944"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">j</span>
<a name="ln-5945"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">kount</span>
<a name="ln-5946"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">location</span>
<a name="ln-5947"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">l2</span>
<a name="ln-5948"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">lj</span>
<a name="ln-5949"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">m</span>
<a name="ln-5950"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">n</span>
<a name="ln-5951"></a>
<a name="ln-5952"></a>   <span class="n">r</span> <span class="o">=</span> <span class="o">-</span><span class="n">G_FIN</span><span class="o">-</span><span class="mi">10</span>
<a name="ln-5953"></a>   <span class="n">G_FIN</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5954"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">r</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span> <span class="k">goto </span><span class="mi">01</span>
<a name="ln-5955"></a>   <span class="k">goto</span> <span class="p">(</span><span class="mi">02</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="n">R</span>
<a name="ln-5956"></a><span class="mi">01</span> <span class="k">continue</span>
<a name="ln-5957"></a><span class="k">   </span><span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-5958"></a>   <span class="k">goto</span> <span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">05</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">),</span><span class="n">R</span>
<a name="ln-5959"></a>   <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;*mat_clause* -- internal error&#39;</span><span class="p">)</span>
<a name="ln-5960"></a>   <span class="k">goto </span><span class="mi">99</span>
<a name="ln-5961"></a><span class="c">!.......................................................................</span>
<a name="ln-5962"></a><span class="c">!     FOR</span>
<a name="ln-5963"></a><span class="mi">02</span> <span class="k">continue</span>
<a name="ln-5964"></a><span class="k">   call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-5965"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">isname</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5966"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="c">! improper for clause</span>
<a name="ln-5967"></a>      <span class="k">return</span>
<a name="ln-5968"></a><span class="k">   endif</span>
<a name="ln-5969"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-5970"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">),</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-5971"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-5972"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">equal</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5973"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="c">! improper for clause</span>
<a name="ln-5974"></a>      <span class="k">return</span>
<a name="ln-5975"></a><span class="k">   endif</span>
<a name="ln-5976"></a><span class="k">   call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-5977"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-5978"></a>   <span class="c">! *call* expr</span>
<a name="ln-5979"></a>   <span class="k">return</span>
<a name="ln-5980"></a><span class="mi">05</span> <span class="k">continue</span>
<a name="ln-5981"></a><span class="k">   </span><span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5982"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-5983"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="k">DO</span><span class="p">))</span> <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">semi</span>
<a name="ln-5984"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">comma</span><span class="p">)</span> <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">semi</span>
<a name="ln-5985"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">semi</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5986"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="c">! improper for clause</span>
<a name="ln-5987"></a>      <span class="k">return</span>
<a name="ln-5988"></a><span class="k">   endif</span>
<a name="ln-5989"></a><span class="mi">10</span> <span class="k">continue</span>
<a name="ln-5990"></a><span class="k">   </span><span class="n">j</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5991"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-5992"></a>   <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">semi</span>
<a name="ln-5993"></a>   <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">blank</span>
<a name="ln-5994"></a>   <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5995"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5996"></a>   <span class="n">m</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5997"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-5998"></a>   <span class="n">lj</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span>
<a name="ln-5999"></a>   <span class="n">l2</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<a name="ln-6000"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="k">goto </span><span class="mi">12</span>
<a name="ln-6001"></a>   <span class="n">lj</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="mi">3</span>
<a name="ln-6002"></a>   <span class="n">l2</span> <span class="o">=</span> <span class="n">lj</span>
<a name="ln-6003"></a>   <span class="n">GM_REALS</span><span class="p">(</span><span class="n">lj</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">+</span> <span class="nb">dble</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6004"></a>   <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lj</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6005"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">lj</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="k">goto </span><span class="mi">20</span>
<a name="ln-6006"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">lj</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="k">goto </span><span class="mi">20</span>
<a name="ln-6007"></a>   <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6008"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">j</span>
<a name="ln-6009"></a><span class="mi">12</span> <span class="k">continue</span>
<a name="ln-6010"></a><span class="k">   if</span> <span class="p">(</span><span class="n">j</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">n</span><span class="p">)</span> <span class="k">goto </span><span class="mi">20</span>
<a name="ln-6011"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6012"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="c">! too many names</span>
<a name="ln-6013"></a>      <span class="k">return</span>
<a name="ln-6014"></a><span class="k">   endif</span>
<a name="ln-6015"></a><span class="k">   </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6016"></a>   <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">l2</span>
<a name="ln-6017"></a>   <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-6018"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6019"></a>
<a name="ln-6020"></a>   <span class="k">if</span><span class="p">(</span><span class="n">too_much_memory</span><span class="p">(</span> <span class="n">l2</span><span class="o">+</span><span class="n">m</span> <span class="o">-</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">return</span>
<a name="ln-6021"></a>
<a name="ln-6022"></a><span class="k">   call </span><span class="n">mat_wcopy</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">lj</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">lj</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">l2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6023"></a>   <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6024"></a>   <span class="k">call </span><span class="n">mat_stack_put</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">))</span>
<a name="ln-6025"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6026"></a><span class="k">   </span><span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span>
<a name="ln-6027"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-6028"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">13</span>
<a name="ln-6029"></a><span class="c">!     *call* PARSE</span>
<a name="ln-6030"></a>   <span class="k">return</span>
<a name="ln-6031"></a><span class="mi">15</span> <span class="k">continue</span>
<a name="ln-6032"></a><span class="k">   goto </span><span class="mi">10</span>
<a name="ln-6033"></a><span class="mi">20</span> <span class="k">continue</span>
<a name="ln-6034"></a><span class="k">   </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6035"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6036"></a>   <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6037"></a>   <span class="k">call </span><span class="n">mat_stack_put</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">))</span>
<a name="ln-6038"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6039"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">2</span>
<a name="ln-6040"></a>   <span class="k">goto </span><span class="mi">80</span>
<a name="ln-6041"></a><span class="c">!.......................................................................</span>
<a name="ln-6042"></a><span class="c">!</span>
<a name="ln-6043"></a><span class="c">!     WHILE OR IF</span>
<a name="ln-6044"></a><span class="c">!</span>
<a name="ln-6045"></a><span class="mi">30</span> <span class="k">continue</span>
<a name="ln-6046"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6047"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">),</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-6048"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6049"></a><span class="mi">35</span> <span class="k">continue</span>
<a name="ln-6050"></a><span class="k">   </span><span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-6051"></a>   <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">blank</span>
<a name="ln-6052"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6053"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-6054"></a><span class="c">!     *call* EXPR</span>
<a name="ln-6055"></a>   <span class="k">return</span>
<a name="ln-6056"></a><span class="mi">40</span> <span class="k">continue</span>
<a name="ln-6057"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">equal</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="n">LESS</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="n">GREAT</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">rbracket</span><span class="p">))</span><span class="k">then</span>
<a name="ln-6058"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>    <span class="c">! improper WHILE or IF clause</span>
<a name="ln-6059"></a>      <span class="k">return</span>
<a name="ln-6060"></a><span class="k">   endif</span>
<a name="ln-6061"></a><span class="k">   </span><span class="n">op</span> <span class="o">=</span> <span class="n">G_SYM</span>
<a name="ln-6062"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6063"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">equal</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">great</span><span class="p">))</span> <span class="n">op</span> <span class="o">=</span> <span class="n">op</span> <span class="o">+</span> <span class="n">G_SYM</span>
<a name="ln-6064"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">great</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6065"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">256</span><span class="o">*</span><span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">+</span> <span class="n">op</span>
<a name="ln-6066"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-6067"></a><span class="c">!     *call* EXPR</span>
<a name="ln-6068"></a>   <span class="k">return</span>
<a name="ln-6069"></a><span class="mi">45</span> <span class="k">continue</span>
<a name="ln-6070"></a><span class="k">   </span><span class="n">op</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">),</span><span class="mi">256</span><span class="p">)</span>
<a name="ln-6071"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span><span class="o">/</span><span class="mi">256</span>
<a name="ln-6072"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6073"></a>   <span class="n">e1</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-6074"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-6075"></a>   <span class="n">e2</span> <span class="o">=</span> <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<a name="ln-6076"></a>   <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-6077"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="k">do</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">thenn</span><span class="p">))</span> <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">semi</span>
<a name="ln-6078"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COMMA</span><span class="p">)</span> <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">SEMI</span>
<a name="ln-6079"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SEMI</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6080"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span> <span class="c">! improper WHILE or IF clause</span>
<a name="ln-6081"></a>      <span class="k">return</span>
<a name="ln-6082"></a><span class="k">   endif</span>
<a name="ln-6083"></a><span class="k">   if</span> <span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">equal</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">e1</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">e2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6084"></a>   <span class="k">if</span> <span class="p">((</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">less</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">e1</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">e2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6085"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">great</span>         <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">e1</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">e2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6086"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.(</span><span class="n">less</span><span class="o">+</span><span class="n">equal</span><span class="p">)</span>  <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">e1</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">e2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6087"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.(</span><span class="n">great</span><span class="o">+</span><span class="n">equal</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">e1</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="n">e2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6088"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.(</span><span class="n">less</span><span class="o">+</span><span class="n">great</span><span class="p">)</span>  <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">e1</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">e2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6089"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6090"></a>   <span class="k">goto </span><span class="mi">80</span>
<a name="ln-6091"></a><span class="mi">50</span> <span class="k">continue</span>
<a name="ln-6092"></a><span class="k">   </span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">14</span>
<a name="ln-6093"></a><span class="c">!     *call* PARSE</span>
<a name="ln-6094"></a>   <span class="k">return</span>
<a name="ln-6095"></a><span class="mi">55</span> <span class="k">continue</span>
<a name="ln-6096"></a><span class="k">   IF</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">:,</span><span class="n">G_PT</span><span class="p">),</span><span class="k">while</span><span class="p">))</span> <span class="k">goto </span><span class="mi">35</span>
<a name="ln-6097"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6098"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="k">else</span><span class="p">))</span> <span class="k">goto </span><span class="mi">80</span>
<a name="ln-6099"></a>   <span class="k">return</span>
<a name="ln-6100"></a><span class="c">!.......................................................................</span>
<a name="ln-6101"></a><span class="c">!     SEARCH FOR MATCHING END OR ELSE</span>
<a name="ln-6102"></a><span class="mi">80</span> <span class="k">continue</span>
<a name="ln-6103"></a><span class="k">   </span><span class="n">kount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6104"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6105"></a><span class="mi">82</span> <span class="k">continue</span>
<a name="ln-6106"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6107"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">isname</span><span class="p">)</span> <span class="k">goto </span><span class="mi">83</span>
<a name="ln-6108"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">ennd</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">kount</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6109"></a><span class="k">   if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="k">else</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">kount</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6110"></a><span class="k">   if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">ennd</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="k">else</span><span class="p">))</span><span class="n">kount</span> <span class="o">=</span> <span class="n">kount</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6111"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">for</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="k">while</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">iff</span><span class="p">))</span> <span class="n">kount</span> <span class="o">=</span> <span class="n">kount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6112"></a><span class="mi">83</span> <span class="k">continue</span>
<a name="ln-6113"></a><span class="k">   call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6114"></a>   <span class="k">goto </span><span class="mi">82</span>
<a name="ln-6115"></a><span class="c">!.......................................................................</span>
<a name="ln-6116"></a><span class="c">!     EXIT FROM LOOP</span>
<a name="ln-6117"></a><span class="mi">90</span> <span class="k">continue</span>
<a name="ln-6118"></a>
<a name="ln-6119"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">14</span><span class="p">)</span> <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6120"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_PT</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">G_PTZ</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6121"></a>
<a name="ln-6122"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">14</span><span class="p">)</span> <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6123"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">G_PTZ</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6124"></a>
<a name="ln-6125"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">13</span><span class="p">)</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6126"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">13</span><span class="p">)</span> <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">2</span>
<a name="ln-6127"></a>   <span class="k">goto </span><span class="mi">80</span>
<a name="ln-6128"></a><span class="c">!.......................................................................</span>
<a name="ln-6129"></a><span class="c">!</span>
<a name="ln-6130"></a><span class="mi">99</span> <span class="k">continue</span>
<a name="ln-6131"></a><span class="k">   call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>    <span class="c">! recursion difficulties</span>
<a name="ln-6132"></a><span class="k">end subroutine </span><span class="n">mat_clause</span>
<a name="ln-6133"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6134"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-6135"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6136"></a><span class="k">subroutine </span><span class="n">mat_expr</span><span class="p">()</span>
<a name="ln-6137"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">r</span>
<a name="ln-6138"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="nb">sign</span>
<a name="ln-6139"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">eye</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="nb">iachar</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">]),</span><span class="n">GG_PAD</span><span class="p">(</span><span class="mi">8</span><span class="p">:)]</span>
<a name="ln-6140"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">kount</span>
<a name="ln-6141"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-6142"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">op</span>
<a name="ln-6143"></a>
<a name="ln-6144"></a>   <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">)</span>
<a name="ln-6145"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6146"></a><span class="c">!        1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 16 18 19 20</span>
<a name="ln-6147"></a>   <span class="k">goto</span> <span class="p">(</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">05</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">),</span><span class="n">R</span>
<a name="ln-6148"></a><span class="c">!  what about drop-though???</span>
<a name="ln-6149"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6150"></a><span class="mi">01</span> <span class="k">continue</span>
<a name="ln-6151"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">colon</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">,</span><span class="n">eye</span><span class="p">)</span>
<a name="ln-6152"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">colon</span><span class="p">)</span> <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">isname</span>
<a name="ln-6153"></a>   <span class="n">kount</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6154"></a><span class="mi">02</span> <span class="k">continue</span>
<a name="ln-6155"></a><span class="k">   </span><span class="nb">sign</span> <span class="o">=</span> <span class="n">plus</span>
<a name="ln-6156"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minus</span><span class="p">)</span> <span class="nb">sign</span> <span class="o">=</span> <span class="n">minus</span>
<a name="ln-6157"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">plus</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">minus</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6158"></a>   <span class="n">G_pt</span> <span class="o">=</span> <span class="n">G_pt</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6159"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_pt</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">G_PSIZE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6160"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="c">! too complicated (stack overflow)</span>
<a name="ln-6161"></a>      <span class="k">return</span>
<a name="ln-6162"></a><span class="k">   endif</span>
<a name="ln-6163"></a><span class="k">   </span><span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sign</span> <span class="o">+</span> <span class="mi">256</span><span class="o">*</span><span class="n">kount</span>
<a name="ln-6164"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-6165"></a>   <span class="c">! *call* term</span>
<a name="ln-6166"></a>   <span class="k">return</span>
<a name="ln-6167"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6168"></a><span class="mi">05</span> <span class="k">continue</span>
<a name="ln-6169"></a><span class="k">   </span><span class="nb">sign</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">),</span><span class="mi">256</span><span class="p">)</span>
<a name="ln-6170"></a>   <span class="n">kount</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">)</span><span class="o">/</span><span class="mi">256</span>
<a name="ln-6171"></a>   <span class="n">G_pt</span> <span class="o">=</span> <span class="n">G_pt</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6172"></a>   <span class="k">if</span> <span class="p">(</span><span class="nb">sign</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minus</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">minus</span><span class="p">)</span>
<a name="ln-6173"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_err</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6174"></a><span class="mi">10</span> <span class="k">continue</span>
<a name="ln-6175"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">plus</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">minus</span><span class="p">)</span> <span class="k">goto </span><span class="mi">20</span>
<a name="ln-6176"></a>   <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6177"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6178"></a><span class="mi">20</span> <span class="k">continue</span>
<a name="ln-6179"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">10</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6180"></a>      <span class="c">! blank is delimiter inside angle brackets</span>
<a name="ln-6181"></a>      <span class="n">ls</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-6182"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LIN</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">blank</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6183"></a>   <span class="k">endif</span>
<a name="ln-6184"></a><span class="k">   </span><span class="n">op</span> <span class="o">=</span> <span class="n">G_SYM</span>
<a name="ln-6185"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6186"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6187"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">op</span> <span class="o">+</span> <span class="mi">256</span><span class="o">*</span><span class="n">kount</span>
<a name="ln-6188"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">7</span>
<a name="ln-6189"></a><span class="c">!     *call* term</span>
<a name="ln-6190"></a>   <span class="k">return</span>
<a name="ln-6191"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6192"></a><span class="mi">25</span> <span class="k">continue</span>
<a name="ln-6193"></a><span class="k">   </span><span class="n">op</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">),</span><span class="mi">256</span><span class="p">)</span>
<a name="ln-6194"></a>   <span class="n">kount</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_pt</span><span class="p">)</span><span class="o">/</span><span class="mi">256</span>
<a name="ln-6195"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6196"></a>   <span class="k">call </span><span class="n">mat_stack2</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
<a name="ln-6197"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6198"></a><span class="k">   goto </span><span class="mi">10</span>
<a name="ln-6199"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6200"></a><span class="mi">50</span> <span class="k">continue</span>
<a name="ln-6201"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">colon</span><span class="p">)</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-6202"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6203"></a>   <span class="n">kount</span> <span class="o">=</span> <span class="n">kount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6204"></a>   <span class="k">goto </span><span class="mi">02</span>
<a name="ln-6205"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6206"></a><span class="mi">60</span> <span class="k">continue</span>
<a name="ln-6207"></a><span class="k">   if</span> <span class="p">(</span><span class="n">kount</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6208"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>  <span class="c">! too many colons</span>
<a name="ln-6209"></a>      <span class="k">return</span>
<a name="ln-6210"></a><span class="k">   endif</span>
<a name="ln-6211"></a><span class="k">   </span><span class="n">G_RHS</span> <span class="o">=</span> <span class="n">kount</span>
<a name="ln-6212"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">kount</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_stack2</span><span class="p">(</span><span class="n">colon</span><span class="p">)</span>
<a name="ln-6213"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_err</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6214"></a><span class="k">   return</span>
<a name="ln-6215"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6216"></a><span class="mi">99</span> <span class="k">continue</span>
<a name="ln-6217"></a><span class="k">   call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>     <span class="c">! recursion difficulties</span>
<a name="ln-6218"></a>   <span class="k">return</span>
<a name="ln-6219"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6220"></a><span class="k">end subroutine </span><span class="n">mat_expr</span>
<a name="ln-6221"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6222"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-6223"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6224"></a><span class="k">subroutine </span><span class="n">mat_factor</span><span class="p">()</span>
<a name="ln-6225"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">r</span>
<a name="ln-6226"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">gg_max_name_length</span><span class="p">)</span>
<a name="ln-6227"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">excnt</span>
<a name="ln-6228"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-6229"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">location</span>
<a name="ln-6230"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ln</span>
<a name="ln-6231"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">ls</span>
<a name="ln-6232"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">n</span>
<a name="ln-6233"></a>
<a name="ln-6234"></a>   <span class="n">r</span> <span class="o">=</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-6235"></a>   <span class="c">!      1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19</span>
<a name="ln-6236"></a>   <span class="k">goto</span> <span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">37</span><span class="p">),</span><span class="n">r</span>
<a name="ln-6237"></a><span class="mi">01</span> <span class="k">continue</span>
<a name="ln-6238"></a><span class="k">   if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">isnum</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">quote</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">less</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-6239"></a>
<a name="ln-6240"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">great</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">rbracket</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6241"></a>         <span class="c">!  MACROS STRING</span>
<a name="ln-6242"></a>            <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6243"></a>            <span class="k">if</span> <span class="p">((</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">less</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6244"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="c">! Empty macro</span>
<a name="ln-6245"></a>            <span class="k">return</span>
<a name="ln-6246"></a><span class="k">         endif</span>
<a name="ln-6247"></a><span class="k">            </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6248"></a>            <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">18</span>
<a name="ln-6249"></a>            <span class="c">! *call* EXPR</span>
<a name="ln-6250"></a>            <span class="k">return</span>
<a name="ln-6251"></a><span class="k">      endif</span>
<a name="ln-6252"></a>
<a name="ln-6253"></a><span class="k">      </span><span class="n">excnt</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6254"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">isname</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6255"></a>         <span class="c">! FUNCTION OR MATRIX ELEMENT</span>
<a name="ln-6256"></a>         <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">G_SYN</span><span class="p">)</span>
<a name="ln-6257"></a>         <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6258"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">lparen</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">lbrace</span><span class="p">)</span> <span class="k">goto </span><span class="mi">42</span>
<a name="ln-6259"></a>         <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6260"></a>         <span class="k">call </span><span class="n">mat_funs</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<a name="ln-6261"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6262"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c">! Can not use function name as variable</span>
<a name="ln-6263"></a>            <span class="k">return</span>
<a name="ln-6264"></a><span class="k">         endif</span>
<a name="ln-6265"></a><span class="k">         call </span><span class="n">mat_stack_get</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-6266"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6267"></a><span class="k">         if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">7</span><span class="p">)</span> <span class="k">goto </span><span class="mi">50</span>
<a name="ln-6268"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">)</span>
<a name="ln-6269"></a>
<a name="ln-6270"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6271"></a><span class="k">            call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">! undefined variable</span>
<a name="ln-6272"></a>            <span class="k">return</span>
<a name="ln-6273"></a><span class="k">         endif</span>
<a name="ln-6274"></a><span class="k">         goto </span><span class="mi">60</span>
<a name="ln-6275"></a>      <span class="k">endif</span>
<a name="ln-6276"></a><span class="k">      </span><span class="n">id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">BLANK</span>
<a name="ln-6277"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">lparen</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">lbrace</span><span class="p">)</span> <span class="k">goto </span><span class="mi">42</span>
<a name="ln-6278"></a>      <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6279"></a>      <span class="k">return</span>
<a name="ln-6280"></a><span class="k">   endif</span>
<a name="ln-6281"></a><span class="c">!======================================================================</span>
<a name="ln-6282"></a>   <span class="c">! put something on the stack</span>
<a name="ln-6283"></a>   <span class="n">location</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6284"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6285"></a><span class="k">      </span><span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6286"></a>       <span class="p">&amp;</span> <span class="o">+</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6287"></a>       <span class="p">&amp;</span> <span class="o">*</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-6288"></a>   <span class="k">endif</span>
<a name="ln-6289"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6290"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-6291"></a>      <span class="k">return</span>
<a name="ln-6292"></a><span class="k">   endif</span>
<a name="ln-6293"></a>
<a name="ln-6294"></a><span class="k">   </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6295"></a>   <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">location</span>
<a name="ln-6296"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">quote</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6297"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">less</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)</span> <span class="k">goto </span><span class="mi">20</span>
<a name="ln-6298"></a>      <span class="c">! single number, getsym stored it in GM_IMAGS</span>
<a name="ln-6299"></a>      <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6300"></a>      <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6301"></a>      <span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">)</span>
<a name="ln-6302"></a>      <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-6303"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6304"></a>      <span class="k">goto </span><span class="mi">60</span>
<a name="ln-6305"></a>      <span class="c">! string</span>
<a name="ln-6306"></a>   <span class="k">endif</span>
<a name="ln-6307"></a>
<a name="ln-6308"></a><span class="k">   </span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6309"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6310"></a>   <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span>  <span class="c">! get next character</span>
<a name="ln-6311"></a>
<a name="ln-6312"></a><span class="c">!==================================</span>
<a name="ln-6313"></a><span class="mi">16</span> <span class="k">continue</span>
<a name="ln-6314"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">QUOTE</span><span class="p">)</span> <span class="k">goto </span><span class="mi">18</span>
<a name="ln-6315"></a><span class="mi">17</span> <span class="k">continue</span>
<a name="ln-6316"></a><span class="k">   </span><span class="n">ln</span> <span class="o">=</span> <span class="n">location</span><span class="o">+</span><span class="n">n</span>
<a name="ln-6317"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6318"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="c">! Improper string</span>
<a name="ln-6319"></a>      <span class="k">return</span>
<a name="ln-6320"></a><span class="k">   endif</span>
<a name="ln-6321"></a><span class="k">   </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">LN</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">G_CHRA</span><span class="p">)</span>
<a name="ln-6322"></a>   <span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">LN</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6323"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6324"></a>   <span class="k">call </span><span class="n">mat_getch</span><span class="p">()</span>  <span class="c">! get next character</span>
<a name="ln-6325"></a>   <span class="k">goto </span><span class="mi">16</span>
<a name="ln-6326"></a>
<a name="ln-6327"></a><span class="mi">18</span> <span class="k">continue</span>
<a name="ln-6328"></a><span class="k">   call </span><span class="n">mat_getch</span><span class="p">()</span>  <span class="c">! get next character</span>
<a name="ln-6329"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_CHRA</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">QUOTE</span><span class="p">)</span> <span class="k">goto </span><span class="mi">17</span>
<a name="ln-6330"></a><span class="c">!==================================</span>
<a name="ln-6331"></a>
<a name="ln-6332"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6333"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="c">! Improper string</span>
<a name="ln-6334"></a>      <span class="k">return</span>
<a name="ln-6335"></a><span class="k">   endif</span>
<a name="ln-6336"></a><span class="k">   </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6337"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-6338"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6339"></a>   <span class="k">goto </span><span class="mi">60</span>
<a name="ln-6340"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6341"></a><span class="c">!  explicit matrix</span>
<a name="ln-6342"></a><span class="mi">20</span> <span class="k">continue</span>
<a name="ln-6343"></a><span class="k">   </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6344"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6345"></a>
<a name="ln-6346"></a><span class="mi">21</span> <span class="k">continue</span>
<a name="ln-6347"></a><span class="k">   </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6348"></a>   <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6349"></a>      <span class="p">&amp;</span>   <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6350"></a>      <span class="p">&amp;</span> <span class="o">+</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)&amp;</span>
<a name="ln-6351"></a>      <span class="p">&amp;</span> <span class="o">*</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6352"></a>   <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6353"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6354"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6355"></a>
<a name="ln-6356"></a><span class="mi">22</span> <span class="k">continue</span>
<a name="ln-6357"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">semi</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">great</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">rbracket</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6358"></a><span class="k">      if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">semi</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6359"></a>      <span class="k">call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">quote</span><span class="p">)</span>
<a name="ln-6360"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6361"></a><span class="k">      </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-6362"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6363"></a>         <span class="p">&amp;</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6364"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6365"></a>         <span class="p">&amp;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6366"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-6367"></a>         <span class="k">return</span>
<a name="ln-6368"></a><span class="k">      endif</span>
<a name="ln-6369"></a><span class="k">      </span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6370"></a>         <span class="p">&amp;</span> <span class="o">+</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6371"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">GG_EOL</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getlin</span><span class="p">()</span>
<a name="ln-6372"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">great</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">rbracket</span><span class="p">)</span> <span class="k">goto </span><span class="mi">21</span>
<a name="ln-6373"></a>      <span class="k">call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">quote</span><span class="p">)</span>
<a name="ln-6374"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6375"></a><span class="k">      call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6376"></a>      <span class="k">goto </span><span class="mi">60</span>
<a name="ln-6377"></a>   <span class="k">endif</span>
<a name="ln-6378"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">comma</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6379"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6380"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span>
<a name="ln-6381"></a>   <span class="c">! *call* EXPR</span>
<a name="ln-6382"></a>   <span class="k">return</span>
<a name="ln-6383"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6384"></a><span class="mi">25</span> <span class="k">continue</span>
<a name="ln-6385"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6386"></a>   <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-6387"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6388"></a><span class="k">      </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6389"></a>   <span class="k">endif</span>
<a name="ln-6390"></a>
<a name="ln-6391"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="k">then</span>
<a name="ln-6392"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-6393"></a>      <span class="k">return</span>
<a name="ln-6394"></a><span class="k">   endif</span>
<a name="ln-6395"></a><span class="k">   </span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-6396"></a>      <span class="p">&amp;</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">+</span> <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6397"></a>   <span class="k">goto </span><span class="mi">22</span>
<a name="ln-6398"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6399"></a><span class="mi">32</span> <span class="k">continue</span>
<a name="ln-6400"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6401"></a>   <span class="k">if</span> <span class="p">((</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">less</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="n">GG_EOL</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6402"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="c">! Improper MACROS</span>
<a name="ln-6403"></a>      <span class="k">return</span>
<a name="ln-6404"></a><span class="k">   endif</span>
<a name="ln-6405"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">LESS</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">lbracket</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6406"></a>   <span class="n">k</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-6407"></a>   <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6408"></a>   <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6409"></a>   <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-6410"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">4</span>
<a name="ln-6411"></a><span class="c">!     transfer stack to input line</span>
<a name="ln-6412"></a>   <span class="n">k</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6413"></a>   <span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-6414"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">*</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span>
<a name="ln-6415"></a>   <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-6416"></a>      <span class="n">ls</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6417"></a>      <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span>
<a name="ln-6418"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">ge</span><span class="p">.</span><span class="n">G_CHARSET_SIZE</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6419"></a><span class="k">         call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="c">! Improper MACROS</span>
<a name="ln-6420"></a>         <span class="k">return</span>
<a name="ln-6421"></a><span class="k">      endif</span>
<a name="ln-6422"></a><span class="k">      if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1024</span><span class="p">)</span> <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6423"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1024</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;Input buffer char limit exceeded=&#39;</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
<a name="ln-6424"></a>   <span class="k">enddo</span>
<a name="ln-6425"></a><span class="k">   </span><span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6426"></a>   <span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">GG_EOL</span><span class="p">;</span><span class="n">G_LIN</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span><span class="o">=</span><span class="n">blank</span>
<a name="ln-6427"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-6428"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6429"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6430"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6431"></a>   <span class="n">G_LINECOUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6432"></a>   <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">blank</span>
<a name="ln-6433"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6434"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6435"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">19</span>
<a name="ln-6436"></a><span class="c">!     *call* EXPR</span>
<a name="ln-6437"></a>   <span class="k">return</span>
<a name="ln-6438"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6439"></a><span class="mi">37</span> <span class="k">continue</span>
<a name="ln-6440"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6441"></a>   <span class="n">k</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
<a name="ln-6442"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6443"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6444"></a>   <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">G_LIN</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6445"></a>   <span class="n">G_CHRA</span> <span class="o">=</span> <span class="n">BLANK</span>
<a name="ln-6446"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6447"></a>   <span class="k">goto </span><span class="mi">60</span>
<a name="ln-6448"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6449"></a><span class="mi">42</span> <span class="k">continue</span>
<a name="ln-6450"></a><span class="k">   call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6451"></a>   <span class="n">excnt</span> <span class="o">=</span> <span class="n">excnt</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6452"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6453"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">excnt</span>
<a name="ln-6454"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">),</span><span class="n">id</span><span class="p">)</span>
<a name="ln-6455"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">11</span>
<a name="ln-6456"></a>   <span class="c">! *call* expr</span>
<a name="ln-6457"></a>   <span class="k">return</span>
<a name="ln-6458"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6459"></a><span class="mi">45</span> <span class="k">continue</span>
<a name="ln-6460"></a><span class="k">   call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">G_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_PT</span><span class="p">))</span>
<a name="ln-6461"></a>   <span class="n">excnt</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-6462"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6463"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">comma</span><span class="p">)</span> <span class="k">goto </span><span class="mi">42</span>
<a name="ln-6464"></a>   <span class="k">if</span> <span class="p">((</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">rparen</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">rbrace</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-6465"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6466"></a>      <span class="k">return</span>
<a name="ln-6467"></a><span class="k">   endif</span>
<a name="ln-6468"></a><span class="k">   if</span> <span class="p">((</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">rparen</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">rbrace</span><span class="p">))</span> <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6469"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">blank</span><span class="p">)</span> <span class="k">goto </span><span class="mi">60</span>
<a name="ln-6470"></a>   <span class="n">G_RHS</span> <span class="o">=</span> <span class="n">excnt</span>
<a name="ln-6471"></a>   <span class="k">call </span><span class="n">MAT_STACK_GET</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-6472"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6473"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">mat_funs</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<a name="ln-6474"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_FIN</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6475"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">! undefined variable</span>
<a name="ln-6476"></a>      <span class="k">return</span>
<a name="ln-6477"></a><span class="k">   endif</span>
<a name="ln-6478"></a>   <span class="c">! evaluate matrix function</span>
<a name="ln-6479"></a><span class="mi">50</span> <span class="k">continue</span>
<a name="ln-6480"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6481"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">16</span>
<a name="ln-6482"></a>   <span class="c">! *call* matfn</span>
<a name="ln-6483"></a>   <span class="k">return</span>
<a name="ln-6484"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6485"></a><span class="mi">55</span> <span class="k">continue</span>
<a name="ln-6486"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6487"></a>   <span class="k">goto </span><span class="mi">60</span>
<a name="ln-6488"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6489"></a><span class="c">!  check for quote (transpose) and ** (power)</span>
<a name="ln-6490"></a><span class="mi">60</span> <span class="k">continue</span>
<a name="ln-6491"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">quote</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6492"></a><span class="k">      </span><span class="n">i</span> <span class="o">=</span> <span class="n">G_LINE_POINTER</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-6493"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_LIN</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">blank</span><span class="p">)</span> <span class="k">goto </span><span class="mi">90</span>
<a name="ln-6494"></a>      <span class="k">call </span><span class="n">mat_stack1</span><span class="p">(</span><span class="n">quote</span><span class="p">)</span>
<a name="ln-6495"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6496"></a><span class="k">      call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6497"></a>   <span class="k">endif</span>
<a name="ln-6498"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">star</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_CHRA</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">star</span><span class="p">)</span> <span class="k">goto </span><span class="mi">90</span>
<a name="ln-6499"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6500"></a>   <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6501"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6502"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">12</span>
<a name="ln-6503"></a>   <span class="c">! *call* factor</span>
<a name="ln-6504"></a>   <span class="k">goto </span><span class="mi">01</span>
<a name="ln-6505"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6506"></a><span class="mi">65</span> <span class="k">continue</span>
<a name="ln-6507"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6508"></a>   <span class="k">call </span><span class="n">mat_stack2</span><span class="p">(</span><span class="n">DSTAR</span><span class="p">)</span>
<a name="ln-6509"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6510"></a><span class="k">   if</span> <span class="p">(</span><span class="n">G_FUN</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">90</span>
<a name="ln-6511"></a>   <span class="c">!  matrix power, use eigenvectors</span>
<a name="ln-6512"></a>   <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6513"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">17</span>
<a name="ln-6514"></a>   <span class="c">! *call* matfn</span>
<a name="ln-6515"></a>   <span class="k">return</span>
<a name="ln-6516"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6517"></a><span class="mi">75</span> <span class="k">continue</span>
<a name="ln-6518"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6519"></a><span class="mi">90</span> <span class="k">continue</span>
<a name="ln-6520"></a><span class="k">   return</span>
<a name="ln-6521"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6522"></a><span class="mi">99</span> <span class="k">continue</span>
<a name="ln-6523"></a><span class="k">   call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="c">! recursion difficulties</span>
<a name="ln-6524"></a>   <span class="k">return</span>
<a name="ln-6525"></a><span class="k">end subroutine </span><span class="n">mat_factor</span>
<a name="ln-6526"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6527"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-6528"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6529"></a><span class="k">subroutine </span><span class="n">mat_term</span><span class="p">()</span>
<a name="ln-6530"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">op</span>
<a name="ln-6531"></a>
<a name="ln-6532"></a>   <span class="k">select case</span><span class="p">(</span> <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6533"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-6534"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6535"></a>      <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-6536"></a>      <span class="c">! *call* factor</span>
<a name="ln-6537"></a>      <span class="k">return</span>
<a name="ln-6538"></a><span class="k">   case</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-6539"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6540"></a>   <span class="k">case</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-6541"></a>      <span class="n">op</span> <span class="o">=</span> <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span>
<a name="ln-6542"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6543"></a>      <span class="k">call </span><span class="n">mat_stack2</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
<a name="ln-6544"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_ERR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6545"></a><span class="k">         return</span>
<a name="ln-6546"></a><span class="k">      endif</span>
<a name="ln-6547"></a>      <span class="c">! some binary ops done in matfns</span>
<a name="ln-6548"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">G_FUN</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6549"></a><span class="k">         </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6550"></a>         <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">15</span>
<a name="ln-6551"></a>         <span class="c">! *call* matfn</span>
<a name="ln-6552"></a>         <span class="k">return</span>
<a name="ln-6553"></a><span class="k">      endif</span>
<a name="ln-6554"></a><span class="k">   case</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-6555"></a>      <span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6556"></a>   <span class="k">case </span><span class="n">default</span>
<a name="ln-6557"></a>      <span class="k">call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-6558"></a>      <span class="k">return</span>
<a name="ln-6559"></a><span class="k">   end select</span>
<a name="ln-6560"></a>
<a name="ln-6561"></a><span class="k">   </span><span class="n">op</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6562"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">dot</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6563"></a><span class="k">      </span><span class="n">op</span> <span class="o">=</span> <span class="n">dot</span>
<a name="ln-6564"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6565"></a>   <span class="k">endif</span>
<a name="ln-6566"></a><span class="k">   if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">star</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">slash</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">G_SYM</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">bslash</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-6567"></a><span class="k">      return</span>
<a name="ln-6568"></a><span class="k">   endif</span>
<a name="ln-6569"></a>
<a name="ln-6570"></a><span class="k">   if</span><span class="p">(</span><span class="n">op</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span> <span class="c">! make a special code out of two characters ie. &quot;./&quot; or just set to last symbol found if op=0</span>
<a name="ln-6571"></a>      <span class="n">op</span> <span class="o">=</span> <span class="n">G_SYM</span>
<a name="ln-6572"></a>   <span class="k">else</span>
<a name="ln-6573"></a><span class="k">      </span><span class="n">op</span> <span class="o">=</span> <span class="n">G_SYM</span> <span class="o">+</span> <span class="mi">1000</span>
<a name="ln-6574"></a>   <span class="k">endif</span>
<a name="ln-6575"></a>
<a name="ln-6576"></a><span class="k">   call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6577"></a>
<a name="ln-6578"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">G_SYM</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">dot</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6579"></a><span class="k">      </span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span> <span class="o">+</span> <span class="mi">1000</span>  <span class="c">! now holds three characters</span>
<a name="ln-6580"></a>      <span class="k">call </span><span class="n">mat_getsym</span><span class="p">()</span>
<a name="ln-6581"></a>   <span class="k">endif</span>
<a name="ln-6582"></a>
<a name="ln-6583"></a><span class="k">   </span><span class="n">G_PT</span> <span class="o">=</span> <span class="n">G_PT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6584"></a>   <span class="n">G_PSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="n">op</span>
<a name="ln-6585"></a>   <span class="n">G_RSTK</span><span class="p">(</span><span class="n">G_PT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">9</span>
<a name="ln-6586"></a>   <span class="c">! *call* factor</span>
<a name="ln-6587"></a>
<a name="ln-6588"></a><span class="k">end subroutine </span><span class="n">mat_term</span>
<a name="ln-6589"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6590"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-6591"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6592"></a><span class="k">subroutine </span><span class="n">mat_savlod</span><span class="p">(</span><span class="n">lun</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">img</span><span class="p">,</span><span class="n">space_left</span><span class="p">,</span><span class="n">xreal</span><span class="p">,</span><span class="n">ximag</span><span class="p">)</span>
<a name="ln-6593"></a>
<a name="ln-6594"></a><span class="c">! ident_31=&quot;@(#)M_matrix::mat_savlod(3fp): read next variable from a save file or write next variable to it&quot;</span>
<a name="ln-6595"></a>
<a name="ln-6596"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">lun</span>                                       <span class="c">! logical unit number</span>
<a name="ln-6597"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>                    <span class="c">! name, format 32a1</span>
<a name="ln-6598"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span>                                      <span class="c">! dimensions</span>
<a name="ln-6599"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">img</span>                                       <span class="c">! nonzero if ximag is nonzero.  returned on a load</span>
<a name="ln-6600"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">space_left</span>                                <span class="c">! 0 for save, = space available for load</span>
<a name="ln-6601"></a><span class="n">doubleprecision</span>                   <span class="kd">::</span> <span class="n">xreal</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">ximag</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>                        <span class="c">! real and optional imaginary parts</span>
<a name="ln-6602"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cid</span>
<a name="ln-6603"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span>
<a name="ln-6604"></a><span class="kt">integer</span>                           <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-6605"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">message</span>
<a name="ln-6606"></a>                                                                               <span class="c">! system dependent formats</span>
<a name="ln-6607"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">f101</span> <span class="o">=</span><span class="s1">&#39;(A,3I9)&#39;</span>                           <span class="c">! ID, MxN dimensions of ID, imaginary or real flag</span>
<a name="ln-6608"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span>        <span class="kd">::</span> <span class="n">f102</span> <span class="o">=</span><span class="s1">&#39;(4Z18)&#39;</span>                            <span class="c">! format for data</span>
<a name="ln-6609"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">space_left</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>                                              <span class="c">! save</span>
<a name="ln-6610"></a>         <span class="k">call </span><span class="n">mat_buf2str</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>                           <span class="c">! convert ID to a character string</span>
<a name="ln-6611"></a>         <span class="k">write</span><span class="p">(</span><span class="n">lun</span><span class="p">,</span><span class="n">f101</span><span class="p">)</span> <span class="n">cid</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">img</span>
<a name="ln-6612"></a>         <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-6613"></a>            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6614"></a>            <span class="n">l</span> <span class="o">=</span> <span class="n">j</span><span class="o">*</span><span class="n">m</span>
<a name="ln-6615"></a>            <span class="k">write</span><span class="p">(</span><span class="n">lun</span><span class="p">,</span><span class="n">f102</span><span class="p">)</span> <span class="n">xreal</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">l</span><span class="p">)</span>                                         <span class="c">! real</span>
<a name="ln-6616"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">img</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">lun</span><span class="p">,</span><span class="n">f102</span><span class="p">)</span> <span class="n">ximag</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">l</span><span class="p">)</span>                         <span class="c">! imaginary</span>
<a name="ln-6617"></a>         <span class="k">enddo</span>
<a name="ln-6618"></a><span class="k">      else</span>                                                                     <span class="c">! load</span>
<a name="ln-6619"></a>         <span class="k">read</span><span class="p">(</span><span class="n">lun</span><span class="p">,</span><span class="n">f101</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">,</span><span class="n">iomsg</span><span class="o">=</span><span class="n">message</span><span class="p">)</span> <span class="n">cid</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">img</span>
<a name="ln-6620"></a>         <span class="k">if</span><span class="p">(</span><span class="n">ios</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6621"></a><span class="k">            call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-6622"></a>            <span class="n">m</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6623"></a>            <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6624"></a>         <span class="k">else</span>
<a name="ln-6625"></a><span class="k">            call </span><span class="n">mat_str2buf</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>                        <span class="c">! convert character string to an ID</span>
<a name="ln-6626"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">space_left</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6627"></a><span class="k">               </span><span class="n">m</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6628"></a>               <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6629"></a>            <span class="k">else</span>
<a name="ln-6630"></a><span class="k">               do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-6631"></a>                  <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6632"></a>                  <span class="n">l</span> <span class="o">=</span> <span class="n">j</span><span class="o">*</span><span class="n">m</span>
<a name="ln-6633"></a>                  <span class="k">read</span><span class="p">(</span><span class="n">lun</span><span class="p">,</span><span class="n">f102</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">,</span><span class="n">iomsg</span><span class="o">=</span><span class="n">message</span><span class="p">)</span> <span class="n">xreal</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">l</span><span class="p">)</span>           <span class="c">! real</span>
<a name="ln-6634"></a>                  <span class="k">if</span><span class="p">(</span><span class="n">ios</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6635"></a><span class="k">                     call </span><span class="n">journal</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-6636"></a>                     <span class="n">m</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6637"></a>                     <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6638"></a>                     <span class="k">exit</span>
<a name="ln-6639"></a><span class="k">                  </span><span class="n">elseif</span> <span class="p">(</span><span class="n">img</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6640"></a><span class="k">                     read</span><span class="p">(</span><span class="n">lun</span><span class="p">,</span><span class="n">f102</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">,</span><span class="n">iomsg</span><span class="o">=</span><span class="n">message</span><span class="p">)</span> <span class="n">ximag</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">l</span><span class="p">)</span>        <span class="c">! imaginary</span>
<a name="ln-6641"></a>                     <span class="k">if</span><span class="p">(</span><span class="n">ios</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6642"></a><span class="k">                        </span><span class="n">m</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6643"></a>                        <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6644"></a>                        <span class="k">exit</span>
<a name="ln-6645"></a><span class="k">                     endif</span>
<a name="ln-6646"></a><span class="k">                  endif</span>
<a name="ln-6647"></a><span class="k">               enddo</span>
<a name="ln-6648"></a><span class="k">            endif</span>
<a name="ln-6649"></a><span class="k">         endif</span>
<a name="ln-6650"></a><span class="k">      endif</span>
<a name="ln-6651"></a><span class="k">end subroutine </span><span class="n">mat_savlod</span>
<a name="ln-6652"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6653"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-6654"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6655"></a><span class="kt">logical </span><span class="k">function </span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-6656"></a>
<a name="ln-6657"></a><span class="c">!     check for equality of two integer arrays</span>
<a name="ln-6658"></a>
<a name="ln-6659"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-6660"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-6661"></a>
<a name="ln-6662"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">i</span>
<a name="ln-6663"></a>
<a name="ln-6664"></a>   <span class="n">mat_eqid</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6665"></a>
<a name="ln-6666"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">GG_MAX_NAME_LENGTH</span>
<a name="ln-6667"></a>      <span class="n">mat_eqid</span> <span class="o">=</span> <span class="n">mat_eqid</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-6668"></a>   <span class="k">enddo</span>
<a name="ln-6669"></a>
<a name="ln-6670"></a><span class="k">end function </span><span class="n">mat_eqid</span>
<a name="ln-6671"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6672"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-6673"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6674"></a><span class="c">!&gt;</span>
<a name="ln-6675"></a><span class="c">!!##NAME</span>
<a name="ln-6676"></a><span class="c">!!    ifin_lala(3f) - [M_matrix] test if variable name exists in lala()</span>
<a name="ln-6677"></a><span class="c">!!    LICENSE(MIT)</span>
<a name="ln-6678"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6679"></a><span class="c">!!</span>
<a name="ln-6680"></a><span class="c">!!      logical function ifin_lala(varname)</span>
<a name="ln-6681"></a><span class="c">!!</span>
<a name="ln-6682"></a><span class="c">!!      character(len=*),intent(in) :: varname</span>
<a name="ln-6683"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6684"></a><span class="c">!!    Determine if a variable name currently exists in lala().</span>
<a name="ln-6685"></a><span class="c">!!</span>
<a name="ln-6686"></a><span class="c">!!##RETURNS</span>
<a name="ln-6687"></a><span class="c">!!     ifin_lala  TRUE if varname exists in lala, else FALSE.</span>
<a name="ln-6688"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6689"></a><span class="c">!!</span>
<a name="ln-6690"></a><span class="c">!!   sample program:</span>
<a name="ln-6691"></a><span class="c">!!</span>
<a name="ln-6692"></a><span class="c">!!      program demo_ifin_lala</span>
<a name="ln-6693"></a><span class="c">!!      use M_matrix, only : ifin_lala</span>
<a name="ln-6694"></a><span class="c">!!      implicit none</span>
<a name="ln-6695"></a><span class="c">!!         write(*,*)&#39;eps &#39;,ifin_lala(&#39;eps&#39;)</span>
<a name="ln-6696"></a><span class="c">!!         write(*,*)&#39;unknown &#39;,ifin_lala(&#39;unknown&#39;)</span>
<a name="ln-6697"></a><span class="c">!!      end program demo_ifin_lala</span>
<a name="ln-6698"></a><span class="c">!!</span>
<a name="ln-6699"></a><span class="c">!!   Results:</span>
<a name="ln-6700"></a><span class="c">!!</span>
<a name="ln-6701"></a><span class="c">!!     eps  T</span>
<a name="ln-6702"></a><span class="c">!!     unknown  F</span>
<a name="ln-6703"></a><span class="k">function </span><span class="n">ifin_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span>
<a name="ln-6704"></a>
<a name="ln-6705"></a><span class="c">! ident_32=&quot;@(#)M_matrix::ifin_lala(3f) :: access LALA variable stack and see if a variable name exists&quot;</span>
<a name="ln-6706"></a>
<a name="ln-6707"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-6708"></a><span class="kt">integer</span>                            <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-6709"></a><span class="kt">logical</span>                            <span class="kd">::</span> <span class="n">ifin_lala</span>
<a name="ln-6710"></a><span class="kt">integer</span>                            <span class="kd">::</span> <span class="n">k</span>
<a name="ln-6711"></a>
<a name="ln-6712"></a>   <span class="n">ifin_lala</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6713"></a>   <span class="k">if</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">lala_init</span><span class="p">(</span><span class="mi">200000</span><span class="p">)</span> <span class="c">! if not initialized initialize</span>
<a name="ln-6714"></a>   <span class="k">if</span><span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">mat_is_name</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span><span class="k">then</span>
<a name="ln-6715"></a><span class="k">      call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="s1">&#39;is not a valid variable name&#39;</span><span class="p">)</span>
<a name="ln-6716"></a>      <span class="n">ifin_lala</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6717"></a>   <span class="k">endif</span>
<a name="ln-6718"></a>
<a name="ln-6719"></a>   <span class="c">! convert character name to lala character set</span>
<a name="ln-6720"></a>   <span class="n">id</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6721"></a>   <span class="k">call </span><span class="n">mat_str2buf</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<a name="ln-6722"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">ID</span><span class="p">)</span>   <span class="c">! copy ID to next blank entry in G_VAR_IDS for messages(?)</span>
<a name="ln-6723"></a>
<a name="ln-6724"></a>   <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>                       <span class="c">! start at bottom and search up through names till find the name</span>
<a name="ln-6725"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">:,</span><span class="n">k</span><span class="p">),</span> <span class="n">id</span><span class="p">))</span><span class="k">exit</span>            <span class="c">! if found name exit loop</span>
<a name="ln-6726"></a>   <span class="k">enddo</span>
<a name="ln-6727"></a>
<a name="ln-6728"></a>   <span class="c">! if matched the name inserted above did not find it.</span>
<a name="ln-6729"></a>   <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-6730"></a><span class="k">      </span><span class="n">ifin_lala</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>                              <span class="c">! unknown variable name</span>
<a name="ln-6731"></a>   <span class="k">endif</span>
<a name="ln-6732"></a>
<a name="ln-6733"></a><span class="k">end function </span><span class="n">ifin_lala</span>
<a name="ln-6734"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6735"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-6736"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-6737"></a><span class="c">!&gt;</span>
<a name="ln-6738"></a><span class="c">!!##NAME</span>
<a name="ln-6739"></a><span class="c">!!     get_from_lala(3f) - [M_matrix] return data from lala(3f) to calling program</span>
<a name="ln-6740"></a><span class="c">!!     LICENSE(MIT)</span>
<a name="ln-6741"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6742"></a><span class="c">!!</span>
<a name="ln-6743"></a><span class="c">!!     subroutine get_from_lala(varname,A,IERR,fixed)</span>
<a name="ln-6744"></a><span class="c">!!</span>
<a name="ln-6745"></a><span class="c">!!      character(len=*),intent(in)               :: varname</span>
<a name="ln-6746"></a><span class="c">!!      [INTRINSIC_TYPE],allocatable,intent(out)  :: a(:,:)</span>
<a name="ln-6747"></a><span class="c">!!      integer,intent(out)                       :: ierr</span>
<a name="ln-6748"></a><span class="c">!!      logical,intent(in),optional               :: fixed</span>
<a name="ln-6749"></a><span class="c">!!</span>
<a name="ln-6750"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6751"></a><span class="c">!!    Given the name of a variable defined with lala(3f) commands return</span>
<a name="ln-6752"></a><span class="c">!!    the values to the calling program.</span>
<a name="ln-6753"></a><span class="c">!!</span>
<a name="ln-6754"></a><span class="c">!!##OPTIONS</span>
<a name="ln-6755"></a><span class="c">!!    VARNAME Name of lala(3f) variable to retrieve</span>
<a name="ln-6756"></a><span class="c">!!</span>
<a name="ln-6757"></a><span class="c">!!    FIXED   If .true., A is assumed to be a fixed size. It should only</span>
<a name="ln-6758"></a><span class="c">!!            be specified if the value is .true.! It is up to the user</span>
<a name="ln-6759"></a><span class="c">!!            at this point to ensure the size is correct at this point.</span>
<a name="ln-6760"></a><span class="c">!!##RETURNS</span>
<a name="ln-6761"></a><span class="c">!!      A    May be of TYPE INTEGER, REAL, CHARACTER, LOGICAL or COMPLEX.</span>
<a name="ln-6762"></a><span class="c">!!           May be a scalar, vector, or MxN matrix.</span>
<a name="ln-6763"></a><span class="c">!!    IERR   Zero if no error occurred</span>
<a name="ln-6764"></a><span class="c">!!</span>
<a name="ln-6765"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6766"></a><span class="c">!!</span>
<a name="ln-6767"></a><span class="c">!!   sample program:</span>
<a name="ln-6768"></a><span class="c">!!</span>
<a name="ln-6769"></a><span class="c">!!    program demo_get_from_lala</span>
<a name="ln-6770"></a><span class="c">!!    use M_matrix, only : lala, get_from_lala, put_into_lala</span>
<a name="ln-6771"></a><span class="c">!!    implicit none</span>
<a name="ln-6772"></a><span class="c">!!    doubleprecision,allocatable :: darr(:,:)</span>
<a name="ln-6773"></a><span class="c">!!    real,allocatable            :: rarr(:,:)</span>
<a name="ln-6774"></a><span class="c">!!    integer,allocatable         :: ivec(:)</span>
<a name="ln-6775"></a><span class="c">!!    integer                     :: ierr</span>
<a name="ln-6776"></a><span class="c">!!    integer                     :: i</span>
<a name="ln-6777"></a><span class="c">!!    character(len=*),parameter  :: gen=&#39;(*(g0,1x))&#39;</span>
<a name="ln-6778"></a><span class="c">!!</span>
<a name="ln-6779"></a><span class="c">!!       ! create an array in LALA so have something to get</span>
<a name="ln-6780"></a><span class="c">!!       call lala(&#39;A=rand(4,5)*10.5,long,A&#39;)</span>
<a name="ln-6781"></a><span class="c">!!</span>
<a name="ln-6782"></a><span class="c">!!       ! get the array as a REAL array</span>
<a name="ln-6783"></a><span class="c">!!       call get_from_lala(&#39;A&#39;,rarr,ierr)</span>
<a name="ln-6784"></a><span class="c">!!       write(*,gen)&#39;in calling program RARR=&#39;,shape(rarr)</span>
<a name="ln-6785"></a><span class="c">!!       write(*,gen)(rarr(i,:),new_line(&#39;A&#39;),i=1,size(rarr,dim=1))</span>
<a name="ln-6786"></a><span class="c">!!</span>
<a name="ln-6787"></a><span class="c">!!       ! get the array as a DOUBLEPRECISION  array</span>
<a name="ln-6788"></a><span class="c">!!       call get_from_lala(&#39;A&#39;,darr,ierr)</span>
<a name="ln-6789"></a><span class="c">!!       write(*,gen)&#39;in calling program darr=&#39;,shape(darr)</span>
<a name="ln-6790"></a><span class="c">!!       write(*,gen)(darr(i,:),new_line(&#39;A&#39;),i=1,size(darr,dim=1))</span>
<a name="ln-6791"></a><span class="c">!!</span>
<a name="ln-6792"></a><span class="c">!!       ! get the array as an INTEGER vector, much like the</span>
<a name="ln-6793"></a><span class="c">!!       ! PUSH(3f) intrinsic</span>
<a name="ln-6794"></a><span class="c">!!       call get_from_lala(&#39;A&#39;,ivec,ierr)</span>
<a name="ln-6795"></a><span class="c">!!       write(*,gen)&#39;in calling program ivec=&#39;,shape(ivec)</span>
<a name="ln-6796"></a><span class="c">!!       write(*,gen)ivec</span>
<a name="ln-6797"></a><span class="c">!!</span>
<a name="ln-6798"></a><span class="c">!!    end program demo_get_from_lala</span>
<a name="ln-6799"></a><span class="c">!!</span>
<a name="ln-6800"></a><span class="c">!!   Results:</span>
<a name="ln-6801"></a><span class="c">!!</span>
<a name="ln-6802"></a><span class="c">!!    &gt;A  =</span>
<a name="ln-6803"></a><span class="c">!!    &gt;   2.2189  6.9865  9.2213  7.6267  2.4278</span>
<a name="ln-6804"></a><span class="c">!!    &gt;   7.9385  6.5981  0.7179  2.0844  2.2729</span>
<a name="ln-6805"></a><span class="c">!!    &gt;   0.0023  8.9223  5.8889  5.7147  9.2756</span>
<a name="ln-6806"></a><span class="c">!!    &gt;   3.4684  7.2002  6.9547  2.4368  6.8514</span>
<a name="ln-6807"></a><span class="c">!!</span>
<a name="ln-6808"></a><span class="c">!!    &gt;A  =</span>
<a name="ln-6809"></a><span class="c">!!    &gt;    COLUMNS     1 THRU     4</span>
<a name="ln-6810"></a><span class="c">!!    &gt;  2.218911087373272 6.986501594306901 9.221273053670302 7.626682105707005</span>
<a name="ln-6811"></a><span class="c">!!    &gt;  7.938460468780249 6.598113777581602 0.717927386518568 2.084401034284383</span>
<a name="ln-6812"></a><span class="c">!!    &gt;  0.002321913605556 8.922324976650998 5.888910365989432 5.714701820863411</span>
<a name="ln-6813"></a><span class="c">!!    &gt;  3.468434463255107 7.200175708159804 6.954747841693461 2.436785291880369</span>
<a name="ln-6814"></a><span class="c">!!    &gt;    COLUMNS     5 THRU     5</span>
<a name="ln-6815"></a><span class="c">!!    &gt;  2.427849056432024</span>
<a name="ln-6816"></a><span class="c">!!    &gt;  2.272864263039082</span>
<a name="ln-6817"></a><span class="c">!!    &gt;  9.275582205271348</span>
<a name="ln-6818"></a><span class="c">!!    &gt;  6.851391694508493</span>
<a name="ln-6819"></a><span class="c">!!    &gt;in calling program RARR= 4 5</span>
<a name="ln-6820"></a><span class="c">!!    &gt; 2.21891117 6.98650169 9.22127342 7.62668228 2.42784905</span>
<a name="ln-6821"></a><span class="c">!!    &gt; 7.93846035 6.59811401 0.717927396 2.08440113 2.27286434</span>
<a name="ln-6822"></a><span class="c">!!    &gt; 0.232191361E-2 8.92232513 5.88891029 5.71470165 9.27558231</span>
<a name="ln-6823"></a><span class="c">!!    &gt; 3.46843457 7.20017576 6.95474768 2.43678522 6.85139179</span>
<a name="ln-6824"></a><span class="c">!!</span>
<a name="ln-6825"></a><span class="c">!!    &gt;in calling program darr= 4 5</span>
<a name="ln-6826"></a><span class="c">!!    &gt; 2.2189110873732716 6.9865015943069011 9.2212730536703020 ..</span>
<a name="ln-6827"></a><span class="c">!!    &gt; 7.6266821057070047 2.4278490564320236</span>
<a name="ln-6828"></a><span class="c">!!    &gt; 7.9384604687802494 6.5981137775816023 0.71792738651856780 ..</span>
<a name="ln-6829"></a><span class="c">!!    &gt; 2.0844010342843831 2.2728642630390823</span>
<a name="ln-6830"></a><span class="c">!!    &gt; 0.23219136055558920E-2 8.9223249766509980 5.8889103659894317 ..</span>
<a name="ln-6831"></a><span class="c">!!    &gt; 5.7147018208634108 9.2755822052713484</span>
<a name="ln-6832"></a><span class="c">!!    &gt; 3.4684344632551074 7.2001757081598043 6.9547478416934609 ..</span>
<a name="ln-6833"></a><span class="c">!!    &gt; 2.4367852918803692 6.8513916945084929</span>
<a name="ln-6834"></a><span class="c">!!</span>
<a name="ln-6835"></a><span class="c">!!    &gt;in calling program ivec= 20</span>
<a name="ln-6836"></a><span class="c">!!    &gt; 2 8 0 3 7 7 9 7 9 1 6 7 8 2 6 2 2 2 9 7</span>
<a name="ln-6837"></a><span class="k">subroutine </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="k">type</span><span class="p">,</span><span class="n">IERR</span><span class="p">)</span>
<a name="ln-6838"></a>
<a name="ln-6839"></a><span class="c">! ident_33=&quot;@(#)M_matrix::get_double_from_lala(3f) :: access LALA variable stack and get a variable by name and its data from the stack&quot;</span>
<a name="ln-6840"></a>
<a name="ln-6841"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">varname</span>    <span class="c">! the name of A.</span>
<a name="ln-6842"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                       <span class="kd">::</span> <span class="k">type</span>       <span class="c">! type =  0  get REAL A from LALA, type  = 1  get IMAGINARY A into LALA,</span>
<a name="ln-6843"></a><span class="kt">integer</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ierr</span>       <span class="c">! return with nonzero IERR after LALA error message.</span>
<a name="ln-6844"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">a</span><span class="p">(:,:)</span>     <span class="c">! A is an M by N matrix</span>
<a name="ln-6845"></a><span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>
<a name="ln-6846"></a><span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">location</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span>
<a name="ln-6847"></a>
<a name="ln-6848"></a>   <span class="k">if</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6849"></a><span class="k">      call </span><span class="n">lala_init</span><span class="p">(</span><span class="mi">200000</span><span class="p">)</span> <span class="c">! if not initialized initialize</span>
<a name="ln-6850"></a>   <span class="k">endif</span>
<a name="ln-6851"></a><span class="k">   </span><span class="n">ierr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6852"></a>
<a name="ln-6853"></a>   <span class="c">! convert character name to lala character set</span>
<a name="ln-6854"></a>   <span class="n">id</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6855"></a>   <span class="k">call </span><span class="n">mat_str2buf</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>
<a name="ln-6856"></a>   <span class="c">! ??? make sure this letter is in set of LALA characters and get its LALA number</span>
<a name="ln-6857"></a>   <span class="k">call </span><span class="n">mat_copyid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">ID</span><span class="p">)</span>   <span class="c">! copy ID to next blank entry in G_VAR_IDS for messages(?)</span>
<a name="ln-6858"></a>
<a name="ln-6859"></a>   <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>                       <span class="c">! start at bottom and search up through names till find the name</span>
<a name="ln-6860"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">mat_eqid</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(</span><span class="mi">1</span><span class="p">:,</span><span class="n">k</span><span class="p">),</span> <span class="n">id</span><span class="p">))</span><span class="k">exit</span>            <span class="c">! if found name exit loop</span>
<a name="ln-6861"></a>   <span class="k">enddo</span>
<a name="ln-6862"></a>
<a name="ln-6863"></a>   <span class="c">! if matched the name inserted above did not find it.</span>
<a name="ln-6864"></a>   <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">GG_MAX_NUMBER_OF_NAMES</span><span class="o">-</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">G_RHS</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">k</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">G_TOP_OF_SAVED</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-6865"></a><span class="k">      call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;ERROR&gt;get_double_from_lala: unknown variable name&#39;</span><span class="p">,</span><span class="n">varname</span><span class="p">)</span>
<a name="ln-6866"></a>      <span class="n">IERR</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-6867"></a>      <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="ln-6868"></a>      <span class="k">allocate</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-6869"></a>   <span class="k">else</span>
<a name="ln-6870"></a><span class="k">      if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="ln-6871"></a>      <span class="n">M</span><span class="o">=</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-6872"></a>      <span class="n">N</span><span class="o">=</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-6873"></a>      <span class="k">allocate</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<a name="ln-6874"></a>      <span class="n">location</span><span class="o">=</span><span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-6875"></a>      <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
<a name="ln-6876"></a>         <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span>
<a name="ln-6877"></a>            <span class="k">if</span><span class="p">(</span><span class="k">type</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6878"></a><span class="k">               </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>       <span class="c">! type =  0  GET REAL A FROM LALA,</span>
<a name="ln-6879"></a>            <span class="k">else</span>
<a name="ln-6880"></a><span class="k">               </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>       <span class="c">! type =  1  GET IMAGINARY A FROM LALA,</span>
<a name="ln-6881"></a>            <span class="k">endif</span>
<a name="ln-6882"></a><span class="k">            </span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6883"></a>         <span class="k">enddo</span>
<a name="ln-6884"></a><span class="k">      enddo</span>
<a name="ln-6885"></a><span class="k">   endif</span>
<a name="ln-6886"></a>
<a name="ln-6887"></a><span class="k">end subroutine </span><span class="n">get_double_from_lala</span>
<a name="ln-6888"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6889"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-6890"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6891"></a><span class="k">function </span><span class="n">rowpack</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<a name="ln-6892"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">arr</span><span class="p">(:,:)</span>
<a name="ln-6893"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vec</span><span class="p">(:)</span>
<a name="ln-6894"></a><span class="kt">integer</span>                     <span class="kd">::</span> <span class="n">i</span>
<a name="ln-6895"></a><span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">vec</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<a name="ln-6896"></a><span class="n">vec</span><span class="o">=</span><span class="p">[(</span><span class="n">arr</span><span class="p">(:,</span><span class="n">i</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">))]</span>
<a name="ln-6897"></a><span class="k">end function </span><span class="n">rowpack</span>
<a name="ln-6898"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6899"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-6900"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-6901"></a><span class="c">!&gt;</span>
<a name="ln-6902"></a><span class="c">!!##NAME</span>
<a name="ln-6903"></a><span class="c">!!     put_from_lala(3f) - [M_matrix] return data from lala(3f) to calling program</span>
<a name="ln-6904"></a><span class="c">!!     LICENSE(MIT)</span>
<a name="ln-6905"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6906"></a><span class="c">!!</span>
<a name="ln-6907"></a><span class="c">!!   subroutine put_into_lala(varname,A,IERR)</span>
<a name="ln-6908"></a><span class="c">!!</span>
<a name="ln-6909"></a><span class="c">!!    character(len=*),intent(in)              :: varname</span>
<a name="ln-6910"></a><span class="c">!!    [INTRINSIC_TYPE],allocatable,intent(in)  :: a(:,:)</span>
<a name="ln-6911"></a><span class="c">!!    integer,intent(out)                      :: ierr</span>
<a name="ln-6912"></a><span class="c">!!</span>
<a name="ln-6913"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6914"></a><span class="c">!!    Define a variable in the lala(3f) utility with a variable declared</span>
<a name="ln-6915"></a><span class="c">!!    in the calling program.</span>
<a name="ln-6916"></a><span class="c">!!</span>
<a name="ln-6917"></a><span class="c">!!##OPTIONS</span>
<a name="ln-6918"></a><span class="c">!!    VARNAME Name of lala(3f) variable to retrieve</span>
<a name="ln-6919"></a><span class="c">!!      A     May be of TYPE INTEGER, REAL, CHARACTER, LOGICAL or COMPLEX.</span>
<a name="ln-6920"></a><span class="c">!!            May be a scalar, vector, or MxN matrix.</span>
<a name="ln-6921"></a><span class="c">!!</span>
<a name="ln-6922"></a><span class="c">!!##RETURNS</span>
<a name="ln-6923"></a><span class="c">!!    IERR   Zero if no error occurred</span>
<a name="ln-6924"></a><span class="c">!!</span>
<a name="ln-6925"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6926"></a><span class="c">!!</span>
<a name="ln-6927"></a><span class="c">!!   sample program:</span>
<a name="ln-6928"></a><span class="c">!!</span>
<a name="ln-6929"></a><span class="c">!!    program demo_put_into_lala</span>
<a name="ln-6930"></a><span class="c">!!    use M_matrix, only : lala, get_from_lala, put_into_lala</span>
<a name="ln-6931"></a><span class="c">!!    implicit none</span>
<a name="ln-6932"></a><span class="c">!!    integer :: ierr</span>
<a name="ln-6933"></a><span class="c">!!</span>
<a name="ln-6934"></a><span class="c">!!       ! store some data from the program into lala(3f)</span>
<a name="ln-6935"></a><span class="c">!!       call put_into_lala(&#39;A&#39;,[1,2,3,4,5,6,7,8,9],ierr)</span>
<a name="ln-6936"></a><span class="c">!!       call put_into_lala(&#39;B&#39;,[1.1,2.2,3.3],ierr)</span>
<a name="ln-6937"></a><span class="c">!!       call put_into_lala(&#39;C&#39;,&quot;This is my title&quot;,ierr)</span>
<a name="ln-6938"></a><span class="c">!!</span>
<a name="ln-6939"></a><span class="c">!!       ! call lala(3f) and display the values</span>
<a name="ln-6940"></a><span class="c">!!       call lala([character(len=80) :: &amp;</span>
<a name="ln-6941"></a><span class="c">!!       &amp; &#39;who,A,B&#39;, &amp;</span>
<a name="ln-6942"></a><span class="c">!!       &amp; &#39;display(C);&#39;, &amp;</span>
<a name="ln-6943"></a><span class="c">!!       &amp; &#39;&#39;, &amp;</span>
<a name="ln-6944"></a><span class="c">!!       &amp; &#39;&#39;])</span>
<a name="ln-6945"></a><span class="c">!!</span>
<a name="ln-6946"></a><span class="c">!!    end program demo_put_into_lala</span>
<a name="ln-6947"></a><span class="c">!!</span>
<a name="ln-6948"></a><span class="c">!!   Results:</span>
<a name="ln-6949"></a><span class="c">!!</span>
<a name="ln-6950"></a><span class="c">!!      &gt; Your current variables are...</span>
<a name="ln-6951"></a><span class="c">!!      &gt; C  B  A  eps  flops  eye  rand</span>
<a name="ln-6952"></a><span class="c">!!      &gt;using 33 out of 200000 elements</span>
<a name="ln-6953"></a><span class="c">!!      &gt;</span>
<a name="ln-6954"></a><span class="c">!!      &gt; A  =</span>
<a name="ln-6955"></a><span class="c">!!      &gt;     1.    2.    3.    4.    5.    6.    7.    8.    9.</span>
<a name="ln-6956"></a><span class="c">!!      &gt;</span>
<a name="ln-6957"></a><span class="c">!!      &gt; B  =</span>
<a name="ln-6958"></a><span class="c">!!      &gt;    1.1000    2.2000    3.3000</span>
<a name="ln-6959"></a><span class="c">!!      &gt;This is my title</span>
<a name="ln-6960"></a><span class="k">subroutine </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">realxx</span><span class="p">,</span><span class="n">imagxx</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-6961"></a>
<a name="ln-6962"></a><span class="c">! ident_34=&quot;@(#)M_matrix:: _store_double_into_lala(3f): put a variable name and its data onto LALA stack&quot;</span>
<a name="ln-6963"></a>
<a name="ln-6964"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">varname</span>                <span class="c">! the name of realxx.</span>
<a name="ln-6965"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">realxx</span><span class="p">(:,:)</span>            <span class="c">! inputarray is an M by N matrix</span>
<a name="ln-6966"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>  <span class="kd">::</span> <span class="n">imagxx</span><span class="p">(:,:)</span>            <span class="c">! inputarray is an M by N matrix</span>
<a name="ln-6967"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">ierr</span>                   <span class="c">! return with nonzero ierr after LALA error message.</span>
<a name="ln-6968"></a>
<a name="ln-6969"></a><span class="kt">integer</span>                              <span class="kd">::</span> <span class="n">img</span>
<a name="ln-6970"></a><span class="kt">integer</span>                              <span class="kd">::</span> <span class="n">space_left</span>
<a name="ln-6971"></a><span class="kt">integer</span>                              <span class="kd">::</span> <span class="n">id</span><span class="p">(</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span> <span class="c">! ID = name, in numeric format</span>
<a name="ln-6972"></a><span class="kt">integer</span>                              <span class="kd">::</span> <span class="n">location</span>
<a name="ln-6973"></a><span class="kt">integer</span>                              <span class="kd">::</span> <span class="n">m</span><span class="p">,</span><span class="n">n</span>                    <span class="c">! m, n = dimensions</span>
<a name="ln-6974"></a>
<a name="ln-6975"></a>   <span class="k">if</span><span class="p">(</span><span class="n">GM_BIGMEM</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6976"></a><span class="k">      call </span><span class="n">lala_init</span><span class="p">(</span><span class="mi">200000</span><span class="p">)</span> <span class="c">! if not initialized initialize</span>
<a name="ln-6977"></a>   <span class="k">else</span>
<a name="ln-6978"></a><span class="k">   endif</span>
<a name="ln-6979"></a>
<a name="ln-6980"></a><span class="k">   </span><span class="n">ierr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6981"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">imagxx</span><span class="p">))</span><span class="k">then</span>
<a name="ln-6982"></a><span class="k">      </span><span class="n">img</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6983"></a>      <span class="k">if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">realxx</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">imagxx</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">realxx</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">imagxx</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span><span class="k">then</span>
<a name="ln-6984"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;ERROR&gt;*lala_put* real and imaginary parts have different sizes&#39;</span><span class="p">)</span>
<a name="ln-6985"></a>         <span class="n">ierr</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-6986"></a>         <span class="k">return</span>
<a name="ln-6987"></a><span class="k">      endif</span>
<a name="ln-6988"></a><span class="k">   else</span>
<a name="ln-6989"></a><span class="k">      </span><span class="n">img</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6990"></a>   <span class="k">endif</span>
<a name="ln-6991"></a>
<a name="ln-6992"></a><span class="k">   if</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-6993"></a><span class="k">      </span><span class="n">location</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="c">! location of bottom of used scratch space</span>
<a name="ln-6994"></a>   <span class="k">else</span>
<a name="ln-6995"></a>     <span class="c">!call journal(&#39;sc&#39;,&#39;&lt;WARNING&gt;G_ARGUMENT_POINTER=&#39;,G_ARGUMENT_POINTER)</span>
<a name="ln-6996"></a>     <span class="n">G_ARGUMENT_POINTER</span><span class="o">=</span> <span class="mi">1</span>
<a name="ln-6997"></a>     <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6998"></a>     <span class="n">location</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6999"></a>   <span class="k">endif</span>
<a name="ln-7000"></a><span class="k">   </span><span class="n">space_left</span> <span class="o">=</span> <span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">G_TOP_OF_SAVED</span><span class="p">)</span> <span class="o">-</span> <span class="n">location</span>
<a name="ln-7001"></a>   <span class="c">!! assume input arrays can be one or two dimension but lala stores everything as a vector and store m and n</span>
<a name="ln-7002"></a>   <span class="n">m</span><span class="o">=</span><span class="n">size</span><span class="p">(</span><span class="n">realxx</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7003"></a>   <span class="n">n</span><span class="o">=</span><span class="n">size</span><span class="p">(</span><span class="n">realxx</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7004"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">space_left</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-7005"></a><span class="k">      call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;ERROR&gt;*lala_put* insufficient space to save data to LALA&#39;</span><span class="p">)</span>
<a name="ln-7006"></a>      <span class="n">ierr</span><span class="o">=-</span><span class="mi">2</span>
<a name="ln-7007"></a>      <span class="k">return</span>
<a name="ln-7008"></a><span class="k">   </span><span class="n">elseif</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span> <span class="c">! check for zero-size input array</span>
<a name="ln-7009"></a>      <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;ERROR&gt;*lala_put* cannot save empty arrays to LALA&#39;</span><span class="p">)</span>
<a name="ln-7010"></a>      <span class="n">ierr</span><span class="o">=-</span><span class="mi">3</span>
<a name="ln-7011"></a>      <span class="k">return</span>
<a name="ln-7012"></a><span class="k">   else</span>
<a name="ln-7013"></a><span class="k">      if</span> <span class="p">(</span><span class="n">img</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7014"></a><span class="k">         call </span><span class="n">mat_rset</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="c">! set imaginary values to zero</span>
<a name="ln-7015"></a>      <span class="k">else</span>
<a name="ln-7016"></a><span class="k">         </span><span class="n">GM_IMAGS</span><span class="p">(</span><span class="n">location</span><span class="p">:</span><span class="n">location</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">rowpack</span><span class="p">(</span><span class="n">imagxx</span><span class="p">)</span>
<a name="ln-7017"></a>      <span class="k">endif</span>
<a name="ln-7018"></a><span class="k">      </span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">location</span><span class="p">:</span><span class="n">location</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">rowpack</span><span class="p">(</span><span class="n">realxx</span><span class="p">)</span>
<a name="ln-7019"></a>   <span class="k">endif</span>
<a name="ln-7020"></a><span class="k">   </span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">=</span><span class="n">m</span>
<a name="ln-7021"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span><span class="o">=</span><span class="n">n</span>
<a name="ln-7022"></a>   <span class="n">G_SYM</span> <span class="o">=</span> <span class="n">semi</span>   <span class="c">!! ??? why</span>
<a name="ln-7023"></a>   <span class="n">G_RHS</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">!! ??? why</span>
<a name="ln-7024"></a>   <span class="k">call </span><span class="n">mat_str2buf</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="n">GG_MAX_NAME_LENGTH</span><span class="p">)</span>                        <span class="c">! convert character string to an ID</span>
<a name="ln-7025"></a>   <span class="c">!! ???? if(G_ERR.ne.0)</span>
<a name="ln-7026"></a>   <span class="c">!! ???? check if varname is an acceptable name</span>
<a name="ln-7027"></a>   <span class="k">call </span><span class="n">mat_stack_put</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<a name="ln-7028"></a>   <span class="c">!! ???? if(G_ERR.ne.0)</span>
<a name="ln-7029"></a>   <span class="n">G_ARGUMENT_POINTER</span> <span class="o">=</span> <span class="n">G_ARGUMENT_POINTER</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7030"></a>   <span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7031"></a>   <span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">G_ARGUMENT_POINTER</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7032"></a><span class="k">end subroutine </span><span class="n">store_double_into_lala</span>
<a name="ln-7033"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7034"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7035"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7036"></a><span class="k">subroutine </span><span class="n">store_array_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">anything</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7037"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7038"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">anything</span><span class="p">(:,:)</span>
<a name="ln-7039"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7040"></a>   <span class="k">select type</span><span class="p">(</span><span class="n">anything</span><span class="p">)</span>
<a name="ln-7041"></a><span class="c">!!    type is (character(len=*));</span>
<a name="ln-7042"></a><span class="c">!!       call store_double_into_lala(varname,</span>
<a name="ln-7043"></a><span class="c">!!       reshape(real(str2ade(anything),kind=dp),[1,len(anything)])</span>
<a name="ln-7044"></a><span class="c">!!       ,ierr=ierr)</span>
<a name="ln-7045"></a><span class="c">!!       call store_double_into_lala(varname,reshape(real(str2ade(anything),kind=dp),[1,len(anything)]),ierr=ierr)</span>
<a name="ln-7046"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">);</span>              <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7047"></a>                                                                     <span class="p">&amp;</span> <span class="kt">real</span><span class="p">(</span><span class="nb">aimag</span><span class="p">(</span><span class="n">anything</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7048"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">));</span>     <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">),</span><span class="nb">aimag</span><span class="p">(</span><span class="n">anything</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7049"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">));</span>   <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7050"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">));</span>  <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7051"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">));</span>  <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7052"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">));</span>  <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7053"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">));</span>    <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7054"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">));</span>    <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7055"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">));</span>   <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7056"></a>   <span class="c">! arbitrarily, 0 is false and not 0 is true, although I prefer the opposite</span>
<a name="ln-7057"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">logical</span><span class="p">);</span>              <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">merge</span><span class="p">(</span><span class="mf">0.1d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">anything</span><span class="p">),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7058"></a>   <span class="k">class </span><span class="n">default</span>
<a name="ln-7059"></a>      <span class="k">stop</span> <span class="s1">&#39;crud. store_array_into_lala(1) does not know about this type&#39;</span>
<a name="ln-7060"></a>   <span class="k">end select</span>
<a name="ln-7061"></a><span class="k">end subroutine </span><span class="n">store_array_into_lala</span>
<a name="ln-7062"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7063"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7064"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7065"></a><span class="k">subroutine </span><span class="n">store_vector_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">anything</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7066"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7067"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">anything</span><span class="p">(:)</span>
<a name="ln-7068"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7069"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">i</span>
<a name="ln-7070"></a>   <span class="k">select type</span><span class="p">(</span><span class="n">anything</span><span class="p">)</span>
<a name="ln-7071"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">));</span>
<a name="ln-7072"></a>       <span class="k">associate</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-7073"></a>                   <span class="p">&amp;</span> <span class="n">letters</span>  <span class="o">=&gt;</span> <span class="p">[(</span> <span class="kt">real</span><span class="p">(</span><span class="n">str2ade</span><span class="p">(</span><span class="n">anything</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))]</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7074"></a>                   <span class="p">&amp;</span> <span class="n">r</span><span class="o">=&gt;</span> <span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7075"></a>                   <span class="p">&amp;</span> <span class="n">c</span><span class="o">=&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">anything</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7076"></a>                 <span class="p">)</span>
<a name="ln-7077"></a>          <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="n">letters</span><span class="p">,[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">],</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7078"></a>       <span class="k">end associate</span>
<a name="ln-7079"></a><span class="k">    type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">)</span>
<a name="ln-7080"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span> <span class="p">&amp;</span>
<a name="ln-7081"></a>                                          <span class="p">&amp;</span> <span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">aimag</span><span class="p">(</span><span class="n">anything</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span> <span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7082"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">))</span>
<a name="ln-7083"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span> <span class="p">&amp;</span>
<a name="ln-7084"></a>                                          <span class="p">&amp;</span> <span class="nb">reshape</span><span class="p">(</span><span class="nb">aimag</span><span class="p">(</span><span class="n">anything</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span> <span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7085"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">))</span>
<a name="ln-7086"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7087"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">))</span>
<a name="ln-7088"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7089"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">))</span>
<a name="ln-7090"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7091"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">))</span>
<a name="ln-7092"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7093"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">))</span>
<a name="ln-7094"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7095"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">))</span>
<a name="ln-7096"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7097"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">))</span>
<a name="ln-7098"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7099"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">logical</span><span class="p">)</span>
<a name="ln-7100"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="nb">merge</span><span class="p">(</span><span class="mf">0.1d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">anything</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7101"></a>    <span class="k">class </span><span class="n">default</span>
<a name="ln-7102"></a>      <span class="k">stop</span> <span class="s1">&#39;crud. store_vector_into_lala(1) does not know about this type&#39;</span>
<a name="ln-7103"></a>      <span class="n">ierr</span><span class="o">=-</span><span class="mi">20</span>
<a name="ln-7104"></a>   <span class="k">end select</span>
<a name="ln-7105"></a><span class="k">end subroutine </span><span class="n">store_vector_into_lala</span>
<a name="ln-7106"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7107"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7108"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7109"></a><span class="k">subroutine </span><span class="n">store_scalar_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">anything</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7110"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7111"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">anything</span>
<a name="ln-7112"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7113"></a><span class="kt">logical</span><span class="p">,</span><span class="k">parameter</span>            <span class="kd">::</span> <span class="n">T</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7114"></a>   <span class="k">select type</span><span class="p">(</span><span class="n">anything</span><span class="p">)</span>
<a name="ln-7115"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">))</span>
<a name="ln-7116"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">str2ade</span><span class="p">(</span><span class="n">anything</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">anything</span><span class="p">)]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7117"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">)</span>
<a name="ln-7118"></a>       <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="p">&amp;</span>
<a name="ln-7119"></a>                                          <span class="p">&amp;</span> <span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="nb">aimag</span><span class="p">(</span><span class="n">anything</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7120"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">))</span>
<a name="ln-7121"></a>             <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">reshape</span><span class="p">([</span><span class="nb">aimag</span><span class="p">(</span><span class="n">anything</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7122"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">));</span>  <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7123"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">));</span> <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7124"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">));</span> <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7125"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">));</span> <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7126"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">));</span>   <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7127"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">));</span>   <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7128"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">));</span>  <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="kt">real</span><span class="p">(</span><span class="n">anything</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7129"></a>    <span class="c">! arbitrarily, 0 is false and not 0 is true, although I prefer the opposite</span>
<a name="ln-7130"></a>    <span class="k">type is</span> <span class="p">(</span><span class="kt">logical</span><span class="p">);</span>             <span class="k">call </span><span class="n">store_double_into_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="nb">reshape</span><span class="p">([</span><span class="nb">merge</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">anything</span><span class="p">)],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7131"></a>    <span class="k">class </span><span class="n">default</span>
<a name="ln-7132"></a>      <span class="k">stop</span> <span class="s1">&#39;crud. store_scalar_into_lala(1) does not know about this type&#39;</span>
<a name="ln-7133"></a>   <span class="k">end select</span>
<a name="ln-7134"></a><span class="k">end subroutine </span><span class="n">store_scalar_into_lala</span>
<a name="ln-7135"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7136"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7137"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7138"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_int8</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7139"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7140"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7141"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7142"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7143"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7144"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7145"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7146"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>
<a name="ln-7147"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_int8</span>
<a name="ln-7148"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7149"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_int16</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7150"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7151"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7152"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7153"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7154"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7155"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7156"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7157"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">)</span>
<a name="ln-7158"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_int16</span>
<a name="ln-7159"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7160"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_int32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7161"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7162"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7163"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7164"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7165"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7166"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7167"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7168"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<a name="ln-7169"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_int32</span>
<a name="ln-7170"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7171"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_int64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7172"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7173"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7174"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7175"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7176"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7177"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7178"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7179"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<a name="ln-7180"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_int64</span>
<a name="ln-7181"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7182"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_real32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7183"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7184"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7185"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7186"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7187"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7188"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7189"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7190"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span>
<a name="ln-7191"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_real32</span>
<a name="ln-7192"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7193"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_real64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7194"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7195"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7196"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7197"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7198"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7199"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7200"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7201"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span>
<a name="ln-7202"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_real64</span>
<a name="ln-7203"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7204"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_real128</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7205"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7206"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7207"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7208"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7209"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7210"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7211"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7212"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span>
<a name="ln-7213"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_real128</span>
<a name="ln-7214"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7215"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_logical</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7216"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7217"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7218"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7219"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7220"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7221"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7222"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7223"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">merge</span><span class="p">(.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-7224"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_logical</span>
<a name="ln-7225"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7226"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_cmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7227"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7228"></a><span class="kt">complex</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7229"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7230"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7231"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7232"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7233"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7234"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7235"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<a name="ln-7236"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_cmplx</span>
<a name="ln-7237"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7238"></a><span class="k">subroutine </span><span class="n">get_fixed_array_from_lala_dpcmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7239"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7240"></a><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7241"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7242"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7243"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7244"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7245"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7246"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7247"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<a name="ln-7248"></a><span class="k">end subroutine </span><span class="n">get_fixed_array_from_lala_dpcmplx</span>
<a name="ln-7249"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7250"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7251"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7252"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_character</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7253"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7254"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7255"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>              <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7256"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7257"></a><span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-7258"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7259"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7260"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7261"></a><span class="k">   do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7262"></a>      <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7263"></a>         <span class="n">out</span><span class="p">(</span><span class="n">i</span><span class="p">)(</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span>
<a name="ln-7264"></a>      <span class="k">enddo</span>
<a name="ln-7265"></a><span class="k">   enddo</span>
<a name="ln-7266"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_character</span>
<a name="ln-7267"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7268"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_int8</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7269"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7270"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7271"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7272"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7273"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7274"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7275"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7276"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>
<a name="ln-7277"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_int8</span>
<a name="ln-7278"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7279"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_int16</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7280"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7281"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7282"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7283"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7284"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7285"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7286"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7287"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">)</span>
<a name="ln-7288"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_int16</span>
<a name="ln-7289"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7290"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_int32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7291"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7292"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7293"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7294"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7295"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7296"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7297"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7298"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<a name="ln-7299"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_int32</span>
<a name="ln-7300"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7301"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_int64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7302"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7303"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7304"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7305"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7306"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7307"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7308"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7309"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<a name="ln-7310"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_int64</span>
<a name="ln-7311"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7312"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_real32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7313"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7314"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7315"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7316"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7317"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7318"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7319"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7320"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span>
<a name="ln-7321"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_real32</span>
<a name="ln-7322"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7323"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_real64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7324"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7325"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7326"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7327"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7328"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7329"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7330"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7331"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span>
<a name="ln-7332"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_real64</span>
<a name="ln-7333"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7334"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_real128</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7335"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7336"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7337"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7338"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7339"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7340"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7341"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7342"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span>
<a name="ln-7343"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_real128</span>
<a name="ln-7344"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7345"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_logical</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7346"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7347"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7348"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7349"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7350"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7351"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7352"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7353"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">merge</span><span class="p">(.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-7354"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_logical</span>
<a name="ln-7355"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7356"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_cmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7357"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7358"></a><span class="kt">complex</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7359"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7360"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7361"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7362"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7363"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7364"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7365"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="n">rowpack</span><span class="p">(</span><span class="n">doublei</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<a name="ln-7366"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_cmplx</span>
<a name="ln-7367"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7368"></a><span class="k">subroutine </span><span class="n">get_fixed_vector_from_lala_dpcmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7369"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7370"></a><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7371"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7372"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7373"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7374"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7375"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7376"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7377"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="n">rowpack</span><span class="p">(</span><span class="n">doublei</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span>
<a name="ln-7378"></a><span class="k">end subroutine </span><span class="n">get_fixed_vector_from_lala_dpcmplx</span>
<a name="ln-7379"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7380"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7381"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7382"></a><span class="k">subroutine </span><span class="n">get_fixed_scalar_from_lala_character</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">fixed</span><span class="p">)</span>
<a name="ln-7383"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7384"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7385"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>              <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7386"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7387"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fixed</span>
<a name="ln-7388"></a><span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-7389"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7390"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7391"></a><span class="k">   </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7392"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7393"></a>      <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7394"></a>         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7395"></a>         <span class="n">out</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span>
<a name="ln-7396"></a>      <span class="k">enddo</span>
<a name="ln-7397"></a><span class="k">   enddo</span>
<a name="ln-7398"></a><span class="k">end subroutine </span><span class="n">get_fixed_scalar_from_lala_character</span>
<a name="ln-7399"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7400"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7401"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7402"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_int8</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7403"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7404"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7405"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7406"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7407"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7408"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7409"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7410"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>
<a name="ln-7411"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_int8</span>
<a name="ln-7412"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7413"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_int16</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7414"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7415"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7416"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7417"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7418"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7419"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7420"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7421"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">)</span>
<a name="ln-7422"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_int16</span>
<a name="ln-7423"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7424"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_int32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7425"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7426"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7427"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7428"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7429"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7430"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7431"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7432"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<a name="ln-7433"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_int32</span>
<a name="ln-7434"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7435"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_int64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7436"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7437"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7438"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7439"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7440"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7441"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7442"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7443"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<a name="ln-7444"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_int64</span>
<a name="ln-7445"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7446"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_real32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7447"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7448"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7449"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7450"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7451"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7452"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7453"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7454"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span>
<a name="ln-7455"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_real32</span>
<a name="ln-7456"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7457"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_real64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7458"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7459"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7460"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7461"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7462"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7463"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7464"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7465"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span>
<a name="ln-7466"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_real64</span>
<a name="ln-7467"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7468"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_real128</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7469"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7470"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7471"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7472"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7473"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7474"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7475"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7476"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span>
<a name="ln-7477"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_real128</span>
<a name="ln-7478"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7479"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_logical</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7480"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7481"></a><span class="kt">logical</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7482"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7483"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7484"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7485"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7486"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7487"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">merge</span><span class="p">(.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-7488"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_logical</span>
<a name="ln-7489"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7490"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_cmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7491"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7492"></a><span class="kt">complex</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7493"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7494"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7495"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7496"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7497"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7498"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7499"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<a name="ln-7500"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_cmplx</span>
<a name="ln-7501"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7502"></a><span class="k">subroutine </span><span class="n">get_array_from_lala_dpcmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7503"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7504"></a><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:,:)</span>
<a name="ln-7505"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7506"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7507"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7508"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7509"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7510"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7511"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="nb">kind</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<a name="ln-7512"></a><span class="k">end subroutine </span><span class="n">get_array_from_lala_dpcmplx</span>
<a name="ln-7513"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7514"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7515"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7516"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_character</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7517"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7518"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7519"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>              <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7520"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7521"></a><span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span>
<a name="ln-7522"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7523"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7524"></a><span class="k">   if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7525"></a>   <span class="k">allocate</span><span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-7526"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7527"></a>      <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7528"></a>         <span class="n">out</span><span class="p">(</span><span class="n">i</span><span class="p">)(</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span>
<a name="ln-7529"></a>      <span class="k">enddo</span>
<a name="ln-7530"></a><span class="k">   enddo</span>
<a name="ln-7531"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_character</span>
<a name="ln-7532"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7533"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_int8</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7534"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7535"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7536"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7537"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7538"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7539"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7540"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7541"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>
<a name="ln-7542"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_int8</span>
<a name="ln-7543"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7544"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_int16</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7545"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7546"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7547"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7548"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7549"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7550"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7551"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7552"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">)</span>
<a name="ln-7553"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_int16</span>
<a name="ln-7554"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7555"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_int32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7556"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7557"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7558"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7559"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7560"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7561"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7562"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7563"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<a name="ln-7564"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_int32</span>
<a name="ln-7565"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7566"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_int64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7567"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7568"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7569"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7570"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7571"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7572"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7573"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7574"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<a name="ln-7575"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_int64</span>
<a name="ln-7576"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7577"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_real32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7578"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7579"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7580"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7581"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7582"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7583"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7584"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7585"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span>
<a name="ln-7586"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_real32</span>
<a name="ln-7587"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7588"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_real64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7589"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7590"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7591"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7592"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7593"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7594"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7595"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7596"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span>
<a name="ln-7597"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_real64</span>
<a name="ln-7598"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7599"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_real128</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7600"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7601"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7602"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>                 <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7603"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7604"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7605"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7606"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7607"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span>
<a name="ln-7608"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_real128</span>
<a name="ln-7609"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7610"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_logical</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7611"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7612"></a><span class="kt">logical</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7613"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7614"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7615"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7616"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7617"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7618"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">merge</span><span class="p">(.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,</span><span class="nb">nint</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-7619"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_logical</span>
<a name="ln-7620"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7621"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_cmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7622"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7623"></a><span class="kt">complex</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7624"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7625"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7626"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7627"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7628"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7629"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7630"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="n">rowpack</span><span class="p">(</span><span class="n">doublei</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<a name="ln-7631"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_cmplx</span>
<a name="ln-7632"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7633"></a><span class="k">subroutine </span><span class="n">get_vector_from_lala_dpcmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7634"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7635"></a><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span><span class="p">(:)</span>
<a name="ln-7636"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>               <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7637"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7638"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7639"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7640"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7641"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7642"></a><span class="k">   </span><span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">rowpack</span><span class="p">(</span><span class="n">double</span><span class="p">),</span><span class="n">rowpack</span><span class="p">(</span><span class="n">doublei</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span>
<a name="ln-7643"></a><span class="k">end subroutine </span><span class="n">get_vector_from_lala_dpcmplx</span>
<a name="ln-7644"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7645"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7646"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7647"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_character</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7648"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7649"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7650"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>              <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7651"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7652"></a><span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-7653"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7654"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7655"></a><span class="k">   if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a name="ln-7656"></a>   <span class="k">allocate</span><span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span> <span class="kd">::</span> <span class="n">out</span><span class="p">)</span>
<a name="ln-7657"></a>   <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7658"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7659"></a>      <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7660"></a>         <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7661"></a>         <span class="n">out</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)))</span>
<a name="ln-7662"></a>      <span class="k">enddo</span>
<a name="ln-7663"></a><span class="k">   enddo</span>
<a name="ln-7664"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_character</span>
<a name="ln-7665"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7666"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_int8</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7667"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7668"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7669"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7670"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7671"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7672"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7673"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7674"></a>   <span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>
<a name="ln-7675"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_int8</span>
<a name="ln-7676"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7677"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_int16</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7678"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7679"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7680"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>     <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7681"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7682"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7683"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7684"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7685"></a>   <span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">)</span>
<a name="ln-7686"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_int16</span>
<a name="ln-7687"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7688"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_int32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7689"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7690"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7691"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>     <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7692"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7693"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7694"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7695"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7696"></a>   <span class="n">out</span><span class="o">=</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<a name="ln-7697"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_int32</span>
<a name="ln-7698"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7699"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_int64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7700"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7701"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7702"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>     <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7703"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7704"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7705"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7706"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7707"></a>   <span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<a name="ln-7708"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_int64</span>
<a name="ln-7709"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7710"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_real32</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7711"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7712"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7713"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7714"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7715"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7716"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7717"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7718"></a>   <span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span>
<a name="ln-7719"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_real32</span>
<a name="ln-7720"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7721"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_real64</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7722"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7723"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7724"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7725"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7726"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7727"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7728"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7729"></a>   <span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span>
<a name="ln-7730"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_real64</span>
<a name="ln-7731"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7732"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_real128</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7733"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7734"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7735"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7736"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7737"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7738"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7739"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7740"></a>   <span class="n">out</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span>
<a name="ln-7741"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_real128</span>
<a name="ln-7742"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7743"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_logical</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7744"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7745"></a><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7746"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:)</span>
<a name="ln-7747"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7748"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7749"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7750"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7751"></a>   <span class="n">out</span><span class="o">=</span><span class="nb">merge</span><span class="p">(.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,</span><span class="nb">nint</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-7752"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_logical</span>
<a name="ln-7753"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7754"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_cmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7755"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7756"></a><span class="kt">complex</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7757"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7758"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7759"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7760"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7761"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7762"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7763"></a>   <span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">doublei</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<a name="ln-7764"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_cmplx</span>
<a name="ln-7765"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7766"></a><span class="k">subroutine </span><span class="n">get_scalar_from_lala_dpcmplx</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7767"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">varname</span>
<a name="ln-7768"></a><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">out</span>
<a name="ln-7769"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">double</span><span class="p">(:,:),</span> <span class="n">doublei</span><span class="p">(:,:)</span>
<a name="ln-7770"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-7771"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">double</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7772"></a>   <span class="k">call </span><span class="n">get_double_from_lala</span><span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">doublei</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-7773"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span>
<a name="ln-7774"></a><span class="k">   if</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span><span class="s1">&#39;warning: returned scalar does not have size 1 but size&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<a name="ln-7775"></a>   <span class="n">out</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">doublei</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span>
<a name="ln-7776"></a><span class="k">end subroutine </span><span class="n">get_scalar_from_lala_dpcmplx</span>
<a name="ln-7777"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7778"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7779"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7780"></a><span class="k">function </span><span class="n">too_much_memory</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
<a name="ln-7781"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">expression</span>
<a name="ln-7782"></a><span class="kt">logical</span>            <span class="kd">::</span> <span class="n">too_much_memory</span>
<a name="ln-7783"></a>
<a name="ln-7784"></a><span class="c">! ident_35=&quot;@(#)too much memory required&quot;</span>
<a name="ln-7785"></a>
<a name="ln-7786"></a>   <span class="n">G_ERR</span><span class="o">=</span><span class="n">expression</span>
<a name="ln-7787"></a>   <span class="k">if</span><span class="p">(</span><span class="n">G_ERR</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7788"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-7789"></a>      <span class="n">too_much_memory</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7790"></a>   <span class="k">else</span>
<a name="ln-7791"></a><span class="k">      </span><span class="n">too_much_memory</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7792"></a>   <span class="k">endif</span>
<a name="ln-7793"></a>
<a name="ln-7794"></a><span class="k">end function </span><span class="n">too_much_memory</span>
<a name="ln-7795"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7796"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-7797"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-7798"></a><span class="k">function </span><span class="n">system_getenv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">default</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-7799"></a>
<a name="ln-7800"></a><span class="c">! ident_36=&quot;@(#)M_system::system_getenv(3f): call get_environment_variable as a function with a default value(3f)&quot;</span>
<a name="ln-7801"></a>
<a name="ln-7802"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">name</span>
<a name="ln-7803"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">default</span>
<a name="ln-7804"></a><span class="kt">integer</span>                              <span class="kd">::</span> <span class="n">howbig</span>
<a name="ln-7805"></a><span class="kt">integer</span>                              <span class="kd">::</span> <span class="nb">stat</span>
<a name="ln-7806"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span>         <span class="kd">::</span> <span class="k">value</span>
<a name="ln-7807"></a>
<a name="ln-7808"></a><span class="k">   if</span><span class="p">(</span><span class="n">NAME</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7809"></a><span class="k">      call </span><span class="nb">get_environment_variable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">howbig</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="nb">stat</span><span class="p">,</span> <span class="n">trim_name</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>  <span class="c">! get length required to hold value</span>
<a name="ln-7810"></a>      <span class="k">if</span><span class="p">(</span><span class="n">howbig</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7811"></a><span class="k">         select case</span> <span class="p">(</span><span class="nb">stat</span><span class="p">)</span>
<a name="ln-7812"></a>         <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>     <span class="c">! print *, NAME, &quot; is not defined in the environment. Strange...&quot;</span>
<a name="ln-7813"></a>            <span class="k">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<a name="ln-7814"></a>         <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>     <span class="c">! print *, &quot;This processor doesn&#39;t support environment variables. Boooh!&quot;</span>
<a name="ln-7815"></a>            <span class="k">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<a name="ln-7816"></a>         <span class="k">case </span><span class="n">default</span> <span class="c">! make string to hold value of sufficient size and get value</span>
<a name="ln-7817"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="k">value</span><span class="p">))</span><span class="k">deallocate</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-7818"></a>            <span class="k">allocate</span><span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">howbig</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="kd">::</span> <span class="k">VALUE</span><span class="p">)</span>
<a name="ln-7819"></a>            <span class="k">call </span><span class="nb">get_environment_variable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="k">value</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="nb">stat</span><span class="p">,</span><span class="n">trim_name</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-7820"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">stat</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">VALUE</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<a name="ln-7821"></a>         <span class="k">end select</span>
<a name="ln-7822"></a><span class="k">      else</span>
<a name="ln-7823"></a><span class="k">         value</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<a name="ln-7824"></a>      <span class="k">endif</span>
<a name="ln-7825"></a><span class="k">   else</span>
<a name="ln-7826"></a><span class="k">      value</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<a name="ln-7827"></a>   <span class="k">endif</span>
<a name="ln-7828"></a><span class="k">   if</span><span class="p">(</span><span class="k">value</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">present</span><span class="p">(</span><span class="n">default</span><span class="p">))</span><span class="k">value</span><span class="o">=</span><span class="n">default</span>
<a name="ln-7829"></a>
<a name="ln-7830"></a><span class="k">end function </span><span class="n">system_getenv</span>
<a name="ln-7831"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-7832"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-7833"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-7834"></a><span class="k">function </span><span class="n">mat_is_name</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">result</span> <span class="p">(</span><span class="n">lout</span><span class="p">)</span>
<a name="ln-7835"></a><span class="c">! determine if a string is a valid Fortran name ignoring trailing spaces</span>
<a name="ln-7836"></a><span class="c">! (but not leading spaces)</span>
<a name="ln-7837"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="nb">int</span><span class="o">=</span><span class="s1">&#39;0123456789&#39;</span>
<a name="ln-7838"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">lower</span><span class="o">=</span><span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span>
<a name="ln-7839"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">upper</span><span class="o">=</span><span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
<a name="ln-7840"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">allowed</span><span class="o">=</span><span class="n">upper</span><span class="o">//</span><span class="n">lower</span><span class="o">//</span><span class="nb">int</span><span class="o">//</span><span class="s1">&#39;_&#39;</span>
<a name="ln-7841"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">line</span>
<a name="ln-7842"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-7843"></a><span class="kt">logical</span>                      <span class="kd">::</span> <span class="n">lout</span>
<a name="ln-7844"></a>        <span class="n">name</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-7845"></a>        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7846"></a><span class="k">            </span><span class="n">lout</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>                                  <span class="p">&amp;</span>
<a name="ln-7847"></a>             <span class="p">&amp;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">verify</span><span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span> <span class="n">lower</span><span class="o">//</span><span class="n">upper</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>  <span class="p">&amp;</span>
<a name="ln-7848"></a>             <span class="p">&amp;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">verify</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">allowed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>             <span class="p">&amp;</span>
<a name="ln-7849"></a>             <span class="p">&amp;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">33</span>
<a name="ln-7850"></a>        <span class="k">else</span>
<a name="ln-7851"></a><span class="k">            </span><span class="n">lout</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7852"></a>        <span class="k">endif</span>
<a name="ln-7853"></a><span class="k">end function </span><span class="n">mat_is_name</span>
<a name="ln-7854"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-7855"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-7856"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-7857"></a><span class="k">subroutine </span><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">valin1</span><span class="p">,</span><span class="n">valin2</span><span class="p">,</span><span class="n">valin3</span><span class="p">)</span>
<a name="ln-7858"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">key</span>
<a name="ln-7859"></a><span class="kt">integer</span><span class="p">,</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">valin1</span><span class="p">,</span><span class="n">valin2</span><span class="p">,</span><span class="n">valin3</span>
<a name="ln-7860"></a><span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">place</span>
<a name="ln-7861"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">valin1</span><span class="p">))</span><span class="k">then</span>
<a name="ln-7862"></a>      <span class="c">! find where string is or should be</span>
<a name="ln-7863"></a>      <span class="k">call </span><span class="n">locate</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7864"></a>      <span class="c">! if string was not found insert it</span>
<a name="ln-7865"></a>      <span class="k">if</span><span class="p">(</span><span class="n">place</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7866"></a><span class="k">         call </span><span class="n">insert</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="nb">iabs</span><span class="p">(</span><span class="n">place</span><span class="p">))</span>
<a name="ln-7867"></a>         <span class="k">call </span><span class="n">insert</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">valin1</span><span class="p">,</span><span class="nb">iabs</span><span class="p">(</span><span class="n">place</span><span class="p">))</span>
<a name="ln-7868"></a>         <span class="k">call </span><span class="n">insert</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span><span class="n">valin2</span><span class="p">,</span><span class="nb">iabs</span><span class="p">(</span><span class="n">place</span><span class="p">))</span>
<a name="ln-7869"></a>         <span class="k">call </span><span class="n">insert</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">valin3</span><span class="p">,</span><span class="nb">iabs</span><span class="p">(</span><span class="n">place</span><span class="p">))</span>
<a name="ln-7870"></a>      <span class="k">else</span>
<a name="ln-7871"></a><span class="k">         call </span><span class="n">replace</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">valin1</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7872"></a>         <span class="k">call </span><span class="n">replace</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span><span class="n">valin2</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7873"></a>         <span class="k">call </span><span class="n">replace</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">valin3</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7874"></a>      <span class="k">endif</span>
<a name="ln-7875"></a><span class="k">   else</span>
<a name="ln-7876"></a><span class="k">      call </span><span class="n">locate</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7877"></a>      <span class="k">if</span><span class="p">(</span><span class="n">place</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7878"></a><span class="k">         call </span><span class="n">remove</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7879"></a>         <span class="k">call </span><span class="n">remove</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7880"></a>         <span class="k">call </span><span class="n">remove</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7881"></a>         <span class="k">call </span><span class="n">remove</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7882"></a>      <span class="k">endif</span>
<a name="ln-7883"></a><span class="k">   endif</span>
<a name="ln-7884"></a><span class="k">end subroutine </span><span class="n">update</span>
<a name="ln-7885"></a>
<a name="ln-7886"></a><span class="k">subroutine </span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">valout1</span><span class="p">,</span><span class="n">valout2</span><span class="p">,</span><span class="n">valout3</span><span class="p">)</span>
<a name="ln-7887"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">key</span>
<a name="ln-7888"></a><span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">valout1</span><span class="p">,</span> <span class="n">valout2</span><span class="p">,</span> <span class="n">valout3</span>
<a name="ln-7889"></a><span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">place</span>
<a name="ln-7890"></a><span class="c">! find where string is or should be</span>
<a name="ln-7891"></a>   <span class="k">call </span><span class="n">locate</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7892"></a>   <span class="k">if</span><span class="p">(</span><span class="n">place</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<a name="ln-7893"></a><span class="k">      </span><span class="n">valout1</span><span class="o">=-</span><span class="mi">99999</span>
<a name="ln-7894"></a>      <span class="n">valout2</span><span class="o">=-</span><span class="mi">99999</span>
<a name="ln-7895"></a>      <span class="n">valout3</span><span class="o">=-</span><span class="mi">99999</span>
<a name="ln-7896"></a>   <span class="k">else</span>
<a name="ln-7897"></a><span class="k">      </span><span class="n">valout1</span><span class="o">=</span><span class="n">rows</span><span class="p">(</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7898"></a>      <span class="n">valout2</span><span class="o">=</span><span class="n">cols</span><span class="p">(</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7899"></a>      <span class="n">valout3</span><span class="o">=</span><span class="n">locs</span><span class="p">(</span><span class="n">place</span><span class="p">)</span>
<a name="ln-7900"></a>   <span class="k">endif</span>
<a name="ln-7901"></a><span class="k">end subroutine </span><span class="n">get</span>
<a name="ln-7902"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-7903"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-7904"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-7905"></a><span class="k">subroutine </span><span class="n">mat_help_text</span><span class="p">()</span>
<a name="ln-7906"></a><span class="n">G_HELP_TEXT</span><span class="o">=</span><span class="p">[</span> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span> <span class="kd">::</span> <span class="p">&amp;</span>
<a name="ln-7907"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-7908"></a><span class="s1">&#39;LALA USERS&#39;&#39; GUIDE&#39;</span><span class="p">,&amp;</span>
<a name="ln-7909"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7910"></a><span class="s1">&#39;                        LALA (May, 1981 - Apr, 2021)&#39;</span><span class="p">,&amp;</span>
<a name="ln-7911"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7912"></a><span class="s1">&#39;   The Linear Algebra Fortran Facility (LALA) is a collection of Fortran&#39;</span><span class="p">,&amp;</span>
<a name="ln-7913"></a><span class="s1">&#39;   procedures that serves as a convenient tool for Fortran programs to&#39;</span><span class="p">,&amp;</span>
<a name="ln-7914"></a><span class="s1">&#39;   interact with their data (interactively or in batch mode) with a&#39;</span><span class="p">,&amp;</span>
<a name="ln-7915"></a><span class="s1">&#39;   tool that acts as a basic &quot;laboratory&quot; for computations involving&#39;</span><span class="p">,&amp;</span>
<a name="ln-7916"></a><span class="s1">&#39;   matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7917"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7918"></a><span class="s1">&#39;   It provides easy access to matrix software developed by the LINPACK&#39;</span><span class="p">,&amp;</span>
<a name="ln-7919"></a><span class="s1">&#39;   and EISPACK projects.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7920"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7921"></a><span class="s1">&#39;   It is based on the Los Alamos procedure MATLAB, and owes much to&#39;</span><span class="p">,&amp;</span>
<a name="ln-7922"></a><span class="s1">&#39;   Cleve Moler, Department of Computer Science, University of New Mexico.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7923"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7924"></a><span class="s1">&#39;                            CONTENTS&#39;</span><span class="p">,&amp;</span>
<a name="ln-7925"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7926"></a><span class="s1">&#39;          -  Elementary operations&#39;</span><span class="p">,&amp;</span>
<a name="ln-7927"></a><span class="s1">&#39;          -  LALA functions&#39;</span><span class="p">,&amp;</span>
<a name="ln-7928"></a><span class="s1">&#39;          -  Rows, columns and submatrices&#39;</span><span class="p">,&amp;</span>
<a name="ln-7929"></a><span class="s1">&#39;          -  &quot;for&quot;, &quot;while&quot; and &quot;if&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7930"></a><span class="s1">&#39;          -  Characters, text, files and macros&#39;</span><span class="p">,&amp;</span>
<a name="ln-7931"></a><span class="s1">&#39;          -  The numerical algorithms&#39;</span><span class="p">,&amp;</span>
<a name="ln-7932"></a><span class="s1">&#39;          -  &quot;flop&quot; and &quot;chop&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7933"></a><span class="s1">&#39;          -  Census example&#39;</span><span class="p">,&amp;</span>
<a name="ln-7934"></a><span class="s1">&#39;          -  Partial differential equation example&#39;</span><span class="p">,&amp;</span>
<a name="ln-7935"></a><span class="s1">&#39;          -  Eigenvalue sensitivity example&#39;</span><span class="p">,&amp;</span>
<a name="ln-7936"></a><span class="s1">&#39;          -  Communicating with other programs&#39;</span><span class="p">,&amp;</span>
<a name="ln-7937"></a><span class="s1">&#39;          -  Appendix  (The HELP file)&#39;</span><span class="p">,&amp;</span>
<a name="ln-7938"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7939"></a><span class="s1">&#39;   The capabilities range from standard tasks such as solving simultaneous&#39;</span><span class="p">,&amp;</span>
<a name="ln-7940"></a><span class="s1">&#39;   linear equations and inverting matrices, through symmetric and&#39;</span><span class="p">,&amp;</span>
<a name="ln-7941"></a><span class="s1">&#39;   nonsymmetric eigenvalue problems, to fairly sophisticated matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-7942"></a><span class="s1">&#39;   tools such as the singular value decomposition.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7943"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7944"></a><span class="s1">&#39;   LALA should be useful in applied linear algebra, as well as more&#39;</span><span class="p">,&amp;</span>
<a name="ln-7945"></a><span class="s1">&#39;   general numerical analysis, matrix theory, statistics and applications&#39;</span><span class="p">,&amp;</span>
<a name="ln-7946"></a><span class="s1">&#39;   of matrices to other disciplines.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7947"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7948"></a><span class="s1">&#39;   LALA can serve as a &quot;desk calculator&quot; for the quick solution of small&#39;</span><span class="p">,&amp;</span>
<a name="ln-7949"></a><span class="s1">&#39;   problems involving matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7950"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7951"></a><span class="s1">&#39;   The program is written in Fortran and is designed to be readily&#39;</span><span class="p">,&amp;</span>
<a name="ln-7952"></a><span class="s1">&#39;   installed under any operating system which permits interactive&#39;</span><span class="p">,&amp;</span>
<a name="ln-7953"></a><span class="s1">&#39;   execution of Fortran programs. The resources required are fairly&#39;</span><span class="p">,&amp;</span>
<a name="ln-7954"></a><span class="s1">&#39;   modest.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7955"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7956"></a><span class="s1">&#39;   The size of the matrices that can be handled in LALA depends upon the&#39;</span><span class="p">,&amp;</span>
<a name="ln-7957"></a><span class="s1">&#39;   amount of storage available on the supporting platform and the optional&#39;</span><span class="p">,&amp;</span>
<a name="ln-7958"></a><span class="s1">&#39;   word count that can be supplied on an initial call to LALA(3f).&#39;</span><span class="p">,&amp;</span>
<a name="ln-7959"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7960"></a><span class="s1">&#39;   In some ways, LALA resembles SPEAKEASY [4] and, to a lesser extent,&#39;</span><span class="p">,&amp;</span>
<a name="ln-7961"></a><span class="s1">&#39;   APL. All are interactive terminal languages that ordinarily accept&#39;</span><span class="p">,&amp;</span>
<a name="ln-7962"></a><span class="s1">&#39;   single-line commands or statements, process them immediately, and print&#39;</span><span class="p">,&amp;</span>
<a name="ln-7963"></a><span class="s1">&#39;   the results. All have arrays or matrices as principal data types. But&#39;</span><span class="p">,&amp;</span>
<a name="ln-7964"></a><span class="s1">&#39;   for LALA, the matrix is the only data type (although scalars, vectors&#39;</span><span class="p">,&amp;</span>
<a name="ln-7965"></a><span class="s1">&#39;   and text are special cases), the underlying system is portable and&#39;</span><span class="p">,&amp;</span>
<a name="ln-7966"></a><span class="s1">&#39;   requires fewer resources, and the supporting subroutines are more&#39;</span><span class="p">,&amp;</span>
<a name="ln-7967"></a><span class="s1">&#39;   powerful and in some cases, have better numerical properties.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7968"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7969"></a><span class="s1">&#39;   Together, LINPACK and EISPACK provide for powerful matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-7970"></a><span class="s1">&#39;   computation. EISPACK is a package of over 70 Fortran subroutines for&#39;</span><span class="p">,&amp;</span>
<a name="ln-7971"></a><span class="s1">&#39;   various matrix eigenvalue computations that are based for the most&#39;</span><span class="p">,&amp;</span>
<a name="ln-7972"></a><span class="s1">&#39;   part on Algol procedures published by Wilkinson, Reinsch and their&#39;</span><span class="p">,&amp;</span>
<a name="ln-7973"></a><span class="s1">&#39;   colleagues [5]. LINPACK is a package of 40 Fortran subroutines (in&#39;</span><span class="p">,&amp;</span>
<a name="ln-7974"></a><span class="s1">&#39;   each of four data types) for solving and analyzing simultaneous linear&#39;</span><span class="p">,&amp;</span>
<a name="ln-7975"></a><span class="s1">&#39;   equations and related matrix problems. Since LALA is not primarily&#39;</span><span class="p">,&amp;</span>
<a name="ln-7976"></a><span class="s1">&#39;   concerned with either execution time efficiency or storage savings,&#39;</span><span class="p">,&amp;</span>
<a name="ln-7977"></a><span class="s1">&#39;   it ignores most of the special matrix properties that LINPACK and&#39;</span><span class="p">,&amp;</span>
<a name="ln-7978"></a><span class="s1">&#39;   EISPACK subroutines use to advantage. Consequently, only 8 subroutines&#39;</span><span class="p">,&amp;</span>
<a name="ln-7979"></a><span class="s1">&#39;   from LINPACK and 5 from EISPACK are actually involved.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7980"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7981"></a><span class="s1">&#39;   In more advanced applications, LALA can be used in conjunction with&#39;</span><span class="p">,&amp;</span>
<a name="ln-7982"></a><span class="s1">&#39;   other programs in several ways. It is possible to define new LALA&#39;</span><span class="p">,&amp;</span>
<a name="ln-7983"></a><span class="s1">&#39;   functions and add them to the system.  it is possible to use the local&#39;</span><span class="p">,&amp;</span>
<a name="ln-7984"></a><span class="s1">&#39;   file system to pass matrices between LALA and other programs. LALA&#39;</span><span class="p">,&amp;</span>
<a name="ln-7985"></a><span class="s1">&#39;   command and statement input can be obtained from a local file instead&#39;</span><span class="p">,&amp;</span>
<a name="ln-7986"></a><span class="s1">&#39;   of from the terminal. The most power and flexibility is obtained by&#39;</span><span class="p">,&amp;</span>
<a name="ln-7987"></a><span class="s1">&#39;   using LALA as a subroutine which is called by other programs.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7988"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7989"></a><span class="s1">&#39;   This document first gives an overview of LALA from the user&#39;&#39;s&#39;</span><span class="p">,&amp;</span>
<a name="ln-7990"></a><span class="s1">&#39;   point of view. Several extended examples involving data fitting,&#39;</span><span class="p">,&amp;</span>
<a name="ln-7991"></a><span class="s1">&#39;   partial differential equations, eigenvalue sensitivity and other&#39;</span><span class="p">,&amp;</span>
<a name="ln-7992"></a><span class="s1">&#39;   topics are included.  The system was designed and programmed using&#39;</span><span class="p">,&amp;</span>
<a name="ln-7993"></a><span class="s1">&#39;   techniques described by Wirth [6], implemented in nonrecursive,&#39;</span><span class="p">,&amp;</span>
<a name="ln-7994"></a><span class="s1">&#39;   portable Fortran. There is a brief discussion of some of the matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-7995"></a><span class="s1">&#39;   algorithms and of their numerical properties. A final section describes&#39;</span><span class="p">,&amp;</span>
<a name="ln-7996"></a><span class="s1">&#39;   how LALA can be used with other programs. The appendix includes the&#39;</span><span class="p">,&amp;</span>
<a name="ln-7997"></a><span class="s1">&#39;   HELP documentation available on-line.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7998"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-7999"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8000"></a><span class="s1">&#39;ELEMENTARY OPERATIONS&#39;</span><span class="p">,&amp;</span>
<a name="ln-8001"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8002"></a><span class="s1">&#39;   LALA works with essentially only one kind of object, a rectangular&#39;</span><span class="p">,&amp;</span>
<a name="ln-8003"></a><span class="s1">&#39;   matrix with complex elements. If the imaginary parts of the elements&#39;</span><span class="p">,&amp;</span>
<a name="ln-8004"></a><span class="s1">&#39;   are all zero, they are not printed, but they still occupy storage. In&#39;</span><span class="p">,&amp;</span>
<a name="ln-8005"></a><span class="s1">&#39;   some situations, special meaning is attached to 1 by 1 matrices,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8006"></a><span class="s1">&#39;   that is scalars, and to 1 by n and m by 1 matrices, that is row and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8007"></a><span class="s1">&#39;   column vectors.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8008"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8009"></a><span class="s1">&#39;   Matrices can be introduced into LALA in four different&#39;</span><span class="p">,&amp;</span>
<a name="ln-8010"></a><span class="s1">&#39;   ways:&#39;</span><span class="p">,&amp;</span>
<a name="ln-8011"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8012"></a><span class="s1">&#39;           --  Explicit list of elements,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8013"></a><span class="s1">&#39;           --  Use of &quot;for&quot; and &quot;while&quot; statements,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8014"></a><span class="s1">&#39;           --  Read from an external file,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8015"></a><span class="s1">&#39;           --  Execute an external Fortran program.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8016"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8017"></a><span class="s1">&#39;   The explicit list is surrounded by angle brackets, &#39;&#39;&lt;&#39;&#39; and &#39;&#39;&gt;&#39;&#39; or&#39;</span><span class="p">,&amp;</span>
<a name="ln-8018"></a><span class="s1">&#39;   braces &#39;&#39;[&#39;&#39; and &#39;&#39;]&#39;&#39;, and uses the semicolon &#39;&#39;;&#39;&#39; to indicate the ends&#39;</span><span class="p">,&amp;</span>
<a name="ln-8019"></a><span class="s1">&#39;   of the rows. For example, the input line&#39;</span><span class="p">,&amp;</span>
<a name="ln-8020"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8021"></a><span class="s1">&#39;      A = &lt;1 2 3; 4 5 6; 7 8 9&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8022"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8023"></a><span class="s1">&#39;   will result in the output&#39;</span><span class="p">,&amp;</span>
<a name="ln-8024"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8025"></a><span class="s1">&#39;      A     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8026"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8027"></a><span class="s1">&#39;          1.    2.   3.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8028"></a><span class="s1">&#39;          4.    5.   6.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8029"></a><span class="s1">&#39;          7.    8.   9.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8030"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8031"></a><span class="s1">&#39;   The matrix A will be saved for later use. The individual elements&#39;</span><span class="p">,&amp;</span>
<a name="ln-8032"></a><span class="s1">&#39;   are separated by commas or blanks and can be any LALA expressions,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8033"></a><span class="s1">&#39;   for example&#39;</span><span class="p">,&amp;</span>
<a name="ln-8034"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8035"></a><span class="s1">&#39;      x = &lt; -1.3, 4/5, 4*atan(1) &gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8036"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8037"></a><span class="s1">&#39;   results in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8038"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8039"></a><span class="s1">&#39;      x     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8040"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8041"></a><span class="s1">&#39;        -1.3000   0.8000   3.1416&#39;</span><span class="p">,&amp;</span>
<a name="ln-8042"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8043"></a><span class="s1">&#39;   The elementary functions available include sqrt, log, exp, sin, cos,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8044"></a><span class="s1">&#39;   atan, abs, round, real, imag, and conjg.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8045"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8046"></a><span class="s1">&#39;   Large matrices can be spread across several input lines, with the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8047"></a><span class="s1">&#39;   carriage returns replacing the semicolons. The above matrix could&#39;</span><span class="p">,&amp;</span>
<a name="ln-8048"></a><span class="s1">&#39;   also have been produced by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8049"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8050"></a><span class="s1">&#39;      A = &lt; 1 2 3&#39;</span><span class="p">,&amp;</span>
<a name="ln-8051"></a><span class="s1">&#39;            4 5 6&#39;</span><span class="p">,&amp;</span>
<a name="ln-8052"></a><span class="s1">&#39;            7 8 9 &gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8053"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8054"></a><span class="s1">&#39;   Matrices can be input from the local file system. Say a file named&#39;</span><span class="p">,&amp;</span>
<a name="ln-8055"></a><span class="s1">&#39;   &#39;&#39;xyz&#39;&#39; contains five lines of text,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8056"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8057"></a><span class="s1">&#39;      A = &lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8058"></a><span class="s1">&#39;      1 2 3&#39;</span><span class="p">,&amp;</span>
<a name="ln-8059"></a><span class="s1">&#39;      4 5 6&#39;</span><span class="p">,&amp;</span>
<a name="ln-8060"></a><span class="s1">&#39;      7 8 9&#39;</span><span class="p">,&amp;</span>
<a name="ln-8061"></a><span class="s1">&#39;      &gt;;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8062"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8063"></a><span class="s1">&#39;   then the LALA statement exec(&#39;&#39;xyz&#39;&#39;) reads the matrix and assigns it&#39;</span><span class="p">,&amp;</span>
<a name="ln-8064"></a><span class="s1">&#39;   to A .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8065"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8066"></a><span class="s1">&#39;   The &quot;for&quot; statement allows the generation of matrices whose elements&#39;</span><span class="p">,&amp;</span>
<a name="ln-8067"></a><span class="s1">&#39;   are given by simple formulas. Our example matrix A could also have&#39;</span><span class="p">,&amp;</span>
<a name="ln-8068"></a><span class="s1">&#39;   been produced by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8069"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8070"></a><span class="s1">&#39;      for i = 1:3, for j = 1:3, A(i,j) = 3*(i-1)+j;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8071"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8072"></a><span class="s1">&#39;   The semicolon at the end of the line suppresses the printing, which&#39;</span><span class="p">,&amp;</span>
<a name="ln-8073"></a><span class="s1">&#39;   in this case would have been nine versions of A with changing elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8074"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8075"></a><span class="s1">&#39;   Several statements may be given on a line, separated by semicolons&#39;</span><span class="p">,&amp;</span>
<a name="ln-8076"></a><span class="s1">&#39;   or commas.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8077"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8078"></a><span class="s1">&#39;   Two consecutive periods anywhere on a line indicate continuation. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-8079"></a><span class="s1">&#39;   periods and any following characters are deleted, then another line&#39;</span><span class="p">,&amp;</span>
<a name="ln-8080"></a><span class="s1">&#39;   is input and concatenated onto the previous line.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8081"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8082"></a><span class="s1">&#39;   Two consecutive slashes anywhere on a line cause the remainder of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8083"></a><span class="s1">&#39;   the line to be ignored. This is useful for inserting comments.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8084"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8085"></a><span class="s1">&#39;   Names of variables are formed by a letter, followed by any of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8086"></a><span class="s1">&#39;   letters, digits and underscores, up to 63 characters in length.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8087"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8088"></a><span class="s1">&#39;   The special character prime (&#39;&#39;) is used to denote the transpose of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8089"></a><span class="s1">&#39;   a matrix, so&#39;</span><span class="p">,&amp;</span>
<a name="ln-8090"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8091"></a><span class="s1">&#39;      X = X&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8092"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8093"></a><span class="s1">&#39;   changes the row vector above into the column vector&#39;</span><span class="p">,&amp;</span>
<a name="ln-8094"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8095"></a><span class="s1">&#39;      X     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8096"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8097"></a><span class="s1">&#39;        -1.3000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8098"></a><span class="s1">&#39;         0.8000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8099"></a><span class="s1">&#39;         3.1416&#39;</span><span class="p">,&amp;</span>
<a name="ln-8100"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8101"></a><span class="s1">&#39;   Individual matrix elements may be referenced by enclosing their&#39;</span><span class="p">,&amp;</span>
<a name="ln-8102"></a><span class="s1">&#39;   subscripts in parentheses. When any element is changed, the entire&#39;</span><span class="p">,&amp;</span>
<a name="ln-8103"></a><span class="s1">&#39;   matrix is reprinted. For example, using the above matrix,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8104"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8105"></a><span class="s1">&#39;      B(3,3) = B(1,3) + B(3,1)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8106"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8107"></a><span class="s1">&#39;   results in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8108"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8109"></a><span class="s1">&#39;      B     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8110"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8111"></a><span class="s1">&#39;          1.    2.    3.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8112"></a><span class="s1">&#39;          4.    5.    6.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8113"></a><span class="s1">&#39;          7.    8.   10.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8114"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8115"></a><span class="s1">&#39;   Addition, subtraction and multiplication of matrices are denoted by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8116"></a><span class="s1">&#39;   +, -, and * . The operations are performed whenever the matrices&#39;</span><span class="p">,&amp;</span>
<a name="ln-8117"></a><span class="s1">&#39;   have the proper dimensions. For example, with the above A and x,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8118"></a><span class="s1">&#39;   the expressions A + X and X*A are incorrect because A is 3 by 3 and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8119"></a><span class="s1">&#39;   X is now 3 by 1. However,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8120"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8121"></a><span class="s1">&#39;      B = A*B&#39;</span><span class="p">,&amp;</span>
<a name="ln-8122"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8123"></a><span class="s1">&#39;   is correct and results in the output&#39;</span><span class="p">,&amp;</span>
<a name="ln-8124"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8125"></a><span class="s1">&#39;      B     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8126"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8127"></a><span class="s1">&#39;         9.7248&#39;</span><span class="p">,&amp;</span>
<a name="ln-8128"></a><span class="s1">&#39;        17.6496&#39;</span><span class="p">,&amp;</span>
<a name="ln-8129"></a><span class="s1">&#39;        28.7159&#39;</span><span class="p">,&amp;</span>
<a name="ln-8130"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8131"></a><span class="s1">&#39;   Note that both upper and lower case letters are allowed for input&#39;</span><span class="p">,&amp;</span>
<a name="ln-8132"></a><span class="s1">&#39;   (on those systems which have both).&#39;</span><span class="p">,&amp;</span>
<a name="ln-8133"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8134"></a><span class="s1">&#39;   There are two &quot;matrix division&quot; symbols in LALA, \ and / .  If A and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8135"></a><span class="s1">&#39;   B are matrices, then A\B and B/A correspond formally to left and right&#39;</span><span class="p">,&amp;</span>
<a name="ln-8136"></a><span class="s1">&#39;   multiplication of B by the inverse of A, that is inv(A)*B and B*inv(A),&#39;</span><span class="p">,&amp;</span>
<a name="ln-8137"></a><span class="s1">&#39;   but the result is obtained directly without the computation of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8138"></a><span class="s1">&#39;   inverse. In the scalar case, 3\1 and 1/3 have the same value, namely&#39;</span><span class="p">,&amp;</span>
<a name="ln-8139"></a><span class="s1">&#39;   one-third. In general, A\B denotes the solution X to the equation A*X =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8140"></a><span class="s1">&#39;   B and B/A denotes the solution to X*A = B.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8141"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8142"></a><span class="s1">&#39;   Left division, A\B, is defined whenever B has as many rows as A. If A&#39;</span><span class="p">,&amp;</span>
<a name="ln-8143"></a><span class="s1">&#39;   is square, it is factored using Gaussian elimination. The factors are&#39;</span><span class="p">,&amp;</span>
<a name="ln-8144"></a><span class="s1">&#39;   used to solve the equations A*X(:,j) = B(:,j) where B(:,j) denotes the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8145"></a><span class="s1">&#39;   j-th column of B. The result is a matrix X with the same dimensions&#39;</span><span class="p">,&amp;</span>
<a name="ln-8146"></a><span class="s1">&#39;   as B. If A is nearly singular (according to the LINPACK condition&#39;</span><span class="p">,&amp;</span>
<a name="ln-8147"></a><span class="s1">&#39;   estimator, RCOND(3f)), a warning message is printed. If A is not&#39;</span><span class="p">,&amp;</span>
<a name="ln-8148"></a><span class="s1">&#39;   square, it is factored using Householder orthogonalization with column&#39;</span><span class="p">,&amp;</span>
<a name="ln-8149"></a><span class="s1">&#39;   pivoting. The factors are used to solve the under- or overdetermined&#39;</span><span class="p">,&amp;</span>
<a name="ln-8150"></a><span class="s1">&#39;   equations in a least squares sense. The result is an M by N matrix X&#39;</span><span class="p">,&amp;</span>
<a name="ln-8151"></a><span class="s1">&#39;   where M is the number of columns of A and N is the number of columns&#39;</span><span class="p">,&amp;</span>
<a name="ln-8152"></a><span class="s1">&#39;   of B . Each column of X has at most K nonzero components, where K is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8153"></a><span class="s1">&#39;   the effective rank of A .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8154"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8155"></a><span class="s1">&#39;   Right division, B/A, can be defined in terms of left division by B/A =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8156"></a><span class="s1">&#39;   (A&#39;&#39;\B&#39;&#39;)&#39;&#39;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8157"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8158"></a><span class="s1">&#39;   For example, since our vector b was computed as A*X, the statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8159"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8160"></a><span class="s1">&#39;      Y = A\B&#39;</span><span class="p">,&amp;</span>
<a name="ln-8161"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8162"></a><span class="s1">&#39;   results in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8163"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8164"></a><span class="s1">&#39;      Y     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8165"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8166"></a><span class="s1">&#39;        -1.3000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8167"></a><span class="s1">&#39;         0.8000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8168"></a><span class="s1">&#39;         3.1416&#39;</span><span class="p">,&amp;</span>
<a name="ln-8169"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8170"></a><span class="s1">&#39;   Of course, Y is not exactly equal to X because of the roundoff errors&#39;</span><span class="p">,&amp;</span>
<a name="ln-8171"></a><span class="s1">&#39;   involved in both A*X and A\B , but we are not printing enough digits&#39;</span><span class="p">,&amp;</span>
<a name="ln-8172"></a><span class="s1">&#39;   to see the difference. The result of the statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8173"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8174"></a><span class="s1">&#39;      E = X - Y&#39;</span><span class="p">,&amp;</span>
<a name="ln-8175"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8176"></a><span class="s1">&#39;   depends upon the particular computer being used. In one case it&#39;</span><span class="p">,&amp;</span>
<a name="ln-8177"></a><span class="s1">&#39;   produces&#39;</span><span class="p">,&amp;</span>
<a name="ln-8178"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8179"></a><span class="s1">&#39;      E     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8180"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8181"></a><span class="s1">&#39;         1.0e-15 *&#39;</span><span class="p">,&amp;</span>
<a name="ln-8182"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8183"></a><span class="s1">&#39;           .3053&#39;</span><span class="p">,&amp;</span>
<a name="ln-8184"></a><span class="s1">&#39;          -.2498&#39;</span><span class="p">,&amp;</span>
<a name="ln-8185"></a><span class="s1">&#39;           .0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8186"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8187"></a><span class="s1">&#39;   The quantity 1.0e-15 is a scale factor which multiplies all the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8188"></a><span class="s1">&#39;   components which follow. Thus our vectors X and Y actually&#39;</span><span class="p">,&amp;</span>
<a name="ln-8189"></a><span class="s1">&#39;   agree to about 15 decimal places on this computer.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8190"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8191"></a><span class="s1">&#39;   It is also possible to obtain element-by-element&#39;</span><span class="p">,&amp;</span>
<a name="ln-8192"></a><span class="s1">&#39;   multiplicative operations. If A and B have the same dimensions,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8193"></a><span class="s1">&#39;   then A .* B denotes the matrix whose elements are simply the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8194"></a><span class="s1">&#39;   products of the individual elements of A and B . The expressions&#39;</span><span class="p">,&amp;</span>
<a name="ln-8195"></a><span class="s1">&#39;   A ./ B and A .\ B give the quotients of the individual elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8196"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8197"></a><span class="s1">&#39;   There are several possible output formats. The statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8198"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8199"></a><span class="s1">&#39;      long, X&#39;</span><span class="p">,&amp;</span>
<a name="ln-8200"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8201"></a><span class="s1">&#39;   results in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8202"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8203"></a><span class="s1">&#39;      X     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8204"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8205"></a><span class="s1">&#39;         -1.300000000000000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8206"></a><span class="s1">&#39;           .800000000000000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8207"></a><span class="s1">&#39;          3.141592653589793&#39;</span><span class="p">,&amp;</span>
<a name="ln-8208"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8209"></a><span class="s1">&#39;   The statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8210"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8211"></a><span class="s1">&#39;      short&#39;</span><span class="p">,&amp;</span>
<a name="ln-8212"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8213"></a><span class="s1">&#39;   restores the original format.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8214"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8215"></a><span class="s1">&#39;   The expression A**p means A to the p-th power. It is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8216"></a><span class="s1">&#39;   defined if A is a square matrix and p is a scalar. If p is an&#39;</span><span class="p">,&amp;</span>
<a name="ln-8217"></a><span class="s1">&#39;   integer greater than one, the power is computed by repeated&#39;</span><span class="p">,&amp;</span>
<a name="ln-8218"></a><span class="s1">&#39;   multiplication. For other values of p the calculation involves&#39;</span><span class="p">,&amp;</span>
<a name="ln-8219"></a><span class="s1">&#39;   the eigenvalues and eigenvectors of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8220"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8221"></a><span class="s1">&#39;   Previously defined matrices and matrix expressions can be&#39;</span><span class="p">,&amp;</span>
<a name="ln-8222"></a><span class="s1">&#39;   used inside brackets to generate larger matrices, for example&#39;</span><span class="p">,&amp;</span>
<a name="ln-8223"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8224"></a><span class="s1">&#39;      C = &lt;A, B; &lt;4 2 0&gt;*X, X&#39;&#39;&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8225"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8226"></a><span class="s1">&#39;   results in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8227"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8228"></a><span class="s1">&#39;      C     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8229"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8230"></a><span class="s1">&#39;         1.0000   2.0000   3.0000   9.7248&#39;</span><span class="p">,&amp;</span>
<a name="ln-8231"></a><span class="s1">&#39;         4.0000   5.0000   6.0000  17.6496&#39;</span><span class="p">,&amp;</span>
<a name="ln-8232"></a><span class="s1">&#39;         7.0000   8.0000  10.0000  28.7159&#39;</span><span class="p">,&amp;</span>
<a name="ln-8233"></a><span class="s1">&#39;        -3.6000  -1.3000   0.8000   3.1416&#39;</span><span class="p">,&amp;</span>
<a name="ln-8234"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8235"></a><span class="s1">&#39;   There are four predefined variables, &quot;eps&quot;, &quot;flop&quot;, &quot;rand&quot; and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8236"></a><span class="s1">&#39;   &quot;eye&quot;. The variable &quot;eps&quot; is used as a tolerance is determining such&#39;</span><span class="p">,&amp;</span>
<a name="ln-8237"></a><span class="s1">&#39;   things as near singularity and rank. Its initial value is the distance&#39;</span><span class="p">,&amp;</span>
<a name="ln-8238"></a><span class="s1">&#39;   from 1.0 to the next largest floating point number on the particular&#39;</span><span class="p">,&amp;</span>
<a name="ln-8239"></a><span class="s1">&#39;   computer being used. The user may reset this to any other value,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8240"></a><span class="s1">&#39;   including zero. &quot;eps&quot; is changed by &quot;chop&quot;, which is described later&#39;</span><span class="p">,&amp;</span>
<a name="ln-8241"></a><span class="s1">&#39;   in this manual.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8242"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8243"></a><span class="s1">&#39;   The value of &quot;rand&quot; is a random variable, with a choice of a uniform&#39;</span><span class="p">,&amp;</span>
<a name="ln-8244"></a><span class="s1">&#39;   or a normal distribution.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8245"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8246"></a><span class="s1">&#39;   The name &quot;eye&quot; is used in place of &quot;i&quot; to denote identity matrices&#39;</span><span class="p">,&amp;</span>
<a name="ln-8247"></a><span class="s1">&#39;   because &quot;i&quot; is often used as a subscript or as sqrt(-1).  The dimensions&#39;</span><span class="p">,&amp;</span>
<a name="ln-8248"></a><span class="s1">&#39;   of &quot;eye&quot; are determined by context. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8249"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8250"></a><span class="s1">&#39;      B = A + 3*eye&#39;</span><span class="p">,&amp;</span>
<a name="ln-8251"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8252"></a><span class="s1">&#39;   adds 3 to the diagonal elements of A and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8253"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8254"></a><span class="s1">&#39;      X = eye/A&#39;</span><span class="p">,&amp;</span>
<a name="ln-8255"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8256"></a><span class="s1">&#39;   is one of several ways in LALA to invert a matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8257"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8258"></a><span class="s1">&#39;   &quot;flop&quot; provides a measure of the number of floating point operations,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8259"></a><span class="s1">&#39;   or &quot;flops&quot;, required for each calculation by reporting the CPU time&#39;</span><span class="p">,&amp;</span>
<a name="ln-8260"></a><span class="s1">&#39;   consumed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8261"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8262"></a><span class="s1">&#39;   A statement may consist of an expression alone, in which case a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8263"></a><span class="s1">&#39;   variable named &quot;ans&quot; is created and the result stored in &quot;ans&quot; for&#39;</span><span class="p">,&amp;</span>
<a name="ln-8264"></a><span class="s1">&#39;   possible future use. Thus&#39;</span><span class="p">,&amp;</span>
<a name="ln-8265"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8266"></a><span class="s1">&#39;      A\A - eye&#39;</span><span class="p">,&amp;</span>
<a name="ln-8267"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8268"></a><span class="s1">&#39;   is the same as&#39;</span><span class="p">,&amp;</span>
<a name="ln-8269"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8270"></a><span class="s1">&#39;      ans = A\A - eye&#39;</span><span class="p">,&amp;</span>
<a name="ln-8271"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8272"></a><span class="s1">&#39;   (Roundoff error usually causes this result to be a matrix of &quot;small&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8273"></a><span class="s1">&#39;   numbers, rather than all zeros.)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8274"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8275"></a><span class="s1">&#39;   All computations are done using double precision real arithmetic. There&#39;</span><span class="p">,&amp;</span>
<a name="ln-8276"></a><span class="s1">&#39;   is no mixed-precision arithmetic.  The Fortran COMPLEX data type&#39;</span><span class="p">,&amp;</span>
<a name="ln-8277"></a><span class="s1">&#39;   is not used because many systems create unnecessary underflows and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8278"></a><span class="s1">&#39;   overflows with complex operations.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8279"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8280"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8281"></a><span class="s1">&#39;FUNCTIONS&#39;</span><span class="p">,&amp;</span>
<a name="ln-8282"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8283"></a><span class="s1">&#39;   Much of LALA&#39;&#39;s computational power comes from the various&#39;</span><span class="p">,&amp;</span>
<a name="ln-8284"></a><span class="s1">&#39;   matrix functions available. The current list includes:&#39;</span><span class="p">,&amp;</span>
<a name="ln-8285"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8286"></a><span class="s1">&#39;      inv(A)          - Inverse.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8287"></a><span class="s1">&#39;      det(A)          - Determinant.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8288"></a><span class="s1">&#39;      cond(A)         - Condition number.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8289"></a><span class="s1">&#39;      rcond(A)        - A measure of nearness to singularity.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8290"></a><span class="s1">&#39;      eig(A)          - Eigenvalues and eigenvectors.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8291"></a><span class="s1">&#39;      schur(A)        - Schur triangular form.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8292"></a><span class="s1">&#39;      hess(A)         - Hessenberg or tridiagonal form.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8293"></a><span class="s1">&#39;      poly(A)         - Characteristic polynomial.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8294"></a><span class="s1">&#39;      svd(A)          - Singular value decomposition.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8295"></a><span class="s1">&#39;      pinv(A,eps)     - Pseudo-inverse with optional tolerance.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8296"></a><span class="s1">&#39;      rank(A,eps)     - Matrix rank with optional tolerance.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8297"></a><span class="s1">&#39;      lu(A)           - Factors from Gaussian elimination.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8298"></a><span class="s1">&#39;      chol(A)         - Factor from Cholesky factorization.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8299"></a><span class="s1">&#39;      qr(A)           - Factors from Householder orthogonalization.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8300"></a><span class="s1">&#39;      rref(A)         - Reduced row echelon form.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8301"></a><span class="s1">&#39;      orth(A)         - Orthogonal vectors spanning range of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8302"></a><span class="s1">&#39;      exp(A)          - e to the A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8303"></a><span class="s1">&#39;      log(A)          - Natural logarithm.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8304"></a><span class="s1">&#39;      sqrt(A)         - Square root.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8305"></a><span class="s1">&#39;      sin(A)          - Trigonometric sine.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8306"></a><span class="s1">&#39;      cos(A)          - Cosine.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8307"></a><span class="s1">&#39;      atan(A)         - Arctangent.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8308"></a><span class="s1">&#39;      round(A)        - Round the elements to nearest integers.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8309"></a><span class="s1">&#39;      abs(A)          - Absolute value of the elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8310"></a><span class="s1">&#39;      real(A)         - Real parts of the elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8311"></a><span class="s1">&#39;      imag(A)         - Imaginary parts of the elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8312"></a><span class="s1">&#39;      conjg(A)        - Complex conjugate.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8313"></a><span class="s1">&#39;      sum(A)          - Sum of the elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8314"></a><span class="s1">&#39;      prod(A)         - Product of the elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8315"></a><span class="s1">&#39;      diag(A)         - Extract or create diagonal matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8316"></a><span class="s1">&#39;      tril(A)         - Lower triangular part of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8317"></a><span class="s1">&#39;      triu(A)         - Upper triangular part of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8318"></a><span class="s1">&#39;      norm(A,p)       - Norm with p = 1, 2 or &#39;&#39;Infinity&#39;&#39;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8319"></a><span class="s1">&#39;      eye(m,n)        - Portion of identity matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8320"></a><span class="s1">&#39;      rand(m,n)       - Matrix with random elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8321"></a><span class="s1">&#39;      ones(m,n)       - Matrix of all ones.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8322"></a><span class="s1">&#39;      magic(n)        - Interesting test matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8323"></a><span class="s1">&#39;      invh(n)         - Inverse Hilbert matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8324"></a><span class="s1">&#39;      roots(C)        - Roots of polynomial with coefficients C.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8325"></a><span class="s1">&#39;      display(A,p)    - Print base p representation of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8326"></a><span class="s1">&#39;      kron(A,B)       - Kronecker tensor product of A and B.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8327"></a><span class="s1">&#39;      plot(X,Y)       - Plot Y as a function of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8328"></a><span class="s1">&#39;      rat(A)          - Find &quot;simple&quot; rational approximation to A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8329"></a><span class="s1">&#39;      user(A)         - Function defined by external program.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8330"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8331"></a><span class="s1">&#39;   Some of these functions have different interpretations when the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8332"></a><span class="s1">&#39;   argument is a matrix or a vector and some of them have additional&#39;</span><span class="p">,&amp;</span>
<a name="ln-8333"></a><span class="s1">&#39;   optional arguments. Details are given in the HELP document in the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8334"></a><span class="s1">&#39;   appendix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8335"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8336"></a><span class="s1">&#39;   Several of these functions can be used in a generalized assignment&#39;</span><span class="p">,&amp;</span>
<a name="ln-8337"></a><span class="s1">&#39;   statement with two or three variables on the left hand side. For&#39;</span><span class="p">,&amp;</span>
<a name="ln-8338"></a><span class="s1">&#39;   example&#39;</span><span class="p">,&amp;</span>
<a name="ln-8339"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8340"></a><span class="s1">&#39;      &lt;X,D&gt; = eig(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8341"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8342"></a><span class="s1">&#39;   stores the eigenvectors of A in the matrix X and a diagonal matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-8343"></a><span class="s1">&#39;   containing the eigenvalues in the matrix D. The statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8344"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8345"></a><span class="s1">&#39;      eig(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8346"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8347"></a><span class="s1">&#39;   simply computes the eigenvalues and stores them in &quot;ans&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8348"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8349"></a><span class="s1">&#39;   Future versions of LALA will probably include additional functions,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8350"></a><span class="s1">&#39;   since they can easily be added to the system.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8351"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8352"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8353"></a><span class="s1">&#39;ROWS COLUMNS AND SUBMATRICES&#39;</span><span class="p">,&amp;</span>
<a name="ln-8354"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8355"></a><span class="s1">&#39;   Individual elements of a matrix can be accessed by giving their&#39;</span><span class="p">,&amp;</span>
<a name="ln-8356"></a><span class="s1">&#39;   subscripts in parentheses, eg. A(1,2), x(i), TAB(ind(k)+1).&#39;</span><span class="p">,&amp;</span>
<a name="ln-8357"></a><span class="s1">&#39;   An expression used as a subscript is rounded to the nearest integer.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8358"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8359"></a><span class="s1">&#39;   Individual rows and columns can be accessed using a colon &#39;&#39;:&#39;&#39; (or a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8360"></a><span class="s1">&#39;   &#39;&#39;|&#39;&#39;) for the free subscript. For example, A(1,:) is the first row of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8361"></a><span class="s1">&#39;   A and A(:,j) is the j-th column. Thus&#39;</span><span class="p">,&amp;</span>
<a name="ln-8362"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8363"></a><span class="s1">&#39;      A(i,:) = A(i,:) + c*A(k,:)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8364"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8365"></a><span class="s1">&#39;   adds c times the k-th row of A to the i-th row.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8366"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8367"></a><span class="s1">&#39;   The colon is used in several other ways in LALA, but all of the uses&#39;</span><span class="p">,&amp;</span>
<a name="ln-8368"></a><span class="s1">&#39;   are based on the following definition.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8369"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8370"></a><span class="s1">&#39;      j:k    is the same as  &lt;j, j+1, ..., k&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8371"></a><span class="s1">&#39;      j:k    is empty if  j &gt; k .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8372"></a><span class="s1">&#39;      j:i:k  is the same as  &lt;j, j+i, j+2i, ..., k&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8373"></a><span class="s1">&#39;      j:i:k  is empty if  i &gt; 0 and j &gt; k or if i &lt; 0 and j &lt; k .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8374"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8375"></a><span class="s1">&#39;   The colon is usually used with integers, but it is possible to&#39;</span><span class="p">,&amp;</span>
<a name="ln-8376"></a><span class="s1">&#39;   use arbitrary real scalars as well. Thus&#39;</span><span class="p">,&amp;</span>
<a name="ln-8377"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8378"></a><span class="s1">&#39;      1:4  is the same as  &lt;1, 2, 3, 4&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8379"></a><span class="s1">&#39;      0: 0.1: 0.5 is the same as &lt;0.0, 0.1, 0.2, 0.3, 0.4, 0.5&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8380"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8381"></a><span class="s1">&#39;   In general, a subscript can be a vector. If X and V are vectors,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8382"></a><span class="s1">&#39;   then X(V) is &lt;X(V(1)), X(V(2)), ..., X(V(n))&gt; . This can also be&#39;</span><span class="p">,&amp;</span>
<a name="ln-8383"></a><span class="s1">&#39;   used with matrices. If V has m components and W has n components,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8384"></a><span class="s1">&#39;   then A(V,W) is the m by n matrix formed from the elements of A whose&#39;</span><span class="p">,&amp;</span>
<a name="ln-8385"></a><span class="s1">&#39;   subscripts are the elements of V and W.  Combinations of the colon&#39;</span><span class="p">,&amp;</span>
<a name="ln-8386"></a><span class="s1">&#39;   notation and the indirect subscripting allow manipulation of various&#39;</span><span class="p">,&amp;</span>
<a name="ln-8387"></a><span class="s1">&#39;   submatrices. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8388"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8389"></a><span class="s1">&#39;      A(&lt;1,5&gt;,:) = A(&lt;5,1&gt;,:)  interchanges rows 1 and 5 of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8390"></a><span class="s1">&#39;      A(2:k,1:n)  is the submatrix formed from rows 2 through k&#39;</span><span class="p">,&amp;</span>
<a name="ln-8391"></a><span class="s1">&#39;         and columns 1 through n of A .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8392"></a><span class="s1">&#39;      A(:,&lt;3 1 2&gt;)  is a permutation of the first three columns.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8393"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8394"></a><span class="s1">&#39;   The notation A(:) has a special meaning. On the right hand side of an&#39;</span><span class="p">,&amp;</span>
<a name="ln-8395"></a><span class="s1">&#39;   assignment statement, it denotes all the elements of A, regarded as&#39;</span><span class="p">,&amp;</span>
<a name="ln-8396"></a><span class="s1">&#39;   a single column. When an expression is assigned to A(:), the current&#39;</span><span class="p">,&amp;</span>
<a name="ln-8397"></a><span class="s1">&#39;   dimensions of A, rather than of the expression, are used.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8398"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8399"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8400"></a><span class="s1">&#39;FOR WHILE AND IF&#39;</span><span class="p">,&amp;</span>
<a name="ln-8401"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8402"></a><span class="s1">&#39;   The &quot;for&quot; clause allows statements to be repeated a specific&#39;</span><span class="p">,&amp;</span>
<a name="ln-8403"></a><span class="s1">&#39;   number of times. The general form is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8404"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8405"></a><span class="s1">&#39;      for variable = expr, statement, ..., statement, end&#39;</span><span class="p">,&amp;</span>
<a name="ln-8406"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8407"></a><span class="s1">&#39;   The &quot;end&quot; and the comma before it may be omitted. In general, the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8408"></a><span class="s1">&#39;   expression may be a matrix, in which case the columns are stored one&#39;</span><span class="p">,&amp;</span>
<a name="ln-8409"></a><span class="s1">&#39;   at a time in the variable and the following statements, up to the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8410"></a><span class="s1">&#39;   &quot;end&quot; or the end of the line, are executed. The expression is often&#39;</span><span class="p">,&amp;</span>
<a name="ln-8411"></a><span class="s1">&#39;   of the form j:k, and its &quot;columns&quot; are simply the scalars from j to&#39;</span><span class="p">,&amp;</span>
<a name="ln-8412"></a><span class="s1">&#39;   k. Some examples (assume n has already been assigned a value):&#39;</span><span class="p">,&amp;</span>
<a name="ln-8413"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8414"></a><span class="s1">&#39;      for i = 1:n, for j = 1:n, A(i,j) = 1/(i+j-1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8415"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8416"></a><span class="s1">&#39;   generates the Hilbert matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8417"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8418"></a><span class="s1">&#39;      for j = 2:n-1, for i = j:n-1, ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-8419"></a><span class="s1">&#39;         A(i,j) = 0; end; A(j,j) = j; end; A&#39;</span><span class="p">,&amp;</span>
<a name="ln-8420"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8421"></a><span class="s1">&#39;   changes all but the &quot;outer edge&quot; of the lower triangle and then&#39;</span><span class="p">,&amp;</span>
<a name="ln-8422"></a><span class="s1">&#39;   prints the final matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8423"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8424"></a><span class="s1">&#39;      for h = 1.0: -0.1: -1.0, (&lt;h, cos(pi*h)&gt;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8425"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8426"></a><span class="s1">&#39;   prints a table of cosines.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8427"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8428"></a><span class="s1">&#39;      &lt;X,D&gt; = eig(A); for v = X, v, A*v&#39;</span><span class="p">,&amp;</span>
<a name="ln-8429"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8430"></a><span class="s1">&#39;   displays eigenvectors, one at a time.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8431"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8432"></a><span class="s1">&#39;        The &quot;while&quot; clause allows statements to be repeated an&#39;</span><span class="p">,&amp;</span>
<a name="ln-8433"></a><span class="s1">&#39;   indefinite number of times. The general form is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8434"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8435"></a><span class="s1">&#39;      while expr relop expr,   statement,..., statement, end&#39;</span><span class="p">,&amp;</span>
<a name="ln-8436"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8437"></a><span class="s1">&#39;   where relop is =, &lt;, &gt;, &lt;=, &gt;=, or &lt;&gt; (not equal). The statements are&#39;</span><span class="p">,&amp;</span>
<a name="ln-8438"></a><span class="s1">&#39;   repeatedly executed as long as the indicated comparison between the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8439"></a><span class="s1">&#39;   real parts of the first components of the two expressions is true. Here&#39;</span><span class="p">,&amp;</span>
<a name="ln-8440"></a><span class="s1">&#39;   are two examples. (Exercise for the reader: What do these segments do?)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8441"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8442"></a><span class="s1">&#39;      eps = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8443"></a><span class="s1">&#39;      while 1 + eps &gt; 1, eps = eps/2;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8444"></a><span class="s1">&#39;      eps = 2*eps&#39;</span><span class="p">,&amp;</span>
<a name="ln-8445"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8446"></a><span class="s1">&#39;      E = 0*A;  F = E + eye; n = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8447"></a><span class="s1">&#39;      while norm(E+F-E,1) &gt; 0, E = E + F; F = A*F/n; n = n + 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8448"></a><span class="s1">&#39;      E&#39;</span><span class="p">,&amp;</span>
<a name="ln-8449"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8450"></a><span class="s1">&#39;   The IF clause allows conditional execution of statements.  The general&#39;</span><span class="p">,&amp;</span>
<a name="ln-8451"></a><span class="s1">&#39;   form is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8452"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8453"></a><span class="s1">&#39;      if expr relop expr,  statement, ..., statement,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8454"></a><span class="s1">&#39;         else statement, ..., statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8455"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8456"></a><span class="s1">&#39;   The first group of statements are executed if the relation is true and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8457"></a><span class="s1">&#39;   the second group are executed if the relation is false.  The &quot;else&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8458"></a><span class="s1">&#39;   and the statements following it may be omitted. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8459"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8460"></a><span class="s1">&#39;      if abs(i-j) = 2, A(i,j) = 0;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8461"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8462"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8463"></a><span class="s1">&#39;CHARACTERS AND TEXTFILES AND MACROS&#39;</span><span class="p">,&amp;</span>
<a name="ln-8464"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8465"></a><span class="s1">&#39;   LALA has several commands which control the output format and the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8466"></a><span class="s1">&#39;   overall execution of the system.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8467"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8468"></a><span class="s1">&#39;   The &quot;help&quot; command allows on-line access to short portions of text&#39;</span><span class="p">,&amp;</span>
<a name="ln-8469"></a><span class="s1">&#39;   describing various operations, functions and special characters. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-8470"></a><span class="s1">&#39;   entire &quot;help&quot; document is reproduced in an appendix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8471"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8472"></a><span class="s1">&#39;   Results are usually printed in a scaled fixed point format that shows&#39;</span><span class="p">,&amp;</span>
<a name="ln-8473"></a><span class="s1">&#39;   4 or 5 significant figures. The commands &quot;short&quot;, &quot;long&quot;, &quot;short e&quot;,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8474"></a><span class="s1">&#39;   &quot;long e&quot; and &quot;long z&quot; alter the output format, but do not alter the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8475"></a><span class="s1">&#39;   precision of the computations or the internal storage.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8476"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8477"></a><span class="s1">&#39;   The &quot;who&quot; command provides information about the functions and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8478"></a><span class="s1">&#39;   variables that are currently defined.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8479"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8480"></a><span class="s1">&#39;   The &quot;clear&quot; command erases all variables, except &quot;eps&quot;, &quot;flop&quot;,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8481"></a><span class="s1">&#39;   &quot;rand&quot; and &quot;eye&quot;. The statement A = &lt;&gt; indicates that a &quot;0 by 0&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8482"></a><span class="s1">&#39;   matrix is to be stored in A. This causes A to be erased so that its&#39;</span><span class="p">,&amp;</span>
<a name="ln-8483"></a><span class="s1">&#39;   storage can be used for other variables.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8484"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8485"></a><span class="s1">&#39;   The &quot;quit&quot; and &quot;exit&quot; commands cause return to the underlying operating&#39;</span><span class="p">,&amp;</span>
<a name="ln-8486"></a><span class="s1">&#39;   system through the Fortran RETURN statement.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8487"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8488"></a><span class="s1">&#39;   LALA has a limited facility for handling text. Any string of characters&#39;</span><span class="p">,&amp;</span>
<a name="ln-8489"></a><span class="s1">&#39;   delineated by quotes (with two quotes used to allow one quote within&#39;</span><span class="p">,&amp;</span>
<a name="ln-8490"></a><span class="s1">&#39;   the string) is saved as a vector of integer values that are the ADE&#39;</span><span class="p">,&amp;</span>
<a name="ln-8491"></a><span class="s1">&#39;   (Ascii Decimal Equivalent) value of the character, with special&#39;</span><span class="p">,&amp;</span>
<a name="ln-8492"></a><span class="s1">&#39;   equivalencing of the characters {}[]&quot; into ()&lt;&gt;&#39;&#39; in expressions. It&#39;</span><span class="p">,&amp;</span>
<a name="ln-8493"></a><span class="s1">&#39;   is important to know you use those characters as part of an expression&#39;</span><span class="p">,&amp;</span>
<a name="ln-8494"></a><span class="s1">&#39;   or command without treating them as equivalent outside of strings.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8495"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8496"></a><span class="s1">&#39;   (The complete list is in the appendix under &quot;CHAR&quot;.) For example&#39;</span><span class="p">,&amp;</span>
<a name="ln-8497"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8498"></a><span class="s1">&#39;      &#39;&#39;2*A + 3&#39;&#39;  is the same as  &lt; 50 42 65 32 43 32 51 &gt;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8499"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8500"></a><span class="s1">&#39;   It is possible, though seldom very meaningful, to use such&#39;</span><span class="p">,&amp;</span>
<a name="ln-8501"></a><span class="s1">&#39;   strings in matrix operations. More frequently, the text is used&#39;</span><span class="p">,&amp;</span>
<a name="ln-8502"></a><span class="s1">&#39;   as a special argument to various functions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8503"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8504"></a><span class="s1">&#39;      norm(A,&#39;&#39;inf&#39;&#39;)    computes the infinity norm of A .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8505"></a><span class="s1">&#39;      display(T)       prints the text stored in T .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8506"></a><span class="s1">&#39;      exec(&#39;&#39;file&#39;&#39;)     obtains LALA input from an external file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8507"></a><span class="s1">&#39;      save(&#39;&#39;file&#39;&#39;)     stores all the current variables in a file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8508"></a><span class="s1">&#39;      load(&#39;&#39;file&#39;&#39;)     retrieves all the variables from a file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8509"></a><span class="s1">&#39;      print(&#39;&#39;file&#39;&#39;,X)  prints X on a file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8510"></a><span class="s1">&#39;      diary(&#39;&#39;file&#39;&#39;)    makes a copy of the complete LALA session.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8511"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8512"></a><span class="s1">&#39;   The text can also be used in a limited string substitution&#39;</span><span class="p">,&amp;</span>
<a name="ln-8513"></a><span class="s1">&#39;   macro facility. If a variable, say T, contains the source text&#39;</span><span class="p">,&amp;</span>
<a name="ln-8514"></a><span class="s1">&#39;   for a LALA statement or expression, then the construction&#39;</span><span class="p">,&amp;</span>
<a name="ln-8515"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8516"></a><span class="s1">&#39;      &gt; T &lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8517"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8518"></a><span class="s1">&#39;   causes T to be executed or evaluated. For example&#39;</span><span class="p">,&amp;</span>
<a name="ln-8519"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8520"></a><span class="s1">&#39;      T = &#39;&#39;2*A + 3&#39;&#39;;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8521"></a><span class="s1">&#39;      S = &#39;&#39;B = &gt;T&lt; + 5&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8522"></a><span class="s1">&#39;      A = 4;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8523"></a><span class="s1">&#39;      &gt; S &lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8524"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8525"></a><span class="s1">&#39;   produces&#39;</span><span class="p">,&amp;</span>
<a name="ln-8526"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8527"></a><span class="s1">&#39;      B     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8528"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8529"></a><span class="s1">&#39;         16.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8530"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8531"></a><span class="s1">&#39;   Some other examples are given under MACROS in the appendix. This&#39;</span><span class="p">,&amp;</span>
<a name="ln-8532"></a><span class="s1">&#39;   facility is useful for fairly short statements and expressions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8533"></a><span class="s1">&#39;   More complicated LALA &quot;programs&quot; should use the &quot;exec&quot; facility.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8534"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8535"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8536"></a><span class="s1">&#39;NUMERICAL ALGORITHMS&#39;</span><span class="p">,&amp;</span>
<a name="ln-8537"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8538"></a><span class="s1">&#39;   The algorithms underlying the basic LALA functions are described in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8539"></a><span class="s1">&#39;   the LINPACK and EISPACK guides [1-3]. The following list gives the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8540"></a><span class="s1">&#39;   subroutines used by these functions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8541"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8542"></a><span class="s1">&#39;      inv(A)          - CGECO,CGEDI&#39;</span><span class="p">,&amp;</span>
<a name="ln-8543"></a><span class="s1">&#39;      det(A)          - CGECO,CGEDI&#39;</span><span class="p">,&amp;</span>
<a name="ln-8544"></a><span class="s1">&#39;      lu(A)           - CGEFA&#39;</span><span class="p">,&amp;</span>
<a name="ln-8545"></a><span class="s1">&#39;      rcond(A)        - CGECO&#39;</span><span class="p">,&amp;</span>
<a name="ln-8546"></a><span class="s1">&#39;      chol(A)         - CPOFA&#39;</span><span class="p">,&amp;</span>
<a name="ln-8547"></a><span class="s1">&#39;      svd(A)          - CSVDC&#39;</span><span class="p">,&amp;</span>
<a name="ln-8548"></a><span class="s1">&#39;      cond(A)         - CSVDC&#39;</span><span class="p">,&amp;</span>
<a name="ln-8549"></a><span class="s1">&#39;      norm(A,2)       - CSVDC&#39;</span><span class="p">,&amp;</span>
<a name="ln-8550"></a><span class="s1">&#39;      pinv(A,eps)     - CSVDC&#39;</span><span class="p">,&amp;</span>
<a name="ln-8551"></a><span class="s1">&#39;      rank(A,eps)     - CSVDC&#39;</span><span class="p">,&amp;</span>
<a name="ln-8552"></a><span class="s1">&#39;      qr(A)           - CQRDC,CQRSL&#39;</span><span class="p">,&amp;</span>
<a name="ln-8553"></a><span class="s1">&#39;      orth(A)         - CQRDC,CSQSL&#39;</span><span class="p">,&amp;</span>
<a name="ln-8554"></a><span class="s1">&#39;      A\B and B/A     - CGECO,CGESL if A is square.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8555"></a><span class="s1">&#39;                      - CQRDC,CQRSL if A is not square.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8556"></a><span class="s1">&#39;      eig(A)          - HTRIDI,IMTQL2,HTRIBK if A is Hermitian.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8557"></a><span class="s1">&#39;                      - CORTH,COMQR2         if A is not Hermitian.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8558"></a><span class="s1">&#39;      schur(A)        - same as EIG.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8559"></a><span class="s1">&#39;      hess(A)         - same as EIG.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8560"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8561"></a><span class="s1">&#39;   Minor modifications were made to all these subroutines. The LINPACK&#39;</span><span class="p">,&amp;</span>
<a name="ln-8562"></a><span class="s1">&#39;   routines were changed to replace the Fortran complex arithmetic&#39;</span><span class="p">,&amp;</span>
<a name="ln-8563"></a><span class="s1">&#39;   with explicit references to real and imaginary parts.  Since most&#39;</span><span class="p">,&amp;</span>
<a name="ln-8564"></a><span class="s1">&#39;   of the floating point arithmetic is concentrated in a few low-level&#39;</span><span class="p">,&amp;</span>
<a name="ln-8565"></a><span class="s1">&#39;   subroutines which perform vector operations (the Basic Linear Algebra&#39;</span><span class="p">,&amp;</span>
<a name="ln-8566"></a><span class="s1">&#39;   Subprograms), this was not an extensive change. It also facilitated&#39;</span><span class="p">,&amp;</span>
<a name="ln-8567"></a><span class="s1">&#39;   implementation of the &quot;flop&quot; and &quot;chop&quot; features which count and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8568"></a><span class="s1">&#39;   optionally truncate each floating point operation.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8569"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8570"></a><span class="s1">&#39;   The EISPACK subroutine COMQR2 was modified to allow access to the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8571"></a><span class="s1">&#39;   Schur triangular form, ordinarily just an intermediate result. IMTQL2&#39;</span><span class="p">,&amp;</span>
<a name="ln-8572"></a><span class="s1">&#39;   was modified to make computation of the eigenvectors optional. Both&#39;</span><span class="p">,&amp;</span>
<a name="ln-8573"></a><span class="s1">&#39;   subroutines were modified to eliminate the machine-dependent accuracy&#39;</span><span class="p">,&amp;</span>
<a name="ln-8574"></a><span class="s1">&#39;   parameter and all the EISPACK subroutines were changed to include&#39;</span><span class="p">,&amp;</span>
<a name="ln-8575"></a><span class="s1">&#39;   &quot;flop&quot; and &quot;chop&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8576"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8577"></a><span class="s1">&#39;   The algorithms employed for the &quot;poly&quot; and &quot;roots&quot; functions&#39;</span><span class="p">,&amp;</span>
<a name="ln-8578"></a><span class="s1">&#39;   illustrate an interesting aspect of the modern approach to eigenvalue&#39;</span><span class="p">,&amp;</span>
<a name="ln-8579"></a><span class="s1">&#39;   computation. &quot;poly(A)&quot; generates the characteristic polynomial of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8580"></a><span class="s1">&#39;   A and &quot;roots(poly(A))&quot; finds the roots of that polynomial, which&#39;</span><span class="p">,&amp;</span>
<a name="ln-8581"></a><span class="s1">&#39;   are, of course, the eigenvalues of A . But both &quot;poly&quot; and &quot;roots&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8582"></a><span class="s1">&#39;   use EISPACK eigenvalues subroutines, which are based on similarity&#39;</span><span class="p">,&amp;</span>
<a name="ln-8583"></a><span class="s1">&#39;   transformations. So the classical approach which characterizes&#39;</span><span class="p">,&amp;</span>
<a name="ln-8584"></a><span class="s1">&#39;   eigenvalues as roots of the characteristic polynomial is actually&#39;</span><span class="p">,&amp;</span>
<a name="ln-8585"></a><span class="s1">&#39;   reversed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8586"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8587"></a><span class="s1">&#39;   If A is an n by n matrix, &quot;poly(A)&quot; produces the coefficients C(1)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8588"></a><span class="s1">&#39;   through C(n+1), with C(1) = 1, in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8589"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8590"></a><span class="s1">&#39;         det(z*eye-A) = C(1)*z**n + ... + C(n)*z + C(n+1) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8591"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8592"></a><span class="s1">&#39;   The algorithm can be expressed compactly using LALA:&#39;</span><span class="p">,&amp;</span>
<a name="ln-8593"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8594"></a><span class="s1">&#39;         Z = eig(A);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8595"></a><span class="s1">&#39;         C = 0*ones(n+1,1);  C(1) = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8596"></a><span class="s1">&#39;         for j = 1:n, C(2:j+1) = C(2:j+1) - Z(j)*C(1:j);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8597"></a><span class="s1">&#39;         C&#39;</span><span class="p">,&amp;</span>
<a name="ln-8598"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8599"></a><span class="s1">&#39;   This recursion is easily derived by expanding the product&#39;</span><span class="p">,&amp;</span>
<a name="ln-8600"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8601"></a><span class="s1">&#39;         (z - z(1))*(z - z(2))* ... * (z-z(n)) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8602"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8603"></a><span class="s1">&#39;   It is possible to prove that &quot;poly(A)&quot; produces the coefficients in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8604"></a><span class="s1">&#39;   the characteristic polynomial of a matrix within roundoff error of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8605"></a><span class="s1">&#39;   A. This is true even if the eigenvalues of A are badly conditioned. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-8606"></a><span class="s1">&#39;   traditional algorithms for obtaining the characteristic polynomial&#39;</span><span class="p">,&amp;</span>
<a name="ln-8607"></a><span class="s1">&#39;   which do not use the eigenvalues do not have such satisfactory&#39;</span><span class="p">,&amp;</span>
<a name="ln-8608"></a><span class="s1">&#39;   numerical properties.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8609"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8610"></a><span class="s1">&#39;   If C is a vector with n+1 components, &quot;roots(C)&quot; finds the roots of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8611"></a><span class="s1">&#39;   the polynomial of degree n ,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8612"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8613"></a><span class="s1">&#39;          p(z) = C(1)*z**n + ... + C(n)*z + C(n+1) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-8614"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8615"></a><span class="s1">&#39;   The algorithm simply involves computing the eigenvalues of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8616"></a><span class="s1">&#39;   companion matrix:&#39;</span><span class="p">,&amp;</span>
<a name="ln-8617"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8618"></a><span class="s1">&#39;         A = 0*ones(n,n)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8619"></a><span class="s1">&#39;         for j = 1:n, A(1,j) = -C(j+1)/C(1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8620"></a><span class="s1">&#39;         for i = 2:n, A(i,i-1) = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8621"></a><span class="s1">&#39;         eig(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8622"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8623"></a><span class="s1">&#39;   It is possible to prove that the results produced are the exact&#39;</span><span class="p">,&amp;</span>
<a name="ln-8624"></a><span class="s1">&#39;   eigenvalues of a matrix within roundoff error of the companion matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-8625"></a><span class="s1">&#39;   A, but this does not mean that they are the exact roots of a polynomial&#39;</span><span class="p">,&amp;</span>
<a name="ln-8626"></a><span class="s1">&#39;   with coefficients within roundoff error of those in C . There are&#39;</span><span class="p">,&amp;</span>
<a name="ln-8627"></a><span class="s1">&#39;   more accurate, more efficient methods for finding polynomial roots,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8628"></a><span class="s1">&#39;   but this approach has the crucial advantage that it does not require&#39;</span><span class="p">,&amp;</span>
<a name="ln-8629"></a><span class="s1">&#39;   very much additional code.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8630"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8631"></a><span class="s1">&#39;   The elementary functions &quot;exp&quot;, &quot;log&quot;, &quot;sqrt&quot;, &quot;sin&quot;, &quot;cos&quot; and &quot;atan&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8632"></a><span class="s1">&#39;   are applied to square matrices by diagonalizing the matrix, applying&#39;</span><span class="p">,&amp;</span>
<a name="ln-8633"></a><span class="s1">&#39;   the functions to the individual eigenvalues and then transforming&#39;</span><span class="p">,&amp;</span>
<a name="ln-8634"></a><span class="s1">&#39;   back. For example, &quot;exp(A)&quot; is computed by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8635"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8636"></a><span class="s1">&#39;         &lt;X,D&gt; = eig(A);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8637"></a><span class="s1">&#39;         for j = 1:n, D(j,j) = exp(D(j,j));&#39;</span><span class="p">,&amp;</span>
<a name="ln-8638"></a><span class="s1">&#39;         X*D/X&#39;</span><span class="p">,&amp;</span>
<a name="ln-8639"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8640"></a><span class="s1">&#39;   This is essentially method number 14 out of the 19 &#39;&#39;dubious&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8641"></a><span class="s1">&#39;   possibilities described in [8]. It is dubious because it doesn&#39;&#39;t always&#39;</span><span class="p">,&amp;</span>
<a name="ln-8642"></a><span class="s1">&#39;   work. The matrix of eigenvectors X can be arbitrarily badly conditioned&#39;</span><span class="p">,&amp;</span>
<a name="ln-8643"></a><span class="s1">&#39;   and all accuracy lost in the computation of X*D/X. A warning message&#39;</span><span class="p">,&amp;</span>
<a name="ln-8644"></a><span class="s1">&#39;   is printed if &quot;rcond(X)&quot; is very small, but this only catches the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8645"></a><span class="s1">&#39;   extreme cases. An example of a case not detected is when A has a double&#39;</span><span class="p">,&amp;</span>
<a name="ln-8646"></a><span class="s1">&#39;   eigenvalue, but theoretically only one linearly independent eigenvector&#39;</span><span class="p">,&amp;</span>
<a name="ln-8647"></a><span class="s1">&#39;   associated with it.  The computed eigenvalues will be separated by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8648"></a><span class="s1">&#39;   something on the order of the square root of the roundoff level. This&#39;</span><span class="p">,&amp;</span>
<a name="ln-8649"></a><span class="s1">&#39;   separation will be reflected in &quot;rcond(X)&quot; which will probably not&#39;</span><span class="p">,&amp;</span>
<a name="ln-8650"></a><span class="s1">&#39;   be small enough to trigger the error message. The computed &quot;exp(A)&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8651"></a><span class="s1">&#39;   will be accurate to only half precision. Better methods are known for&#39;</span><span class="p">,&amp;</span>
<a name="ln-8652"></a><span class="s1">&#39;   computing &quot;exp(A)&quot;, but they do not easily extend to the other five&#39;</span><span class="p">,&amp;</span>
<a name="ln-8653"></a><span class="s1">&#39;   functions and would require a considerable amount of additional code.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8654"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8655"></a><span class="s1">&#39;   The expression A**p is evaluated by repeated multiplication if p is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8656"></a><span class="s1">&#39;   an integer greater than 1. Otherwise it is evaluated by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8657"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8658"></a><span class="s1">&#39;         &lt;X,D&gt; = eig(A);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8659"></a><span class="s1">&#39;         for j = 1:n, D(j,j) = exp(p*log(D(j,j)))&#39;</span><span class="p">,&amp;</span>
<a name="ln-8660"></a><span class="s1">&#39;         X*D/X&#39;</span><span class="p">,&amp;</span>
<a name="ln-8661"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8662"></a><span class="s1">&#39;   This suffers from the same potential loss of accuracy if X is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8663"></a><span class="s1">&#39;   badly conditioned. It was partly for this reason that the case p =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8664"></a><span class="s1">&#39;   1 is included in the general case. Comparison of A**1 with A gives&#39;</span><span class="p">,&amp;</span>
<a name="ln-8665"></a><span class="s1">&#39;   some idea of the loss of accuracy for other values of p and for the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8666"></a><span class="s1">&#39;   elementary functions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8667"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8668"></a><span class="s1">&#39;   &quot;rref&quot;, the reduced row echelon form, is of some interest in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8669"></a><span class="s1">&#39;   theoretical linear algebra, although it has little computational&#39;</span><span class="p">,&amp;</span>
<a name="ln-8670"></a><span class="s1">&#39;   value. It is included in LALA for pedagogical reasons. The algorithm&#39;</span><span class="p">,&amp;</span>
<a name="ln-8671"></a><span class="s1">&#39;   is essentially Gauss-Jordan elimination with detection of negligible&#39;</span><span class="p">,&amp;</span>
<a name="ln-8672"></a><span class="s1">&#39;   columns applied to rectangular matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8673"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8674"></a><span class="s1">&#39;   There are three separate places in LALA where the rank of a matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-8675"></a><span class="s1">&#39;   is implicitly computed: in rref(A), in A\B for non-square A, and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8676"></a><span class="s1">&#39;   in the pseudoinverse pinv(A). Three different algorithms with three&#39;</span><span class="p">,&amp;</span>
<a name="ln-8677"></a><span class="s1">&#39;   different criteria for negligibility are used and so it is possible&#39;</span><span class="p">,&amp;</span>
<a name="ln-8678"></a><span class="s1">&#39;   that three different values could be produced for the same matrix. With&#39;</span><span class="p">,&amp;</span>
<a name="ln-8679"></a><span class="s1">&#39;   rref(A), the rank of A is the number of nonzero rows. The elimination&#39;</span><span class="p">,&amp;</span>
<a name="ln-8680"></a><span class="s1">&#39;   algorithm used for &quot;rref&quot; is the fastest of the three rank-determining&#39;</span><span class="p">,&amp;</span>
<a name="ln-8681"></a><span class="s1">&#39;   algorithms, but it is the least sophisticated numerically and the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8682"></a><span class="s1">&#39;   least reliable.  With A\B, the algorithm is essentially that used&#39;</span><span class="p">,&amp;</span>
<a name="ln-8683"></a><span class="s1">&#39;   by example subroutine SQRST in chapter 9 of the LINPACK guide. With&#39;</span><span class="p">,&amp;</span>
<a name="ln-8684"></a><span class="s1">&#39;   pinv(A), the algorithm is based on the singular value decomposition&#39;</span><span class="p">,&amp;</span>
<a name="ln-8685"></a><span class="s1">&#39;   and is described in chapter 11 of the LINPACK guide. The SVD algorithm&#39;</span><span class="p">,&amp;</span>
<a name="ln-8686"></a><span class="s1">&#39;   is the most time-consuming, but the most reliable and is therefore&#39;</span><span class="p">,&amp;</span>
<a name="ln-8687"></a><span class="s1">&#39;   also used for rank(A).&#39;</span><span class="p">,&amp;</span>
<a name="ln-8688"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8689"></a><span class="s1">&#39;   The uniformly distributed random numbers in &quot;rand&quot; are obtained from&#39;</span><span class="p">,&amp;</span>
<a name="ln-8690"></a><span class="s1">&#39;   the machine-independent random number generator URAND described in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8691"></a><span class="s1">&#39;   [9]. It is possible to switch to normally distributed random numbers,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8692"></a><span class="s1">&#39;   which are obtained using a transformation also described in [9].&#39;</span><span class="p">,&amp;</span>
<a name="ln-8693"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8694"></a><span class="s1">&#39;        The computation of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8695"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8696"></a><span class="s1">&#39;                   2    2&#39;</span><span class="p">,&amp;</span>
<a name="ln-8697"></a><span class="s1">&#39;             sqrt(a  + b )&#39;</span><span class="p">,&amp;</span>
<a name="ln-8698"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8699"></a><span class="s1">&#39;   is required in many matrix algorithms, particularly those involving&#39;</span><span class="p">,&amp;</span>
<a name="ln-8700"></a><span class="s1">&#39;   complex arithmetic. A new approach to carrying out this operation is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8701"></a><span class="s1">&#39;   described by Moler and Morrison [10]. It is a cubically convergent&#39;</span><span class="p">,&amp;</span>
<a name="ln-8702"></a><span class="s1">&#39;   algorithm which starts with a and b , rather than with their squares,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8703"></a><span class="s1">&#39;   and thereby avoids destructive arithmetic underflows and overflows. In&#39;</span><span class="p">,&amp;</span>
<a name="ln-8704"></a><span class="s1">&#39;   LALA, the algorithm is used for complex modulus, Euclidean vector&#39;</span><span class="p">,&amp;</span>
<a name="ln-8705"></a><span class="s1">&#39;   norm, plane rotations, and the shift calculation in the eigenvalue&#39;</span><span class="p">,&amp;</span>
<a name="ln-8706"></a><span class="s1">&#39;   and singular value iterations.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8707"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8708"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8709"></a><span class="s1">&#39;FLOP AND CHOP&#39;</span><span class="p">,&amp;</span>
<a name="ln-8710"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8711"></a><span class="s1">&#39;   Detailed information about the amount of work involved in matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-8712"></a><span class="s1">&#39;   calculations and the resulting accuracy is provided by &quot;flop&quot; and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8713"></a><span class="s1">&#39;   &quot;chop&quot;. The basic unit of work is the &quot;flop&quot;, or floating point&#39;</span><span class="p">,&amp;</span>
<a name="ln-8714"></a><span class="s1">&#39;   operation. Roughly, one flop is one execution of a Fortran statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8715"></a><span class="s1">&#39;   like&#39;</span><span class="p">,&amp;</span>
<a name="ln-8716"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8717"></a><span class="s1">&#39;         S = S + X(I)*Y(I)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8718"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8719"></a><span class="s1">&#39;   or&#39;</span><span class="p">,&amp;</span>
<a name="ln-8720"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8721"></a><span class="s1">&#39;         Y(I) = Y(I) + T*X(I)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8722"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8723"></a><span class="s1">&#39;   In other words, it consists of one floating point multiplication,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8724"></a><span class="s1">&#39;   together with one floating point addition and the associated&#39;</span><span class="p">,&amp;</span>
<a name="ln-8725"></a><span class="s1">&#39;   indexing and storage reference operations.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8726"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8727"></a><span class="s1">&#39;   LALA will print the CPU time required for a particular&#39;</span><span class="p">,&amp;</span>
<a name="ln-8728"></a><span class="s1">&#39;   statement when the statement is terminated by an extra comma. For&#39;</span><span class="p">,&amp;</span>
<a name="ln-8729"></a><span class="s1">&#39;   example, the line&#39;</span><span class="p">,&amp;</span>
<a name="ln-8730"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8731"></a><span class="s1">&#39;         n = 20;  rand(n)*rand(n);,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8732"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8733"></a><span class="s1">&#39;   ends with an extra comma. Two 20 by 20 random matrices are generated&#39;</span><span class="p">,&amp;</span>
<a name="ln-8734"></a><span class="s1">&#39;   and multiplied together. The result is assigned to &quot;ans&quot;, but the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8735"></a><span class="s1">&#39;   semicolon suppresses its printing. The only output is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8736"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8737"></a><span class="s1">&#39;           8800 flops&#39;</span><span class="p">,&amp;</span>
<a name="ln-8738"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8739"></a><span class="s1">&#39;   This is n**3 + 2*n**2 flops, n**2 for each random matrix and n**3&#39;</span><span class="p">,&amp;</span>
<a name="ln-8740"></a><span class="s1">&#39;   for the product.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8741"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8742"></a><span class="s1">&#39;   &quot;flop&quot; is a predefined vector with two components. &quot;flop(1)&quot; is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8743"></a><span class="s1">&#39;   the number of flops used by the most recently executed statement,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8744"></a><span class="s1">&#39;   except that statements with zero flops are ignored. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8745"></a><span class="s1">&#39;   after executing the previous statement,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8746"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8747"></a><span class="s1">&#39;         flop(1)/n**3&#39;</span><span class="p">,&amp;</span>
<a name="ln-8748"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8749"></a><span class="s1">&#39;   results in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8750"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8751"></a><span class="s1">&#39;         ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8752"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8753"></a><span class="s1">&#39;             1.1000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8754"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8755"></a><span class="s1">&#39;   &quot;flop(2)&quot; is the cumulative total of all the flops used since&#39;</span><span class="p">,&amp;</span>
<a name="ln-8756"></a><span class="s1">&#39;   the beginning of the LALA session. The statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8757"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8758"></a><span class="s1">&#39;         flop = &lt;0 0&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8759"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8760"></a><span class="s1">&#39;   resets the total.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8761"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8762"></a><span class="s1">&#39;   There are several difficulties associated with keeping a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8763"></a><span class="s1">&#39;   precise count of floating point operations.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8764"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8765"></a><span class="s1">&#39;   As the program generally uses complex values but only performs&#39;</span><span class="p">,&amp;</span>
<a name="ln-8766"></a><span class="s1">&#39;   operations on the real matrices in many cases where all the imaginary&#39;</span><span class="p">,&amp;</span>
<a name="ln-8767"></a><span class="s1">&#39;   values are zero it may not provide an accurate measure of the relative&#39;</span><span class="p">,&amp;</span>
<a name="ln-8768"></a><span class="s1">&#39;   costs of real and complex arithmetic.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8769"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8770"></a><span class="s1">&#39;   The result of each floating point operation may also be &quot;chopped&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8771"></a><span class="s1">&#39;   to simulate a computer with a shorter word length. The details&#39;</span><span class="p">,&amp;</span>
<a name="ln-8772"></a><span class="s1">&#39;   of this chopping operation depend upon the format of the floating&#39;</span><span class="p">,&amp;</span>
<a name="ln-8773"></a><span class="s1">&#39;   point word. Usually, the fraction in the floating point word can be&#39;</span><span class="p">,&amp;</span>
<a name="ln-8774"></a><span class="s1">&#39;   regarded as consisting of several octal or hexadecimal digits. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-8775"></a><span class="s1">&#39;   least significant of these digits can be set to zero by a logical&#39;</span><span class="p">,&amp;</span>
<a name="ln-8776"></a><span class="s1">&#39;   masking operation. Thus the statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8777"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8778"></a><span class="s1">&#39;         chop(p)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8779"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8780"></a><span class="s1">&#39;   causes the p least significant octal or hexadecimal digits in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8781"></a><span class="s1">&#39;   the result of each floating point operation to be set to zero.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8782"></a><span class="s1">&#39;   For example, if the computer being used has an IBM 360 long floating&#39;</span><span class="p">,&amp;</span>
<a name="ln-8783"></a><span class="s1">&#39;   point word with 14 hexadecimal digits in the fraction, then &quot;chop(8)&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8784"></a><span class="s1">&#39;   results in simulation of a computer with only 6 hexadecimal digits&#39;</span><span class="p">,&amp;</span>
<a name="ln-8785"></a><span class="s1">&#39;   in the fraction, i.e. a short floating point word. On a computer such&#39;</span><span class="p">,&amp;</span>
<a name="ln-8786"></a><span class="s1">&#39;   as the CDC 6600 with 16 octal digits, &quot;chop(8)&quot; results in about the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8787"></a><span class="s1">&#39;   same accuracy because the remaining 8 octal digits represent the same&#39;</span><span class="p">,&amp;</span>
<a name="ln-8788"></a><span class="s1">&#39;   number of bits as 6 hexadecimal digits.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8789"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8790"></a><span class="s1">&#39;   Some idea of the effect of &quot;chop&quot; on any particular system can&#39;</span><span class="p">,&amp;</span>
<a name="ln-8791"></a><span class="s1">&#39;   be obtained by executing the following statements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8792"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8793"></a><span class="s1">&#39;         long,   t = 1/10&#39;</span><span class="p">,&amp;</span>
<a name="ln-8794"></a><span class="s1">&#39;         long z, t = 1/10&#39;</span><span class="p">,&amp;</span>
<a name="ln-8795"></a><span class="s1">&#39;         chop(8)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8796"></a><span class="s1">&#39;         long,   t = 1/10&#39;</span><span class="p">,&amp;</span>
<a name="ln-8797"></a><span class="s1">&#39;         long z, t = 1/10&#39;</span><span class="p">,&amp;</span>
<a name="ln-8798"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8799"></a><span class="s1">&#39;   The following Fortran subprograms illustrate more details of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8800"></a><span class="s1">&#39;   &quot;flop&quot; and &quot;chop&quot;. The first subprogram is a simplified example of a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8801"></a><span class="s1">&#39;   system-dependent function used within LALA itself. The common variable&#39;</span><span class="p">,&amp;</span>
<a name="ln-8802"></a><span class="s1">&#39;   G_FLOP_COUNTER is essentially the first component of the variable&#39;</span><span class="p">,&amp;</span>
<a name="ln-8803"></a><span class="s1">&#39;   FLOP. The common variable CHP is initially zero, but it is set to p&#39;</span><span class="p">,&amp;</span>
<a name="ln-8804"></a><span class="s1">&#39;   by the statement &quot;chop(p)&quot;. To shorten the DATA statement, we assume&#39;</span><span class="p">,&amp;</span>
<a name="ln-8805"></a><span class="s1">&#39;   there are only 6 hexadecimal digits. We also assume an extension of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8806"></a><span class="s1">&#39;   Fortran that allows .AND. to be used as a binary operation between&#39;</span><span class="p">,&amp;</span>
<a name="ln-8807"></a><span class="s1">&#39;   two real variables.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8808"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8809"></a><span class="s1">&#39;         REAL FUNCTION FLOP(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8810"></a><span class="s1">&#39;         REAL X&#39;</span><span class="p">,&amp;</span>
<a name="ln-8811"></a><span class="s1">&#39;         INTEGER G_FLOP_COUNTER,CHP&#39;</span><span class="p">,&amp;</span>
<a name="ln-8812"></a><span class="s1">&#39;         COMMON G_FLOP_COUNTER,CHP&#39;</span><span class="p">,&amp;</span>
<a name="ln-8813"></a><span class="s1">&#39;         REAL MASK(5)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8814"></a><span class="s1">&#39;         DATA MASK/ZFFFFFFF0,ZFFFFFF00,ZFFFFF000,ZFFFF0000,ZFFF00000/&#39;</span><span class="p">,&amp;</span>
<a name="ln-8815"></a><span class="s1">&#39;         G_FLOP_COUNTER = G_FLOP_COUNTER + 1&#39;</span><span class="p">,&amp;</span>
<a name="ln-8816"></a><span class="s1">&#39;         IF (CHP .EQ. 0) FLOP = X&#39;</span><span class="p">,&amp;</span>
<a name="ln-8817"></a><span class="s1">&#39;         IF (CHP .GE. 1 .AND. CHP .LE. 5) FLOP = X .AND. MASK(CHP)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8818"></a><span class="s1">&#39;         IF (CHP .GE. 6) FLOP = 0.0&#39;</span><span class="p">,&amp;</span>
<a name="ln-8819"></a><span class="s1">&#39;         END REAL FUNCTION FLOP&#39;</span><span class="p">,&amp;</span>
<a name="ln-8820"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8821"></a><span class="s1">&#39;   The following subroutine illustrates a typical use of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8822"></a><span class="s1">&#39;   previous function within LALA. It is a simplified version of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8823"></a><span class="s1">&#39;   the Basic Linear Algebra Subprogram that adds a scalar multiple&#39;</span><span class="p">,&amp;</span>
<a name="ln-8824"></a><span class="s1">&#39;   of one vector to another. We assume here that the vectors are&#39;</span><span class="p">,&amp;</span>
<a name="ln-8825"></a><span class="s1">&#39;   stored with a memory increment of one.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8826"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8827"></a><span class="s1">&#39;         SUBROUTINE SAXPY(N,TR,TI,XR,XI,YR,YI)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8828"></a><span class="s1">&#39;         REAL TR,TI,XR(N),XI(N),YR(N),YI(N),FLOP&#39;</span><span class="p">,&amp;</span>
<a name="ln-8829"></a><span class="s1">&#39;         IF (N .LE. 0) return&#39;</span><span class="p">,&amp;</span>
<a name="ln-8830"></a><span class="s1">&#39;         IF (TR .EQ. 0.0 .AND. TI .EQ. 0.0) return&#39;</span><span class="p">,&amp;</span>
<a name="ln-8831"></a><span class="s1">&#39;         DO I = 1, N&#39;</span><span class="p">,&amp;</span>
<a name="ln-8832"></a><span class="s1">&#39;            YR(I) = FLOP(YR(I) + TR*XR(I) - TI*XI(I))&#39;</span><span class="p">,&amp;</span>
<a name="ln-8833"></a><span class="s1">&#39;            YI(I) = YI(I) + TR*XI(I) + TI*XR(I)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8834"></a><span class="s1">&#39;            IF (YI(I) .NE. 0.0D0) YI(I) = FLOP(YI(I))&#39;</span><span class="p">,&amp;</span>
<a name="ln-8835"></a><span class="s1">&#39;         enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-8836"></a><span class="s1">&#39;         END SUBROUTINE SAXPY&#39;</span><span class="p">,&amp;</span>
<a name="ln-8837"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8838"></a><span class="s1">&#39;   The saxpy operation is perhaps the most fundamental&#39;</span><span class="p">,&amp;</span>
<a name="ln-8839"></a><span class="s1">&#39;   operation within LINPACK. It is used in the computation of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8840"></a><span class="s1">&#39;   LU, the QR and the SVD factorizations, and in several other&#39;</span><span class="p">,&amp;</span>
<a name="ln-8841"></a><span class="s1">&#39;   places. We see that adding a multiple of one vector with n&#39;</span><span class="p">,&amp;</span>
<a name="ln-8842"></a><span class="s1">&#39;   components to another uses n flops if the vectors are real and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8843"></a><span class="s1">&#39;   between n and 2*n flops if the vectors have nonzero imaginary&#39;</span><span class="p">,&amp;</span>
<a name="ln-8844"></a><span class="s1">&#39;   components.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8845"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8846"></a><span class="s1">&#39;   The permanent LALA variable &quot;eps&quot; is reset by the statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8847"></a><span class="s1">&#39;   CHOP(p). Its new value is usually the smallest inverse power of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8848"></a><span class="s1">&#39;   two that satisfies the Fortran logical test&#39;</span><span class="p">,&amp;</span>
<a name="ln-8849"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8850"></a><span class="s1">&#39;               FLOP(1.0+eps) .GT. 1.0&#39;</span><span class="p">,&amp;</span>
<a name="ln-8851"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8852"></a><span class="s1">&#39;   However, if &quot;eps&quot; had been directly reset to a larger value, the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8853"></a><span class="s1">&#39;   old value is retained.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8854"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8855"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-8856"></a><span class="s1">&#39;CENSUS EXAMPLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-8857"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8858"></a><span class="s1">&#39;   Our first extended example involves predicting the population of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8859"></a><span class="s1">&#39;   United States in 1980 using extrapolation of various fits to the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8860"></a><span class="s1">&#39;   census data from 1900 through 1970. There are eight observations,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8861"></a><span class="s1">&#39;   so we begin with the LALA statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8862"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8863"></a><span class="s1">&#39;      n = 8&#39;</span><span class="p">,&amp;</span>
<a name="ln-8864"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8865"></a><span class="s1">&#39;   The values of the dependent variable, the population in millions,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8866"></a><span class="s1">&#39;   can be entered with&#39;</span><span class="p">,&amp;</span>
<a name="ln-8867"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8868"></a><span class="s1">&#39;      y = &lt; 75.995   91.972  105.711  123.203   ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-8869"></a><span class="s1">&#39;           131.669  150.697  179.323  203.212&gt;&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8870"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8871"></a><span class="s1">&#39;   In order to produce a reasonably scaled matrix, the independent&#39;</span><span class="p">,&amp;</span>
<a name="ln-8872"></a><span class="s1">&#39;   variable, time, is transformed from the interval [1900,1970] to&#39;</span><span class="p">,&amp;</span>
<a name="ln-8873"></a><span class="s1">&#39;   [-1.00,0.75]. This can be accomplished directly with&#39;</span><span class="p">,&amp;</span>
<a name="ln-8874"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8875"></a><span class="s1">&#39;      t = -1.0:0.25:0.75&#39;</span><span class="p">,&amp;</span>
<a name="ln-8876"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8877"></a><span class="s1">&#39;   or in a fancier, but perhaps clearer, way with&#39;</span><span class="p">,&amp;</span>
<a name="ln-8878"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8879"></a><span class="s1">&#39;      t = 1900:10:1970;   t = (t - 1940*ones(t))/40&#39;</span><span class="p">,&amp;</span>
<a name="ln-8880"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8881"></a><span class="s1">&#39;   Either of these is equivalent to&#39;</span><span class="p">,&amp;</span>
<a name="ln-8882"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8883"></a><span class="s1">&#39;      t = &lt;-1 -.75 -.50 -.25 0 .25 .50 .75&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8884"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8885"></a><span class="s1">&#39;   The interpolating polynomial of degree n-1 involves an Vandermonde&#39;</span><span class="p">,&amp;</span>
<a name="ln-8886"></a><span class="s1">&#39;   matrix of order n with elements that might be generated by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8887"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8888"></a><span class="s1">&#39;      for i = 1:n, for j = 1:n, a(i,j) = t(i)**(j-1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8889"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8890"></a><span class="s1">&#39;   However, this results in an error caused by 0**0 when i = 5 and&#39;</span><span class="p">,&amp;</span>
<a name="ln-8891"></a><span class="s1">&#39;   j = 1 . The preferable approach is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8892"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8893"></a><span class="s1">&#39;      A = ones(n,n);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8894"></a><span class="s1">&#39;      for i = 1:n, for j = 2:n, a(i,j) = t(i)*a(i,j-1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8895"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8896"></a><span class="s1">&#39;   Now the statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8897"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8898"></a><span class="s1">&#39;      cond(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8899"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8900"></a><span class="s1">&#39;   produces the output&#39;</span><span class="p">,&amp;</span>
<a name="ln-8901"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8902"></a><span class="s1">&#39;      ans  =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8903"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8904"></a><span class="s1">&#39;         1.1819E+03&#39;</span><span class="p">,&amp;</span>
<a name="ln-8905"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8906"></a><span class="s1">&#39;   which indicates that transformation of the time variable has resulted&#39;</span><span class="p">,&amp;</span>
<a name="ln-8907"></a><span class="s1">&#39;   in a reasonably well conditioned matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8908"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8909"></a><span class="s1">&#39;        The statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8910"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8911"></a><span class="s1">&#39;      c = A\y&#39;</span><span class="p">,&amp;</span>
<a name="ln-8912"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8913"></a><span class="s1">&#39;   results in&#39;</span><span class="p">,&amp;</span>
<a name="ln-8914"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8915"></a><span class="s1">&#39;      C     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8916"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8917"></a><span class="s1">&#39;        131.6690&#39;</span><span class="p">,&amp;</span>
<a name="ln-8918"></a><span class="s1">&#39;         41.0406&#39;</span><span class="p">,&amp;</span>
<a name="ln-8919"></a><span class="s1">&#39;        103.5396&#39;</span><span class="p">,&amp;</span>
<a name="ln-8920"></a><span class="s1">&#39;        262.4535&#39;</span><span class="p">,&amp;</span>
<a name="ln-8921"></a><span class="s1">&#39;       -326.0658&#39;</span><span class="p">,&amp;</span>
<a name="ln-8922"></a><span class="s1">&#39;       -662.0814&#39;</span><span class="p">,&amp;</span>
<a name="ln-8923"></a><span class="s1">&#39;        341.9022&#39;</span><span class="p">,&amp;</span>
<a name="ln-8924"></a><span class="s1">&#39;        533.6373&#39;</span><span class="p">,&amp;</span>
<a name="ln-8925"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8926"></a><span class="s1">&#39;   These are the coefficients in the interpolating polynomial&#39;</span><span class="p">,&amp;</span>
<a name="ln-8927"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8928"></a><span class="s1">&#39;         n-1&#39;</span><span class="p">,&amp;</span>
<a name="ln-8929"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8930"></a><span class="s1">&#39;         c  + c t + ... + c t&#39;</span><span class="p">,&amp;</span>
<a name="ln-8931"></a><span class="s1">&#39;          1    2           n&#39;</span><span class="p">,&amp;</span>
<a name="ln-8932"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8933"></a><span class="s1">&#39;   Our transformation of the time variable has resulted in t = 1&#39;</span><span class="p">,&amp;</span>
<a name="ln-8934"></a><span class="s1">&#39;   corresponding to the year 1980. Consequently, the extrapolated&#39;</span><span class="p">,&amp;</span>
<a name="ln-8935"></a><span class="s1">&#39;   population is simply the sum of the coefficients. This can be&#39;</span><span class="p">,&amp;</span>
<a name="ln-8936"></a><span class="s1">&#39;   computed by&#39;</span><span class="p">,&amp;</span>
<a name="ln-8937"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8938"></a><span class="s1">&#39;      p = sum(c)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8939"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8940"></a><span class="s1">&#39;   The result is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8941"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8942"></a><span class="s1">&#39;      P     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-8943"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8944"></a><span class="s1">&#39;        426.0950&#39;</span><span class="p">,&amp;</span>
<a name="ln-8945"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8946"></a><span class="s1">&#39;   which indicates a 1980 population of over 426 million. Clearly, using&#39;</span><span class="p">,&amp;</span>
<a name="ln-8947"></a><span class="s1">&#39;   the seventh degree interpolating polynomial to extrapolate even a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8948"></a><span class="s1">&#39;   fairly short distance beyond the end of the data interval is not a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8949"></a><span class="s1">&#39;   good idea.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8950"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8951"></a><span class="s1">&#39;   The coefficients in least squares fits by polynomials of lower degree&#39;</span><span class="p">,&amp;</span>
<a name="ln-8952"></a><span class="s1">&#39;   can be computed using fewer than n columns of the matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8953"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8954"></a><span class="s1">&#39;      for k = 1:n, c = A(:,1:k)\y,  p = sum(c)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8955"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8956"></a><span class="s1">&#39;   would produce the coefficients of these fits, as well as the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8957"></a><span class="s1">&#39;   resulting extrapolated population. If we do not want to print all the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8958"></a><span class="s1">&#39;   coefficients, we can simply generate a small table of populations&#39;</span><span class="p">,&amp;</span>
<a name="ln-8959"></a><span class="s1">&#39;   predicted by polynomials of degrees zero through seven. We also&#39;</span><span class="p">,&amp;</span>
<a name="ln-8960"></a><span class="s1">&#39;   compute the maximum deviation between the fitted and observed values.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8961"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8962"></a><span class="s1">&#39;      for k = 1:n, X = A(:,1:k);  c = X\y;  ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-8963"></a><span class="s1">&#39;         d(k) = k-1;  p(k) = sum(c);  e(k) = norm(X*c-y,&#39;&#39;inf&#39;&#39;);&#39;</span><span class="p">,&amp;</span>
<a name="ln-8964"></a><span class="s1">&#39;      &lt;d, p, e&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8965"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8966"></a><span class="s1">&#39;   The resulting output is&#39;</span><span class="p">,&amp;</span>
<a name="ln-8967"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8968"></a><span class="s1">&#39;         0   132.7227  70.4892&#39;</span><span class="p">,&amp;</span>
<a name="ln-8969"></a><span class="s1">&#39;         1   211.5101   9.8079&#39;</span><span class="p">,&amp;</span>
<a name="ln-8970"></a><span class="s1">&#39;         2   227.7744   5.0354&#39;</span><span class="p">,&amp;</span>
<a name="ln-8971"></a><span class="s1">&#39;         3   241.9574   3.8941&#39;</span><span class="p">,&amp;</span>
<a name="ln-8972"></a><span class="s1">&#39;         4   234.2814   4.0643&#39;</span><span class="p">,&amp;</span>
<a name="ln-8973"></a><span class="s1">&#39;         5   189.7310   2.5066&#39;</span><span class="p">,&amp;</span>
<a name="ln-8974"></a><span class="s1">&#39;         6   118.3025   1.6741&#39;</span><span class="p">,&amp;</span>
<a name="ln-8975"></a><span class="s1">&#39;         7   426.0950   0.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-8976"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8977"></a><span class="s1">&#39;   The zeroth degree fit, 132.7 million, is the result of fitting a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8978"></a><span class="s1">&#39;   constant to the data and is simply the average. The results obtained&#39;</span><span class="p">,&amp;</span>
<a name="ln-8979"></a><span class="s1">&#39;   with polynomials of degree one through four all appear reasonable. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-8980"></a><span class="s1">&#39;   maximum deviation of the degree four fit is slightly greater than the&#39;</span><span class="p">,&amp;</span>
<a name="ln-8981"></a><span class="s1">&#39;   degree three, even though the sum of the squares of the deviations&#39;</span><span class="p">,&amp;</span>
<a name="ln-8982"></a><span class="s1">&#39;   is less. The coefficients of the highest powers in the fits of degree&#39;</span><span class="p">,&amp;</span>
<a name="ln-8983"></a><span class="s1">&#39;   five and six turn out to be negative and the predicted populations of&#39;</span><span class="p">,&amp;</span>
<a name="ln-8984"></a><span class="s1">&#39;   less than 200 million are probably unrealistic. The hopefully absurd&#39;</span><span class="p">,&amp;</span>
<a name="ln-8985"></a><span class="s1">&#39;   prediction of the interpolating polynomial concludes the table.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8986"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8987"></a><span class="s1">&#39;   We wish to emphasize that roundoff errors are not significant&#39;</span><span class="p">,&amp;</span>
<a name="ln-8988"></a><span class="s1">&#39;   here. Nearly identical results would be obtained on other computers,&#39;</span><span class="p">,&amp;</span>
<a name="ln-8989"></a><span class="s1">&#39;   or with other algorithms. The results simply indicate the difficulties&#39;</span><span class="p">,&amp;</span>
<a name="ln-8990"></a><span class="s1">&#39;   associated with extrapolation of polynomial fits of even modest degree.&#39;</span><span class="p">,&amp;</span>
<a name="ln-8991"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8992"></a><span class="s1">&#39;   A stabilized fit by a seventh degree polynomial can be obtained using&#39;</span><span class="p">,&amp;</span>
<a name="ln-8993"></a><span class="s1">&#39;   the pseudoinverse, but it requires a fairly delicate choice of a&#39;</span><span class="p">,&amp;</span>
<a name="ln-8994"></a><span class="s1">&#39;   tolerance. The statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-8995"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8996"></a><span class="s1">&#39;      s = svd(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-8997"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-8998"></a><span class="s1">&#39;   produces the singular values&#39;</span><span class="p">,&amp;</span>
<a name="ln-8999"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9000"></a><span class="s1">&#39;      S     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9001"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9002"></a><span class="s1">&#39;         3.4594&#39;</span><span class="p">,&amp;</span>
<a name="ln-9003"></a><span class="s1">&#39;         2.2121&#39;</span><span class="p">,&amp;</span>
<a name="ln-9004"></a><span class="s1">&#39;         1.0915&#39;</span><span class="p">,&amp;</span>
<a name="ln-9005"></a><span class="s1">&#39;         0.4879&#39;</span><span class="p">,&amp;</span>
<a name="ln-9006"></a><span class="s1">&#39;         0.1759&#39;</span><span class="p">,&amp;</span>
<a name="ln-9007"></a><span class="s1">&#39;         0.0617&#39;</span><span class="p">,&amp;</span>
<a name="ln-9008"></a><span class="s1">&#39;         0.0134&#39;</span><span class="p">,&amp;</span>
<a name="ln-9009"></a><span class="s1">&#39;         0.0029&#39;</span><span class="p">,&amp;</span>
<a name="ln-9010"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9011"></a><span class="s1">&#39;   We see that the last three singular values are less than 0.1 ,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9012"></a><span class="s1">&#39;   consequently, A can be approximately by a matrix of rank five with an&#39;</span><span class="p">,&amp;</span>
<a name="ln-9013"></a><span class="s1">&#39;   error less than 0.1 . The Moore-Penrose pseudoinverse of this rank&#39;</span><span class="p">,&amp;</span>
<a name="ln-9014"></a><span class="s1">&#39;   five matrix is obtained from the singular value decomposition with&#39;</span><span class="p">,&amp;</span>
<a name="ln-9015"></a><span class="s1">&#39;   the following statements&#39;</span><span class="p">,&amp;</span>
<a name="ln-9016"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9017"></a><span class="s1">&#39;      c = pinv(A,0.1)*y, p = sum(c), e = norm(a*c-y,&#39;&#39;inf&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9018"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9019"></a><span class="s1">&#39;   The output is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9020"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9021"></a><span class="s1">&#39;      C     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9022"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9023"></a><span class="s1">&#39;       134.7972&#39;</span><span class="p">,&amp;</span>
<a name="ln-9024"></a><span class="s1">&#39;        67.5055&#39;</span><span class="p">,&amp;</span>
<a name="ln-9025"></a><span class="s1">&#39;        23.5523&#39;</span><span class="p">,&amp;</span>
<a name="ln-9026"></a><span class="s1">&#39;         9.2834&#39;</span><span class="p">,&amp;</span>
<a name="ln-9027"></a><span class="s1">&#39;         3.0174&#39;</span><span class="p">,&amp;</span>
<a name="ln-9028"></a><span class="s1">&#39;         2.6503&#39;</span><span class="p">,&amp;</span>
<a name="ln-9029"></a><span class="s1">&#39;        -2.8808&#39;</span><span class="p">,&amp;</span>
<a name="ln-9030"></a><span class="s1">&#39;         3.2467&#39;</span><span class="p">,&amp;</span>
<a name="ln-9031"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9032"></a><span class="s1">&#39;      P     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9033"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9034"></a><span class="s1">&#39;       241.1720&#39;</span><span class="p">,&amp;</span>
<a name="ln-9035"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9036"></a><span class="s1">&#39;      E     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9037"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9038"></a><span class="s1">&#39;         3.9469&#39;</span><span class="p">,&amp;</span>
<a name="ln-9039"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9040"></a><span class="s1">&#39;   The resulting seventh degree polynomial has coefficients which are much&#39;</span><span class="p">,&amp;</span>
<a name="ln-9041"></a><span class="s1">&#39;   smaller than those of the interpolating polynomial given earlier. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-9042"></a><span class="s1">&#39;   predicted population and the maximum deviation are reasonable. Any&#39;</span><span class="p">,&amp;</span>
<a name="ln-9043"></a><span class="s1">&#39;   choice of the tolerance between the fifth and sixth singular values&#39;</span><span class="p">,&amp;</span>
<a name="ln-9044"></a><span class="s1">&#39;   would produce the same results, but choices outside this range result&#39;</span><span class="p">,&amp;</span>
<a name="ln-9045"></a><span class="s1">&#39;   in pseudoinverses of different rank and do not work as well.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9046"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9047"></a><span class="s1">&#39;   The one term exponential approximation&#39;</span><span class="p">,&amp;</span>
<a name="ln-9048"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9049"></a><span class="s1">&#39;        y(t) = k exp(pt)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9050"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9051"></a><span class="s1">&#39;   can be transformed into a linear approximation by taking logarithms.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9052"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9053"></a><span class="s1">&#39;        log(y(t)) = log k + pt&#39;</span><span class="p">,&amp;</span>
<a name="ln-9054"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9055"></a><span class="s1">&#39;                  = c  + c t&#39;</span><span class="p">,&amp;</span>
<a name="ln-9056"></a><span class="s1">&#39;                     1    2&#39;</span><span class="p">,&amp;</span>
<a name="ln-9057"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9058"></a><span class="s1">&#39;   The following segment makes use of the fact that a function of a&#39;</span><span class="p">,&amp;</span>
<a name="ln-9059"></a><span class="s1">&#39;   vector is the function applied to the individual components.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9060"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9061"></a><span class="s1">&#39;      X = A(:,1:2);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9062"></a><span class="s1">&#39;      c = X\log(y)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9063"></a><span class="s1">&#39;      p = exp(sum(c))&#39;</span><span class="p">,&amp;</span>
<a name="ln-9064"></a><span class="s1">&#39;      e = norm(exp(X*c)-y,&#39;&#39;inf&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9065"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9066"></a><span class="s1">&#39;   The resulting output is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9067"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9068"></a><span class="s1">&#39;      C     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9069"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9070"></a><span class="s1">&#39;         4.9083&#39;</span><span class="p">,&amp;</span>
<a name="ln-9071"></a><span class="s1">&#39;         0.5407&#39;</span><span class="p">,&amp;</span>
<a name="ln-9072"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9073"></a><span class="s1">&#39;      P     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9074"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9075"></a><span class="s1">&#39;       232.5134&#39;</span><span class="p">,&amp;</span>
<a name="ln-9076"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9077"></a><span class="s1">&#39;      E     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9078"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9079"></a><span class="s1">&#39;         4.9141&#39;</span><span class="p">,&amp;</span>
<a name="ln-9080"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9081"></a><span class="s1">&#39;   The predicted population and maximum deviation appear satisfactory and&#39;</span><span class="p">,&amp;</span>
<a name="ln-9082"></a><span class="s1">&#39;   indicate that the exponential model is a reasonable one to consider.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9083"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9084"></a><span class="s1">&#39;   As a curiosity, we return to the degree six polynomial.  Since the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9085"></a><span class="s1">&#39;   coefficient of the high order term is negative and the value of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9086"></a><span class="s1">&#39;   polynomial at t = 1 is positive, it must have a root at some value&#39;</span><span class="p">,&amp;</span>
<a name="ln-9087"></a><span class="s1">&#39;   of t greater than one. The statements&#39;</span><span class="p">,&amp;</span>
<a name="ln-9088"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9089"></a><span class="s1">&#39;      X = A(:,1:7);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9090"></a><span class="s1">&#39;      c = X\y;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9091"></a><span class="s1">&#39;      c = c(7:-1:1);  //reverse the order of the coefficients&#39;</span><span class="p">,&amp;</span>
<a name="ln-9092"></a><span class="s1">&#39;      z = roots(c)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9093"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9094"></a><span class="s1">&#39;   produce&#39;</span><span class="p">,&amp;</span>
<a name="ln-9095"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9096"></a><span class="s1">&#39;      Z     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9097"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9098"></a><span class="s1">&#39;         1.1023-  0.0000*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9099"></a><span class="s1">&#39;         0.3021+  0.7293*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9100"></a><span class="s1">&#39;        -0.8790+  0.6536*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9101"></a><span class="s1">&#39;        -1.2939-  0.0000*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9102"></a><span class="s1">&#39;        -0.8790-  0.6536*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9103"></a><span class="s1">&#39;         0.3021-  0.7293*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9104"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9105"></a><span class="s1">&#39;   There is only one real, positive root. The corresponding time on the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9106"></a><span class="s1">&#39;   original scale is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9107"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9108"></a><span class="s1">&#39;      1940 + 40*real(z(1))&#39;</span><span class="p">,&amp;</span>
<a name="ln-9109"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9110"></a><span class="s1">&#39;        =  1984.091&#39;</span><span class="p">,&amp;</span>
<a name="ln-9111"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9112"></a><span class="s1">&#39;   We conclude that the United States population should become zero&#39;</span><span class="p">,&amp;</span>
<a name="ln-9113"></a><span class="s1">&#39;   early in February of 1984.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9114"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9115"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9116"></a><span class="s1">&#39;PARTIAL DIFFERENTIAL EQUATION EXAMPLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-9117"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9118"></a><span class="s1">&#39;   Our second extended example is a boundary value problem for Laplace&#39;&#39;s&#39;</span><span class="p">,&amp;</span>
<a name="ln-9119"></a><span class="s1">&#39;   equation. The underlying physical problem involves the conductivity&#39;</span><span class="p">,&amp;</span>
<a name="ln-9120"></a><span class="s1">&#39;   of a medium with cylindrical inclusions and is considered by Keller&#39;</span><span class="p">,&amp;</span>
<a name="ln-9121"></a><span class="s1">&#39;   and Sachs [7].&#39;</span><span class="p">,&amp;</span>
<a name="ln-9122"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9123"></a><span class="s1">&#39;        Find a function  u(x,y)  satisfying Laplace&#39;&#39;s equation&#39;</span><span class="p">,&amp;</span>
<a name="ln-9124"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9125"></a><span class="s1">&#39;                  u   + u   = 0&#39;</span><span class="p">,&amp;</span>
<a name="ln-9126"></a><span class="s1">&#39;                   xx    yy&#39;</span><span class="p">,&amp;</span>
<a name="ln-9127"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9128"></a><span class="s1">&#39;   The domain is a unit square with a quarter circle of radius rho removed&#39;</span><span class="p">,&amp;</span>
<a name="ln-9129"></a><span class="s1">&#39;   from one corner. There are Neumann conditions on the top and bottom&#39;</span><span class="p">,&amp;</span>
<a name="ln-9130"></a><span class="s1">&#39;   edges and Dirichlet conditions on the remainder of the boundary.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9131"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9132"></a><span class="s1">&#39;                            u  = 0&#39;</span><span class="p">,&amp;</span>
<a name="ln-9133"></a><span class="s1">&#39;                             n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9134"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9135"></a><span class="s1">&#39;                        -------------&#39;</span><span class="p">,&amp;</span>
<a name="ln-9136"></a><span class="s1">&#39;                       |             .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9137"></a><span class="s1">&#39;                       |             .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9138"></a><span class="s1">&#39;                       |              .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9139"></a><span class="s1">&#39;                       |               .  u = 1&#39;</span><span class="p">,&amp;</span>
<a name="ln-9140"></a><span class="s1">&#39;                       |                 .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9141"></a><span class="s1">&#39;                       |                    .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9142"></a><span class="s1">&#39;                       |                       .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9143"></a><span class="s1">&#39;                u = 0  |                        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9144"></a><span class="s1">&#39;                       |                        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9145"></a><span class="s1">&#39;                       |                        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9146"></a><span class="s1">&#39;                       |                        |  u = 1&#39;</span><span class="p">,&amp;</span>
<a name="ln-9147"></a><span class="s1">&#39;                       |                        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9148"></a><span class="s1">&#39;                       |                        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9149"></a><span class="s1">&#39;                       |                        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9150"></a><span class="s1">&#39;                        ------------------------&#39;</span><span class="p">,&amp;</span>
<a name="ln-9151"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9152"></a><span class="s1">&#39;                                 u  = 0&#39;</span><span class="p">,&amp;</span>
<a name="ln-9153"></a><span class="s1">&#39;                                  n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9154"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9155"></a><span class="s1">&#39;   The effective conductivity of an medium is then given by the integral&#39;</span><span class="p">,&amp;</span>
<a name="ln-9156"></a><span class="s1">&#39;   along the left edge,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9157"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9158"></a><span class="s1">&#39;                               1&#39;</span><span class="p">,&amp;</span>
<a name="ln-9159"></a><span class="s1">&#39;                    sigma = integral  u (0,y) dy&#39;</span><span class="p">,&amp;</span>
<a name="ln-9160"></a><span class="s1">&#39;                              0        n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9161"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9162"></a><span class="s1">&#39;   It is of interest to study the relation between the radius rho and&#39;</span><span class="p">,&amp;</span>
<a name="ln-9163"></a><span class="s1">&#39;   the conductivity sigma. In particular, as rho approaches one, sigma&#39;</span><span class="p">,&amp;</span>
<a name="ln-9164"></a><span class="s1">&#39;   becomes infinite.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9165"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9166"></a><span class="s1">&#39;   Keller and Sachs use a finite difference approximation. The following&#39;</span><span class="p">,&amp;</span>
<a name="ln-9167"></a><span class="s1">&#39;   technique makes use of the fact that the equation is actually Laplace&#39;&#39;s&#39;</span><span class="p">,&amp;</span>
<a name="ln-9168"></a><span class="s1">&#39;   equation and leads to a much smaller matrix problem to solve.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9169"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9170"></a><span class="s1">&#39;        Consider an approximate solution of the form&#39;</span><span class="p">,&amp;</span>
<a name="ln-9171"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9172"></a><span class="s1">&#39;                    n      2j-1&#39;</span><span class="p">,&amp;</span>
<a name="ln-9173"></a><span class="s1">&#39;              u =  sum  c r    cos(2j-1)t&#39;</span><span class="p">,&amp;</span>
<a name="ln-9174"></a><span class="s1">&#39;                   j=1   j&#39;</span><span class="p">,&amp;</span>
<a name="ln-9175"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9176"></a><span class="s1">&#39;   where r,t are polar coordinates (t is theta). The coefficients are&#39;</span><span class="p">,&amp;</span>
<a name="ln-9177"></a><span class="s1">&#39;   to be determined. For any set of coefficients, this function already&#39;</span><span class="p">,&amp;</span>
<a name="ln-9178"></a><span class="s1">&#39;   satisfies the differential equation because the basis functions are&#39;</span><span class="p">,&amp;</span>
<a name="ln-9179"></a><span class="s1">&#39;   harmonic; it satisfies the normal derivative boundary condition on&#39;</span><span class="p">,&amp;</span>
<a name="ln-9180"></a><span class="s1">&#39;   the bottom edge of the domain because we used cos t in preference to&#39;</span><span class="p">,&amp;</span>
<a name="ln-9181"></a><span class="s1">&#39;   sin t ; and it satisfies the boundary condition on the left edge of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9182"></a><span class="s1">&#39;   the domain because we use only odd multiples of t .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9183"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9184"></a><span class="s1">&#39;   The computational task is to find coefficients so that the boundary&#39;</span><span class="p">,&amp;</span>
<a name="ln-9185"></a><span class="s1">&#39;   conditions on the remaining edges are satisfied as well as possible. To&#39;</span><span class="p">,&amp;</span>
<a name="ln-9186"></a><span class="s1">&#39;   accomplish this, pick m points (r,t) on the remaining edges. It is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9187"></a><span class="s1">&#39;   desirable to have m &gt; n and in practice we usually choose m to be two&#39;</span><span class="p">,&amp;</span>
<a name="ln-9188"></a><span class="s1">&#39;   or three times as large as n .  Typical values of n are 10 or 20 and&#39;</span><span class="p">,&amp;</span>
<a name="ln-9189"></a><span class="s1">&#39;   of m are 20 to 60. An m by n matrix A is generated. The i,j element&#39;</span><span class="p">,&amp;</span>
<a name="ln-9190"></a><span class="s1">&#39;   is the j-th basis function, or its normal derivative, evaluated at&#39;</span><span class="p">,&amp;</span>
<a name="ln-9191"></a><span class="s1">&#39;   the i-th boundary point. A right hand side with m components is also&#39;</span><span class="p">,&amp;</span>
<a name="ln-9192"></a><span class="s1">&#39;   generated. In this example, the elements of the right hand side are&#39;</span><span class="p">,&amp;</span>
<a name="ln-9193"></a><span class="s1">&#39;   either zero or one. The coefficients are then found by solving the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9194"></a><span class="s1">&#39;   overdetermined set of equations&#39;</span><span class="p">,&amp;</span>
<a name="ln-9195"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9196"></a><span class="s1">&#39;               Ac = b&#39;</span><span class="p">,&amp;</span>
<a name="ln-9197"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9198"></a><span class="s1">&#39;   in a least squares sense.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9199"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9200"></a><span class="s1">&#39;   Once the coefficients have been determined, the approximate solution&#39;</span><span class="p">,&amp;</span>
<a name="ln-9201"></a><span class="s1">&#39;   is defined everywhere on the domain. It is then possible to compute the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9202"></a><span class="s1">&#39;   effective conductivity sigma . In fact, a very simple formula results,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9203"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9204"></a><span class="s1">&#39;                        n       j-1&#39;</span><span class="p">,&amp;</span>
<a name="ln-9205"></a><span class="s1">&#39;              sigma =  sum  (-1)   c&#39;</span><span class="p">,&amp;</span>
<a name="ln-9206"></a><span class="s1">&#39;                       j=1          j&#39;</span><span class="p">,&amp;</span>
<a name="ln-9207"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9208"></a><span class="s1">&#39;   To use LALA for this problem, the following &quot;program&quot; is first stored&#39;</span><span class="p">,&amp;</span>
<a name="ln-9209"></a><span class="s1">&#39;   in the local computer file system, say under the name &quot;PDE&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9210"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9211"></a><span class="s1">&#39;      //Conductivity example.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9212"></a><span class="s1">&#39;      //Parameters ---&#39;</span><span class="p">,&amp;</span>
<a name="ln-9213"></a><span class="s1">&#39;         rho       //radius of cylindrical inclusion&#39;</span><span class="p">,&amp;</span>
<a name="ln-9214"></a><span class="s1">&#39;         n         //number of terms in solution&#39;</span><span class="p">,&amp;</span>
<a name="ln-9215"></a><span class="s1">&#39;         m         //number of boundary points&#39;</span><span class="p">,&amp;</span>
<a name="ln-9216"></a><span class="s1">&#39;      //initialize operation counter&#39;</span><span class="p">,&amp;</span>
<a name="ln-9217"></a><span class="s1">&#39;         flop = &lt;0 0&gt;;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9218"></a><span class="s1">&#39;      //initialize variables&#39;</span><span class="p">,&amp;</span>
<a name="ln-9219"></a><span class="s1">&#39;         m1 = round(m/3);   //number of points on each straight edge&#39;</span><span class="p">,&amp;</span>
<a name="ln-9220"></a><span class="s1">&#39;         m2 = m - m1;       //number of points with Dirichlet conditions&#39;</span><span class="p">,&amp;</span>
<a name="ln-9221"></a><span class="s1">&#39;         pi = 4*atan(1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9222"></a><span class="s1">&#39;      //generate points in Cartesian coordinates&#39;</span><span class="p">,&amp;</span>
<a name="ln-9223"></a><span class="s1">&#39;         //right hand edge&#39;</span><span class="p">,&amp;</span>
<a name="ln-9224"></a><span class="s1">&#39;         for i = 1:m1, x(i) = 1; y(i) = (1-rho)*(i-1)/(m1-1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9225"></a><span class="s1">&#39;         //top edge&#39;</span><span class="p">,&amp;</span>
<a name="ln-9226"></a><span class="s1">&#39;         for i = m2+1:m, x(i) = (1-rho)*(m-i)/(m-m2-1); y(i) = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9227"></a><span class="s1">&#39;         //circular edge&#39;</span><span class="p">,&amp;</span>
<a name="ln-9228"></a><span class="s1">&#39;         for i = m1+1:m2, t = pi/2*(i-m1)/(m2-m1+1); ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9229"></a><span class="s1">&#39;            x(i) = 1-rho*sin(t);  y(i) = 1-rho*cos(t);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9230"></a><span class="s1">&#39;      //convert to polar coordinates&#39;</span><span class="p">,&amp;</span>
<a name="ln-9231"></a><span class="s1">&#39;         for i = 1:m-1, th(i) = atan(y(i)/x(i));  ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9232"></a><span class="s1">&#39;            r(i) = sqrt(x(i)**2+y(i)**2);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9233"></a><span class="s1">&#39;         th(m) = pi/2;  r(m) = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9234"></a><span class="s1">&#39;      //generate matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-9235"></a><span class="s1">&#39;         //Dirichlet conditions&#39;</span><span class="p">,&amp;</span>
<a name="ln-9236"></a><span class="s1">&#39;         for i = 1:m2, for j = 1:n, k = 2*j-1; ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9237"></a><span class="s1">&#39;            a(i,j) = r(i)**k*cos(k*th(i));&#39;</span><span class="p">,&amp;</span>
<a name="ln-9238"></a><span class="s1">&#39;         //Neumann conditions&#39;</span><span class="p">,&amp;</span>
<a name="ln-9239"></a><span class="s1">&#39;         for i = m2+1:m, for j = 1:n, k = 2*j-1; ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9240"></a><span class="s1">&#39;            a(i,j) = k*r(i)**(k-1)*sin((k-1)*th(i));&#39;</span><span class="p">,&amp;</span>
<a name="ln-9241"></a><span class="s1">&#39;      //generate right hand side&#39;</span><span class="p">,&amp;</span>
<a name="ln-9242"></a><span class="s1">&#39;         for i = 1:m2, b(i) = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9243"></a><span class="s1">&#39;         for i = m2+1:m, b(i) = 0;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9244"></a><span class="s1">&#39;      //solve for coefficients&#39;</span><span class="p">,&amp;</span>
<a name="ln-9245"></a><span class="s1">&#39;         c = A\b&#39;</span><span class="p">,&amp;</span>
<a name="ln-9246"></a><span class="s1">&#39;      //compute effective conductivity&#39;</span><span class="p">,&amp;</span>
<a name="ln-9247"></a><span class="s1">&#39;         c(2:2:n) = -c(2:2:n);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9248"></a><span class="s1">&#39;         sigma = sum(c)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9249"></a><span class="s1">&#39;      //output total operation count&#39;</span><span class="p">,&amp;</span>
<a name="ln-9250"></a><span class="s1">&#39;         ops = flop(2)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9251"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9252"></a><span class="s1">&#39;   The program can be used within LALA by setting the three parameters&#39;</span><span class="p">,&amp;</span>
<a name="ln-9253"></a><span class="s1">&#39;   and then accessing the file. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9254"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9255"></a><span class="s1">&#39;      rho = .9;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9256"></a><span class="s1">&#39;      n = 15;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9257"></a><span class="s1">&#39;      m = 30;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9258"></a><span class="s1">&#39;      exec(&#39;&#39;PDE&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9259"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9260"></a><span class="s1">&#39;   The resulting output is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9261"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9262"></a><span class="s1">&#39;      rho   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9263"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9264"></a><span class="s1">&#39;         .9000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9265"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9266"></a><span class="s1">&#39;      n     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9267"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9268"></a><span class="s1">&#39;       15.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9269"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9270"></a><span class="s1">&#39;      m     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9271"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9272"></a><span class="s1">&#39;       30.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9273"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9274"></a><span class="s1">&#39;      c     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9275"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9276"></a><span class="s1">&#39;         2.2275&#39;</span><span class="p">,&amp;</span>
<a name="ln-9277"></a><span class="s1">&#39;        -2.2724&#39;</span><span class="p">,&amp;</span>
<a name="ln-9278"></a><span class="s1">&#39;         1.1448&#39;</span><span class="p">,&amp;</span>
<a name="ln-9279"></a><span class="s1">&#39;         0.1455&#39;</span><span class="p">,&amp;</span>
<a name="ln-9280"></a><span class="s1">&#39;        -0.1678&#39;</span><span class="p">,&amp;</span>
<a name="ln-9281"></a><span class="s1">&#39;        -0.0005&#39;</span><span class="p">,&amp;</span>
<a name="ln-9282"></a><span class="s1">&#39;        -0.3785&#39;</span><span class="p">,&amp;</span>
<a name="ln-9283"></a><span class="s1">&#39;         0.2299&#39;</span><span class="p">,&amp;</span>
<a name="ln-9284"></a><span class="s1">&#39;         0.3228&#39;</span><span class="p">,&amp;</span>
<a name="ln-9285"></a><span class="s1">&#39;        -0.2242&#39;</span><span class="p">,&amp;</span>
<a name="ln-9286"></a><span class="s1">&#39;        -0.1311&#39;</span><span class="p">,&amp;</span>
<a name="ln-9287"></a><span class="s1">&#39;         0.0924&#39;</span><span class="p">,&amp;</span>
<a name="ln-9288"></a><span class="s1">&#39;         0.0310&#39;</span><span class="p">,&amp;</span>
<a name="ln-9289"></a><span class="s1">&#39;        -0.0154&#39;</span><span class="p">,&amp;</span>
<a name="ln-9290"></a><span class="s1">&#39;        -0.0038&#39;</span><span class="p">,&amp;</span>
<a name="ln-9291"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9292"></a><span class="s1">&#39;      sigm  =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9293"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9294"></a><span class="s1">&#39;         5.0895&#39;</span><span class="p">,&amp;</span>
<a name="ln-9295"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9296"></a><span class="s1">&#39;      ops   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9297"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9298"></a><span class="s1">&#39;         16204.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9299"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9300"></a><span class="s1">&#39;   A total of 16204 floating point operations were necessary to set up the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9301"></a><span class="s1">&#39;   matrix, solve for the coefficients and compute the conductivity. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-9302"></a><span class="s1">&#39;   operation count is roughly proportional to m*n**2. The results obtained&#39;</span><span class="p">,&amp;</span>
<a name="ln-9303"></a><span class="s1">&#39;   for sigma as a function of rho by this approach are essentially the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9304"></a><span class="s1">&#39;   same as those obtained by the finite difference technique of Keller&#39;</span><span class="p">,&amp;</span>
<a name="ln-9305"></a><span class="s1">&#39;   and Sachs, but the computational effort involved is much less.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9306"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9307"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9308"></a><span class="s1">&#39;EIGENVALUE SENSITIVITY EXAMPLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-9309"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9310"></a><span class="s1">&#39;   In this example, we construct a matrix whose eigenvalues are moderately&#39;</span><span class="p">,&amp;</span>
<a name="ln-9311"></a><span class="s1">&#39;   sensitive to perturbations and then analyze that sensitivity. We&#39;</span><span class="p">,&amp;</span>
<a name="ln-9312"></a><span class="s1">&#39;   begin with the statement&#39;</span><span class="p">,&amp;</span>
<a name="ln-9313"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9314"></a><span class="s1">&#39;      B = &lt;3 0 7; 0 2 0; 0 0 1&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9315"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9316"></a><span class="s1">&#39;   which produces&#39;</span><span class="p">,&amp;</span>
<a name="ln-9317"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9318"></a><span class="s1">&#39;      B     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9319"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9320"></a><span class="s1">&#39;          3.    0.    7.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9321"></a><span class="s1">&#39;          0.    2.    0.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9322"></a><span class="s1">&#39;          0.    0.    1.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9323"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9324"></a><span class="s1">&#39;   Obviously, the eigenvalues of B are 1, 2 and 3 . Moreover, since&#39;</span><span class="p">,&amp;</span>
<a name="ln-9325"></a><span class="s1">&#39;   B is not symmetric, these eigenvalues are slightly sensitive to&#39;</span><span class="p">,&amp;</span>
<a name="ln-9326"></a><span class="s1">&#39;   perturbation. (The value b(1,3) = 7 was chosen so that the elements&#39;</span><span class="p">,&amp;</span>
<a name="ln-9327"></a><span class="s1">&#39;   of the matrix A below are less than 1000.)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9328"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9329"></a><span class="s1">&#39;   We now generate a similarity transformation to disguise the eigenvalues&#39;</span><span class="p">,&amp;</span>
<a name="ln-9330"></a><span class="s1">&#39;   and make them more sensitive.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9331"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9332"></a><span class="s1">&#39;      L = &lt;1 0 0; 2 1 0; -3 4 1&gt;, M = L\L&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9333"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9334"></a><span class="s1">&#39;      L     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9335"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9336"></a><span class="s1">&#39;          1.    0.    0.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9337"></a><span class="s1">&#39;          2.    1.    0.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9338"></a><span class="s1">&#39;         -3.    4.    1.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9339"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9340"></a><span class="s1">&#39;      M     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9341"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9342"></a><span class="s1">&#39;          1.0000    2.0000   -3.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9343"></a><span class="s1">&#39;         -2.0000   -3.0000   10.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9344"></a><span class="s1">&#39;         11.0000   18.0000  -48.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9345"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9346"></a><span class="s1">&#39;   The matrix M has determinant equal to 1 and is moderately badly&#39;</span><span class="p">,&amp;</span>
<a name="ln-9347"></a><span class="s1">&#39;   conditioned. The similarity transformation is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9348"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9349"></a><span class="s1">&#39;      A = M*B/M&#39;</span><span class="p">,&amp;</span>
<a name="ln-9350"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9351"></a><span class="s1">&#39;      A     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9352"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9353"></a><span class="s1">&#39;        -64.0000   82.0000   21.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9354"></a><span class="s1">&#39;        144.0000 -178.0000  -46.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9355"></a><span class="s1">&#39;       -771.0000  962.0000  248.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9356"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9357"></a><span class="s1">&#39;   Because det(M) = 1 , the elements of A would be exact integers&#39;</span><span class="p">,&amp;</span>
<a name="ln-9358"></a><span class="s1">&#39;   if there were no roundoff. So,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9359"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9360"></a><span class="s1">&#39;      A = round(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9361"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9362"></a><span class="s1">&#39;      A     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9363"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9364"></a><span class="s1">&#39;        -64.   82.   21.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9365"></a><span class="s1">&#39;        144. -178.  -46.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9366"></a><span class="s1">&#39;       -771.  962.  248.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9367"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9368"></a><span class="s1">&#39;   This, then, is our test matrix. We can now forget how it&#39;</span><span class="p">,&amp;</span>
<a name="ln-9369"></a><span class="s1">&#39;   was generated and analyze its eigenvalues.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9370"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9371"></a><span class="s1">&#39;      &lt;X,D&gt; = eig(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9372"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9373"></a><span class="s1">&#39;      D     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9374"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9375"></a><span class="s1">&#39;          3.0000    0.0000    0.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9376"></a><span class="s1">&#39;          0.0000    1.0000    0.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9377"></a><span class="s1">&#39;          0.0000    0.0000    2.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9378"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9379"></a><span class="s1">&#39;      X     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9380"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9381"></a><span class="s1">&#39;          -.0891    3.4903   41.8091&#39;</span><span class="p">,&amp;</span>
<a name="ln-9382"></a><span class="s1">&#39;           .1782   -9.1284  -62.7136&#39;</span><span class="p">,&amp;</span>
<a name="ln-9383"></a><span class="s1">&#39;          -.9800   46.4473  376.2818&#39;</span><span class="p">,&amp;</span>
<a name="ln-9384"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9385"></a><span class="s1">&#39;   Since A is similar to B, its eigenvalues are also 1, 2 and 3.  They&#39;</span><span class="p">,&amp;</span>
<a name="ln-9386"></a><span class="s1">&#39;   happen to be computed in another order by the EISPACK subroutines. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-9387"></a><span class="s1">&#39;   fact that the columns of X, which are the eigenvectors, are so far&#39;</span><span class="p">,&amp;</span>
<a name="ln-9388"></a><span class="s1">&#39;   from being orthonormal is our first indication that the eigenvalues&#39;</span><span class="p">,&amp;</span>
<a name="ln-9389"></a><span class="s1">&#39;   are sensitive. To see this sensitivity, we display more figures of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9390"></a><span class="s1">&#39;   the computed eigenvalues.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9391"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9392"></a><span class="s1">&#39;      long, diag(D)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9393"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9394"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9395"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9396"></a><span class="s1">&#39;         2.999999999973599&#39;</span><span class="p">,&amp;</span>
<a name="ln-9397"></a><span class="s1">&#39;         1.000000000015625&#39;</span><span class="p">,&amp;</span>
<a name="ln-9398"></a><span class="s1">&#39;         2.000000000011505&#39;</span><span class="p">,&amp;</span>
<a name="ln-9399"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9400"></a><span class="s1">&#39;   We see that, on this computer, the last five significant figures are&#39;</span><span class="p">,&amp;</span>
<a name="ln-9401"></a><span class="s1">&#39;   contaminated by roundoff error. A somewhat superficial explanation&#39;</span><span class="p">,&amp;</span>
<a name="ln-9402"></a><span class="s1">&#39;   of this is provided by&#39;</span><span class="p">,&amp;</span>
<a name="ln-9403"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9404"></a><span class="s1">&#39;      short,  cond(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9405"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9406"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9407"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9408"></a><span class="s1">&#39;         3.2216e+05&#39;</span><span class="p">,&amp;</span>
<a name="ln-9409"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9410"></a><span class="s1">&#39;   The condition number of X gives an upper bound for the relative&#39;</span><span class="p">,&amp;</span>
<a name="ln-9411"></a><span class="s1">&#39;   error in the computed eigenvalues. However, this condition&#39;</span><span class="p">,&amp;</span>
<a name="ln-9412"></a><span class="s1">&#39;   number is affected by scaling.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9413"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9414"></a><span class="s1">&#39;      X = X/diag(X(3,:)),  cond(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9415"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9416"></a><span class="s1">&#39;      X     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9417"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9418"></a><span class="s1">&#39;           .0909     .0751     .1111&#39;</span><span class="p">,&amp;</span>
<a name="ln-9419"></a><span class="s1">&#39;          -.1818    -.1965    -.1667&#39;</span><span class="p">,&amp;</span>
<a name="ln-9420"></a><span class="s1">&#39;          1.0000    1.0000    1.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9421"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9422"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9423"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9424"></a><span class="s1">&#39;         1.7692e+03&#39;</span><span class="p">,&amp;</span>
<a name="ln-9425"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9426"></a><span class="s1">&#39;   Rescaling the eigenvectors so that their last components are all&#39;</span><span class="p">,&amp;</span>
<a name="ln-9427"></a><span class="s1">&#39;   equal to one has two consequences. The condition of X is decreased&#39;</span><span class="p">,&amp;</span>
<a name="ln-9428"></a><span class="s1">&#39;   by over two orders of magnitude. (This is about the minimum condition&#39;</span><span class="p">,&amp;</span>
<a name="ln-9429"></a><span class="s1">&#39;   that can be obtained by such diagonal scaling.)  Moreover, it is now&#39;</span><span class="p">,&amp;</span>
<a name="ln-9430"></a><span class="s1">&#39;   apparent that the three eigenvectors are nearly parallel.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9431"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9432"></a><span class="s1">&#39;   More detailed information on the sensitivity of the individual&#39;</span><span class="p">,&amp;</span>
<a name="ln-9433"></a><span class="s1">&#39;   eigenvalues involves the left eigenvectors.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9434"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9435"></a><span class="s1">&#39;      Y = inv(X&#39;&#39;),  Y&#39;&#39;*A*X&#39;</span><span class="p">,&amp;</span>
<a name="ln-9436"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9437"></a><span class="s1">&#39;      Y     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9438"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9439"></a><span class="s1">&#39;       -511.5000  259.5000  252.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9440"></a><span class="s1">&#39;        616.0000 -346.0000 -270.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9441"></a><span class="s1">&#39;        159.5000  -86.5000  -72.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9442"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9443"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9444"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9445"></a><span class="s1">&#39;          3.0000     .0000     .0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9446"></a><span class="s1">&#39;           .0000    1.0000     .0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9447"></a><span class="s1">&#39;           .0000     .0000    2.0000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9448"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9449"></a><span class="s1">&#39;   We are now in a position to compute the sensitivities of the individual&#39;</span><span class="p">,&amp;</span>
<a name="ln-9450"></a><span class="s1">&#39;   eigenvalues.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9451"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9452"></a><span class="s1">&#39;      for j = 1:3, c(j) = norm(Y(:,j))*norm(X(:,j)); end,  C&#39;</span><span class="p">,&amp;</span>
<a name="ln-9453"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9454"></a><span class="s1">&#39;      C     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9455"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9456"></a><span class="s1">&#39;        833.1092&#39;</span><span class="p">,&amp;</span>
<a name="ln-9457"></a><span class="s1">&#39;        450.7228&#39;</span><span class="p">,&amp;</span>
<a name="ln-9458"></a><span class="s1">&#39;        383.7564&#39;</span><span class="p">,&amp;</span>
<a name="ln-9459"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9460"></a><span class="s1">&#39;   These three numbers are the reciprocals of the cosines of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9461"></a><span class="s1">&#39;   angles between the left and right eigenvectors. It can be shown that&#39;</span><span class="p">,&amp;</span>
<a name="ln-9462"></a><span class="s1">&#39;   perturbation of the elements of A can result in a perturbation of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9463"></a><span class="s1">&#39;   the j-th eigenvalue which is c(j) times as large.  In this example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9464"></a><span class="s1">&#39;   the first eigenvalue has the largest sensitivity.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9465"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9466"></a><span class="s1">&#39;   We now proceed to show that A is close to a matrix with a double&#39;</span><span class="p">,&amp;</span>
<a name="ln-9467"></a><span class="s1">&#39;   eigenvalue. The direction of the required perturbation is given by&#39;</span><span class="p">,&amp;</span>
<a name="ln-9468"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9469"></a><span class="s1">&#39;      E = -1.e-6*Y(:,1)*X(:,1)&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9470"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9471"></a><span class="s1">&#39;      E     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9472"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9473"></a><span class="s1">&#39;         1.0e-03 *&#39;</span><span class="p">,&amp;</span>
<a name="ln-9474"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9475"></a><span class="s1">&#39;           .0465    -.0930     .5115&#39;</span><span class="p">,&amp;</span>
<a name="ln-9476"></a><span class="s1">&#39;          -.0560     .1120    -.6160&#39;</span><span class="p">,&amp;</span>
<a name="ln-9477"></a><span class="s1">&#39;          -.0145     .0290    -.1595&#39;</span><span class="p">,&amp;</span>
<a name="ln-9478"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9479"></a><span class="s1">&#39;   With some trial and error which we do not show, we bracket the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9480"></a><span class="s1">&#39;   point where two eigenvalues of a perturbed A coalesce and then&#39;</span><span class="p">,&amp;</span>
<a name="ln-9481"></a><span class="s1">&#39;   become complex.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9482"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9483"></a><span class="s1">&#39;      eig(A + .4*E),  eig(A + .5*E)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9484"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9485"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9486"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9487"></a><span class="s1">&#39;          1.1500&#39;</span><span class="p">,&amp;</span>
<a name="ln-9488"></a><span class="s1">&#39;          2.5996&#39;</span><span class="p">,&amp;</span>
<a name="ln-9489"></a><span class="s1">&#39;          2.2504&#39;</span><span class="p">,&amp;</span>
<a name="ln-9490"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9491"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9492"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9493"></a><span class="s1">&#39;         2.4067 +  .1753*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9494"></a><span class="s1">&#39;         2.4067 -  .1753*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9495"></a><span class="s1">&#39;         1.1866 + 0.0000*i&#39;</span><span class="p">,&amp;</span>
<a name="ln-9496"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9497"></a><span class="s1">&#39;   Now, a bisecting search, driven by the imaginary part of one of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9498"></a><span class="s1">&#39;   the eigenvalues, finds the point where two eigenvalues are nearly&#39;</span><span class="p">,&amp;</span>
<a name="ln-9499"></a><span class="s1">&#39;   equal.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9500"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9501"></a><span class="s1">&#39;      r = .4;  s = .5;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9502"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9503"></a><span class="s1">&#39;      while s-r &gt; 1.e-14, t = (r+s)/2; d = eig(A+t*E); ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9504"></a><span class="s1">&#39;        if imag(d(1))=0, r = t; else, s = t;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9505"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9506"></a><span class="s1">&#39;      long,  T&#39;</span><span class="p">,&amp;</span>
<a name="ln-9507"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9508"></a><span class="s1">&#39;      T     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9509"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9510"></a><span class="s1">&#39;           .450380734134507&#39;</span><span class="p">,&amp;</span>
<a name="ln-9511"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9512"></a><span class="s1">&#39;   Finally, we display the perturbed matrix, which is obviously close&#39;</span><span class="p">,&amp;</span>
<a name="ln-9513"></a><span class="s1">&#39;   to the original, and its pair of nearly equal eigenvalues.  (We have&#39;</span><span class="p">,&amp;</span>
<a name="ln-9514"></a><span class="s1">&#39;   dropped a few digits from the long output.)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9515"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9516"></a><span class="s1">&#39;      A+t*E,  eig(A+t*E)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9517"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9518"></a><span class="s1">&#39;      A&#39;</span><span class="p">,&amp;</span>
<a name="ln-9519"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9520"></a><span class="s1">&#39;       -63.999979057   81.999958114   21.000230369&#39;</span><span class="p">,&amp;</span>
<a name="ln-9521"></a><span class="s1">&#39;       143.999974778 -177.999949557  -46.000277434&#39;</span><span class="p">,&amp;</span>
<a name="ln-9522"></a><span class="s1">&#39;      -771.000006530  962.000013061  247.999928164&#39;</span><span class="p">,&amp;</span>
<a name="ln-9523"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9524"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9525"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9526"></a><span class="s1">&#39;         2.415741150&#39;</span><span class="p">,&amp;</span>
<a name="ln-9527"></a><span class="s1">&#39;         2.415740621&#39;</span><span class="p">,&amp;</span>
<a name="ln-9528"></a><span class="s1">&#39;         1.168517777&#39;</span><span class="p">,&amp;</span>
<a name="ln-9529"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9530"></a><span class="s1">&#39;   The first two eigenvectors of A + t*E are almost indistinguishable&#39;</span><span class="p">,&amp;</span>
<a name="ln-9531"></a><span class="s1">&#39;   indicating that the perturbed matrix is almost defective.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9532"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9533"></a><span class="s1">&#39;      &lt;X,D&gt; = eig(A+t*E);  X = X/diag(X(3,:))&#39;</span><span class="p">,&amp;</span>
<a name="ln-9534"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9535"></a><span class="s1">&#39;      X     =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9536"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9537"></a><span class="s1">&#39;          .096019578     .096019586    .071608466&#39;</span><span class="p">,&amp;</span>
<a name="ln-9538"></a><span class="s1">&#39;         -.178329614    -.178329608   -.199190520&#39;</span><span class="p">,&amp;</span>
<a name="ln-9539"></a><span class="s1">&#39;         1.000000000    1.000000000   1.000000000&#39;</span><span class="p">,&amp;</span>
<a name="ln-9540"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9541"></a><span class="s1">&#39;      short,  cond(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9542"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9543"></a><span class="s1">&#39;      ans   =&#39;</span><span class="p">,&amp;</span>
<a name="ln-9544"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9545"></a><span class="s1">&#39;         3.3997e+09&#39;</span><span class="p">,&amp;</span>
<a name="ln-9546"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9547"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9548"></a><span class="s1">&#39;COMMUNICATING WITH OTHER PROGRAMS&#39;</span><span class="p">,&amp;</span>
<a name="ln-9549"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9550"></a><span class="s1">&#39;   There are four different ways LALA can be used in&#39;</span><span class="p">,&amp;</span>
<a name="ln-9551"></a><span class="s1">&#39;   conjunction with other programs:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9552"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9553"></a><span class="s1">&#39;      -- user() - a user-supplied subroutine&#39;</span><span class="p">,&amp;</span>
<a name="ln-9554"></a><span class="s1">&#39;      -- exec() - reading commands from a file&#39;</span><span class="p">,&amp;</span>
<a name="ln-9555"></a><span class="s1">&#39;      -- save() and load() -- reading specially formatted data files.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9556"></a><span class="s1">&#39;      -- lala() - call the interpreter with a CHARACTER array of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9557"></a><span class="s1">&#39;                  commands or interactively.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9558"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9559"></a><span class="s1">&#39;   Let us illustrate each of these by equivalents of the following&#39;</span><span class="p">,&amp;</span>
<a name="ln-9560"></a><span class="s1">&#39;   simple example.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9561"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9562"></a><span class="s1">&#39;   You can start the lala(1) program up and simply enter:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9563"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9564"></a><span class="s1">&#39;         n = 6&#39;</span><span class="p">,&amp;</span>
<a name="ln-9565"></a><span class="s1">&#39;         for i = 1:n, for j = 1:n, a(i,j) = abs(i-j);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9566"></a><span class="s1">&#39;         a&#39;</span><span class="p">,&amp;</span>
<a name="ln-9567"></a><span class="s1">&#39;         x = inv(a)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9568"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9569"></a><span class="s1">&#39;   An example user routine could be introduced into LALA that&#39;</span><span class="p">,&amp;</span>
<a name="ln-9570"></a><span class="s1">&#39;   does the same thing as the &quot;for&quot; statement by compiling and&#39;</span><span class="p">,&amp;</span>
<a name="ln-9571"></a><span class="s1">&#39;   linking the following subroutine into the calling program.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9572"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9573"></a><span class="s1">&#39;         program demo_user&#39;</span><span class="p">,&amp;</span>
<a name="ln-9574"></a><span class="s1">&#39;         implicit none&#39;</span><span class="p">,&amp;</span>
<a name="ln-9575"></a><span class="s1">&#39;         use M_matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-9576"></a><span class="s1">&#39;         call set_usersub(lala_user)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9577"></a><span class="s1">&#39;         call lala()&#39;</span><span class="p">,&amp;</span>
<a name="ln-9578"></a><span class="s1">&#39;         subroutine lala_user(a,m,n,s,t)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9579"></a><span class="s1">&#39;            implicit none&#39;</span><span class="p">,&amp;</span>
<a name="ln-9580"></a><span class="s1">&#39;            doubleprecision a(:),s,t&#39;</span><span class="p">,&amp;</span>
<a name="ln-9581"></a><span class="s1">&#39;            integer m,n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9582"></a><span class="s1">&#39;            n = int(a(1))&#39;</span><span class="p">,&amp;</span>
<a name="ln-9583"></a><span class="s1">&#39;            m = n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9584"></a><span class="s1">&#39;            do j = 1, n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9585"></a><span class="s1">&#39;               do i = 1, n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9586"></a><span class="s1">&#39;                  k = i + (j-1)*m&#39;</span><span class="p">,&amp;</span>
<a name="ln-9587"></a><span class="s1">&#39;                  a(k) = iabs(i-j)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9588"></a><span class="s1">&#39;               enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9589"></a><span class="s1">&#39;            enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9590"></a><span class="s1">&#39;            end subroutine lala_user&#39;</span><span class="p">,&amp;</span>
<a name="ln-9591"></a><span class="s1">&#39;         end program demo_user&#39;</span><span class="p">,&amp;</span>
<a name="ln-9592"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9593"></a><span class="s1">&#39;   A user-defined function can then be registered with the program&#39;</span><span class="p">,&amp;</span>
<a name="ln-9594"></a><span class="s1">&#39;   with&#39;</span><span class="p">,&amp;</span>
<a name="ln-9595"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9596"></a><span class="s1">&#39;           call set_usersub(SUBROUTINE_NAME)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9597"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9598"></a><span class="s1">&#39;   Note the routine must be defined with an explicit interface&#39;</span><span class="p">,&amp;</span>
<a name="ln-9599"></a><span class="s1">&#39;   available in the calling unit.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9600"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9601"></a><span class="s1">&#39;   Then the LALA statements&#39;</span><span class="p">,&amp;</span>
<a name="ln-9602"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9603"></a><span class="s1">&#39;         n = 6&#39;</span><span class="p">,&amp;</span>
<a name="ln-9604"></a><span class="s1">&#39;         a = user(n)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9605"></a><span class="s1">&#39;         x = inv(a)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9606"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9607"></a><span class="s1">&#39;   do the job.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9608"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9609"></a><span class="s1">&#39;   The example procedure could be called by storing the following&#39;</span><span class="p">,&amp;</span>
<a name="ln-9610"></a><span class="s1">&#39;   text in a file named, say, EXAMPLE.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9611"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9612"></a><span class="s1">&#39;         for i = 1:n, for j = 1:n, a(i,j) = abs(i-j);&#39;</span><span class="p">,&amp;</span>
<a name="ln-9613"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9614"></a><span class="s1">&#39;   Then the LALA statements&#39;</span><span class="p">,&amp;</span>
<a name="ln-9615"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9616"></a><span class="s1">&#39;         n = 6&#39;</span><span class="p">,&amp;</span>
<a name="ln-9617"></a><span class="s1">&#39;         exec(&#39;&#39;EXAMPLE&#39;&#39;,0)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9618"></a><span class="s1">&#39;         x = inv(a)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9619"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9620"></a><span class="s1">&#39;   have the desired effect. The 0 as the optional second parameter&#39;</span><span class="p">,&amp;</span>
<a name="ln-9621"></a><span class="s1">&#39;   of exec indicates that the text in the file should not be printed&#39;</span><span class="p">,&amp;</span>
<a name="ln-9622"></a><span class="s1">&#39;   on the terminal.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9623"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9624"></a><span class="s1">&#39;   The matrices A and X could also be stored in files. Two&#39;</span><span class="p">,&amp;</span>
<a name="ln-9625"></a><span class="s1">&#39;   separate main programs would be involved. The first is:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9626"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9627"></a><span class="s1">&#39;            program maina&#39;</span><span class="p">,&amp;</span>
<a name="ln-9628"></a><span class="s1">&#39;            doubleprecision a(10,10)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9629"></a><span class="s1">&#39;            n = 6&#39;</span><span class="p">,&amp;</span>
<a name="ln-9630"></a><span class="s1">&#39;            do j = 1, n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9631"></a><span class="s1">&#39;               do i = 1, n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9632"></a><span class="s1">&#39;                  a(i,j) = iabs(i-j)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9633"></a><span class="s1">&#39;               enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9634"></a><span class="s1">&#39;            enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9635"></a><span class="s1">&#39;            OPEN(UNIT=1,FILE=&#39;&#39;A&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9636"></a><span class="s1">&#39;            write(1,&#39;&#39;(a32,2i4)&#39;&#39;) &#39;&#39;a&#39;&#39;, n,n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9637"></a><span class="s1">&#39;            do j = 1, n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9638"></a><span class="s1">&#39;               write(1,102) (a(i,j),i=1,n)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9639"></a><span class="s1">&#39;            enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9640"></a><span class="s1">&#39;        102 format(4z18)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9641"></a><span class="s1">&#39;            end program maina&#39;</span><span class="p">,&amp;</span>
<a name="ln-9642"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9643"></a><span class="s1">&#39;   The OPEN statement may take different forms on different systems.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9644"></a><span class="s1">&#39;   It attaches Fortran logical unit number 1 to the file named A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9645"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9646"></a><span class="s1">&#39;   The FORMAT number 102 may also be system dependent. This&#39;</span><span class="p">,&amp;</span>
<a name="ln-9647"></a><span class="s1">&#39;   particular one is appropriate for hexadecimal computers with an 8&#39;</span><span class="p">,&amp;</span>
<a name="ln-9648"></a><span class="s1">&#39;   byte double precision floating point word. Check, or modify,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9649"></a><span class="s1">&#39;   LALA subroutine SAVLOD.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9650"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9651"></a><span class="s1">&#39;   After this program is executed, enter LALA and give the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9652"></a><span class="s1">&#39;   following statements:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9653"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9654"></a><span class="s1">&#39;         load(&#39;&#39;A&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9655"></a><span class="s1">&#39;         X = inv(a)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9656"></a><span class="s1">&#39;         save(&#39;&#39;X&#39;&#39;,X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9657"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9658"></a><span class="s1">&#39;   If all goes according to plan, this will read the matrix &quot;a&quot; from&#39;</span><span class="p">,&amp;</span>
<a name="ln-9659"></a><span class="s1">&#39;   the file A, invert it, store the inverse in X and then write the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9660"></a><span class="s1">&#39;   matrix X on the file X. The following program can then access X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9661"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9662"></a><span class="s1">&#39;            program mainx&#39;</span><span class="p">,&amp;</span>
<a name="ln-9663"></a><span class="s1">&#39;            doubleprecision x(10,10)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9664"></a><span class="s1">&#39;            open(unit=1,file=&#39;&#39;x&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9665"></a><span class="s1">&#39;            rewind 1&#39;</span><span class="p">,&amp;</span>
<a name="ln-9666"></a><span class="s1">&#39;            read (1, &#39;&#39;(a32,2i4)&#39;&#39;) id,m,n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9667"></a><span class="s1">&#39;            do j = 1, n&#39;</span><span class="p">,&amp;</span>
<a name="ln-9668"></a><span class="s1">&#39;               read(1,&#39;&#39;(4z18)&#39;&#39;) (x(i,j),i=1,m)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9669"></a><span class="s1">&#39;            enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9670"></a><span class="s1">&#39;            ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9671"></a><span class="s1">&#39;            ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9672"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9673"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9674"></a><span class="s1">&#39;   The most elaborate mechanism involves using LALA as a subroutine&#39;</span><span class="p">,&amp;</span>
<a name="ln-9675"></a><span class="s1">&#39;   within another program. Communication with the LALA stack is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9676"></a><span class="s1">&#39;   accomplished using subroutine lala().&#39;</span><span class="p">,&amp;</span>
<a name="ln-9677"></a><span class="s1">&#39;    The preamble of MATZ is:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9678"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9679"></a><span class="s1">&#39;         SUBROUTINE MATZ(A,LDA,M,N,ID,JOB,IERR)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9680"></a><span class="s1">&#39;         INTEGER LDA,M,N,JOB,IERR&#39;</span><span class="p">,&amp;</span>
<a name="ln-9681"></a><span class="s1">&#39;         character(len=*) :: id&#39;</span><span class="p">,&amp;</span>
<a name="ln-9682"></a><span class="s1">&#39;         DOUBLEPRECISION A(LDA,N)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9683"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9684"></a><span class="s1">&#39;         ! ACCESS LALA VARIABLE STACK&#39;</span><span class="p">,&amp;</span>
<a name="ln-9685"></a><span class="s1">&#39;         ! A IS AN M BY N MATRIX, STORED IN AN ARRAY WITH&#39;</span><span class="p">,&amp;</span>
<a name="ln-9686"></a><span class="s1">&#39;         !     LEADING DIMENSION LDA.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9687"></a><span class="s1">&#39;         ! ID IS THE NAME OF A. ID IS UP TO FOUR CHARACTERS.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9688"></a><span class="s1">&#39;         ! JOB =  0  GET REAL A FROM LALA,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9689"></a><span class="s1">&#39;         !     =  1  PUT REAL A INTO LALA,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9690"></a><span class="s1">&#39;         !     = 10  GET IMAG PART OF A FROM LALA,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9691"></a><span class="s1">&#39;         !     = 11  PUT IMAG PART OF A INTO LALA.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9692"></a><span class="s1">&#39;         ! RETURN WITH NONZERO IERR AFTER LALA ERROR MESSAGE.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9693"></a><span class="s1">&#39;         !&#39;</span><span class="p">,&amp;</span>
<a name="ln-9694"></a><span class="s1">&#39;         ! USES LALA ROUTINES STACKG, STACKP AND ERROR&#39;</span><span class="p">,&amp;</span>
<a name="ln-9695"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9696"></a><span class="s1">&#39;        The preamble of subroutine LALA is:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9697"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9698"></a><span class="s1">&#39;         SUBROUTINE LALA(INIT)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9699"></a><span class="s1">&#39;         ! INIT = 0 FOR FIRST ENTRY, NONZERO FOR SUBSEQUENT ENTRIES&#39;</span><span class="p">,&amp;</span>
<a name="ln-9700"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9701"></a><span class="s1">&#39;        To do our example, write the following program:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9702"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9703"></a><span class="s1">&#39;            DOUBLEPRECISION A(10,10),X(10,10)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9704"></a><span class="s1">&#39;            DATA LDA/10/&#39;</span><span class="p">,&amp;</span>
<a name="ln-9705"></a><span class="s1">&#39;            call M_88(0,&#39;&#39;&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9706"></a><span class="s1">&#39;            N = 6&#39;</span><span class="p">,&amp;</span>
<a name="ln-9707"></a><span class="s1">&#39;            DO J = 1, N&#39;</span><span class="p">,&amp;</span>
<a name="ln-9708"></a><span class="s1">&#39;               DO I = 1, N&#39;</span><span class="p">,&amp;</span>
<a name="ln-9709"></a><span class="s1">&#39;                  A(I,J) = IABS(I-J)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9710"></a><span class="s1">&#39;               enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9711"></a><span class="s1">&#39;            enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-9712"></a><span class="s1">&#39;            call MATZ(A,LDA,N,N,&#39;&#39;A&#39;&#39;,1,IERR)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9713"></a><span class="s1">&#39;            IF (IERR .NE. 0) GO TO ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9714"></a><span class="s1">&#39;            call LALA(1,&#39;&#39;&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9715"></a><span class="s1">&#39;            call MATZ(X,LDA,N,N,&#39;&#39;X&#39;&#39;,0,IERR)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9716"></a><span class="s1">&#39;            IF (IERR .NE. 0) GO TO ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9717"></a><span class="s1">&#39;            ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9718"></a><span class="s1">&#39;            ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-9719"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9720"></a><span class="s1">&#39;   When this program is executed, the call to LALA(0) produces the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9721"></a><span class="s1">&#39;   LALA greeting, then waits for input. The command&#39;</span><span class="p">,&amp;</span>
<a name="ln-9722"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9723"></a><span class="s1">&#39;            quit&#39;</span><span class="p">,&amp;</span>
<a name="ln-9724"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9725"></a><span class="s1">&#39;   sends control back to our example program. The matrix A is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9726"></a><span class="s1">&#39;   generated by the program and sent to the stack by the first call&#39;</span><span class="p">,&amp;</span>
<a name="ln-9727"></a><span class="s1">&#39;   to MATZ. The call to LALA(1) produces the LALA(1) prompt. Then&#39;</span><span class="p">,&amp;</span>
<a name="ln-9728"></a><span class="s1">&#39;   the statements&#39;</span><span class="p">,&amp;</span>
<a name="ln-9729"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9730"></a><span class="s1">&#39;            X = inv(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9731"></a><span class="s1">&#39;            quit&#39;</span><span class="p">,&amp;</span>
<a name="ln-9732"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9733"></a><span class="s1">&#39;   will invert our matrix, put the result on the stack and go back&#39;</span><span class="p">,&amp;</span>
<a name="ln-9734"></a><span class="s1">&#39;   to our program. The second call to MATZ will retrieve X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9735"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9736"></a><span class="s1">&#39;   By the way, this matrix X is interesting. Take a look at&#39;</span><span class="p">,&amp;</span>
<a name="ln-9737"></a><span class="s1">&#39;   round(2*(n-1)*X).&#39;</span><span class="p">,&amp;</span>
<a name="ln-9738"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9739"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9740"></a><span class="s1">&#39;ACKNOWLEDGEMENT&#39;</span><span class="p">,&amp;</span>
<a name="ln-9741"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9742"></a><span class="s1">&#39;   LALA was inspired by the MATLAB subroutine.  Most of the work on&#39;</span><span class="p">,&amp;</span>
<a name="ln-9743"></a><span class="s1">&#39;   MATLAB was carried out at the University of New Mexico, where it was&#39;</span><span class="p">,&amp;</span>
<a name="ln-9744"></a><span class="s1">&#39;   being supported by the National Science Foundation. Additional work&#39;</span><span class="p">,&amp;</span>
<a name="ln-9745"></a><span class="s1">&#39;   has been done during visits to Stanford Linear Accelerator Center,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9746"></a><span class="s1">&#39;   Argonne National Laboratory and Los Alamos Scientific Laboratory,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9747"></a><span class="s1">&#39;   where support has been provided by NSF and the Department of Energy.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9748"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9749"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9750"></a><span class="s1">&#39;REFERENCES FOR THE MATLAB ROUTINE&#39;</span><span class="p">,&amp;</span>
<a name="ln-9751"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9752"></a><span class="s1">&#39; [1]  J. J. Dongarra, J. R. Bunch, C. B. Moler and G. W. Stewart,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9753"></a><span class="s1">&#39;      LINPACK Users&#39;&#39; Guide, Society for Industrial and Applied&#39;</span><span class="p">,&amp;</span>
<a name="ln-9754"></a><span class="s1">&#39;      Mathematics, Philadelphia, 1979.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9755"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9756"></a><span class="s1">&#39; [2]  B. T. Smith, J. M. Boyle, J. J. Dongarra, B. S. Garbow, Y.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9757"></a><span class="s1">&#39;      Ikebe, V. C. Klema, C. B. Moler, Matrix Eigensystem Routines&#39;</span><span class="p">,&amp;</span>
<a name="ln-9758"></a><span class="s1">&#39;      -- EISPACK Guide, Lecture Notes in Computer Science, volume&#39;</span><span class="p">,&amp;</span>
<a name="ln-9759"></a><span class="s1">&#39;      6, second edition, Springer-Verlag, 1976.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9760"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9761"></a><span class="s1">&#39; [3]  B. S. Garbow, J. M. Boyle, J. J. Dongarra, C. B. Moler,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9762"></a><span class="s1">&#39;      Matrix Eigensystem Routines -- EISPACK Guide Extension,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9763"></a><span class="s1">&#39;      Lecture Notes in Computer Science, volume 51, Springer-&#39;</span><span class="p">,&amp;</span>
<a name="ln-9764"></a><span class="s1">&#39;      Verlag, 1977.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9765"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9766"></a><span class="s1">&#39; [4]  S. Cohen and S. Piper, SPEAKEASY III Reference Manual,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9767"></a><span class="s1">&#39;      Speakeasy Computing Corp., Chicago, Ill., 1979.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9768"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9769"></a><span class="s1">&#39; [5]  J. H. Wilkinson and C. Reinsch, Handbook for Automatic&#39;</span><span class="p">,&amp;</span>
<a name="ln-9770"></a><span class="s1">&#39;      Computation, volume II, Linear Algebra, Springer-Verlag,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9771"></a><span class="s1">&#39;     1971.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9772"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9773"></a><span class="s1">&#39; [6]  Niklaus Wirth, Algorithms + Data Structures = Programs,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9774"></a><span class="s1">&#39;      Prentice-Hall, 1976.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9775"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9776"></a><span class="s1">&#39; [7]  H. B. Keller and D. Sachs, &quot;Calculations of the Conductivity&#39;</span><span class="p">,&amp;</span>
<a name="ln-9777"></a><span class="s1">&#39;      of a Medium Containing Cylindrical Inclusions&quot;, J. Applied&#39;</span><span class="p">,&amp;</span>
<a name="ln-9778"></a><span class="s1">&#39;      Physics 35, 537-538, 1964.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9779"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9780"></a><span class="s1">&#39; [8]  C. B. Moler and C. F. Van Loan, Nineteen Dubious Ways to&#39;</span><span class="p">,&amp;</span>
<a name="ln-9781"></a><span class="s1">&#39;      Compute the Exponential of a Matrix, SIAM Review 20, 801-&#39;</span><span class="p">,&amp;</span>
<a name="ln-9782"></a><span class="s1">&#39;      836, 1979.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9783"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9784"></a><span class="s1">&#39; [9]  G. E. Forsythe, M. A. Malcolm and C. B. Moler, Computer&#39;</span><span class="p">,&amp;</span>
<a name="ln-9785"></a><span class="s1">&#39;      Methods for Mathematical Computations, Prentice-Hall, 1977.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9786"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9787"></a><span class="s1">&#39; [10] C. B. Moler and D. R. Morrison, &quot;Replacing square roots by&#39;</span><span class="p">,&amp;</span>
<a name="ln-9788"></a><span class="s1">&#39;      Pythagorean sums&quot;, University of New Mexico, Computer&#39;</span><span class="p">,&amp;</span>
<a name="ln-9789"></a><span class="s1">&#39;      Science Department, technical report, submitted for&#39;</span><span class="p">,&amp;</span>
<a name="ln-9790"></a><span class="s1">&#39;     publication, 1980.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9791"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9792"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9793"></a><span class="s1">&#39;SUMMARY    A list of basic (case-sensitive) section and topic names&#39;</span><span class="p">,&amp;</span>
<a name="ln-9794"></a><span class="s1">&#39;   .______________._________________________________________________________.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9795"></a><span class="s1">&#39;   |SYNTAX        | [ ] &lt; &gt; ( ) = .  , !  ; \ / &#39;&#39;&#39;&#39; + - * : semi ?           |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9796"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9797"></a><span class="s1">&#39;   |VARIABLES     | ans    clear who                                        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9798"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9799"></a><span class="s1">&#39;   |BASIC         | atan   cos   exp    log    sin      sqrt                |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9800"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9801"></a><span class="s1">&#39;   |HIGH          | abs    base  chol   chop   cond     conjg  det    diag  |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9802"></a><span class="s1">&#39;   |              | eig    eye   hess   invh   imag     inv    kron   lu    |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9803"></a><span class="s1">&#39;   |              | magic  norm  ones   orth   pinv     poly   prod   qr    |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9804"></a><span class="s1">&#39;   |              | rand   rank  rcond  rat    real     rref   roots  round |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9805"></a><span class="s1">&#39;   |              | schur  shape sum    svd    tril     triu   user   zeros |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9806"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9807"></a><span class="s1">&#39;   |FLOW control  | else   end   if     for    while    exit   quit         |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9808"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9809"></a><span class="s1">&#39;   |FILE access   | exec   load  print  save   delete                       |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9810"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9811"></a><span class="s1">&#39;   |OUTPUT options| lines  long  short  diary  display  plot                |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9812"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9813"></a><span class="s1">&#39;   |ENVIRONMENT   | getenv                                                  |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9814"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9815"></a><span class="s1">&#39;   |DOCUMENTATION | help   fhelp  NEWS                                      |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9816"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9817"></a><span class="s1">&#39;   |MISCELLANEOUS | eps    debug  flops sh     MACROS   EDIT   CHARS        |&#39;</span><span class="p">,&amp;</span>
<a name="ln-9818"></a><span class="s1">&#39;   |______________._________________________________________________________|&#39;</span><span class="p">,&amp;</span>
<a name="ln-9819"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9820"></a><span class="s1">&#39;SAMPLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-9821"></a><span class="s1">&#39;      Here are a few sample statements:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9822"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9823"></a><span class="s1">&#39;       A = &lt;1 2; 3 4&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9824"></a><span class="s1">&#39;       b = &lt;5 6&gt;&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9825"></a><span class="s1">&#39;       x = A\b&#39;</span><span class="p">,&amp;</span>
<a name="ln-9826"></a><span class="s1">&#39;       &lt;V,D&gt; = eig(A),  norm(A-V*D/V)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9827"></a><span class="s1">&#39;       help \ , help eig&#39;</span><span class="p">,&amp;</span>
<a name="ln-9828"></a><span class="s1">&#39;       exec(&#39;&#39;demo&#39;&#39;,7)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9829"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9830"></a><span class="s1">&#39;      For more information, generate the LALA Users&#39;&#39; Guide&#39;</span><span class="p">,&amp;</span>
<a name="ln-9831"></a><span class="s1">&#39;      using&#39;</span><span class="p">,&amp;</span>
<a name="ln-9832"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9833"></a><span class="s1">&#39;        help manual&#39;</span><span class="p">,&amp;</span>
<a name="ln-9834"></a><span class="s1">&#39;        w help.txt&#39;</span><span class="p">,&amp;</span>
<a name="ln-9835"></a><span class="s1">&#39;        q&#39;</span><span class="p">,&amp;</span>
<a name="ln-9836"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9837"></a><span class="s1">&#39;DOCUMENTATION&#39;</span><span class="p">,&amp;</span>
<a name="ln-9838"></a><span class="s1">&#39;fhelp topic|SECTION_NAME&#39;</span><span class="p">,&amp;</span>
<a name="ln-9839"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9840"></a><span class="s1">&#39;      &quot;fhelp&quot; is identical in usage to &quot;help&quot; except that it searches a&#39;</span><span class="p">,&amp;</span>
<a name="ln-9841"></a><span class="s1">&#39;      collection of descriptions of Fortran intrinsics.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9842"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9843"></a><span class="s1">&#39;        fhelp verify&#39;</span><span class="p">,&amp;</span>
<a name="ln-9844"></a><span class="s1">&#39;        fhelp pack&#39;</span><span class="p">,&amp;</span>
<a name="ln-9845"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9846"></a><span class="s1">&#39;      See &quot;help&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9847"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9848"></a><span class="s1">&#39;help  topic|SECTION_NAME&#39;</span><span class="p">,&amp;</span>
<a name="ln-9849"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9850"></a><span class="s1">&#39;      &quot;help&quot; gives assistance. It is equivalent to &quot;help SUMMARY&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9851"></a><span class="s1">&#39;      by default.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9852"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9853"></a><span class="s1">&#39;      o  &quot;help&quot; with no options lists common topic and section names.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9854"></a><span class="s1">&#39;      o  The special topic &quot;topics&quot; shows all topic lines.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9855"></a><span class="s1">&#39;      o  The special topic &quot;manual&quot; displays all the help text.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9856"></a><span class="s1">&#39;      o  The special topic &quot;search&quot; shows lines from the manual&#39;</span><span class="p">,&amp;</span>
<a name="ln-9857"></a><span class="s1">&#39;         containing the subsequent string&#39;</span><span class="p">,&amp;</span>
<a name="ln-9858"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9859"></a><span class="s1">&#39;         Enter &quot;h&quot; at the &quot;continue ...&quot; prompt for additional options.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9860"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9861"></a><span class="s1">&#39;      For example:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9862"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9863"></a><span class="s1">&#39;         help        // a list of common topics and section names&#39;</span><span class="p">,&amp;</span>
<a name="ln-9864"></a><span class="s1">&#39;         help topics // a list of topics including the first line of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9865"></a><span class="s1">&#39;                     // the topic.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9866"></a><span class="s1">&#39;         help abs    // produces help on the function &quot;abs&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9867"></a><span class="s1">&#39;         help FLOW   // the entire section on flow control is displayed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9868"></a><span class="s1">&#39;         help manual // show all the help text&#39;</span><span class="p">,&amp;</span>
<a name="ln-9869"></a><span class="s1">&#39;         help help   // obviously prints this message.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9870"></a><span class="s1">&#39;         help search factor // show all lines containing &quot;factor&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9871"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9872"></a><span class="s1">&#39;      Alternatively, To place all the documenation in a file, use&#39;</span><span class="p">,&amp;</span>
<a name="ln-9873"></a><span class="s1">&#39;      &quot;help manual&quot; and enter &quot;w help.txt&quot; at the &quot;continue ..&quot; prompt.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9874"></a><span class="s1">&#39;NEWS&#39;</span><span class="p">,&amp;</span>
<a name="ln-9875"></a><span class="s1">&#39;      LALA is intended to be used primarily by families of FORTRAN&#39;</span><span class="p">,&amp;</span>
<a name="ln-9876"></a><span class="s1">&#39;      programs that wish to add a consistent interactive &quot;calculator&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9877"></a><span class="s1">&#39;      mode for interactively inspecting and modifying data.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9878"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9879"></a><span class="s1">&#39;      May, 1981.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9880"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9881"></a><span class="s1">&#39;      This is a port of the Argonne National Lab. FORTRAN 77 MATLAB&#39;</span><span class="p">,&amp;</span>
<a name="ln-9882"></a><span class="s1">&#39;      routine circa 1981.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9883"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9884"></a><span class="s1">&#39;      Mar, 1990.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9885"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9886"></a><span class="s1">&#39;      Input lines can now be recalled and edited.  A &quot;??&quot; on a line by&#39;</span><span class="p">,&amp;</span>
<a name="ln-9887"></a><span class="s1">&#39;      itself calls the command history mode. Enter &quot;?&quot; after entering&#39;</span><span class="p">,&amp;</span>
<a name="ln-9888"></a><span class="s1">&#39;      the mode for details.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9889"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9890"></a><span class="s1">&#39;      Apr, 2021.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9891"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9892"></a><span class="s1">&#39;      Rewritten but largely true to the original documentation.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9893"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9894"></a><span class="s1">&#39;what  does nothing for now&#39;</span><span class="p">,&amp;</span>
<a name="ln-9895"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9896"></a><span class="s1">&#39;sh    Starts the command shell interactively, using the command defined by&#39;</span><span class="p">,&amp;</span>
<a name="ln-9897"></a><span class="s1">&#39;      the environment variable SHELL. Note that in addition any line&#39;</span><span class="p">,&amp;</span>
<a name="ln-9898"></a><span class="s1">&#39;      starting with an exclamation (!) is passed to the system for&#39;</span><span class="p">,&amp;</span>
<a name="ln-9899"></a><span class="s1">&#39;      execution.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9900"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-9901"></a><span class="s1">&#39;SYNTAX&#39;</span><span class="p">,&amp;</span>
<a name="ln-9902"></a><span class="s1">&#39;[     See &quot;&lt;&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9903"></a><span class="s1">&#39;]     See &quot;&lt;&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9904"></a><span class="s1">&#39;&gt;     See &quot;&lt;&quot; . Also see MACROS.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9905"></a><span class="s1">&#39;&lt;     &lt; &gt; or [ ] are brackets used in forming vectors and matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9906"></a><span class="s1">&#39;      &quot;&lt;6.9 9.64 sqrt(-1)&gt;&quot; is a vector with three elements separated by&#39;</span><span class="p">,&amp;</span>
<a name="ln-9907"></a><span class="s1">&#39;      blanks. &quot;[1+I 2-I 3]&quot; and &quot;[1 +I 2 -I 3]&quot; are not the same. The&#39;</span><span class="p">,&amp;</span>
<a name="ln-9908"></a><span class="s1">&#39;      first has three elements, the second has five.  &lt;11 12 13; 21 22&#39;</span><span class="p">,&amp;</span>
<a name="ln-9909"></a><span class="s1">&#39;      23&gt; is a 2 by 3 matrix. The semicolon ends the first row.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9910"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9911"></a><span class="s1">&#39;      Vectors and matrices can be used inside &lt; &gt; brackets.  &lt;A B; C&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9912"></a><span class="s1">&#39;      is allowed if the number of rows of A equals the number of rows&#39;</span><span class="p">,&amp;</span>
<a name="ln-9913"></a><span class="s1">&#39;      of B and the number of columns of A plus the number of columns of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9914"></a><span class="s1">&#39;      B equals the number of columns of C. This rule generalizes in a&#39;</span><span class="p">,&amp;</span>
<a name="ln-9915"></a><span class="s1">&#39;      hopefully obvious way to allow fairly complicated constructions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9916"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9917"></a><span class="s1">&#39;      A = &lt; &gt; stores an empty matrix in A, thereby removing it from the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9918"></a><span class="s1">&#39;      list of current variables.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9919"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9920"></a><span class="s1">&#39;      For the use of &lt; and &gt; on the left of the = in multiple assignment&#39;</span><span class="p">,&amp;</span>
<a name="ln-9921"></a><span class="s1">&#39;      statements, See &quot;lu&quot;, &quot;eig&quot;, &quot;svd&quot; and so on.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9922"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9923"></a><span class="s1">&#39;      In &quot;while&quot; and &quot;if&quot; clauses, &quot;&lt;&gt;&quot; means less than or greater than,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9924"></a><span class="s1">&#39;      i.e. not equal, &quot;&lt;&quot; means less than, &quot;&gt;&quot; means greater than,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9925"></a><span class="s1">&#39;      &quot;&lt;=&quot; means less than or equal, &quot;&gt;=&quot; means greater than or equal.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9926"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9927"></a><span class="s1">&#39;      For the use of &quot;&gt;&quot; and &quot;&lt;&quot; to delineate macros, see MACROS.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9928"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9929"></a><span class="s1">&#39;{     see &quot;(&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9930"></a><span class="s1">&#39;}     see &quot;(&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9931"></a><span class="s1">&#39;)     See &quot;(&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9932"></a><span class="s1">&#39;(     ( ) or { } are used to indicate precedence in arithmetic expressions&#39;</span><span class="p">,&amp;</span>
<a name="ln-9933"></a><span class="s1">&#39;      and to enclose arguments of functions in the usual way. They are&#39;</span><span class="p">,&amp;</span>
<a name="ln-9934"></a><span class="s1">&#39;      also used to enclose subscripts of vectors and matrices in a manner&#39;</span><span class="p">,&amp;</span>
<a name="ln-9935"></a><span class="s1">&#39;      somewhat more general than the usual way. If X and V are vectors,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9936"></a><span class="s1">&#39;      then X(V) is &lt;X(V(1)), X(V(2)), ..., X(V(N))&gt;. The components of V&#39;</span><span class="p">,&amp;</span>
<a name="ln-9937"></a><span class="s1">&#39;      are rounded to nearest integers and used as subscripts. An error&#39;</span><span class="p">,&amp;</span>
<a name="ln-9938"></a><span class="s1">&#39;      occurs if any such subscript is less than 1 or greater than the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9939"></a><span class="s1">&#39;      dimension of X. Some examples:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9940"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9941"></a><span class="s1">&#39;         X(3) is the third element of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9942"></a><span class="s1">&#39;         X([1 2 3]) is the first three elements of X. So is&#39;</span><span class="p">,&amp;</span>
<a name="ln-9943"></a><span class="s1">&#39;         X([sqrt(2), sqrt(3), 4*atan(1)]) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9944"></a><span class="s1">&#39;         If X has N components, X(N:-1:1) reverses them.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9945"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9946"></a><span class="s1">&#39;      The same indirect subscripting is used in matrices. If V has&#39;</span><span class="p">,&amp;</span>
<a name="ln-9947"></a><span class="s1">&#39;      M components and W has N components, then A(V,W) is the M by N&#39;</span><span class="p">,&amp;</span>
<a name="ln-9948"></a><span class="s1">&#39;      matrix formed from the elements of A whose subscripts are the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9949"></a><span class="s1">&#39;      elements of V and W. For example...  A(&lt;1,5&gt;,:) = A(&lt;5,1&gt;,:)&#39;</span><span class="p">,&amp;</span>
<a name="ln-9950"></a><span class="s1">&#39;      interchanges rows 1 and 5 of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9951"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9952"></a><span class="s1">&#39;=     Used in assignment statements and to mean equality in &quot;while&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9953"></a><span class="s1">&#39;      and &quot;if&quot; clauses.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9954"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9955"></a><span class="s1">&#39;.     Decimal point. 314/100, 3.14 and .314E1 are all the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9956"></a><span class="s1">&#39;      same.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9957"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9958"></a><span class="s1">&#39;      Element-by-element multiplicative operations are obtained&#39;</span><span class="p">,&amp;</span>
<a name="ln-9959"></a><span class="s1">&#39;      using .* , ./ , or .\ . For example, C = A ./ B is the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9960"></a><span class="s1">&#39;      matrix with elements c(i,j) = a(i,j)/b(i,j) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-9961"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9962"></a><span class="s1">&#39;      Kronecker tensor products and quotients are obtained with&#39;</span><span class="p">,&amp;</span>
<a name="ln-9963"></a><span class="s1">&#39;      .*. , ./. and .\. . See &quot;kron&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9964"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9965"></a><span class="s1">&#39;      Two or more points at the end of the line indicate&#39;</span><span class="p">,&amp;</span>
<a name="ln-9966"></a><span class="s1">&#39;      continuation. The total line length limit is 1024&#39;</span><span class="p">,&amp;</span>
<a name="ln-9967"></a><span class="s1">&#39;      characters.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9968"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9969"></a><span class="s1">&#39;,     Used to separate matrix subscripts and function arguments.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9970"></a><span class="s1">&#39;      Used at the end of &quot;for&quot;, &quot;while&quot; and &quot;if&quot; clauses. Used to&#39;</span><span class="p">,&amp;</span>
<a name="ln-9971"></a><span class="s1">&#39;      separate statements in multi-statement lines. In this&#39;</span><span class="p">,&amp;</span>
<a name="ln-9972"></a><span class="s1">&#39;      situation, it may be replaced by a semicolon to suppress&#39;</span><span class="p">,&amp;</span>
<a name="ln-9973"></a><span class="s1">&#39;      printing.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9974"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9975"></a><span class="s1">&#39;!     If an exclamation is the first character of a line the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9976"></a><span class="s1">&#39;      rest of the line is passed to the system to be executed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9977"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9978"></a><span class="s1">&#39;      Examples:&#39;</span><span class="p">,&amp;</span>
<a name="ln-9979"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9980"></a><span class="s1">&#39;         // enter command history mode and change all occurrences of&#39;</span><span class="p">,&amp;</span>
<a name="ln-9981"></a><span class="s1">&#39;         // &quot;abc&quot; to &quot;123&quot; on the last command entered.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9982"></a><span class="s1">&#39;         !!c/abc/123&#39;</span><span class="p">,&amp;</span>
<a name="ln-9983"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9984"></a><span class="s1">&#39;         // pass command to system&#39;</span><span class="p">,&amp;</span>
<a name="ln-9985"></a><span class="s1">&#39;         !ls -ltrasd&#39;</span><span class="p">,&amp;</span>
<a name="ln-9986"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9987"></a><span class="s1">&#39;      see &quot;EDIT&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9988"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9989"></a><span class="s1">&#39;;     Used inside brackets to end rows.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9990"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9991"></a><span class="s1">&#39;      Used after an expression or statement to suppress printing.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9992"></a><span class="s1">&#39;      See &quot;semi&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-9993"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-9994"></a><span class="s1">&#39;\     Backslash or matrix left division. A\B is roughly the&#39;</span><span class="p">,&amp;</span>
<a name="ln-9995"></a><span class="s1">&#39;      same as &quot;inv(A)*B&quot;, except it is computed in a different&#39;</span><span class="p">,&amp;</span>
<a name="ln-9996"></a><span class="s1">&#39;      way. If A is an N by N matrix and B is a column vector&#39;</span><span class="p">,&amp;</span>
<a name="ln-9997"></a><span class="s1">&#39;      with N components, or a matrix with several such columns,&#39;</span><span class="p">,&amp;</span>
<a name="ln-9998"></a><span class="s1">&#39;      then X = A\B is the solution to the equation A*X = B&#39;</span><span class="p">,&amp;</span>
<a name="ln-9999"></a><span class="s1">&#39;      computed by Gaussian elimination. A warning message is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10000"></a><span class="s1">&#39;      printed if A is badly scaled or nearly singular.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10001"></a><span class="s1">&#39;      A\eye produces the inverse of A .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10002"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10003"></a><span class="s1">&#39;      If A is an M by N matrix with M &lt; or &gt; N and B is a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10004"></a><span class="s1">&#39;      column vector with M components, or a matrix with several&#39;</span><span class="p">,&amp;</span>
<a name="ln-10005"></a><span class="s1">&#39;      such columns, then X = A\B is the solution in the least&#39;</span><span class="p">,&amp;</span>
<a name="ln-10006"></a><span class="s1">&#39;      squares sense to the under- or overdetermined system of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10007"></a><span class="s1">&#39;      equations A*X = B. The effective rank, K, of A is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10008"></a><span class="s1">&#39;      determined from the QR decomposition with pivoting. A&#39;</span><span class="p">,&amp;</span>
<a name="ln-10009"></a><span class="s1">&#39;      solution X is computed which has at most K nonzero&#39;</span><span class="p">,&amp;</span>
<a name="ln-10010"></a><span class="s1">&#39;      components per column. If K &lt; N this will usually not be&#39;</span><span class="p">,&amp;</span>
<a name="ln-10011"></a><span class="s1">&#39;      the same solution as pinv(A)*B .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10012"></a><span class="s1">&#39;      A\eye produces a generalized inverse of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10013"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10014"></a><span class="s1">&#39;      If A and B have the same dimensions, then A .\ B has&#39;</span><span class="p">,&amp;</span>
<a name="ln-10015"></a><span class="s1">&#39;      elements a(i,j)\b(i,j) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10016"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10017"></a><span class="s1">&#39;      Also, see &quot;edit&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10018"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10019"></a><span class="s1">&#39;/     Slash or matrix right division. B/A is roughly the same&#39;</span><span class="p">,&amp;</span>
<a name="ln-10020"></a><span class="s1">&#39;      as B*inv(A) . More precisely, B/A = (A&#39;&#39;\B&#39;&#39;)&#39;&#39; . See \ .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10021"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10022"></a><span class="s1">&#39;      IF A and B have the same dimensions, then A ./ B has&#39;</span><span class="p">,&amp;</span>
<a name="ln-10023"></a><span class="s1">&#39;      elements a(i,j)/b(i,j) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10024"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10025"></a><span class="s1">&#39;      Two or more slashes together on a line indicate a logical end of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10026"></a><span class="s1">&#39;      line. Any following text is ignored.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10027"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10028"></a><span class="s1">&#39;&#39;&#39;     Transpose. X&#39;&#39; is the complex conjugate transpose of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10029"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10030"></a><span class="s1">&#39;      A quote is also use to delmit text. &#39;&#39;ANY TEXT&#39;&#39; is a vector whose&#39;</span><span class="p">,&amp;</span>
<a name="ln-10031"></a><span class="s1">&#39;      components are the LALA internal codes for the characters. A&#39;</span><span class="p">,&amp;</span>
<a name="ln-10032"></a><span class="s1">&#39;      quote within the text is indicated by two quotes. See &quot;display&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10033"></a><span class="s1">&#39;      and &quot;FILE&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10034"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10035"></a><span class="s1">&#39;+     Addition. X + Y . X and Y must have the same dimensions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10036"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10037"></a><span class="s1">&#39;-     Subtraction. X - Y . X and Y must have the same&#39;</span><span class="p">,&amp;</span>
<a name="ln-10038"></a><span class="s1">&#39;      dimensions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10039"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10040"></a><span class="s1">&#39;*     Matrix multiplication, X*Y . Any scalar (1 by 1 matrix)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10041"></a><span class="s1">&#39;      may multiply anything. Otherwise, the number of columns of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10042"></a><span class="s1">&#39;      X must equal the number of rows of Y .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10043"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10044"></a><span class="s1">&#39;      Element-by-element multiplication is obtained with X .* Y .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10045"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10046"></a><span class="s1">&#39;      The Kronecker tensor product is denoted by X .*. Y .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10047"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10048"></a><span class="s1">&#39;      Powers. X**p is X to the p power. p must be a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10049"></a><span class="s1">&#39;      scalar. If X is a matrix, see &quot;HIGH&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10050"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10051"></a><span class="s1">&#39;:     Colon. Used in subscripts, &quot;for&quot; iterations and possibly&#39;</span><span class="p">,&amp;</span>
<a name="ln-10052"></a><span class="s1">&#39;      elsewhere.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10053"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10054"></a><span class="s1">&#39;        j:k   is the same as  &lt;j, j+1, ..., k&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10055"></a><span class="s1">&#39;              is empty if  j &gt; k .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10056"></a><span class="s1">&#39;        j:i:k is the same as [j, j+i,j+2*i, ..., k]&#39;</span><span class="p">,&amp;</span>
<a name="ln-10057"></a><span class="s1">&#39;              (Fortran DO loop users beware of the unusual order!)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10058"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10059"></a><span class="s1">&#39;         j:i:k  is the same as  &lt;j, j+i, j+2i, ..., k&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10060"></a><span class="s1">&#39;         j:i:k  is empty if  i &gt; 0 and j &gt; k or if i &lt; 0 and j &lt; k .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10061"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10062"></a><span class="s1">&#39;      The colon notation can be used to pick out selected rows,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10063"></a><span class="s1">&#39;      columns and elements of vectors and matrices.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10064"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10065"></a><span class="s1">&#39;         A(:)    is all the elements of A, regarded as a single column.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10066"></a><span class="s1">&#39;                 However, used on the left side of an assignment, A(:)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10067"></a><span class="s1">&#39;                 fills A, but preserves its shape.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10068"></a><span class="s1">&#39;        A(:,j)   is the j-th column of A&#39;</span><span class="p">,&amp;</span>
<a name="ln-10069"></a><span class="s1">&#39;        A(j:k)   is A(j), A(j+1), ... , A(k)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10070"></a><span class="s1">&#39;        A(:,j:k) is A(:,j), A(:,j+1), ... ,A(:,k) and so on.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10071"></a><span class="s1">&#39;        A(:,:)   is the same as A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10072"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10073"></a><span class="s1">&#39;      For the use of the colon in the &quot;for&quot; statement, See &quot;for&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10074"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10075"></a><span class="s1">&#39;semi  &quot;semi&quot; toggles the action of semicolons at the end of lines.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10076"></a><span class="s1">&#39;      It will make semicolons cause rather than suppress printing.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10077"></a><span class="s1">&#39;      A second &quot;semi&quot; restores the initial interpretation.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10078"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10079"></a><span class="s1">&#39;VARIABLES&#39;</span><span class="p">,&amp;</span>
<a name="ln-10080"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10081"></a><span class="s1">&#39;ans   Variable created automatically when expressions are not&#39;</span><span class="p">,&amp;</span>
<a name="ln-10082"></a><span class="s1">&#39;      assigned to anything else.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10083"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10084"></a><span class="s1">&#39;clear  Erases all variables, except &quot;eps&quot;, &quot;flop&quot;, &quot;eye&quot; and &quot;rand&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10085"></a><span class="s1">&#39;       X = &lt;&gt; erases only variable X . So does &quot;clear X&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10086"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10087"></a><span class="s1">&#39;who   Lists current variables.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10088"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10089"></a><span class="s1">&#39;MACROS&#39;</span><span class="p">,&amp;</span>
<a name="ln-10090"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10091"></a><span class="s1">&#39;       The macro facility involves text and inward pointing angle&#39;</span><span class="p">,&amp;</span>
<a name="ln-10092"></a><span class="s1">&#39;       brackets. If &quot;STRING&quot; is the source text for any LALA&#39;</span><span class="p">,&amp;</span>
<a name="ln-10093"></a><span class="s1">&#39;       expression or statement, then&#39;</span><span class="p">,&amp;</span>
<a name="ln-10094"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10095"></a><span class="s1">&#39;             t = &#39;&#39;STRING&#39;&#39;;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10096"></a><span class="s1">&#39;       encodes the text as a vector of integers and stores that&#39;</span><span class="p">,&amp;</span>
<a name="ln-10097"></a><span class="s1">&#39;       vector in t. &quot;display(t)&quot; will print the text and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10098"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10099"></a><span class="s1">&#39;             &gt;t&lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10100"></a><span class="s1">&#39;       causes the text to be interpreted, either as a statement or&#39;</span><span class="p">,&amp;</span>
<a name="ln-10101"></a><span class="s1">&#39;       as a factor in an expression. For example&#39;</span><span class="p">,&amp;</span>
<a name="ln-10102"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10103"></a><span class="s1">&#39;             t = &#39;&#39;1/(i+j-1)&#39;&#39;;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10104"></a><span class="s1">&#39;             display(t)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10105"></a><span class="s1">&#39;             for i = 1:n, for j = 1:n, a(i,j) = &gt;t&lt;;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10106"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10107"></a><span class="s1">&#39;       generates the Hilbert matrix of order n.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10108"></a><span class="s1">&#39;       Another example showing indexed text,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10109"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10110"></a><span class="s1">&#39;             S = &lt;&#39;&#39;x = 3            &#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10111"></a><span class="s1">&#39;                  &#39;&#39;y = 4            &#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10112"></a><span class="s1">&#39;                  &#39;&#39;z = sqrt(x*x+y*y)&#39;&#39;&gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10113"></a><span class="s1">&#39;             for k = 1:3, &gt;S(k,:)&lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10114"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10115"></a><span class="s1">&#39;       It is necessary that the strings making up the &quot;rows&quot; of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10116"></a><span class="s1">&#39;       the &quot;matrix&quot; S have the same lengths.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10117"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10118"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10119"></a><span class="s1">&#39;BASIC FUNCTIONS&#39;</span><span class="p">,&amp;</span>
<a name="ln-10120"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10121"></a><span class="s1">&#39;      For matrix arguments X , the functions &quot;sin&quot;, &quot;cos&quot;, &quot;atan&quot;,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10122"></a><span class="s1">&#39;      &quot;sqrt&quot;, &quot;log&quot;, &quot;exp&quot; and X**p are computed using eigenvalues D&#39;</span><span class="p">,&amp;</span>
<a name="ln-10123"></a><span class="s1">&#39;      and eigenvectors V . If &lt;V,D&gt; = eig(X) then f(X) = V*f(D)/V . This&#39;</span><span class="p">,&amp;</span>
<a name="ln-10124"></a><span class="s1">&#39;      method may give inaccurate results if V is badly conditioned. Some&#39;</span><span class="p">,&amp;</span>
<a name="ln-10125"></a><span class="s1">&#39;      idea of the accuracy can be obtained by comparing X**1 with X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10126"></a><span class="s1">&#39;      For vector arguments, the function is applied to each component.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10127"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10128"></a><span class="s1">&#39;atan  atan(X) is the arctangent of X . See &quot;BASIC&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10129"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10130"></a><span class="s1">&#39;cos   cos(X) is the cosine of X . See &quot;BASIC&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10131"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10132"></a><span class="s1">&#39;exp   exp(X) is the exponential of X , e to the X . See &quot;BASIC&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10133"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10134"></a><span class="s1">&#39;log   log(X) is the natural logarithm of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10135"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10136"></a><span class="s1">&#39;      Complex results are produced if X is not positive, or has&#39;</span><span class="p">,&amp;</span>
<a name="ln-10137"></a><span class="s1">&#39;      nonpositive eigenvalues.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10138"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10139"></a><span class="s1">&#39;      See &quot;BASIC&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10140"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10141"></a><span class="s1">&#39;sin   sin(X) is the sine of X. See &quot;BASIC&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10142"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10143"></a><span class="s1">&#39;sqrt  sqrt(X) is the square root of X. See &quot;BASIC&quot;. Complex&#39;</span><span class="p">,&amp;</span>
<a name="ln-10144"></a><span class="s1">&#39;      results are produced if X is not positive, or has&#39;</span><span class="p">,&amp;</span>
<a name="ln-10145"></a><span class="s1">&#39;      nonpositive eigenvalues.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10146"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10147"></a><span class="s1">&#39;HIGH LEVEL FUNCTIONS&#39;</span><span class="p">,&amp;</span>
<a name="ln-10148"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10149"></a><span class="s1">&#39;abs   abs(X) is the absolute value, or complex modulus,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10150"></a><span class="s1">&#39;      of the elements of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10151"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10152"></a><span class="s1">&#39;base  base(X,B) is a vector containing the base B representation&#39;</span><span class="p">,&amp;</span>
<a name="ln-10153"></a><span class="s1">&#39;      of X. This is often used in conjunction with &quot;display&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10154"></a><span class="s1">&#39;      &quot;display(X,B)&quot; is the same as &quot;display(base(X,B))&quot;. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10155"></a><span class="s1">&#39;      &quot;display(4*atan(1),16)&quot; prints the hexadecimal representation of pi.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10156"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10157"></a><span class="s1">&#39;chol  Cholesky factorization. &quot;chol(X)&quot; uses only the diagonal&#39;</span><span class="p">,&amp;</span>
<a name="ln-10158"></a><span class="s1">&#39;      and upper triangle of X. The lower triangular is assumed to be&#39;</span><span class="p">,&amp;</span>
<a name="ln-10159"></a><span class="s1">&#39;      the (complex conjugate) transpose of the upper. If X is positive&#39;</span><span class="p">,&amp;</span>
<a name="ln-10160"></a><span class="s1">&#39;      definite, then &quot;R = chol(X)&quot; produces an upper triangular R so&#39;</span><span class="p">,&amp;</span>
<a name="ln-10161"></a><span class="s1">&#39;      that R&#39;&#39;*R = X . If X is not positive definite, an error message&#39;</span><span class="p">,&amp;</span>
<a name="ln-10162"></a><span class="s1">&#39;      is printed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10163"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10164"></a><span class="s1">&#39;chop  Truncate arithmetic. &quot;chop(P)&quot; causes P places to be chopped&#39;</span><span class="p">,&amp;</span>
<a name="ln-10165"></a><span class="s1">&#39;      off after each arithmetic operation in subsequent computations. This&#39;</span><span class="p">,&amp;</span>
<a name="ln-10166"></a><span class="s1">&#39;      means P hexadecimal digits on some computers and P octal digits&#39;</span><span class="p">,&amp;</span>
<a name="ln-10167"></a><span class="s1">&#39;      on others. &quot;chop(0)&quot; restores full precision.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10168"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10169"></a><span class="s1">&#39;cond  Condition number in 2-norm. &quot;cond(X)&quot; is the ratio of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10170"></a><span class="s1">&#39;      largest singular value of X to the smallest.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10171"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10172"></a><span class="s1">&#39;conjg  &quot;conjg(X)&quot; is the complex conjugate of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10173"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10174"></a><span class="s1">&#39;det   &quot;det(X)&quot; is the determinant of the square matrix X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10175"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10176"></a><span class="s1">&#39;diag  If V is a row or column vector with N components,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10177"></a><span class="s1">&#39;      &quot;diag(V,K)&quot; is a square matrix of order &quot;N+abs(K)&quot; with the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10178"></a><span class="s1">&#39;      elements of V on the K-th diagonal. K = 0 is the main diagonal,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10179"></a><span class="s1">&#39;      K &gt; 0 is above the main diagonal and K &lt; 0 is below the main&#39;</span><span class="p">,&amp;</span>
<a name="ln-10180"></a><span class="s1">&#39;      diagonal. &quot;diag(V)&quot; simply puts V on the main diagonal. eg.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10181"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10182"></a><span class="s1">&#39;         diag(-M:M) + diag(ones(2*M,1),1) + diag(ones(2*M,1),-1)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10183"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10184"></a><span class="s1">&#39;      produces a tridiagonal matrix of order 2*M+1 .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10185"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10186"></a><span class="s1">&#39;      If X is a matrix, &quot;diag(X,K)&quot; is a column vector formed from the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10187"></a><span class="s1">&#39;      elements of the K-th diagonal of X.  &quot;diag(X)&quot; is the main diagonal&#39;</span><span class="p">,&amp;</span>
<a name="ln-10188"></a><span class="s1">&#39;      of X.  &quot;diag(diag(X))&quot; is a diagonal matrix .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10189"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10190"></a><span class="s1">&#39;eig   Eigenvalues and eigenvectors.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10191"></a><span class="s1">&#39;      &quot;eig(X)&quot; is a vector containing the eigenvalues of a square&#39;</span><span class="p">,&amp;</span>
<a name="ln-10192"></a><span class="s1">&#39;      matrix X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10193"></a><span class="s1">&#39;      &quot;&lt;V,D&gt; = eig(X)&quot; produces a diagonal matrix D of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10194"></a><span class="s1">&#39;      eigenvalues and a full matrix V whose columns are the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10195"></a><span class="s1">&#39;      corresponding eigenvectors so that X*V = V*D .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10196"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10197"></a><span class="s1">&#39;eye   Identity matrix. &quot;eye(N)&quot; is the N by N identity matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10198"></a><span class="s1">&#39;      &quot;eye(M,N)&quot; is an M by N matrix with 1&#39;&#39;s on the diagonal and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10199"></a><span class="s1">&#39;      zeros elsewhere. &quot;eye(A)&quot; is the same size as A. &quot;eye&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10200"></a><span class="s1">&#39;      with no arguments is an identity matrix of whatever order&#39;</span><span class="p">,&amp;</span>
<a name="ln-10201"></a><span class="s1">&#39;      is appropriate in the context. For example &quot;A + 3*eye&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10202"></a><span class="s1">&#39;      adds 3 to each diagonal element of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10203"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10204"></a><span class="s1">&#39;hess  Hessenberg form. The Hessenberg form of a matrix is zero&#39;</span><span class="p">,&amp;</span>
<a name="ln-10205"></a><span class="s1">&#39;      below the first subdiagonal. If the matrix is symmetric or&#39;</span><span class="p">,&amp;</span>
<a name="ln-10206"></a><span class="s1">&#39;      Hermitian, the form is tridiagonal. &lt;P,H&gt; = &quot;hess(A)&quot; produces a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10207"></a><span class="s1">&#39;      unitary matrix P and a Hessenberg matrix H so that A = P*H*P&#39;&#39;. By&#39;</span><span class="p">,&amp;</span>
<a name="ln-10208"></a><span class="s1">&#39;      itself, &quot;hess(A)&quot; returns H.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10209"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10210"></a><span class="s1">&#39;invh  Inverse Hilbert matrix. &quot;invh(N)&quot; is the inverse of a N_by_N&#39;</span><span class="p">,&amp;</span>
<a name="ln-10211"></a><span class="s1">&#39;      Hilbert matrix (which is a famous example of a badly conditioned&#39;</span><span class="p">,&amp;</span>
<a name="ln-10212"></a><span class="s1">&#39;      matrix). The result is exact for N less than about 15, depending&#39;</span><span class="p">,&amp;</span>
<a name="ln-10213"></a><span class="s1">&#39;      upon the computer.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10214"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10215"></a><span class="s1">&#39;         for i = 1:N, for j = 1:N, A(i,j) = 1/(i+j-1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-10216"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10217"></a><span class="s1">&#39;      generates the NxN Hilbert matrix.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10218"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10219"></a><span class="s1">&#39;      &quot;invh&quot; has an alias of &quot;inverse_hilbert&quot; and &quot;invhilb&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10220"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10221"></a><span class="s1">&#39;aimag see &quot;imag&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10222"></a><span class="s1">&#39;imag  &quot;imag(X)&quot; is the imaginary part of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10223"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10224"></a><span class="s1">&#39;inv   &quot;inv(X)&quot; is the inverse of the square matrix X . A warning&#39;</span><span class="p">,&amp;</span>
<a name="ln-10225"></a><span class="s1">&#39;      message is printed if X is badly scaled or nearly&#39;</span><span class="p">,&amp;</span>
<a name="ln-10226"></a><span class="s1">&#39;      singular.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10227"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10228"></a><span class="s1">&#39;kron  &quot;kron(X,Y)&quot; is the Kronecker tensor product of X and Y. It&#39;</span><span class="p">,&amp;</span>
<a name="ln-10229"></a><span class="s1">&#39;      is also denoted by X .*. Y . The result is a large matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-10230"></a><span class="s1">&#39;      formed by taking all possible products between the elements&#39;</span><span class="p">,&amp;</span>
<a name="ln-10231"></a><span class="s1">&#39;      of X and those of Y . For example, if X is 2 by 3, then&#39;</span><span class="p">,&amp;</span>
<a name="ln-10232"></a><span class="s1">&#39;      X .*. Y is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10233"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10234"></a><span class="s1">&#39;            &lt; x(1,1)*Y  x(1,2)*Y  x(1,3)*Y&#39;</span><span class="p">,&amp;</span>
<a name="ln-10235"></a><span class="s1">&#39;              x(2,1)*Y  x(2,2)*Y  x(2,3)*Y &gt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10236"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10237"></a><span class="s1">&#39;      The five-point discrete Laplacian for an n-by-n grid can be&#39;</span><span class="p">,&amp;</span>
<a name="ln-10238"></a><span class="s1">&#39;      generated by&#39;</span><span class="p">,&amp;</span>
<a name="ln-10239"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10240"></a><span class="s1">&#39;            T = diag(ones(n-1,1),1);  T = T + T&#39;&#39;;  I = eye(T);&#39;</span><span class="p">,&amp;</span>
<a name="ln-10241"></a><span class="s1">&#39;            A = T.*.I + I.*.T - 4*eye;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10242"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10243"></a><span class="s1">&#39;      Just in case they might be useful, LALA includes&#39;</span><span class="p">,&amp;</span>
<a name="ln-10244"></a><span class="s1">&#39;      constructions called Kronecker tensor quotients, denoted by&#39;</span><span class="p">,&amp;</span>
<a name="ln-10245"></a><span class="s1">&#39;      X ./. Y and X .\. Y . They are obtained by replacing the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10246"></a><span class="s1">&#39;      element-wise multiplications in X .*. Y with divisions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10247"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10248"></a><span class="s1">&#39;lu    Factors from Gaussian elimination. &lt;L,U&gt; = LU(X) stores a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10249"></a><span class="s1">&#39;      upper triangular matrix in U and a &#39;&#39;psychologically lower&#39;</span><span class="p">,&amp;</span>
<a name="ln-10250"></a><span class="s1">&#39;      triangular matrix&#39;&#39;, i.e. a product of lower triangular and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10251"></a><span class="s1">&#39;      permutation matrices, in L , so that X = L*U . By itself,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10252"></a><span class="s1">&#39;      &quot;lu(X)&quot; returns the output from CGEFA .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10253"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10254"></a><span class="s1">&#39;magic  Magic square. &quot;magic(N)&quot; is an N by N matrix constructed&#39;</span><span class="p">,&amp;</span>
<a name="ln-10255"></a><span class="s1">&#39;       from the integers 1 through N**2 with equal row, column and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10256"></a><span class="s1">&#39;       diagonal sums. N must be a positive whole number not equal to two.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10257"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10258"></a><span class="s1">&#39;norm  computes the norm or P-norm of X&#39;</span><span class="p">,&amp;</span>
<a name="ln-10259"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10260"></a><span class="s1">&#39;      norm(X,P) computes the P-norm of X. P=2 is the default, which defines&#39;</span><span class="p">,&amp;</span>
<a name="ln-10261"></a><span class="s1">&#39;      the standard norm.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10262"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10263"></a><span class="s1">&#39;      For matrices..&#39;</span><span class="p">,&amp;</span>
<a name="ln-10264"></a><span class="s1">&#39;          norm(X,1)      is the 1-norm of X; ie. the largest column sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-10265"></a><span class="s1">&#39;                         of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10266"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10267"></a><span class="s1">&#39;          norm(X,2)      the largest singular value of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10268"></a><span class="s1">&#39;          or norm(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10269"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10270"></a><span class="s1">&#39;          norm(X,&#39;&#39;inf&#39;&#39;)  is the infinity norm of X; ie. the largest row&#39;</span><span class="p">,&amp;</span>
<a name="ln-10271"></a><span class="s1">&#39;                         sum of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10272"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10273"></a><span class="s1">&#39;          norm(X,&#39;&#39;fro&#39;&#39;)  is the F-norm, i.e. &quot;sqrt(sum(diag(X&#39;&#39;*X)))&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10274"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10275"></a><span class="s1">&#39;      For vectors..&#39;</span><span class="p">,&amp;</span>
<a name="ln-10276"></a><span class="s1">&#39;          norm(V,P)      the same as sum(V(I)**P)**(1/P) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10277"></a><span class="s1">&#39;                         ??? what about negative values of (I) and odd P? abs() or not&#39;</span><span class="p">,&amp;</span>
<a name="ln-10278"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10279"></a><span class="s1">&#39;          norm(V,2)      the square root of the sum of the squares of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10280"></a><span class="s1">&#39;          or norm(V)     the entries of V.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10281"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10282"></a><span class="s1">&#39;          norm(V,&#39;&#39;inf&#39;&#39;)  the value is max(abs(V)) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10283"></a><span class="s1">&#39;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10284"></a><span class="s1">&#39;!!          If X is a vector, then&#39;</span><span class="p">,&amp;</span>
<a name="ln-10285"></a><span class="s1">&#39;!!&#39;</span><span class="p">,&amp;</span>
<a name="ln-10286"></a><span class="s1">&#39;!!            norm(x,p) = sum(abs(x) .^ p) ^ (1/p)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10287"></a><span class="s1">&#39;!!            norm(x,1) is the sum of the absolute values of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10288"></a><span class="s1">&#39;!!            norm(x)/sqrt(n) is the root-mean-square value.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10289"></a><span class="s1">&#39;!!            norm(x,-inf)=min(abs(x))&#39;</span><span class="p">,&amp;</span>
<a name="ln-10290"></a><span class="s1">&#39;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10291"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10292"></a><span class="s1">&#39;ones  All ones. &quot;ones(N)&quot; is an N by N matrix of ones. &quot;ones(M,N)&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10293"></a><span class="s1">&#39;      is an M by N matrix of ones . &quot;ones(A)&quot; is the same size as A and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10294"></a><span class="s1">&#39;      all ones .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10295"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10296"></a><span class="s1">&#39;         a=magic(4)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10297"></a><span class="s1">&#39;         a=a+ones(a)*3 // Add 3 to each element of &quot;a&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10298"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10299"></a><span class="s1">&#39;orth  Orthogonalization. &quot;Q = orth(X)&quot; is a matrix with&#39;</span><span class="p">,&amp;</span>
<a name="ln-10300"></a><span class="s1">&#39;      orthonormal columns, i.e. Q&#39;&#39;*Q = eye, which span the same&#39;</span><span class="p">,&amp;</span>
<a name="ln-10301"></a><span class="s1">&#39;      space as the columns of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10302"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10303"></a><span class="s1">&#39;pinv  Pseudoinverse.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10304"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10305"></a><span class="s1">&#39;      &quot;X = pinv(A)&quot; produces a matrix X of the same dimensions as A&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10306"></a><span class="s1">&#39;      so that A*X*A = A , X*A*X = X and AX and XA are Hermitian . The&#39;</span><span class="p">,&amp;</span>
<a name="ln-10307"></a><span class="s1">&#39;      computation is based on &quot;svd(A)&quot; and any singular values less&#39;</span><span class="p">,&amp;</span>
<a name="ln-10308"></a><span class="s1">&#39;      than a tolerance are treated as zero. The default tolerance is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10309"></a><span class="s1">&#39;      &quot;norm(shape(A),&#39;&#39;inf&#39;&#39;)*norM(A)*eps&quot;. This tolerance may be overridden&#39;</span><span class="p">,&amp;</span>
<a name="ln-10310"></a><span class="s1">&#39;      with &quot;X = pinv(A,tol)&quot;. See &quot;rank&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10311"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10312"></a><span class="s1">&#39;poly  Characteristic polynomial.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10313"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10314"></a><span class="s1">&#39;      If A is an N by N matrix, &quot;poly(A)&quot; is a column vector with&#39;</span><span class="p">,&amp;</span>
<a name="ln-10315"></a><span class="s1">&#39;      N+1 elements which are the coefficients of the characteristic&#39;</span><span class="p">,&amp;</span>
<a name="ln-10316"></a><span class="s1">&#39;      polynomial, &quot;det(lambda*eye - A)&quot; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10317"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10318"></a><span class="s1">&#39;      If V is a vector, &quot;poly(V)&quot; is a vector whose elements are the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10319"></a><span class="s1">&#39;      coefficients of the polynomial whose roots are the elements of V&#39;</span><span class="p">,&amp;</span>
<a name="ln-10320"></a><span class="s1">&#39;      . For vectors, &quot;roots&quot; and &quot;poly&quot; are inverse functions of each&#39;</span><span class="p">,&amp;</span>
<a name="ln-10321"></a><span class="s1">&#39;      other, up to ordering, scaling, and roundoff error.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10322"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10323"></a><span class="s1">&#39;      &quot;roots(poly(1:20))&quot; generates Wilkinson&#39;&#39;s famous example.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10324"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10325"></a><span class="s1">&#39;prod  &quot;prod(X)&quot; is the product of all the elements of X .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10326"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10327"></a><span class="s1">&#39;qr    Orthogonal-triangular decomposition.  &quot;&lt;Q,R&gt; = qr(X)&quot; produces an&#39;</span><span class="p">,&amp;</span>
<a name="ln-10328"></a><span class="s1">&#39;      upper triangular matrix R of the same&#39;</span><span class="p">,&amp;</span>
<a name="ln-10329"></a><span class="s1">&#39;      dimension as X and a unitary matrix Q so that X = Q*R .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10330"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10331"></a><span class="s1">&#39;      &quot;&lt;Q,R,E&gt; = qr(X)&quot; produces a permutation matrix E, an upper&#39;</span><span class="p">,&amp;</span>
<a name="ln-10332"></a><span class="s1">&#39;      triangular R with decreasing diagonal elements and a unitary Q&#39;</span><span class="p">,&amp;</span>
<a name="ln-10333"></a><span class="s1">&#39;      so that X*E = Q*R .  By itself, &quot;qr(X)&quot; returns the output of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10334"></a><span class="s1">&#39;      &quot;cqrdc&quot;. &quot;triu(qr(X))&quot; is R .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10335"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10336"></a><span class="s1">&#39;rand  Random numbers and matrices. &quot;rand(N)&quot; is an N by N matrix&#39;</span><span class="p">,&amp;</span>
<a name="ln-10337"></a><span class="s1">&#39;      with random entries. &quot;rand(M,N)&quot; is an M by N matrix with&#39;</span><span class="p">,&amp;</span>
<a name="ln-10338"></a><span class="s1">&#39;      random entries. &quot;rand(A)&quot; is the same size as A. &quot;rand&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10339"></a><span class="s1">&#39;      with no arguments is a scalar whose value changes each time&#39;</span><span class="p">,&amp;</span>
<a name="ln-10340"></a><span class="s1">&#39;      it is referenced.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10341"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10342"></a><span class="s1">&#39;      Ordinarily, random numbers are uniformly distributed in&#39;</span><span class="p">,&amp;</span>
<a name="ln-10343"></a><span class="s1">&#39;      the interval &quot;(0.0,1.0). rand(&#39;&#39;normal&#39;&#39;)&quot; switches to a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10344"></a><span class="s1">&#39;      normal distribution with mean 0.0 and variance 1.0.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10345"></a><span class="s1">&#39;      &quot;rand(&#39;&#39;uniform&#39;&#39;)&quot; switches back to the uniform distribution.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10346"></a><span class="s1">&#39;      &quot;rand(&#39;&#39;seed&#39;&#39;)&quot; returns the current value of the seed for the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10347"></a><span class="s1">&#39;      generator. &quot;rand(&#39;&#39;seed&#39;&#39;,n)&quot; sets the seed to n.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10348"></a><span class="s1">&#39;      &quot;rand(&#39;&#39;seed&#39;&#39;,0)&quot; resets the seed to 0, its value when LALA&#39;</span><span class="p">,&amp;</span>
<a name="ln-10349"></a><span class="s1">&#39;      is first entered.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10350"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10351"></a><span class="s1">&#39;rank  Rank. &quot;K = rank(X)&quot; is the number of singular values of X&#39;</span><span class="p">,&amp;</span>
<a name="ln-10352"></a><span class="s1">&#39;      that are larger than &quot;norm(shape(X),&#39;&#39;inf&#39;&#39;)*norm(X)*eps&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10353"></a><span class="s1">&#39;      &quot;K = rank(X,tol)&quot; is the number of singular values of X that&#39;</span><span class="p">,&amp;</span>
<a name="ln-10354"></a><span class="s1">&#39;      are larger than tol.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10355"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10356"></a><span class="s1">&#39;rcond  &quot;rcond(X)&quot; is an estimate for the reciprocal of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10357"></a><span class="s1">&#39;       condition of X in the 1-norm obtained by the LINPACK&#39;</span><span class="p">,&amp;</span>
<a name="ln-10358"></a><span class="s1">&#39;       condition estimator. If X is well conditioned, rcond(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10359"></a><span class="s1">&#39;       is near 1.0. If X is badly conditioned, rcond(X) is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10360"></a><span class="s1">&#39;       near 0.0.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10361"></a><span class="s1">&#39;       &lt;R, Z&gt; = rcond(A) sets R to rcond(A) and also produces a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10362"></a><span class="s1">&#39;       vector Z so that&#39;</span><span class="p">,&amp;</span>
<a name="ln-10363"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10364"></a><span class="s1">&#39;                 norm(A*Z,1) = R*norm(A,1)*norm(Z,1)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10365"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10366"></a><span class="s1">&#39;       So, if rcond(A) is small, then Z is an approximate null&#39;</span><span class="p">,&amp;</span>
<a name="ln-10367"></a><span class="s1">&#39;       vector.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10368"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10369"></a><span class="s1">&#39;rat   An experimental function which attempts to remove the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10370"></a><span class="s1">&#39;      roundoff error from results that should be &quot;simple&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10371"></a><span class="s1">&#39;      rational numbers.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10372"></a><span class="s1">&#39;      &quot;rat(X)&quot; approximates each element of X by a continued&#39;</span><span class="p">,&amp;</span>
<a name="ln-10373"></a><span class="s1">&#39;      fraction of the form&#39;</span><span class="p">,&amp;</span>
<a name="ln-10374"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10375"></a><span class="s1">&#39;                a/b = d1 + 1/(d2 + 1/(d3 + ... + 1/dk))&#39;</span><span class="p">,&amp;</span>
<a name="ln-10376"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10377"></a><span class="s1">&#39;      with k &lt;= len, integer di and abs(di) &lt;= max . The default&#39;</span><span class="p">,&amp;</span>
<a name="ln-10378"></a><span class="s1">&#39;      values of the parameters are len = 5 and max = 100.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10379"></a><span class="s1">&#39;      &quot;rat(len,max)&quot; changes the default values. Increasing either&#39;</span><span class="p">,&amp;</span>
<a name="ln-10380"></a><span class="s1">&#39;      len or max increases the number of possible fractions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10381"></a><span class="s1">&#39;      &quot;&lt;A,B&gt; = rat(X)&quot; produces integer matrices A and B so that&#39;</span><span class="p">,&amp;</span>
<a name="ln-10382"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10383"></a><span class="s1">&#39;                A ./ B  =  rat(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10384"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10385"></a><span class="s1">&#39;      Some examples:&#39;</span><span class="p">,&amp;</span>
<a name="ln-10386"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10387"></a><span class="s1">&#39;            long&#39;</span><span class="p">,&amp;</span>
<a name="ln-10388"></a><span class="s1">&#39;            T = invh(6), X = inv(T)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10389"></a><span class="s1">&#39;            &lt;A,B&gt; = rat(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10390"></a><span class="s1">&#39;            H = A ./ B, S = inv(H)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10391"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10392"></a><span class="s1">&#39;            short e&#39;</span><span class="p">,&amp;</span>
<a name="ln-10393"></a><span class="s1">&#39;            d = 1:8,  e = ones(d),  A = abs(d&#39;&#39;*e - e&#39;&#39;*d)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10394"></a><span class="s1">&#39;            X = inv(A)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10395"></a><span class="s1">&#39;            rat(X)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10396"></a><span class="s1">&#39;            display(ans)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10397"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10398"></a><span class="s1">&#39;real  &quot;real(X)&quot; is the real part of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10399"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10400"></a><span class="s1">&#39;rref  &quot;rref(A)&quot; is the reduced row echelon form of the rectangular&#39;</span><span class="p">,&amp;</span>
<a name="ln-10401"></a><span class="s1">&#39;      matrix. rref(A,B) is the same as rref(&lt;A,B&gt;) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10402"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10403"></a><span class="s1">&#39;roots  Find polynomial roots. &quot;roots(C)&quot; computes the roots of the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10404"></a><span class="s1">&#39;       polynomial whose coefficients are the elements of the vector C.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10405"></a><span class="s1">&#39;       If C has N+1 components, the polynomial is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10406"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10407"></a><span class="s1">&#39;          C(1)*X**N + ... + C(N)*X + C(N+1)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10408"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10409"></a><span class="s1">&#39;       See &quot;poly&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10410"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10411"></a><span class="s1">&#39;round  &quot;round(X)&quot; rounds the elements of X to the nearest integers.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10412"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10413"></a><span class="s1">&#39;schur  Schur decomposition. &quot;&lt;U,T&gt; = schur(X)&quot; produces an upper&#39;</span><span class="p">,&amp;</span>
<a name="ln-10414"></a><span class="s1">&#39;       triangular matrix T , with the eigenvalues of X on the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10415"></a><span class="s1">&#39;       diagonal, and a unitary matrix U so that X = U*T*U&#39;&#39; and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10416"></a><span class="s1">&#39;       U&#39;&#39;*U = eye . By itself, &quot;schur(X)&quot; returns T .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10417"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10418"></a><span class="s1">&#39;shape  If X is an M by N matrix, then shape(X) is &lt;M, N&gt; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10419"></a><span class="s1">&#39;       Can also be used with a multiple assignment,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10420"></a><span class="s1">&#39;            &lt;M, N&gt; = shape(X) .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10421"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10422"></a><span class="s1">&#39;sum   &quot;sum(X)&quot; is the sum of all the elements of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10423"></a><span class="s1">&#39;      &quot;sum(diag(X))&quot; is the trace of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10424"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10425"></a><span class="s1">&#39;svd   Singular value decomposition. &quot;&lt;U,S,V&gt; = svd(X)&quot; produces a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10426"></a><span class="s1">&#39;      diagonal matrix S , of the same dimension as X and with&#39;</span><span class="p">,&amp;</span>
<a name="ln-10427"></a><span class="s1">&#39;      nonnegative diagonal elements in decreasing order, and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10428"></a><span class="s1">&#39;      unitary matrices U and V so that X = U*S*V&#39;&#39; .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10429"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10430"></a><span class="s1">&#39;      By itself, &quot;svd(X)&quot; returns a vector containing the singular&#39;</span><span class="p">,&amp;</span>
<a name="ln-10431"></a><span class="s1">&#39;      values.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10432"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10433"></a><span class="s1">&#39;      &quot;&lt;U,S,V&gt; = svd(X,0)&quot; produces the &quot;economy size&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10434"></a><span class="s1">&#39;      decomposition. If X is m by n with m &gt; n, then only the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10435"></a><span class="s1">&#39;      first n columns of U are computed and S is n by n .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10436"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10437"></a><span class="s1">&#39;tril  Lower triangle. &quot;tril(X)&quot; is the lower triangular part of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10438"></a><span class="s1">&#39;      &quot;tril(X,K)&quot; is the elements on and below the K-th diagonal of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10439"></a><span class="s1">&#39;      X. K = 0 is the main diagonal, K &gt; 0 is above the main&#39;</span><span class="p">,&amp;</span>
<a name="ln-10440"></a><span class="s1">&#39;      diagonal and K &lt; 0 is below the main diagonal.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10441"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10442"></a><span class="s1">&#39;triu  Upper triangle. &quot;triu(X)&quot; is the upper triangular part of X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10443"></a><span class="s1">&#39;      &quot;triu(X,K)&quot; is the elements on and above the K-th diagonal of X. K&#39;</span><span class="p">,&amp;</span>
<a name="ln-10444"></a><span class="s1">&#39;      = 0 is the main diagonal, K &gt; 0 is above the main diagonal and K &lt;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10445"></a><span class="s1">&#39;      0 is below the main diagonal.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10446"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10447"></a><span class="s1">&#39;user  Allows personal Fortran subroutines to be linked into&#39;</span><span class="p">,&amp;</span>
<a name="ln-10448"></a><span class="s1">&#39;      LALA. The subroutine should have the heading&#39;</span><span class="p">,&amp;</span>
<a name="ln-10449"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10450"></a><span class="s1">&#39;         SUBROUTINE USER(A,M,N,S,T)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10451"></a><span class="s1">&#39;         REAL or DOUBLEPRECISION A(M,N),S,T&#39;</span><span class="p">,&amp;</span>
<a name="ln-10452"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10453"></a><span class="s1">&#39;      The LALA statement &quot;Y = user(X,s,t)&quot; results in a call to the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10454"></a><span class="s1">&#39;      subroutine with a copy of the matrix X stored in the argument A,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10455"></a><span class="s1">&#39;      its column and row dimensions in M and N, and the scalar parameters&#39;</span><span class="p">,&amp;</span>
<a name="ln-10456"></a><span class="s1">&#39;      s and t stored in S and T. If s and t are omitted, they are set&#39;</span><span class="p">,&amp;</span>
<a name="ln-10457"></a><span class="s1">&#39;      to 0.0. After the return, A is stored in Y. The dimensions M and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10458"></a><span class="s1">&#39;      N may be reset within the subroutine. The statement Y = &quot;user(K)&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10459"></a><span class="s1">&#39;      results in a call with M = 1, N = 1 and A(1,1) = &quot;float(K)&quot;. After&#39;</span><span class="p">,&amp;</span>
<a name="ln-10460"></a><span class="s1">&#39;      the subroutine has been written, it must be compiled and linked&#39;</span><span class="p">,&amp;</span>
<a name="ln-10461"></a><span class="s1">&#39;      to the LALA object code within the local operating system.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10462"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10463"></a><span class="s1">&#39;zeros&#39;</span><span class="p">,&amp;</span>
<a name="ln-10464"></a><span class="s1">&#39;      Returns a matrix of all zeros.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10465"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10466"></a><span class="s1">&#39;         zeros(N)    returns an N by N matrix of zeroes.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10467"></a><span class="s1">&#39;         zeros(M,N)  returns an M by N matrix of zeroes.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10468"></a><span class="s1">&#39;         zeros(X)    returns a matrix of zeroes of the same order as X.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10469"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10470"></a><span class="s1">&#39;FLOW CONTROL&#39;</span><span class="p">,&amp;</span>
<a name="ln-10471"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10472"></a><span class="s1">&#39;else  Used with &quot;if&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10473"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10474"></a><span class="s1">&#39;end   Terminates the scope of &quot;for&quot;, &quot;while&quot; and &quot;if&quot; statements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10475"></a><span class="s1">&#39;      Without &quot;end&quot;s, &quot;for&quot; and &quot;while&quot; repeat all statements up to&#39;</span><span class="p">,&amp;</span>
<a name="ln-10476"></a><span class="s1">&#39;      the end of the line. Each &quot;end&quot; is paired with the closest&#39;</span><span class="p">,&amp;</span>
<a name="ln-10477"></a><span class="s1">&#39;      previous unpaired &quot;for&quot; or &quot;while&quot; and serves to terminate its&#39;</span><span class="p">,&amp;</span>
<a name="ln-10478"></a><span class="s1">&#39;      scope. The line&#39;</span><span class="p">,&amp;</span>
<a name="ln-10479"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10480"></a><span class="s1">&#39;         for I=1:N, for J=1:N, A(I,J)=1/(I+J-1); A&#39;</span><span class="p">,&amp;</span>
<a name="ln-10481"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10482"></a><span class="s1">&#39;      would cause A to be printed N**2 times, once for each new&#39;</span><span class="p">,&amp;</span>
<a name="ln-10483"></a><span class="s1">&#39;      element. On the other hand, the line&#39;</span><span class="p">,&amp;</span>
<a name="ln-10484"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10485"></a><span class="s1">&#39;         for I=1:N, for J=1:N, A(I,J)=1/(I+J-1); end, end, A&#39;</span><span class="p">,&amp;</span>
<a name="ln-10486"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10487"></a><span class="s1">&#39;      will lead to only the final printing of A.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10488"></a><span class="s1">&#39;      Similar considerations apply to &quot;while&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10489"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10490"></a><span class="s1">&#39;      See &quot;exit&quot; (terminates execution of loops or of LALA itself).&#39;</span><span class="p">,&amp;</span>
<a name="ln-10491"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10492"></a><span class="s1">&#39;if    Conditionally execute statements&#39;</span><span class="p">,&amp;</span>
<a name="ln-10493"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10494"></a><span class="s1">&#39;      SIMPLE FORM&#39;</span><span class="p">,&amp;</span>
<a name="ln-10495"></a><span class="s1">&#39;       Enter&#39;</span><span class="p">,&amp;</span>
<a name="ln-10496"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10497"></a><span class="s1">&#39;         if expression rop expression, statements&#39;</span><span class="p">,&amp;</span>
<a name="ln-10498"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10499"></a><span class="s1">&#39;      where rop is =, &lt;, &gt;, &lt;=, &gt;=, or &lt;&gt; (not equal). The&#39;</span><span class="p">,&amp;</span>
<a name="ln-10500"></a><span class="s1">&#39;      statements are executed once if the indicated comparison&#39;</span><span class="p">,&amp;</span>
<a name="ln-10501"></a><span class="s1">&#39;      between the real parts of the first components of the two&#39;</span><span class="p">,&amp;</span>
<a name="ln-10502"></a><span class="s1">&#39;      expressions is true, otherwise the statements are skipped.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10503"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10504"></a><span class="s1">&#39;      EXAMPLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-10505"></a><span class="s1">&#39;        Enter&#39;</span><span class="p">,&amp;</span>
<a name="ln-10506"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10507"></a><span class="s1">&#39;         if abs(i-j) = 1, a(i,j) = -1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10508"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10509"></a><span class="s1">&#39;      More complicated forms use &quot;end&quot; in the same way it is used with&#39;</span><span class="p">,&amp;</span>
<a name="ln-10510"></a><span class="s1">&#39;      &quot;for&quot; and &quot;while&quot; and use &quot;else&quot; as an abbreviation for &quot;end&quot;,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10511"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10512"></a><span class="s1">&#39;         if expression not rop expression&#39;</span><span class="p">,&amp;</span>
<a name="ln-10513"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10514"></a><span class="s1">&#39;      EXAMPLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-10515"></a><span class="s1">&#39;        Enter&#39;</span><span class="p">,&amp;</span>
<a name="ln-10516"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10517"></a><span class="s1">&#39;         for i = 1:n, for j = 1:n, ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-10518"></a><span class="s1">&#39;            if i = j, a(i,j) = 2; else if abs(i-j) = 1, a(i,j) = -1; ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-10519"></a><span class="s1">&#39;            else a(i,j) = 0;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10520"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10521"></a><span class="s1">&#39;      An easier way to accomplish the same thing is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10522"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10523"></a><span class="s1">&#39;         a = 2*eye(n);&#39;</span><span class="p">,&amp;</span>
<a name="ln-10524"></a><span class="s1">&#39;         for i = 1:n-1, a(i,i+1) = -1; a(i+1,i) = -1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10525"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10526"></a><span class="s1">&#39;for   Repeat statements a specific number of times.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10527"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10528"></a><span class="s1">&#39;         for variable = expr, statement, ..., statement, end&#39;</span><span class="p">,&amp;</span>
<a name="ln-10529"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10530"></a><span class="s1">&#39;      The &quot;end&quot; at the end of a line may be omitted. The comma before the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10531"></a><span class="s1">&#39;      &quot;end&quot; may also be omitted. The columns of the expression are stored&#39;</span><span class="p">,&amp;</span>
<a name="ln-10532"></a><span class="s1">&#39;      one at a time in the variable and then the following statements,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10533"></a><span class="s1">&#39;      up to the &quot;end&quot;, are executed.  The expression is often of the form&#39;</span><span class="p">,&amp;</span>
<a name="ln-10534"></a><span class="s1">&#39;      X:Y, in which case its columns are simply scalars. Some examples&#39;</span><span class="p">,&amp;</span>
<a name="ln-10535"></a><span class="s1">&#39;      (assume N has already been assigned a value).&#39;</span><span class="p">,&amp;</span>
<a name="ln-10536"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10537"></a><span class="s1">&#39;       for I = 1:N, for J = 1:N, A(I,J) = 1/(I+J-1);&#39;</span><span class="p">,&amp;</span>
<a name="ln-10538"></a><span class="s1">&#39;       for J = 2:N-1, A(J,J) = J; end; A&#39;</span><span class="p">,&amp;</span>
<a name="ln-10539"></a><span class="s1">&#39;       for S = 1.0: -0.1: 0.0, ... steps S with increments of -0.1 .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10540"></a><span class="s1">&#39;       for E = eye(N), ... sets E to the unit N-vectors.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10541"></a><span class="s1">&#39;       for V = A, ... has the same effect as&#39;</span><span class="p">,&amp;</span>
<a name="ln-10542"></a><span class="s1">&#39;       for J = 1:N, V = A(:,J); ... except J is also set here.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10543"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10544"></a><span class="s1">&#39;while  Repeat statements an indefinite number of times.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10545"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10546"></a><span class="s1">&#39;          while expr rop expr, statement, ..., statement, end&#39;</span><span class="p">,&amp;</span>
<a name="ln-10547"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10548"></a><span class="s1">&#39;       where rop is =, &lt;, &gt;, &lt;=, &gt;=, or &lt;&gt; (not equal). The &quot;end&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10549"></a><span class="s1">&#39;       at the end of a line may be omitted. The comma before the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10550"></a><span class="s1">&#39;       &quot;end&quot; may also be omitted. The commas may be replaced by&#39;</span><span class="p">,&amp;</span>
<a name="ln-10551"></a><span class="s1">&#39;       semicolons to avoid printing. The statements are&#39;</span><span class="p">,&amp;</span>
<a name="ln-10552"></a><span class="s1">&#39;       repeatedly executed as long as the indicated comparison&#39;</span><span class="p">,&amp;</span>
<a name="ln-10553"></a><span class="s1">&#39;       between the real parts of the first components of the two&#39;</span><span class="p">,&amp;</span>
<a name="ln-10554"></a><span class="s1">&#39;       expressions is true.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10555"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10556"></a><span class="s1">&#39;       EXAMPLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-10557"></a><span class="s1">&#39;       (assume a matrix A is already defined).&#39;</span><span class="p">,&amp;</span>
<a name="ln-10558"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10559"></a><span class="s1">&#39;        E = 0*A; F = E + eye; N = 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10560"></a><span class="s1">&#39;        while norm(E+F-E,1) &gt; 0, E = E + F; F = A*F/N; N = N + 1;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10561"></a><span class="s1">&#39;        E&#39;</span><span class="p">,&amp;</span>
<a name="ln-10562"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10563"></a><span class="s1">&#39;exit  Causes termination of a &quot;for&quot; or &quot;while&quot; loop.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10564"></a><span class="s1">&#39;      If not in a loop, terminates execution of LALA.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10565"></a><span class="s1">&#39;      Also see &quot;quit&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10566"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10567"></a><span class="s1">&#39;quit  From the terminal, causes return to the operating system&#39;</span><span class="p">,&amp;</span>
<a name="ln-10568"></a><span class="s1">&#39;      or other program which invoked LALA. From inside an&#39;</span><span class="p">,&amp;</span>
<a name="ln-10569"></a><span class="s1">&#39;      &quot;exec&quot;, causes return to the invoking &quot;exec&quot;, or to the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10570"></a><span class="s1">&#39;      terminal.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10571"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10572"></a><span class="s1">&#39;FILE ACCESS&#39;</span><span class="p">,&amp;</span>
<a name="ln-10573"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10574"></a><span class="s1">&#39;      The &quot;exec&quot;, &quot;save&quot;, &quot;delete&quot;, &quot;load&quot;, &quot;diary&quot;, and &quot;print&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10575"></a><span class="s1">&#39;      functions access files.  The &#39;&#39;file&#39;&#39; parameter takes different&#39;</span><span class="p">,&amp;</span>
<a name="ln-10576"></a><span class="s1">&#39;      forms for different operating systems. On most systems, &#39;&#39;file&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10577"></a><span class="s1">&#39;      may be a string of up to 1024 characters in quotes. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10578"></a><span class="s1">&#39;      &quot;save(&#39;&#39;A&#39;&#39;)&quot; or &quot;exec(&#39;&#39;LALA/demo.exec&#39;&#39;)&quot; . The string will be used&#39;</span><span class="p">,&amp;</span>
<a name="ln-10579"></a><span class="s1">&#39;      as the name of a file in the local operating system.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10580"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10581"></a><span class="s1">&#39;      Check your local installation for details.  The filename must be&#39;</span><span class="p">,&amp;</span>
<a name="ln-10582"></a><span class="s1">&#39;      composed of recognized characters. See &quot;char&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10583"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10584"></a><span class="s1">&#39;      Also see &quot;quit&quot; and &quot;exit&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10585"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10586"></a><span class="s1">&#39;delete  &quot;delete(&#39;&#39;filename&#39;&#39;)&quot; deletes the given file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10587"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10588"></a><span class="s1">&#39;exec  &quot;exec(&#39;&#39;file&#39;&#39;,k)&quot; obtains subsequent LALA input from an&#39;</span><span class="p">,&amp;</span>
<a name="ln-10589"></a><span class="s1">&#39;      external file. The printing of input is controlled by the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10590"></a><span class="s1">&#39;      optional parameter k .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10591"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10592"></a><span class="s1">&#39;      Files are searched for by the given name. If not found, it is searched&#39;</span><span class="p">,&amp;</span>
<a name="ln-10593"></a><span class="s1">&#39;      for in the colon-separated directory names in the environment variable&#39;</span><span class="p">,&amp;</span>
<a name="ln-10594"></a><span class="s1">&#39;      LALA_PATH. It is looked for first literally by the given name, and then&#39;</span><span class="p">,&amp;</span>
<a name="ln-10595"></a><span class="s1">&#39;      by the name suffixed with &quot;.la&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10596"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10597"></a><span class="s1">&#39;      &quot;include&quot; is an alias for &quot;exec&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10598"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10599"></a><span class="s1">&#39;         If k = 0 , there is no echo, prompt or pause. This is the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10600"></a><span class="s1">&#39;                    default if the exec command is followed by a semicolon.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10601"></a><span class="s1">&#39;         If k = 1 , the input is echoed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10602"></a><span class="s1">&#39;         If k = 2 , the LALA prompt &lt;&gt; is printed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10603"></a><span class="s1">&#39;         If k = 3 , there will be echos and prompts, but no pauses.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10604"></a><span class="s1">&#39;                    This is the the default if the exec command is not&#39;</span><span class="p">,&amp;</span>
<a name="ln-10605"></a><span class="s1">&#39;                    followed by a semicolon.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10606"></a><span class="s1">&#39;         If k = 4 , LALA pauses before each prompt and waits for a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10607"></a><span class="s1">&#39;                    null line to continue.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10608"></a><span class="s1">&#39;         If k = 7 , there will be echos, prompts and pauses. This is&#39;</span><span class="p">,&amp;</span>
<a name="ln-10609"></a><span class="s1">&#39;                    useful for demonstrations on video terminals.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10610"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10611"></a><span class="s1">&#39;      &quot;exec&quot;&#39;&#39;s may be nested, i.e. the text in the file may contain&#39;</span><span class="p">,&amp;</span>
<a name="ln-10612"></a><span class="s1">&#39;      &quot;exec&quot; of another file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10613"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10614"></a><span class="s1">&#39;      &quot;exec&quot; may not be recursive, as Fortran (currently) does not allow&#39;</span><span class="p">,&amp;</span>
<a name="ln-10615"></a><span class="s1">&#39;      for multiple opens of a file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10616"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10617"></a><span class="s1">&#39;      &quot;exec&quot;s may also be driven by &quot;for&quot; and &quot;while&quot; loops.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10618"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10619"></a><span class="s1">&#39;include  &quot;include&quot; is an alias for &quot;exec&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10620"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10621"></a><span class="s1">&#39;load  &quot;load(&#39;&#39;file&#39;&#39;)&quot; retrieves all the variables from the file .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10622"></a><span class="s1">&#39;      See FILE and &quot;save&quot; for more details. To prepare your own&#39;</span><span class="p">,&amp;</span>
<a name="ln-10623"></a><span class="s1">&#39;      file for &quot;load&quot;ing, change the &quot;read&quot; to &quot;write&quot; in the code&#39;</span><span class="p">,&amp;</span>
<a name="ln-10624"></a><span class="s1">&#39;      given under &quot;save&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10625"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10626"></a><span class="s1">&#39;print  &quot;print(&#39;&#39;file&#39;&#39;,X)&quot; prints X on the file using the current&#39;</span><span class="p">,&amp;</span>
<a name="ln-10627"></a><span class="s1">&#39;       format determined by &quot;short&quot;, &quot;long z&quot;, etc. See FILE.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10628"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10629"></a><span class="s1">&#39;doc   does nothing at the moment&#39;</span><span class="p">,&amp;</span>
<a name="ln-10630"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10631"></a><span class="s1">&#39;save  &quot;save(&#39;&#39;file&#39;&#39;)&quot; stores all the current variables in a file.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10632"></a><span class="s1">&#39;      &quot;save(&#39;&#39;file&#39;&#39;,X)&quot; saves only X . See FILE .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10633"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10634"></a><span class="s1">&#39;      The variables may be retrieved later by &quot;load(&#39;&#39;file&#39;&#39;)&quot; or by your&#39;</span><span class="p">,&amp;</span>
<a name="ln-10635"></a><span class="s1">&#39;      own program using the following code for each matrix.  The lines&#39;</span><span class="p">,&amp;</span>
<a name="ln-10636"></a><span class="s1">&#39;      involving &quot;ximag&quot; may be eliminated if everything is known to&#39;</span><span class="p">,&amp;</span>
<a name="ln-10637"></a><span class="s1">&#39;      be real.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10638"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10639"></a><span class="s1">&#39;        &gt; ! attach LUN to &#39;&#39;file&#39;&#39;, then ...&#39;</span><span class="p">,&amp;</span>
<a name="ln-10640"></a><span class="s1">&#39;        &gt; doubleprecision :: xreal(mmax,nmax)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10641"></a><span class="s1">&#39;        &gt; doubleprecision :: ximag(mmax,nmax)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10642"></a><span class="s1">&#39;        &gt; character(len=32) :: id&#39;</span><span class="p">,&amp;</span>
<a name="ln-10643"></a><span class="s1">&#39;        &gt; read(LUN,&#39;&#39;(a32,3i9)&#39;&#39;) id,m,n,img&#39;</span><span class="p">,&amp;</span>
<a name="ln-10644"></a><span class="s1">&#39;        &gt; do j = 1, n&#39;</span><span class="p">,&amp;</span>
<a name="ln-10645"></a><span class="s1">&#39;        &gt;    read(LUN,&#39;&#39;(4z18)&#39;&#39;) (xreal(i,j), i=1,m)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10646"></a><span class="s1">&#39;        &gt;    if (img .ne. 0) read(LUN,102) (ximag(i,j),i=1,m)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10647"></a><span class="s1">&#39;        &gt; enddo&#39;</span><span class="p">,&amp;</span>
<a name="ln-10648"></a><span class="s1">&#39;        &gt; ! The formats used are system dependent. These are typical.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10649"></a><span class="s1">&#39;        &gt; ! See SUBROUTINE mat_savlod(3f) in your local implementation&#39;</span><span class="p">,&amp;</span>
<a name="ln-10650"></a><span class="s1">&#39;        &gt; ! of LALA.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10651"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10652"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10653"></a><span class="s1">&#39;OUTPUT OPTIONS&#39;</span><span class="p">,&amp;</span>
<a name="ln-10654"></a><span class="s1">&#39;      ( Also see &quot;FILE&quot; (&quot;exec&quot;, &quot;load&quot;, &quot;print&quot;, &quot;save&quot; ))&#39;</span><span class="p">,&amp;</span>
<a name="ln-10655"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10656"></a><span class="s1">&#39;lines  An internal count is kept of the number of lines of output&#39;</span><span class="p">,&amp;</span>
<a name="ln-10657"></a><span class="s1">&#39;       since the last input. Whenever this count approaches a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10658"></a><span class="s1">&#39;       limit, the user is asked whether or not to suppress&#39;</span><span class="p">,&amp;</span>
<a name="ln-10659"></a><span class="s1">&#39;       printing until the next input. Initially the limit is 21.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10660"></a><span class="s1">&#39;       &quot;lines(N)&quot; resets the limit to N .&#39;</span><span class="p">,&amp;</span>
<a name="ln-10661"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10662"></a><span class="s1">&#39;long   See &quot;short&quot; also.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10663"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10664"></a><span class="s1">&#39;       Determine output format. All computations are done in&#39;</span><span class="p">,&amp;</span>
<a name="ln-10665"></a><span class="s1">&#39;       complex arithmetic and double precision if it is available.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10666"></a><span class="s1">&#39;       &quot;short&quot; and &quot;long&quot; merely switch between different output&#39;</span><span class="p">,&amp;</span>
<a name="ln-10667"></a><span class="s1">&#39;       formats.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10668"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10669"></a><span class="s1">&#39;        long     // Scaled fixed point format with about 15 digits.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10670"></a><span class="s1">&#39;        long e   // Floating point format with about 15 digits.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10671"></a><span class="s1">&#39;        long z   // System dependent format, often hexadecimal.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10672"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10673"></a><span class="s1">&#39;short  See &quot;long&quot; also.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10674"></a><span class="s1">&#39;       Determine output format. All computations are done in&#39;</span><span class="p">,&amp;</span>
<a name="ln-10675"></a><span class="s1">&#39;       complex arithmetic and double precision if it is available.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10676"></a><span class="s1">&#39;       &quot;short&quot; and &quot;long&quot; merely switch between different output&#39;</span><span class="p">,&amp;</span>
<a name="ln-10677"></a><span class="s1">&#39;       formats.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10678"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10679"></a><span class="s1">&#39;        short    // Scaled fixed point format with about 5 digits.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10680"></a><span class="s1">&#39;        short e  // Floating point format with about 5 digits.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10681"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10682"></a><span class="s1">&#39;diary  &quot;diary(&#39;&#39;file&#39;&#39;)&quot; causes a copy of all subsequent terminal input and&#39;</span><span class="p">,&amp;</span>
<a name="ln-10683"></a><span class="s1">&#39;       most of the resulting output to be written on the file. &quot;diary(0)&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10684"></a><span class="s1">&#39;       turns it off. See &quot;FILE&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10685"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10686"></a><span class="s1">&#39;display  &quot;display(X)&quot; prints X in a compact format.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10687"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10688"></a><span class="s1">&#39;      If base &gt;= 2 is specified the values are printed as numeric&#39;</span><span class="p">,&amp;</span>
<a name="ln-10689"></a><span class="s1">&#39;      values in the specified base.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10690"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10691"></a><span class="s1">&#39;           display(0:10,10 ) // display values in base 10&#39;</span><span class="p">,&amp;</span>
<a name="ln-10692"></a><span class="s1">&#39;           display(0:10,16 ) // display values as hexadecimal values&#39;</span><span class="p">,&amp;</span>
<a name="ln-10693"></a><span class="s1">&#39;           display(0:10,2 )  // display values as binary numbers&#39;</span><span class="p">,&amp;</span>
<a name="ln-10694"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10695"></a><span class="s1">&#39;      If no base is specified and all the elements of X are integers&#39;</span><span class="p">,&amp;</span>
<a name="ln-10696"></a><span class="s1">&#39;      between 0 and 255, then X is interpreted as LALA text and printed&#39;</span><span class="p">,&amp;</span>
<a name="ln-10697"></a><span class="s1">&#39;      accordingly.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10698"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10699"></a><span class="s1">&#39;         &lt;&gt;display(&#39;&#39;the analysis is complete&#39;&#39;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10700"></a><span class="s1">&#39;           the analysis is complete&#39;</span><span class="p">,&amp;</span>
<a name="ln-10701"></a><span class="s1">&#39;         display(32:126) // print the printable default LALA characters&#39;</span><span class="p">,&amp;</span>
<a name="ln-10702"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10703"></a><span class="s1">&#39;      Otherwise or if the base is one, + , - and blank are printed for&#39;</span><span class="p">,&amp;</span>
<a name="ln-10704"></a><span class="s1">&#39;      positive, negative and zero elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10705"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10706"></a><span class="s1">&#39;         display(rand(24,80)-rand(24,80))&#39;</span><span class="p">,&amp;</span>
<a name="ln-10707"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10708"></a><span class="s1">&#39;      Imaginary parts are ignored.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10709"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10710"></a><span class="s1">&#39;      Note that &quot;display(X,B)&quot; is the same as &quot;display(base(X,B))&quot; except&#39;</span><span class="p">,&amp;</span>
<a name="ln-10711"></a><span class="s1">&#39;      for base 1 except it forces &quot;display&quot; to display numeric values.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10712"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10713"></a><span class="s1">&#39;      &quot;display&quot; has an alias of &quot;disp&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10714"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10715"></a><span class="s1">&#39;plot  &quot;plot(X,Y)&quot; produces a plot of the elements of Y against&#39;</span><span class="p">,&amp;</span>
<a name="ln-10716"></a><span class="s1">&#39;      those of X. plot(Y) is the same as plot(1:n,Y) where n is the number&#39;</span><span class="p">,&amp;</span>
<a name="ln-10717"></a><span class="s1">&#39;      of elements in Y. plot(X,Y,P) or &quot;plot(X,Y,p1,...,pk)&quot; passes the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10718"></a><span class="s1">&#39;      optional parameter vector P or scalars p1 through pk to the plot&#39;</span><span class="p">,&amp;</span>
<a name="ln-10719"></a><span class="s1">&#39;      routine. The default plot routine is a crude printer-plot. This&#39;</span><span class="p">,&amp;</span>
<a name="ln-10720"></a><span class="s1">&#39;      version writes the data as a simple X Y table into a scratch file&#39;</span><span class="p">,&amp;</span>
<a name="ln-10721"></a><span class="s1">&#39;      called &quot;scratch.dat&quot; and then calls the command&#39;</span><span class="p">,&amp;</span>
<a name="ln-10722"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10723"></a><span class="s1">&#39;        xy scratch.dat [options]&#39;</span><span class="p">,&amp;</span>
<a name="ln-10724"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10725"></a><span class="s1">&#39;      Hopefully, you have the command xy(1) in your search path.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10726"></a><span class="s1">&#39;      If not, you can make one by creating a script that calls&#39;</span><span class="p">,&amp;</span>
<a name="ln-10727"></a><span class="s1">&#39;      a plotting utility.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10728"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10729"></a><span class="s1">&#39;         t = 0:50;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10730"></a><span class="s1">&#39;         plot( t.*cos(t), t.*sin(t) )&#39;</span><span class="p">,&amp;</span>
<a name="ln-10731"></a><span class="s1">&#39;         opts=&#39;&#39; -m -1 -title test plot -d pdf&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10732"></a><span class="s1">&#39;         plot( t.*cos(t), t.*sin(t),opts)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10733"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10734"></a><span class="s1">&#39;ENVIRONMENT&#39;</span><span class="p">,&amp;</span>
<a name="ln-10735"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10736"></a><span class="s1">&#39;getenv   get environment variable or return a space&#39;</span><span class="p">,&amp;</span>
<a name="ln-10737"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10738"></a><span class="s1">&#39;            // read commands from a file if an environment variable is set.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10739"></a><span class="s1">&#39;            MATRC=getenv(&#39;&#39;MATRC&#39;&#39;);&#39;</span><span class="p">,&amp;</span>
<a name="ln-10740"></a><span class="s1">&#39;            if MATRC &lt;&gt; &#39;&#39; &#39;&#39;, exec(&#39;&#39;MATRC&#39;&#39;);&#39;</span><span class="p">,&amp;</span>
<a name="ln-10741"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10742"></a><span class="s1">&#39;PERFORMANCE INFORMATION&#39;</span><span class="p">,&amp;</span>
<a name="ln-10743"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10744"></a><span class="s1">&#39;flops  Count of floating point operations.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10745"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10746"></a><span class="s1">&#39;       &quot;flops&quot; is a permanently defined row vector with two elements.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10747"></a><span class="s1">&#39;       &quot;flops(1)&quot; is the cpu time consumed by the the previous&#39;</span><span class="p">,&amp;</span>
<a name="ln-10748"></a><span class="s1">&#39;       statement. &quot;flops(2)&quot; is a cumulative total. &quot;flops&quot; can be used&#39;</span><span class="p">,&amp;</span>
<a name="ln-10749"></a><span class="s1">&#39;       in the same way as any other vector. &quot;flops(2) = 0&quot; resets the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10750"></a><span class="s1">&#39;       cumulative total. In addition, &quot;flops(1)&quot; will be printed whenever&#39;</span><span class="p">,&amp;</span>
<a name="ln-10751"></a><span class="s1">&#39;       a statement is terminated by an extra comma. For example,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10752"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10753"></a><span class="s1">&#39;         X = inv(A);,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10754"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10755"></a><span class="s1">&#39;       or&#39;</span><span class="p">,&amp;</span>
<a name="ln-10756"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10757"></a><span class="s1">&#39;         cond(A), (as the last statement on the line).&#39;</span><span class="p">,&amp;</span>
<a name="ln-10758"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10759"></a><span class="s1">&#39;MISCELLANEOUS&#39;</span><span class="p">,&amp;</span>
<a name="ln-10760"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10761"></a><span class="s1">&#39;CHAR  special issues regarding strings&#39;</span><span class="p">,&amp;</span>
<a name="ln-10762"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10763"></a><span class="s1">&#39;   LALA has a limited facility for handling text. Any string of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10764"></a><span class="s1">&#39;   characters delineated by quotes (with two quotes used to allow one&#39;</span><span class="p">,&amp;</span>
<a name="ln-10765"></a><span class="s1">&#39;   quote within the string) is saved as a vector of integer values that&#39;</span><span class="p">,&amp;</span>
<a name="ln-10766"></a><span class="s1">&#39;   are the ADE (Ascii Decimal Equivalent) value of the character.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10767"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10768"></a><span class="s1">&#39;   In commands { and } are equivalent to ( and )&#39;</span><span class="p">,&amp;</span>
<a name="ln-10769"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10770"></a><span class="s1">&#39;   When defining an array [ and ] or &lt; and &gt; may be used as the delimiters.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10771"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10772"></a><span class="s1">&#39;   lala(3f)  is too flexible about that and lets them be interchanged freely&#39;</span><span class="p">,&amp;</span>
<a name="ln-10773"></a><span class="s1">&#39;   instead of being matched but that will probably change to be more strictly&#39;</span><span class="p">,&amp;</span>
<a name="ln-10774"></a><span class="s1">&#39;   enforced.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10775"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10776"></a><span class="s1">&#39;   Currently &quot; is not a special character but will probably be allowed as a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10777"></a><span class="s1">&#39;   string quoting character in the future.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10778"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10779"></a><span class="s1">&#39;   For example&#39;</span><span class="p">,&amp;</span>
<a name="ln-10780"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10781"></a><span class="s1">&#39;      &#39;&#39;2*A + 3&#39;&#39;        //  is the same as  &lt; 50 42 65 32 43 32 51 &gt;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10782"></a><span class="s1">&#39;      display(32:126)  //  display the basic visible ASCII characters&#39;</span><span class="p">,&amp;</span>
<a name="ln-10783"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10784"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10785"></a><span class="s1">&#39;   So if you wanted to home the cursor and clear the screen on an&#39;</span><span class="p">,&amp;</span>
<a name="ln-10786"></a><span class="s1">&#39;   ANSI-compatible terminal and entered&#39;</span><span class="p">,&amp;</span>
<a name="ln-10787"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10788"></a><span class="s1">&#39;       display(&lt;27,&#39;&#39;[H&#39;&#39;,27,&#39;&#39;[2J&#39;&#39;&gt;)&#39;</span><span class="p">,&amp;</span>
<a name="ln-10789"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10790"></a><span class="s1">&#39;   The terminal screen would clear. More usefully, if you define the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10791"></a><span class="s1">&#39;   string&#39;</span><span class="p">,&amp;</span>
<a name="ln-10792"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10793"></a><span class="s1">&#39;       clr=&#39;&#39;display([27,91,&#39;&#39;&#39;&#39;H&#39;&#39;&#39;&#39;,27,91,&#39;&#39;&#39;&#39;2J&#39;&#39;&#39;&#39;])&#39;&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10794"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10795"></a><span class="s1">&#39;   Then entering&#39;</span><span class="p">,&amp;</span>
<a name="ln-10796"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10797"></a><span class="s1">&#39;       &gt;clr&#39;</span><span class="p">,&amp;</span>
<a name="ln-10798"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10799"></a><span class="s1">&#39;   will clear the screen on ANSI terminals and emulators.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10800"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10801"></a><span class="s1">&#39;DECIMAL ADE TABLE&#39;</span><span class="p">,&amp;</span>
<a name="ln-10802"></a><span class="s1">&#39;      The ASCII Decimal Equivalents&#39;</span><span class="p">,&amp;</span>
<a name="ln-10803"></a><span class="s1">&#39;      *-------*-------*-------*-------*-------*-------*-------*-------*&#39;</span><span class="p">,&amp;</span>
<a name="ln-10804"></a><span class="s1">&#39;      | 00 nul| 01 soh| 02 stx| 03 etx| 04 eot| 05 enq| 06 ack| 07 bel|&#39;</span><span class="p">,&amp;</span>
<a name="ln-10805"></a><span class="s1">&#39;      | 08 bs | 09 ht | 10 nl | 11 vt | 12 np | 13 cr | 14 so | 15 si |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10806"></a><span class="s1">&#39;      | 16 dle| 17 dc1| 18 dc2| 19 dc3| 20 dc4| 21 nak| 22 syn| 23 etb|&#39;</span><span class="p">,&amp;</span>
<a name="ln-10807"></a><span class="s1">&#39;      | 24 can| 25 em | 26 sub| 27 esc| 28 fs | 29 gs | 30 rs | 31 us |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10808"></a><span class="s1">&#39;      | 32 sp | 33  ! | 34  &quot; | 35  # | 36  $ | 37  % | 38  &amp; | 39  &#39;&#39; |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10809"></a><span class="s1">&#39;      | 40  ( | 41  ) | 42  * | 43  + | 44  , | 45  - | 46  . | 47  / |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10810"></a><span class="s1">&#39;      | 48  0 | 49  1 | 50  2 | 51  3 | 52  4 | 53  5 | 54  6 | 55  7 |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10811"></a><span class="s1">&#39;      | 56  8 | 57  9 | 58  : | 59  ; | 60  &lt; | 61  = | 62  &gt; | 63  ? |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10812"></a><span class="s1">&#39;      | 64  @ | 65  A | 66  B | 67  C | 68  D | 69  E | 70  F | 71  G |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10813"></a><span class="s1">&#39;      | 72  H | 73  I | 74  J | 75  K | 76  L | 77  M | 78  N | 79  O |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10814"></a><span class="s1">&#39;      | 80  P | 81  Q | 82  R | 83  S | 84  T | 85  U | 86  V | 87  W |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10815"></a><span class="s1">&#39;      | 88  X | 89  Y | 90  Z | 91  [ | 92  \ | 93  ] | 94  ^ | 95  _ |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10816"></a><span class="s1">&#39;      | 96  ` | 97  a | 98  b | 99  c |100  d |101  e |102  f |103  g |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10817"></a><span class="s1">&#39;      |104  h |105  i |106  j |107  k |108  l |109  m |110  n |111  o |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10818"></a><span class="s1">&#39;      |112  p |113  q |114  r |115  s |116  t |117  u |118  v |119  w |&#39;</span><span class="p">,&amp;</span>
<a name="ln-10819"></a><span class="s1">&#39;      |120  x |121  y |122  z |123  { |124  | |125  } |126  ~ |127 del|&#39;</span><span class="p">,&amp;</span>
<a name="ln-10820"></a><span class="s1">&#39;      *-------*-------*-------*-------*-------*-------*-------*-------*&#39;</span><span class="p">,&amp;</span>
<a name="ln-10821"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10822"></a><span class="s1">&#39;??    Two exclamation marks beginning a line enters command history mode.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10823"></a><span class="s1">&#39;      The rest of the line is treated as an optional initial history&#39;</span><span class="p">,&amp;</span>
<a name="ln-10824"></a><span class="s1">&#39;      edit command. Enter &quot;???&quot; to enter history mode and then display&#39;</span><span class="p">,&amp;</span>
<a name="ln-10825"></a><span class="s1">&#39;      additional instructions.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10826"></a><span class="s1">&#39;      see &quot;EDIT&quot; for further details.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10827"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10828"></a><span class="s1">&#39;EDIT&#39;</span><span class="p">,&amp;</span>
<a name="ln-10829"></a><span class="s1">&#39;      A command line consisting of two question marks(&quot;??&quot;) will cause a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10830"></a><span class="s1">&#39;      small line-based editor to be called (very similar to the CDC NOS&#39;</span><span class="p">,&amp;</span>
<a name="ln-10831"></a><span class="s1">&#39;      editor &quot;xedit&quot;) with a copy of the previous input lines. When the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10832"></a><span class="s1">&#39;      editor returns control to LALA, it will execute the edited command&#39;</span><span class="p">,&amp;</span>
<a name="ln-10833"></a><span class="s1">&#39;      (by default).&#39;</span><span class="p">,&amp;</span>
<a name="ln-10834"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10835"></a><span class="s1">&#39;      In editor mode the command to be edited is shifted over one and the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10836"></a><span class="s1">&#39;      first character of input determines the edit mode. The letter &quot;c&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10837"></a><span class="s1">&#39;      begins a string change (ie. &quot;c/oldstring/newstring/&quot;).  The &quot;l&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10838"></a><span class="s1">&#39;      command lists the lines. A number goes to that command line as&#39;</span><span class="p">,&amp;</span>
<a name="ln-10839"></a><span class="s1">&#39;      listed by the &quot;l&quot; command. If the change command begins with a&#39;</span><span class="p">,&amp;</span>
<a name="ln-10840"></a><span class="s1">&#39;      space a letter replaces the one above it with the exception of&#39;</span><span class="p">,&amp;</span>
<a name="ln-10841"></a><span class="s1">&#39;      the special characters # (delete) &amp; (blank out) and ^ (insert the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10842"></a><span class="s1">&#39;      following string here).&#39;</span><span class="p">,&amp;</span>
<a name="ln-10843"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10844"></a><span class="s1">&#39;      An editing loop is entered until a carriage return on an empty&#39;</span><span class="p">,&amp;</span>
<a name="ln-10845"></a><span class="s1">&#39;      line is entered to accept the new line or a period is entered to&#39;</span><span class="p">,&amp;</span>
<a name="ln-10846"></a><span class="s1">&#39;      cancel the editing.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10847"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10848"></a><span class="s1">&#39;      For example, if you had entered a line such as:&#39;</span><span class="p">,&amp;</span>
<a name="ln-10849"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10850"></a><span class="s1">&#39;         &lt;M,N&gt;=shape(A);for I = 1:M, for J = 1:N, A(I,J) = A(I,J)+3.6;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10851"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10852"></a><span class="s1">&#39;      Then to repeat the command changing &quot;3.6&quot; to &quot;5.1&quot; enter&#39;</span><span class="p">,&amp;</span>
<a name="ln-10853"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10854"></a><span class="s1">&#39;         ??&#39;</span><span class="p">,&amp;</span>
<a name="ln-10855"></a><span class="s1">&#39;      the previous command is then displayed. Now enter&#39;</span><span class="p">,&amp;</span>
<a name="ln-10856"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10857"></a><span class="s1">&#39;         c/3.6/5.1&#39;</span><span class="p">,&amp;</span>
<a name="ln-10858"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10859"></a><span class="s1">&#39;      and then enter a carriage return and the edited line will be&#39;</span><span class="p">,&amp;</span>
<a name="ln-10860"></a><span class="s1">&#39;      executed.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10861"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10862"></a><span class="s1">&#39;      The first command can appear on the same line if the line starts&#39;</span><span class="p">,&amp;</span>
<a name="ln-10863"></a><span class="s1">&#39;      with &quot;?? &quot; (two question marks followed by a space). For example&#39;</span><span class="p">,&amp;</span>
<a name="ln-10864"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10865"></a><span class="s1">&#39;         ?? /rand&#39;</span><span class="p">,&amp;</span>
<a name="ln-10866"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10867"></a><span class="s1">&#39;      would take you into edit mode on the last command containing the&#39;</span><span class="p">,&amp;</span>
<a name="ln-10868"></a><span class="s1">&#39;      string &quot;rand&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10869"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10870"></a><span class="s1">&#39;      Enter &quot;?&quot; in edit mode to display further help on editor mode.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10871"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10872"></a><span class="s1">&#39;eps   Floating point relative accuracy. A permanent variable&#39;</span><span class="p">,&amp;</span>
<a name="ln-10873"></a><span class="s1">&#39;      whose value is initially the distance from 1.0 to the next largest&#39;</span><span class="p">,&amp;</span>
<a name="ln-10874"></a><span class="s1">&#39;      floating point number. The value is changed by &quot;chop&quot;, and other&#39;</span><span class="p">,&amp;</span>
<a name="ln-10875"></a><span class="s1">&#39;      values may be assigned. &quot;eps&quot; is used as a default tolerance by &quot;pinv&quot;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10876"></a><span class="s1">&#39;      and &quot;rank&quot;.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10877"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10878"></a><span class="s1">&#39;lala  A placeholder for a new command.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10879"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10880"></a><span class="s1">&#39;debug  &quot;debu(1)&quot; turns on verbose low-level debugging for the developer,&#39;</span><span class="p">,&amp;</span>
<a name="ln-10881"></a><span class="s1">&#39;       &quot;debu(0)&quot; turns it back off.&#39;</span><span class="p">,&amp;</span>
<a name="ln-10882"></a><span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-10883"></a><span class="s1">&#39;================================================================================&#39;</span><span class="p">,&amp;</span>
<a name="ln-10884"></a><span class="s1">&#39;&#39;</span><span class="p">]</span>
<a name="ln-10885"></a><span class="k">end subroutine </span><span class="n">mat_help_text</span>
<a name="ln-10886"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10887"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10888"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10889"></a><span class="k">function </span><span class="n">find_exec_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">returned</span><span class="p">)</span>
<a name="ln-10890"></a><span class="c">! look for file. If not found look for file.la. If not found, repeat using directories in MATRIX_PATH=DIR1:DIR2:DIR3...</span>
<a name="ln-10891"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>
<a name="ln-10892"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span>            <span class="kd">::</span> <span class="n">returned</span>
<a name="ln-10893"></a>   <span class="k">if</span><span class="p">(</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span><span class="k">then</span>
<a name="ln-10894"></a><span class="k">      </span><span class="n">returned</span><span class="o">=</span><span class="n">filename</span>
<a name="ln-10895"></a>   <span class="n">elseif</span><span class="p">(</span><span class="n">exists</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.la&#39;</span><span class="p">))</span><span class="k">then</span>
<a name="ln-10896"></a><span class="k">      </span><span class="n">returned</span><span class="o">=</span><span class="n">filename</span><span class="o">//</span><span class="s1">&#39;.la&#39;</span>
<a name="ln-10897"></a>   <span class="k">else</span>
<a name="ln-10898"></a><span class="k">      </span><span class="n">returned</span><span class="o">=</span><span class="n">lookfor</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;LALA_PATH&#39;</span><span class="p">)</span>
<a name="ln-10899"></a>      <span class="k">if</span><span class="p">(</span><span class="n">returned</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="k">then</span>
<a name="ln-10900"></a><span class="k">         </span><span class="n">returned</span><span class="o">=</span><span class="n">lookfor</span><span class="p">(</span><span class="n">filename</span><span class="o">//</span><span class="s1">&#39;.la&#39;</span><span class="p">,</span><span class="s1">&#39;LALA_PATH&#39;</span><span class="p">)</span>
<a name="ln-10901"></a>      <span class="k">endif</span>
<a name="ln-10902"></a><span class="k">      if</span><span class="p">(</span><span class="n">returned</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="n">returned</span><span class="o">=</span><span class="n">filename</span>
<a name="ln-10903"></a>   <span class="k">endif</span>
<a name="ln-10904"></a><span class="k">end function </span><span class="n">find_exec_file</span>
<a name="ln-10905"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10906"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10907"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10908"></a><span class="kt">logical </span><span class="k">function </span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a name="ln-10909"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>
<a name="ln-10910"></a>    <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">exist</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
<a name="ln-10911"></a><span class="k">end function</span>
<a name="ln-10912"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10913"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10914"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10915"></a><span class="k">subroutine </span><span class="n">printit</span><span class="p">()</span>
<a name="ln-10916"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-10917"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">m</span><span class="p">,</span><span class="n">n</span>
<a name="ln-10918"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">l</span>
<a name="ln-10919"></a><span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">))</span> <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;G_PSEUDO_FILE:SIZE:&#39;</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">G_PSEUDO_FILE</span><span class="p">)</span>
<a name="ln-10920"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_PROMPT:&#39;</span><span class="p">,</span><span class="n">G_PROMPT</span><span class="p">,</span><span class="s1">&#39;:G_ECHO:&#39;</span><span class="p">,</span><span class="n">G_ECHO</span>
<a name="ln-10921"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_LIN:&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">ade2str</span><span class="p">(</span><span class="n">G_LIN</span><span class="p">))</span>
<a name="ln-10922"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_LINE_POINTER:&#39;</span><span class="p">,</span><span class="n">G_LINE_POINTER</span>
<a name="ln-10923"></a><span class="c">!                                              ! [1] first character to process in current line</span>
<a name="ln-10924"></a><span class="c">!                                              ! [2] last character to process in current line</span>
<a name="ln-10925"></a><span class="c">!                                              ! [3]</span>
<a name="ln-10926"></a><span class="c">!                                              ! [4] pointer into current character in current line being processed</span>
<a name="ln-10927"></a><span class="c">!                                              ! [5]</span>
<a name="ln-10928"></a><span class="c">!                                              ! [6]</span>
<a name="ln-10929"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_LHS:&#39;</span><span class="p">,</span><span class="n">G_LHS</span><span class="p">,</span><span class="s1">&#39;:G_RHS:&#39;</span><span class="p">,</span><span class="n">G_RHS</span>
<a name="ln-10930"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_FIN:&#39;</span><span class="p">,</span><span class="n">G_FIN</span><span class="p">,</span><span class="s1">&#39;:G_FUN:&#39;</span><span class="p">,</span><span class="n">G_FUN</span><span class="p">,</span><span class="s1">&#39;:G_FMT:&#39;</span><span class="p">,</span><span class="n">G_FMT</span>
<a name="ln-10931"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_RIO:&#39;</span><span class="p">,</span><span class="n">G_RIO</span><span class="p">,</span><span class="s1">&#39;:G_INPUT_LUN:&#39;</span><span class="p">,</span><span class="n">G_INPUT_LUN</span>
<a name="ln-10932"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_PTZ:&#39;</span><span class="p">,</span><span class="n">G_PTZ</span><span class="p">,</span><span class="s1">&#39;:G_SYM:&#39;</span><span class="p">,</span><span class="n">G_SYM</span><span class="p">,</span><span class="s1">&#39;:G_SYN:&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">ade2str</span><span class="p">(</span><span class="n">G_SYN</span><span class="p">))</span>
<a name="ln-10933"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_CURRENT_RANDOM_SEED:&#39;</span><span class="p">,</span><span class="n">G_CURRENT_RANDOM_SEED</span><span class="p">,</span><span class="s1">&#39;:G_CURRENT_RANDOM_TYPE:&#39;</span><span class="p">,</span><span class="n">G_CURRENT_RANDOM_TYPE</span>
<a name="ln-10934"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_FLOP_COUNTER:&#39;</span><span class="p">,</span><span class="n">G_FLOP_COUNTER</span>
<a name="ln-10935"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_DEBUG_LEVEL:&#39;</span><span class="p">,</span><span class="n">G_DEBUG_LEVEL</span>
<a name="ln-10936"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_FILE_OPEN_ERROR:&#39;</span><span class="p">,</span><span class="n">G_FILE_OPEN_ERROR</span><span class="p">,</span><span class="s1">&#39;:G_ERR:&#39;</span><span class="p">,</span><span class="n">G_ERR</span>
<a name="ln-10937"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_LINECOUNT:&#39;</span><span class="p">,</span><span class="n">G_LINECOUNT</span>
<a name="ln-10938"></a><span class="c">!                                    ! [1] lines displayed since count started</span>
<a name="ln-10939"></a><span class="c">!                                    ! [2] line limit before warning (ie. page length+1)</span>
<a name="ln-10940"></a><span class="c">!                                    ! [3] 0 or 1 for &quot;semi&quot; mode to be on or off</span>
<a name="ln-10941"></a><span class="c">!                                    ! [4] flag from &quot;exec&quot; command, and ...</span>
<a name="ln-10942"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_BUF:&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">ade2str</span><span class="p">(</span><span class="n">G_BUF</span><span class="p">))</span>
<a name="ln-10943"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;GM_BIGMEM:&#39;</span><span class="p">,</span><span class="n">GM_BIGMEM</span>
<a name="ln-10944"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">gen1</span><span class="p">)</span><span class="s1">&#39;G_TOP_OF_SAVED:&#39;</span><span class="p">,</span><span class="n">G_TOP_OF_SAVED</span><span class="p">,</span><span class="s1">&#39;:G_ARGUMENT_POINTER:&#39;</span><span class="p">,</span><span class="n">G_ARGUMENT_POINTER</span>
<a name="ln-10945"></a><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">GG_MAX_NUMBER_OF_NAMES</span>
<a name="ln-10946"></a>   <span class="n">m</span><span class="o">=</span><span class="n">G_VAR_ROWS</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-10947"></a>   <span class="n">n</span><span class="o">=</span><span class="n">G_VAR_COLS</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-10948"></a>   <span class="n">l</span><span class="o">=</span><span class="n">G_VAR_DATALOC</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-10949"></a>   <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">ade2str</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(:,</span><span class="n">i</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">l</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">m</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span><span class="k">then</span>
<a name="ln-10950"></a><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">i</span><span class="p">,</span><span class="n">ade2str</span><span class="p">(</span><span class="n">G_VAR_IDS</span><span class="p">(:,</span><span class="n">i</span><span class="p">)),</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;VALS=&#39;</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">GM_REALS</span><span class="p">(</span><span class="n">l</span><span class="p">:</span><span class="n">l</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-10951"></a>   <span class="k">endif</span>
<a name="ln-10952"></a><span class="k">enddo</span>
<a name="ln-10953"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-10954"></a><span class="c">! PARSING</span>
<a name="ln-10955"></a><span class="c">!integer,parameter        :: G_PSIZE=32                        ! stack size for pseudo-recursion</span>
<a name="ln-10956"></a><span class="c">!integer                  :: G_IDS(GG_MAX_NAME_LENGTH,G_PSIZE)</span>
<a name="ln-10957"></a><span class="c">!integer                  :: G_PSTK(G_PSIZE)</span>
<a name="ln-10958"></a><span class="c">!integer                  :: G_RSTK(G_PSIZE)</span>
<a name="ln-10959"></a><span class="c">!integer                  :: G_PT</span>
<a name="ln-10960"></a><span class="c">!</span>
<a name="ln-10961"></a><span class="c">!integer                  :: G_CHRA ! current character in line</span>
<a name="ln-10962"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-10963"></a><span class="c">!doubleprecision,allocatable    :: GM_REALS(:), GM_IMAGS(:)               ! set to size of GM_BIGMEM</span>
<a name="ln-10964"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-10965"></a><span class="k">end subroutine </span><span class="n">printit</span>
<a name="ln-10966"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10967"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10968"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10969"></a><span class="k">subroutine </span><span class="n">mat_wdiv</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span><span class="n">ai</span><span class="p">,</span><span class="n">br</span><span class="p">,</span><span class="n">bi</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">ci</span><span class="p">)</span>
<a name="ln-10970"></a>
<a name="ln-10971"></a><span class="c">! ident_17=&quot;@(#)M_LA::mat_wdiv(3fp): c = a/b&quot;</span>
<a name="ln-10972"></a>
<a name="ln-10973"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">ar</span>
<a name="ln-10974"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">ai</span>
<a name="ln-10975"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">br</span>
<a name="ln-10976"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">bi</span>
<a name="ln-10977"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">cr</span>
<a name="ln-10978"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">ci</span>
<a name="ln-10979"></a>
<a name="ln-10980"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">s</span>
<a name="ln-10981"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">d</span>
<a name="ln-10982"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">ars</span>
<a name="ln-10983"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">ais</span>
<a name="ln-10984"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">brs</span>
<a name="ln-10985"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">bis</span>
<a name="ln-10986"></a>
<a name="ln-10987"></a>   <span class="n">s</span> <span class="o">=</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">br</span><span class="p">)</span> <span class="o">+</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">bi</span><span class="p">)</span>
<a name="ln-10988"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10989"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<a name="ln-10990"></a>      <span class="k">return</span>
<a name="ln-10991"></a><span class="k">   endif</span>
<a name="ln-10992"></a><span class="k">   </span><span class="n">ars</span> <span class="o">=</span> <span class="n">ar</span><span class="o">/</span><span class="n">s</span>
<a name="ln-10993"></a>   <span class="n">ais</span> <span class="o">=</span> <span class="n">ai</span><span class="o">/</span><span class="n">s</span>
<a name="ln-10994"></a>   <span class="n">brs</span> <span class="o">=</span> <span class="n">br</span><span class="o">/</span><span class="n">s</span>
<a name="ln-10995"></a>   <span class="n">bis</span> <span class="o">=</span> <span class="n">bi</span><span class="o">/</span><span class="n">s</span>
<a name="ln-10996"></a>   <span class="n">d</span> <span class="o">=</span> <span class="n">brs</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bis</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-10997"></a>   <span class="n">cr</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">((</span><span class="n">ars</span><span class="o">*</span><span class="n">brs</span> <span class="o">+</span> <span class="n">ais</span><span class="o">*</span><span class="n">bis</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)</span>
<a name="ln-10998"></a>   <span class="n">ci</span> <span class="o">=</span> <span class="p">(</span><span class="n">ais</span><span class="o">*</span><span class="n">brs</span> <span class="o">-</span> <span class="n">ars</span><span class="o">*</span><span class="n">bis</span><span class="p">)</span><span class="o">/</span><span class="n">d</span>
<a name="ln-10999"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ci</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ci</span> <span class="o">=</span> <span class="n">mat_flop</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span>
<a name="ln-11000"></a><span class="k">end subroutine </span><span class="n">mat_wdiv</span>
<a name="ln-11001"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-11002"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-11003"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-11004"></a><span class="k">subroutine </span><span class="n">mat_wlog</span><span class="p">(</span><span class="n">in_real</span><span class="p">,</span><span class="n">in_imag</span><span class="p">,</span><span class="n">out_real</span><span class="p">,</span><span class="n">out_imag</span><span class="p">)</span>
<a name="ln-11005"></a>
<a name="ln-11006"></a><span class="c">! ident_22=&quot;@(#)M_LA::mat_wlog(3fp): y = log(x)&quot;</span>
<a name="ln-11007"></a>
<a name="ln-11008"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">in_real</span><span class="p">,</span> <span class="n">in_imag</span>
<a name="ln-11009"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">out_real</span><span class="p">,</span> <span class="n">out_imag</span>
<a name="ln-11010"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">t</span>
<a name="ln-11011"></a><span class="n">doubleprecision</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-11012"></a>   <span class="n">r</span> <span class="o">=</span> <span class="n">mat_pythag</span><span class="p">(</span><span class="n">in_real</span><span class="p">,</span><span class="n">in_imag</span><span class="p">)</span>
<a name="ln-11013"></a>
<a name="ln-11014"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11015"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="c">!  Singularity of LOG or ATAN</span>
<a name="ln-11016"></a>   <span class="k">else</span>
<a name="ln-11017"></a><span class="k">      </span><span class="n">t</span> <span class="o">=</span> <span class="n">datan2</span><span class="p">(</span><span class="n">in_imag</span><span class="p">,</span><span class="n">in_real</span><span class="p">)</span>
<a name="ln-11018"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">in_imag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">in_real</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="n">t</span> <span class="o">=</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="ln-11019"></a>      <span class="n">out_real</span> <span class="o">=</span> <span class="nb">dlog</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a name="ln-11020"></a>      <span class="n">out_imag</span> <span class="o">=</span> <span class="n">t</span>
<a name="ln-11021"></a>   <span class="k">endif</span>
<a name="ln-11022"></a>
<a name="ln-11023"></a><span class="k">end subroutine </span><span class="n">mat_wlog</span>
<a name="ln-11024"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-11025"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-11026"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-11027"></a><span class="k">subroutine </span><span class="n">mat_watan</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">yr</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span>
<a name="ln-11028"></a>
<a name="ln-11029"></a><span class="c">! ident_37=&quot;@(#)M_LA::mat_watan(3fp): y = atan(x) = (i/2)*log((i+x)/(i-x))&quot;</span>
<a name="ln-11030"></a>
<a name="ln-11031"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">xr</span><span class="p">,</span> <span class="n">xi</span>
<a name="ln-11032"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yr</span><span class="p">,</span> <span class="n">yi</span>
<a name="ln-11033"></a><span class="n">doubleprecision</span>             <span class="kd">::</span> <span class="n">tr</span><span class="p">,</span> <span class="n">ti</span>
<a name="ln-11034"></a>
<a name="ln-11035"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">xi</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11036"></a><span class="k">      </span><span class="n">yr</span> <span class="o">=</span> <span class="n">datan2</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-11037"></a>      <span class="n">yi</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11038"></a>   <span class="n">elseif</span> <span class="p">(</span><span class="n">xr</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">dabs</span><span class="p">(</span><span class="n">xi</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11039"></a><span class="k">      call </span><span class="n">mat_wdiv</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">xi</span><span class="p">,</span><span class="o">-</span><span class="n">xr</span><span class="p">,</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">xi</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">ti</span><span class="p">)</span>
<a name="ln-11040"></a>      <span class="k">call </span><span class="n">mat_wlog</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span><span class="n">ti</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">ti</span><span class="p">)</span>
<a name="ln-11041"></a>      <span class="n">yr</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">ti</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-11042"></a>      <span class="n">yi</span> <span class="o">=</span> <span class="n">tr</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-11043"></a>   <span class="k">else</span>
<a name="ln-11044"></a><span class="k">      call </span><span class="n">mat_err</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="c">! Singularity of LOG or ATAN</span>
<a name="ln-11045"></a>   <span class="k">endif</span>
<a name="ln-11046"></a>
<a name="ln-11047"></a><span class="k">end subroutine </span><span class="n">mat_watan</span>
<a name="ln-11048"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-11049"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-11050"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-11051"></a><span class="k">end module </span><span class="n">M_matrix</span>
<a name="ln-11052"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-11053"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-11054"></a><span class="c">!==================================================================================================================================!</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2021-09-17 18:10  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> M_strings was developed by John S. Urban</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>